// /web/private/htdocs/staff/sponomar/TEST/corehtml/jsutils/tileshop_pmc.1/scale_pmc.1.js.orig

function ScaleCtrl(oTileData,oNotifier){var oThis=this;this.oTileData=oTileData;this.oNotifier=oNotifier;this.oCanvas=document.createElement("div");this.oCanvas.className="scale-pmc";this.oCanvas.ondrag=function(){return false;};this.oCanvas.onselectstart=function(){return false;};utils.addEvent(this.oCanvas,"click",function(e){var oTarget=utils.getTargetObj(e);if(typeof oTarget.iScaleIndex=="undefined")return;oThis.oNotifier.Notify(oThis,"disable","");if(!utils.hasClass(oTarget,"selected-"+oTarget.iScaleIndex)){if(oThis.oCanvas.oSelected){utils.removeClass(oThis.oCanvas.oSelected,"selected-"+oThis.oCanvas.oSelected.iScaleIndex);}
utils.addClass(oTarget,"selected-"+oTarget.iScaleIndex);oThis.oCanvas.oSelected=oTarget;oThis.oTileData.iScaleIndex=oTarget.iScaleIndex;oThis.oNotifier.Notify(oTarget,"scale",oThis.oTileData.iScaleIndex);}},false);this.oNotifier.setListener(oThis,"data-is-ready",function(){if(oThis.oTileData.oScales.length>1){oThis.Draw();oThis.oCanvas.style.display="block";}},null);}
ScaleCtrl.prototype.Draw=function(){var oThis=this;utils.removeChildren(this.oCanvas);var oA_Up=null;if(this.oTileData.oScales.length>1){oA_Up=document.createElement("a");oA_Up.setAttribute("href","javascript:void(0)");oA_Up.setAttribute("title","Zoom in");oA_Up.innerHTML="&nbsp;";oA_Up.className="scale-up";this.oCanvas.appendChild(oA_Up);}
utils.addEvent(oA_Up,"click",function(e){oThis.oNotifier.Notify(this,"scale","up");},null);this.oCanvas.oSelected=0;this.oCanvas.iSelectedIndex=0;for(var i=0;i<this.oTileData.oScales.length;i++){if(!this.oTileData.oScales[i])continue;var oA=document.createElement("a");oA.setAttribute("href","javascript:void(0)");oA.setAttribute("title","Zoom to level "+(this.oTileData.oScales.length-i));oA.innerHTML="";oA.iScaleIndex=i;oA.className="scale-"+(i+1);this.oCanvas.appendChild(oA);if(i==this.oTileData.iScaleIndex){utils.addClass(oA,"selected-"+(i+1));oA.setAttribute("title","Zoom level "+(this.oTileData.oScales.length-i));this.oCanvas.oSelected=oA;this.oCanvas.iSelectedIndex=i;}}
var oA_Down=null;if(this.oTileData.oScales.length>1){oA_Down=document.createElement("a");oA_Down.setAttribute("href","javascript:void(0)");oA_Down.setAttribute("title","Zoom out");oA_Down.innerHTML="&nbsp;";oA_Down.className="scale-down";utils.addEvent(oA_Down,"click",function(e){oThis.oNotifier.Notify(this,"scale","down");},null);this.oCanvas.appendChild(oA_Down);}
if(this.oCanvas.iSelectedIndex==0){oA_Up.className="scale-up-disabled";oThis.oNotifier.Notify(oThis,"disable","scale-up");}else if(this.oCanvas.iSelectedIndex==this.oTileData.oScales.length-1){oA_Down.className="scale-down-disabled";oThis.oNotifier.Notify(oThis,"disable","scale-down");}else{oThis.oNotifier.Notify(oThis,"disable","");}}