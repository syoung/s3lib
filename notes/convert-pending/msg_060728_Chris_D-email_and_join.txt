Hi Chris,

Thanks a lot for your help and sorting out issue 1 (image node from scratch) and issue 2 (users on nodes and master).

As for issue 3 (job completion emails), the 'local@gems.rsmas.miami.edu' account has been receiving intermittent emails:

getmail

User 'local' connected successfully to host 'localhost'
Folder 'INBOX' has 92 messages
Subject: test
Subject: Undelivered Mail Returned to Sender
Subject: test3
Subject: test4
Subject: test5
Subject: test10
Subject: test
Subject: test11
Subject: test12_local@gems_to_self
Subject: test13_local@gems_to_self
Subject: test14_vanwye@node002_to_local@gems
Subject: test15_vanwye@node004_to_local@gems
Subject: test17_vanwye@node006_to_local@gems
Subject: test16_vanwye@node005_to_local@gems - 2nd time
Subject: test18_vanwye@node007_to_local@gems
Subject: test19_vanwye@node008_to_local@gems
Subject: test20_vanwye@node009_to_local@gems
Subject: test21_vanwye@node010_to_local@gems
Subject: test22_vanwye@node011_to_local@gems
Subject: test23_vanwye@node012_to_local@gems
Subject: test24_vanwye@node013_to_local@gems
Subject: test25_vanwye@node014_to_local@gems
Subject: test26_vanwye@node015_to_local@gems
Subject: test27_vanwye@node016_to_local@gems
Subject: Job-array task 13.7 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 13.8 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 13.4 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 13.5 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 13.3 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 13.1 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 14.4 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 14.5 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 14.3 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 14.9 (funnybase3-swissprot.sh) Complete
Subject: Job-array task 14.10 (funnybase3-swissprot.sh) Complete
Subject: test vanwye@node008 to local@gems
Subject: test vanwye@node015 to local@gems
Subject: test vanwye@node016 to local@gems
Subject: test vanwye@node014 to local@gems
Subject: test vanwye@node013 to local@gems
Subject: test vanwye@node012 to local@gems
Subject: test vanwye@node011 to local@gems
Subject: test vanwye@node010 to local@gems
Subject: test vanwye@node009 to local@gems
Subject: test vanwye@node008 to local@gems
Subject: test vanwye@node006 to local@gems
Subject: test vanwye@node005 to local@gems
Subject: test vanwye@node004 to local@gems
Subject: test vanwye@node002 to local@gems
Subject: test vanwye@node001 to local@gems
Subject: vanwye@node002 to local@gems
Subject: local@gems to self
Subject: Job-array task 58.9 (funnybase3-ensembl-chimp.sh) Complete
Subject: Job-array task 59.5 (funnybase3-ensembl-chimp.sh) Complete
Subject: Job-array task 60.5 (funnybase3-ensembl-elegans.sh) Complete
Subject: Job-array task 61.2 (funnybase3-ensembl-fugu.sh) Complete
Subject: Job-array task 63.10 (funnybase3-ensembl-elegans.sh) Complete
Subject: Job-array task 65.10 (funnybase3-ensembl-human.sh) Complete
Subject: Job-array task 69.8 (funnybase3-refseq-dog.sh) Complete
Subject: Job-array task 70.6 (funnybase3-refseq-human.sh) Complete
Subject: Job-array task 72.8 (funnybase3-refseq-rat.sh) Complete
Subject: Job-array task 73.9 (funnybase3-unigene-anopheles.sh) Complete
Subject: Job-array task 74.8 (funnybase3-unigene-dog.sh) Complete
Subject: Job-array task 75.6 (funnybase3-unigene-drosophila.sh) Complete
Subject: Job-array task 76.6 (funnybase3-unigene-elegans.sh) Complete
Subject: Job-array task 77.9 (funnybase3-unigene-fugu.sh) Complete
Subject: Job-array task 78.9 (funnybase3-unigene-human.sh) Complete
Subject: Job-array task 79.10 (funnybase3-unigene-hydra.sh) Complete
Subject: Job-array task 81.4 (funnybase3-unigene-pig.sh) Complete
Subject: Job-array task 82.5 (funnybase3-unigene-pine.sh) Complete
Subject: Job-array task 83.5 (funnybase3-unigene-rat.sh) Complete
Subject: Job-array task 84.7 (funnybase3-unigene-rice.sh) Complete
Subject: Job-array task 85.8 (funnybase3-unigene-zebrafish.sh) Complete
Subject: Job-array task 86.8 (funnybase3-unigene-anopheles.sh) Complete
Subject: Job-array task 87.6 (funnybase3-genbank.sh) Complete
Subject: Job-array task 88.4 (funnybase3-genbank.sh) Complete
Subject: Job-array task 89.10 (funnybase3-ensembl-human.sh) Complete
Subject: Job-array task 91.9 (funnybase3-unigene-drosophila.sh) Complete
Subject: Job-array task 92.9 (funnybase3-ensembl-mouse.sh) Complete
Subject: Job-array task 97.3 (funnybase3-ensembl-yeast.sh) Complete
Subject: Job-array task 99.2 (funnybase3-unigene-hydra.sh) Complete
Subject: Job-array task 100.7 (funnybase3-unigene-mouse.sh) Complete
Subject: Job-array task 101.5 (funnybase3-refseq-human.sh) Complete
Subject: Job-array task 102.5 (funnybase3-refseq-mouse.sh) Complete
Subject: Job-array task 104.4 (funnybase3-unigene-anopheles.sh) Complete
Subject: Job-array task 105.6 (funnybase3-unigene-dog.sh) Complete
Subject: Job-array task 106.6 (funnybase3-unigene-drosophila.sh) Complete
Subject: Job-array task 107.3 (funnybase3-unigene-elegans.sh) Complete
Subject: Job-array task 108.3 (funnybase3-unigene-fugu.sh) Complete
Subject: Job-array task 109.5 (funnybase3-unigene-human.sh) Complete
Subject: Job-array task 110.4 (funnybase3-unigene-hydra.sh) Complete
Subject: Job-array task 111.2 (funnybase3-unigene-mouse.sh) Complete

This looks like only one host, possible just the master, is sending messages back to 'local@gems.rsmas.miami.edu'.

So I tested out each node with the script /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh:

gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node002.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 116 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node001.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 117 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@gems.rsmas.miami.edu /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 118 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node004.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 119 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node005.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 120 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node006.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 121 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node007.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 122 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node008.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 123 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node009.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 124 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node010.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 125 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node011.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 126 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node012.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 127 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node013.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 128 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node014.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 129 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node015.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 130 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ sudo qsub -q all.q@node016.cluster.private /Users/local/FUNNYBASE/bin/pipeline2/testblast.sh
Your job 131 ("testblast.sh") has been submitted.
gems:~/FUNNYBASE/bin/pipeline2 local$ 


And there were no new messages in the 'local@gems.rsmas.miami.edu' mailbox!

I checked the 'messages' file for gems:
<snip>
07/28/2006 12:03:15|execd|gems|E|mailer had timeout - killing
07/28/2006 12:03:15|execd|gems|E|mailer exited with exit status = 1
07/28/2006 12:03:38|execd|gems|E|mailer had timeout - killing
07/28/2006 12:03:38|execd|gems|E|mailer exited with exit status = 1

So it at least registered an attempt to send email, as did the nodes (here's the node001/messages file):

<snip>
07/28/2006 09:20:16|execd|node001|E|mailer had timeout - killing
07/28/2006 09:20:16|execd|node001|E|mailer exited with exit status = 1
07/28/2006 09:20:46|execd|node001|E|mailer had timeout - killing
07/28/2006 09:20:46|execd|node001|E|mailer exited with exit status = 1


Do you remember what the settings were when jobs 58 to 111 were sent?



Regarding the 'join' error message, when I run on the command line I still get the same message in the error file:

sudo qsub -sync y -t 1-10 /Users/local/FUNNYBASE/pipeline/blast.databases/funnybase3-refseq-human.sh

Password:
Your job 115.1-10:1 ("funnybase3-refseq-human.sh") has been submitted.
Job 115.4 exited with exit code 0.
Job 115.1 exited with exit code 0.
Job 115.2 exited with exit code 0.
Job 115.3 exited with exit code 0.
Job 115.7 exited with exit code 0.
Job 115.9 exited with exit code 0.
Job 115.8 exited with exit code 0.
Job 115.5 exited with exit code 0.
Job 115.6 exited with exit code 0.
Job 115.10 exited with exit code 0.
gems:~/FUNNYBASE/bin/pipeline2 local$ emacs *115.1

usage: join [-a fileno | -v fileno ] [-e string] [-1 field] [-2 field]
            [-o list] [-t char] file1 file2


Here are the contents of the shell script /Users/local/FUNNYBASE/pipeline/blast.databases/funnybase3-refseq-human.sh:

#!sh
#$ -S /bin/bash

# Tell the SGE that this is an array job, with "tasks" to be numbered 1 to 'max_tasks' (default=16)
# #$ -t 1-10:1

Join output with errors and place in current working directory
#$ -j y
#$ -cwd

# Location of the BLOSUM62 matrix
BLASTMAT=/common/data/blastmat
export BLASTMAT

#$ -M local@gems.rsmas.miami.edu
#$ -m e

# When a single command in the array job is sent to a compute node,
# its task number is stored in the variable SGE TASK ID,
# so we can use the value of that variable to get the results we want:

/common/bin/blastall -p blastx -d /common/data/refseq-human -i /Users/local/FUNNYBASE/pipeline/blast.databases/funnybase3\
.$SGE_TASK_ID -o /Users/local/FUNNYBASE/pipeline/blast.databases/funnybase3.blast.$SGE_TASK_ID -e 1e-10 -M BLOSUM62 -m 7

############################# End of shell script



Cheers,

Stuart



>From: "Chris Dwan via RT" <inquiry-support@bioteam.net>
>Reply-To: inquiry-support@bioteam.net
>To: youngstuart@hotmail.com
>Subject: Re: [bioteam.net #11123] Requesting iDS Certificate
>Date: Fri, 28 Jul 2006 10:23:18 -0400
>
>
> > 2. I can now log in as the young user on the nodes though I can't log
> > in as young on the master node. Do I have to change any settings on
> > the user account or the master node to be able to log in as young on
> > the master node?
>
>Here is what was going on:
>
>users "young" and "vanwye" were defined both in the "local"
>authentication space and in the LDAP space.  On the portal, the local
>authentication took priority.  The nodes, being unable to see the
>local settings for the portal, used LDAP.  Since the users had the
>same name, but different user ids, things were confused.
>
>I've deleted the local users using worgroup manager, and adjusted
>file permissions to the correct UIDs.  I also ran the "Directory
>Access" application to cause the portal to look at its own LDAP
>domain for authentication.  This should have been set automatically,
>but it wasn't.
>
>There is still a problem with the "vanwye" account, in that the home
>directory is not set correctly.  Please set it to "/Users/vanwye" in
>Workgroup Admin.  You will have to authenticate as "diiradmin" to do
>this.
>
> > 3. 'join' problem - the script is at:
> >
> > /Users/local/FUNNYBASE/bin/pipeline2/funnybasearrayblast.pl
> >
> > USAGE:
> >
> > cd /Users/local/FUNNYBASE/bin/pipeline2
> > sudo ./funnybasearrayblast.pl -c conf/young.conf
>
>This error message is straight from the command line:
>
>gems:/Users/local/FUNNYBASE/bin/pipeline2 root# join
>usage: join [-a fileno | -v fileno ] [-e string] [-1 field] [-2 field]
>              [-o list] [-t char] file1 file2
>
>In that directory, the only instances of "join" are in perl scripts,
>and look like this:
>
>my $id_string = join " ", @ids;
>
>Best I can figure, without getting too in depth about how this code
>works (which would be well out of scope for inquiry support), is that
>at some point a perl command is being interpreted by a shell as
>something to be run on the command line.
>
>I ran a pair of test array jobs as user "www" in ~www, and verified
>that array jobs work.
>
>I'm sort of lost as to where we are with mail at this point.  Does
>the system do what you need it to, regarding email?
>
>-Chris Dwan
>   The Bioteam
>
>
>


From : 	Chris Dwan via RT <inquiry-support@bioteam.net>
Reply-To : 	inquiry-support@bioteam.net
Sent : 	Friday, July 28, 2006 1:28 PM
To : 	youngstuart@hotmail.com
Subject : 	Re: [bioteam.net #11123] Requesting iDS Certificate
	
	
Go to previous message	|	Go to next message	|	Delete	|	Inbox

Good morning,

I'm still baffled by mail delivery on your system.  Hopefully one of  
the other bioteam folks can jump in and help out here.

One question on that:  Do you have an institutional firewall that  
might be messing with us?  That would also explain why I can't get in  
(directly) via ARD.  If you see motion on the screen, I've connected  
via remote desktop by way of an ssh tunnel.  Hopefully things will be  
more obvious through the GUI than they were from the command line.

> 2. I can now log in as the young user on the nodes though I can't log
> in as young on the master node. Do I have to change any settings on
> the user account or the master node to be able to log in as young on
> the master node?

It looks like "young" has a different UID on the master than on the  
nodes:

gems:/Users root# id young
uid=1026(young) gid=20(staff) groups=20(staff), 80(admin)

gems:/Users root# ssh node001 id young
uid=1029(young) gid=20(staff) groups=20(staff), 80(admin)

I'm not totally sure how that would have happened.  I'll check to see  
how things are defined.

> 3. 'join' problem - the script is at:
>
> /Users/local/FUNNYBASE/bin/pipeline2/funnybasearrayblast.pl
>
> USAGE:
>
> cd /Users/local/FUNNYBASE/bin/pipeline2
> sudo ./funnybasearrayblast.pl -c conf/young.conf

Looking into this as well.  Just wanted to send an update, since I  
said it would be done this morning, and it's not.

-Chris Dwan
  The BioTeam

