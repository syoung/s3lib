

</entry>



<entry [Thu Oct 28 12:35:09 EDT 2010] RERUN MAQ loop.pl ASKING ONLY FOR THE BEST HIT>




*** HUNG PEGASUS SO CANCELLED JOBS ***



USE -C OPTION TO SPECIFY ONLY ONE HIT

Usage:   maq map [options] <out.map> <chr.bfa> <reads_1.bfq> [reads_2.bfq]

    -C INT      max number of hits to output. >512 for all 01 hits. [250]


FIRST ROUND
-----------

screen -S loop-maq-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--replicates 1-10 \
--concurrent \
--params "-C 1" \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/%REPLICATE% \
--species human \
--label maq-200bp-chr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/%REPLICATE%/maq-200bp-chr22-%REPLICATE%.out 



SECOND ROUND
------------


/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--replicates 17-33 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/%REPLICATE% \
--species human \
--label maq-200bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/%REPLICATE%/maq-200bp-autochr22-%REPLICATE%.out 










NOTES
-----

/nethome/bioinfo/apps/maq/0.7.1/maq match 

Usage:   maq map [options] <out.map> <chr.bfa> <reads_1.bfq> [reads_2.bfq]

Options: -1 INT      length of the first read (<=127) [0]
         -2 INT      length of the second read (<=127) [0]
         -m FLOAT    rate of difference between reads and references [0.001]
         -e INT      maximum allowed sum of qualities of mismatches [70]
         -d FILE     adapter sequence file [null]
         -a INT      max distance between two paired reads [250]
         -A INT      max distance between two RF paired reads [0]
         -n INT      number of mismatches in the first 24bp [2]
         -M c|g      methylation alignment mode [null]
         -u FILE     dump unmapped and poorly aligned reads to FILE [null]
         -H FILE     dump multiple/all 01-mismatch hits to FILE [null]
         -C INT      max number of hits to output. >512 for all 01 hits. [250]
         -s INT      seed for random number generator [random]
         -W          disable Smith-Waterman alignment
         -t          trim all reads (usually not recommended)
         -c          match in the colorspace
         


</entry>



<entry [Wed Oct 20 12:56:25 EDT 2010] TO DO>



#### FIX NOVOALIGN.pl USAGE  #### DONE Wed Oct 20 12:54:25 EDT 2010
    

#### DISTRIBUTED SAV.pl     #### DONE  Fri Oct 22 11:22:11 EDT 2010
(threaded Loop.pm, copy sqlite db file to outdir):
    - including dbSNP with 3.3 billion-read SNPs


#### COVERAGE (C or pl SCRIPT)  #### DONE Mon Oct 25 16:49:50 EDT 2010
CREATED bamCoverage.pl
http://picard.sourceforge.net/command-line-overview.shtml#CompareSAMs
http://www.broadinstitute.org/gsa/wiki/index.php/Running_the_GATK_for_the_first_time
pysam
http://wwwfgu.anat.ox.ac.uk/~andreas/documentation/samtools/api.html


#### CHECK MAQ RUNS #### ONWORKING

- SNP CALLING FAILURES DUE TO FAILED sam SORT JOBS (CLUSTER NODE FAILURES?)

- FIXED BY RERUNNING AND USING bam INTERMEDIARY


*** MAQ FILE 7: RUNNING ALIGNMENT ***  Tue Oct 26 20:55:48 EDT 2010
RERUN SNP CALLS WHEN ALIGNMENT IS FINISHED (WITH CORRECTED hit.sam FILENAME)


#### FIX BOWTIE SNPS #### ONWORKING

BOWTIE FILE 9: SNP PREDICTION COMPLETED

*** BOWTIE FILE 1: ALIGNMENT RUNNING ***



#### FIX TOTAL HIT READ COUNTS #### ONWORKING
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/
~/base/bin/utils/lines.pl out.hitct.sorted
    out.hitct.sorted: 632884


RUN snpVenn.pl AGAINST ALL


DE NOVO SNPS (VELVET, LOCAL REALIGNMENT) vs 3.3 billion read SNPs
http://www.broadinstitute.org/gsa/wiki/index.php/Local_realignment_around_indels


RUN bamCoverage.pl ON ALL ELAND







</entry>



<entry [Mon Nov  1 12:26:04 EDT 2010] CREATED indexReads.pl, lookupRead.pl AND numberReads.pl FOR FAST LOOKUP OF READ HITS>





MAQ  **** DID NOT LOAD!!
---

1. LOOP THROUGH ALL MAQ (3.3 BILLION READS) VS chr22 hit.sam FILES (3.9GB EACH)

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/indexes
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/indexes

screen -S maq-indexreads

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/indexReads.pl \
--replicates 1-33 \
--loop distributed \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/%REPLICATE%/chr22/hit.sam \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/%REPLICATE%/chr22/hit.db \
--outdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/indexes \
--label maq-chr22-indexReads \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 


    4 HOURS
    
RUNNING
Wed Nov  3 14:20:31 EDT 2010

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq
ll */chr22/hit.db
    
    -rw-rw-rw- 1 syoung root 311M Nov  3 17:15 10/chr22/hit.db
    -rw-rw-rw- 1 syoung root 383M Nov  3 17:15 11/chr22/hit.db
    -rw-rw-rw- 1 syoung root 315M Nov  3 17:15 12/chr22/hit.db
    -rw-rw-rw- 1 syoung root 316M Nov  3 17:15 13/chr22/hit.db
    -rw-rw-rw- 1 syoung root 310M Nov  3 17:15 14/chr22/hit.db
    -rw-rw-rw- 1 syoung root 309M Nov  3 17:15 15/chr22/hit.db
    -rw-rw-rw- 1 syoung root 666M Nov  3 17:15 16/chr22/hit.db
    -rw-rw-rw- 1 syoung root 556M Nov  3 17:15 17/chr22/hit.db
    -rw-rw-rw- 1 syoung root 558M Nov  3 17:15 18/chr22/hit.db
    -rw-rw-rw- 1 syoung root 557M Nov  3 17:15 19/chr22/hit.db
    -rw-rw-rw- 1 syoung root 424M Nov  3 17:15 1/chr22/hit.db
    -rw-rw-rw- 1 syoung root 469M Nov  3 17:15 20/chr22/hit.db
    -rw-rw-rw- 1 syoung root 514M Nov  3 17:15 21/chr22/hit.db
    -rw-rw-rw- 1 syoung root 426M Nov  3 17:15 22/chr22/hit.db
    -rw-rw-rw- 1 syoung root 424M Nov  3 17:15 23/chr22/hit.db
    -rw-rw-rw- 1 syoung root 456M Nov  3 17:15 24/chr22/hit.db
    -rw-rw-rw- 1 syoung root 448M Nov  3 17:15 25/chr22/hit.db
    -rw-rw-rw- 1 syoung root 555M Nov  3 17:15 26/chr22/hit.db
    -rw-rw-rw- 1 syoung root 505M Nov  3 17:15 27/chr22/hit.db
    -rw-rw-rw- 1 syoung root 363M Nov  3 17:16 28/chr22/hit.db
    -rw-rw-rw- 1 syoung root 362M Nov  3 17:16 29/chr22/hit.db
    -rw-rw-rw- 1 syoung root 429M Nov  3 17:15 2/chr22/hit.db
    -rw-rw-rw- 1 syoung root 358M Nov  3 17:16 30/chr22/hit.db
    -rw-rw-rw- 1 syoung root 364M Nov  3 17:16 31/chr22/hit.db
    -rw-rw-rw- 1 syoung root 363M Nov  3 17:16 32/chr22/hit.db
    -rw-rw-rw- 1 syoung root 364M Nov  3 17:16 33/chr22/hit.db
    -rw-rw-rw- 1 syoung root 465M Nov  3 17:15 3/chr22/hit.db
    -rw-rw-rw- 1 syoung root 468M Nov  3 17:15 4/chr22/hit.db
    -rw-rw-rw- 1 syoung root 530M Nov  3 17:15 5/chr22/hit.db
    -rw-rw-rw- 1 syoung root 530M Nov  3 17:15 6/chr22/hit.db
    -rw-rw-rw- 1 syoung root 530M Nov  3 17:15 7/chr22/hit.db
    -rw-rw-rw- 1 syoung root 524M Nov  3 17:15 8/chr22/hit.db
    -rw-rw-rw- 1 syoung root 316M Nov  3 17:15 9/chr22/hit.db



INPUT SAM FILES
---------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq
ll */chr22/hit.sam

    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:06 10/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 31 04:35 11/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 31 07:13 12/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 31 09:25 13/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 31 10:27 14/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 01:46 15/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 04:08 16/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 06:14 17/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 08:18 18/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 10:26 19/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:08 1/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 12:42 20/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 02:29 21/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 04:55 22/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 07:12 23/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 09:41 24/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  1 11:54 25/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 02:03 26/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 04:12 27/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 06:35 28/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 09:04 29/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:10 2/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 10:09 30/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 12:29 31/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 15:00 32/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Nov  2 17:26 33/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:03 3/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:10 4/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:08 5/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:05 6/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:01 7/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:07 8/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 28 17:10 9/chr22/hit.sam



head 1/chr22/hit.sam

    RR002319.5673218:1:61:1847:1157#0       149     chr22   14430048        0       *       *       0       0       CTGGACCAAGACCCCAGACGGAGAGGACTTGAATAT    ,%'%-/235'/176.C-17+(A*A++BC,5-DI-B:    MF:i:192
    SRR004825.1384277:5:23:723:820#0        153     chr22   14430054        5       36M     *       0       0       TTCCTCCTTCAGGAGCGCTGCAGTGGGCCTAAGTGC    "%&+#+-$%7+*+-14(4*2D4,-6FIIDBB4?BID    MF:i:64 AM:i:SM:i:5   NM:i:3  UQ:i:42 H0:i:0  H1:i:0
    ...


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/1/chr22/hit.db \
--readname SRR004825.1384277:5:23:723:820#0
    
    Use of uninitialized value in string eq at /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl line 95.
    Use of uninitialized value in string eq at /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl line 95.
    $VAR1 = [];



/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/numberReads.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/chr22/maq/1/chr22/hit.db
    
    memory usage BEFORE hash:
      RSS    VSZ
     9476 102556
    
    IndexRead::numberReads    Printing sample entries
    memory usage BEFORE counter:
      RSS    VSZ
    10108 102988
    
    IndexRead::numberReads    counter: 0
    memory usage @ counter:
      RSS    VSZ
    10112 102988
    
    Elapsed time: 30 milliseconds
    0






2. LOOP THROUGH ALL CHROMOSOME HITS FOR ELAND USING 2000 bp READS
-----------------------------------------------------------------



**** DID NOT LOAD!!



CREATE DIRECTORIES

screen -S cp-eland-genome

NGSDIR=/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
SCRATCHDIR=/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
mkdir -p $SCRATCHDIR
cd $NGSDIR
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then

        CHROMODIR=$(echo $DIR | egrep "^chr[0-9XY]+" ); 
        if [ "$CHROMODIR" != "" ]; then
    
            echo $CHROMODIR
            mkdir -p $SCRATCHDIR/$CHROMODIR
            cp -f $NGSDIR/$CHROMODIR/hit.sam $SCRATCHDIR/$CHROMODIR/hit.sam
        fi;
    fi;
done;

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
ls -al */hit.sam

    -rw-rw-r-- 1 syoung root 1003970671 Nov  3 13:47 chr10/hit.sam
    -rw-rw-r-- 1 syoung root  942904041 Nov  3 13:47 chr11/hit.sam
    -rw-rw-r-- 1 syoung root  909119074 Nov  3 13:48 chr12/hit.sam
    -rw-rw-r-- 1 syoung root  713832528 Nov  3 13:48 chr13/hit.sam
    -rw-rw-r-- 1 syoung root  746199558 Nov  3 13:49 chr14/hit.sam
    -rw-rw-r-- 1 syoung root  734531817 Nov  3 13:49 chr15/hit.sam
    -rw-rw-r-- 1 syoung root  804951020 Nov  3 13:49 chr16/hit.sam
    -rw-rw-r-- 1 syoung root  775927373 Nov  3 13:50 chr17/hit.sam
    -rw-rw-r-- 1 syoung root  749371798 Nov  3 13:50 chr18/hit.sam
    -rw-rw-r-- 1 syoung root  691927408 Nov  3 13:51 chr19/hit.sam
    -rw-rw-r-- 1 syoung root 1374684848 Nov  3 13:46 chr1/hit.sam
    -rw-rw-r-- 1 syoung root  728311798 Nov  3 13:52 chr20/hit.sam
    -rw-rw-r-- 1 syoung root  644466942 Nov  3 13:52 chr21/hit.sam
    -rw-rw-r-- 1 syoung root  624863844 Nov  3 13:52 chr22/hit.sam
    -rw-rw-r-- 1 syoung root 1370049309 Nov  3 13:51 chr2/hit.sam
    -rw-rw-r-- 1 syoung root 1118192085 Nov  3 13:53 chr3/hit.sam
    -rw-rw-r-- 1 syoung root 1017407860 Nov  3 13:54 chr4/hit.sam
    -rw-rw-r-- 1 syoung root 1024366774 Nov  3 13:54 chr5/hit.sam
    -rw-rw-r-- 1 syoung root 1018264750 Nov  3 13:55 chr6/hit.sam
    -rw-rw-r-- 1 syoung root 1008297544 Nov  3 13:55 chr7/hit.sam
    -rw-rw-r-- 1 syoung root  923247724 Nov  3 13:56 chr8/hit.sam
    -rw-rw-r-- 1 syoung root  834754148 Nov  3 13:56 chr9/hit.sam
    -rw-rw-r-- 1 syoung root  647858086 Nov  3 13:57 chrX/hit.sam
    -rw-rw-r-- 1 syoung root  511598345 Nov  3 13:57 chrY/hit.sam



RUN indexReads.pl IN PARALLEL ON CLUSTER

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/indexes
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/indexes

screen -S eland-indexreads

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/indexReads.pl \
--replicates chr1,chr2,chr3,chr4,chr5,chr6,chr7,chr8,chr9,chr10,chr11,chr12,chr13,chr14,chr15,chr16,chr17,chr18,chr19,chr20,chr21,chr22,chrX,chrY \
--loop distributed \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/%REPLICATE%/hit.sam \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/%REPLICATE%/hit.db \
--outdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/indexes \
--label eland-genome-indexReads \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 

    
    Run time: 04:01:15
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    6:39PM, 3 November 2010
    ****************************************

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
ll chr*/hit.db

    -rw-rw-rw- 1 syoung root 294M Nov  3 18:38 chr10/hit.db
    -rw-rw-rw- 1 syoung root 296M Nov  3 18:38 chr11/hit.db
    -rw-rw-rw- 1 syoung root 282M Nov  3 18:38 chr12/hit.db
    -rw-rw-rw- 1 syoung root 286M Nov  3 18:38 chr13/hit.db
    -rw-rw-rw- 1 syoung root 296M Nov  3 18:38 chr14/hit.db
    -rw-rw-rw- 1 syoung root 291M Nov  3 18:38 chr15/hit.db
    -rw-rw-rw- 1 syoung root 288M Nov  3 18:38 chr16/hit.db
    -rw-rw-rw- 1 syoung root 423M Nov  3 17:28 chr17/hit.db
    -rw-rw-rw- 1 syoung root 402M Nov  3 17:27 chr18/hit.db
    -rw-rw-rw- 1 syoung root 387M Nov  3 17:00 chr19/hit.db
    -rw-rw-rw- 1 syoung root 751M Nov  3 18:00 chr1/hit.db
    -rw-rw-rw- 1 syoung root 397M Nov  3 17:31 chr20/hit.db
    -rw-rw-rw- 1 syoung root 344M Nov  3 17:28 chr21/hit.db
    -rw-rw-rw- 1 syoung root 334M Nov  3 17:22 chr22/hit.db
    -rw-rw-rw- 1 syoung root 744M Nov  3 17:27 chr2/hit.db
    -rw-rw-rw- 1 syoung root 493M Nov  3 18:38 chr3/hit.db
    -rw-rw-rw- 1 syoung root 474M Nov  3 18:39 chr4/hit.db
    -rw-rw-rw- 1 syoung root 469M Nov  3 18:38 chr5/hit.db
    -rw-rw-rw- 1 syoung root 470M Nov  3 18:39 chr6/hit.db
    -rw-rw-rw- 1 syoung root 477M Nov  3 18:38 chr7/hit.db
    -rw-rw-rw- 1 syoung root 477M Nov  3 18:39 chr8/hit.db
    -rw-rw-rw- 1 syoung root 291M Nov  3 18:38 chr9/hit.db
    -rw-rw-rw- 1 syoung root 351M Nov  3 17:30 chrX/hit.db
    -rw-rw-rw- 1 syoung root 283M Nov  3 17:16 chrY/hit.db


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
ll chr*/hit.sam
 
    -rw-rw-r-- 1 syoung root 958M Nov  3 13:47 chr10/hit.sam
    -rw-rw-r-- 1 syoung root 900M Nov  3 13:47 chr11/hit.sam
    -rw-rw-r-- 1 syoung root 868M Nov  3 13:48 chr12/hit.sam
    -rw-rw-r-- 1 syoung root 681M Nov  3 13:48 chr13/hit.sam
    -rw-rw-r-- 1 syoung root 712M Nov  3 13:49 chr14/hit.sam
    -rw-rw-r-- 1 syoung root 701M Nov  3 13:49 chr15/hit.sam
    -rw-rw-r-- 1 syoung root 768M Nov  3 13:49 chr16/hit.sam
    -rw-rw-r-- 1 syoung root 740M Nov  3 13:50 chr17/hit.sam
    -rw-rw-r-- 1 syoung root 715M Nov  3 13:50 chr18/hit.sam
    -rw-rw-r-- 1 syoung root 660M Nov  3 13:51 chr19/hit.sam
    -rw-rw-r-- 1 syoung root 1.3G Nov  3 13:46 chr1/hit.sam
    -rw-rw-r-- 1 syoung root 695M Nov  3 13:52 chr20/hit.sam
    -rw-rw-r-- 1 syoung root 615M Nov  3 13:52 chr21/hit.sam
    -rw-rw-r-- 1 syoung root 596M Nov  3 13:52 chr22/hit.sam
    -rw-rw-r-- 1 syoung root 1.3G Nov  3 13:51 chr2/hit.sam
    -rw-rw-r-- 1 syoung root 1.1G Nov  3 13:53 chr3/hit.sam
    -rw-rw-r-- 1 syoung root 971M Nov  3 13:54 chr4/hit.sam
    -rw-rw-r-- 1 syoung root 977M Nov  3 13:54 chr5/hit.sam
    -rw-rw-r-- 1 syoung root 972M Nov  3 13:55 chr6/hit.sam
    -rw-rw-r-- 1 syoung root 962M Nov  3 13:55 chr7/hit.sam
    -rw-rw-r-- 1 syoung root 881M Nov  3 13:56 chr8/hit.sam
    -rw-rw-r-- 1 syoung root 797M Nov  3 13:56 chr9/hit.sam
    -rw-rw-r-- 1 syoung root 618M Nov  3 13:57 chrX/hit.sam
    -rw-rw-r-- 1 syoung root 488M Nov  3 13:57 chrY/hit.sam


head /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chr1/hit.sam
 
    SRR005734.12191737:4:28:1238:1080       113     chr1    10074   10      36M     =       249239049       249228975       CACCCTCACCCTCACCCTAACCCTAACCCTAACCCA    ++++++++++++++++++++++++++++++++++++    MD:Z:23T5T5T  SM:i:10
    SRR005718.17911234:4:101:474:888        153     chr1    10146   4       36M     *       0       0       CACCCTCACCCTAACCCTAACCCTAACCCTAACCTA    !!)%+!%$+++'+++++++++++*++++++++++++    MD:Z:29T4GT     SM:i:4
    ...
    


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chr1/hit.db \
--readname SRR005734.12191737:4:28:1238:1080

    Use of uninitialized value in string eq at /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl line 95.
    Use of uninitialized value in string eq at /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl line 95.
    $VAR1 = [];


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/numberReads.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chr1/hit.db 




indexReads.pl
-------------

time /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/indexReads.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.db

    IndexRead::buildIndex    Loading inputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam
    100000
    200000
    IndexReads::indexFile    Finished processing inputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam
    IndexRead::buildIndex    Completed
    
    real    0m14.186s
    user    0m12.024s
    sys     0m1.735s


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22
ll hit.db hit.sam

    -rw-rw-rw- 1 syoung root  24M Nov  3 12:49 hit.db
    -rw-rw-rw- 1 syoung root  44M Oct 27 01:00 hit.sam


lookupRead.pl
-------------

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-200.db \
--readname SRR005720.8192700:3:140:594:191#0


numberReads.pl
--------------

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/numberReads.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-200.db

    2


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/numberReads.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.db

    256562
    
    real    0m3.946s
    user    0m1.115s
    sys     0m0.122s


NOTES
-----


TESTS
-----


indexReads.pl
-------------

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/indexReads.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-200.sam \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-200.db

    OK!
    
    IndexRead::buildIndex    Loading inputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-200.sam    
    IndexReads::indexFile    Finished processing inputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-200.sam
    IndexRead::buildIndex    Completed


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/indexReads.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.sam \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db


lookupReads.pl
--------------

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl --dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db --readname SRR005734.15335768:6:14:197:412#0/1 --mode count

    IndexRead::lookupRead    readname: SRR005734.15335768:6:14:197:412#0/1
    IndexRead::lookupRead    dbfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db
    IndexRead::lookupRead   readname SRR005734.15335768:6:14:197:412#0/1 entries: chr22,16113947,147
    IndexRead::lookupRead   scalar = get_dup(SRR005734.15335768:6:14:197:412#0/1, 1)
    2


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl --dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db --readname SRR005734.15335768:6:14:197:412#0/1 --mode array

    IndexRead::lookupRead    readname: SRR005734.15335768:6:14:197:412#0/1
    IndexRead::lookupRead    dbfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db
    IndexRead::lookupRead   readname SRR005734.15335768:6:14:197:412#0/1 entries: chr22,16113947,147
    IndexRead::lookupRead   array = get_dup(SRR005734.15335768:6:14:197:412#0/1):
    
    chr22,16113947,147
    chr22,16113948,147


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl --dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db --readname SRR005734.15335768:6:14:197:412#0/1 --mode hash

    IndexRead::lookupRead    readname: SRR005734.15335768:6:14:197:412#0/1
    IndexRead::lookupRead    dbfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db
    IndexRead::lookupRead   readname SRR005734.15335768:6:14:197:412#0/1 entries: chr22,16113947,147
    IndexRead::lookupRead   hash = get_dup(SRR005734.15335768:6:14:197:412#0/1, 1):
    
    $VAR1 = {
              'chr22,16113947,147' => 1,
              'chr22,16113948,147' => 1
            };



numberReads.pl
--------------

time /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/numberReads.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit-dups.db
    
    1
    
    real    0m0.124s
    user    0m0.103s
    sys     0m0.019s



time /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/numberReads.pl \
--dbfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.db

    256562
    
    real    0m1.690s
    user    0m1.593s
    sys     0m0.086s




2nd COLUMN <FLAG> IN SAM FILE
-----------------------------


0x0001 the read is paired in sequencing, no matter whether it is mapped in a pair
0x0002 the read is mapped in a proper pair (depends on the protocol, normally inferred during alignment) 1
0x0004 the query sequence itself is unmapped
0x0008 the mate is unmapped 1
0x0010 strand of the query (0 for forward; 1 for reverse strand)
0x0020 strand of the mate 1
0x0040 the read is the first read in a pair 1,2
0x0080 the read is the second read in a pair 1,2
0x0100 the alignment is not primary (a read having split hits may have multiple primary alignment records)
0x0200 the read fails platform/vendor quality checks
0x0400 the read is either a PCR duplicate or an optical duplicate

Notes:
1. Flag 0x02, 0x08, 0x20, 0x40 and 0x80 are only meaningful when flag 0x01 is present.
2. If in a read pair the information on which read is the first in the pair is lost in the upstream analysis, flag 0x01 should
be present and 0x40 and 0x80 are both zero.


UNPACKING C STRUCTURES FROM BINARY FILES
----------------------------------------


http://perldoc.perl.org/perlpacktut.html#Packing-and-Unpacking-C-Structures

If you have to deal with a lot of C structures, and don't want to hack all your template strings manually, you'll probably want to have a look at the CPAN module

Convert::Binary::C
Not only can it parse your C source directly, but it also has built-in support for all the odds and ends described further on in this section.



http://search.cpan.org/~mhx/Convert-Binary-C-0.74/lib/Convert/Binary/C.pm

use Convert::Binary::C;
  use Data::Dumper;
  
  #---------------------
  # Create a new object
  #---------------------
  my $c = new Convert::Binary::C ByteOrder => 'BigEndian';
  
  #---------------------------------------------------
  # Add include paths and global preprocessor defines
  #---------------------------------------------------
  $c->Include('/usr/lib/gcc/i686-pc-linux-gnu/4.1.2/include',
              '/usr/include')
    ->Define(qw( __USE_POSIX __USE_ISOC99=1 ));
  
  #----------------------------------
  # Parse the 'time.h' header file
  #----------------------------------
  $c->parse_file('time.h');
  
  #---------------------------------------
  # See which files the object depends on
  #---------------------------------------
  print Dumper([$c->dependencies]);
  
  #-----------------------------------------------------------
  # See if struct timespec is defined and dump its definition
  #-----------------------------------------------------------
  if ($c->def('struct timespec')) {
    print Dumper($c->struct('timespec'));
  }
  
  #-------------------------------
  # Create some binary dummy data
  #-------------------------------
  my $data = "binary_test_string";
  
  #--------------------------------------------------------
  # Unpack $data according to 'struct timespec' definition
  #--------------------------------------------------------
  if (length($data) >= $c->sizeof('timespec')) {
    my $perl = $c->unpack('timespec', $data);
    print Dumper($perl);
  }
  
  #--------------------------------------------------------
  # See which member lies at offset 5 of 'struct timespec'
  #--------------------------------------------------------
  my $member = $c->member('timespec', 5);
  print "member('timespec', 5) = '$member'\n";
  
  


POST ON INDEXING FILES
----------------------

FILEINDEX
http://hackmap.blogspot.com/2010/04/fileindex.html

CODE IS HERE
https://github.com/brentp/bio-playground/blob/master/fileindex/fileindex.py


IDEAS FOR TESTS
---------------

https://github.com/keithj/cl-tokyo-cabinet/blob/master/perf/performance.lisp



PERL B-TREES
------------

sub lookupRead
{
	my $self		=	shift;
	
	my $readname	=	$self->get_readname();
	my $dbfile		=	$self->get_dbfile();

my $DEBUG = 1;
	print "IndexRead::lookupRead    readname: $readname\n" if $DEBUG;
	print "IndexRead::lookupRead    dbfile: $dbfile\n" if $DEBUG;
	
	#### CHECK INPUTS
	print "IndexRead::lookupRead   readname not defined. Exiting\n"
		and exit if not defined $readname;
	print "IndexRead::lookupRead   dbfile not defined. Exiting\n"
		and exit if not defined $dbfile;
	
	# ENABLE DUPLICATE RECORDS
	$DB_BTREE->{'flags'} = R_DUP ;

	my ($key, $value, $x, $status);

	my $hash;
	$x = tie %$hash, "DB_File", $dbfile, O_RDWR|O_CREAT, 0666, $DB_BTREE 
	or die "Cannot open $dbfile: $!\n";

## OK!!!

	# iterate through the btree using seq
	# and print each key/value pair.
#	$key = $value = 0 ;
#    for ($status = $x->seq($key, $value, R_FIRST) ;
#         $status == 0 ;
#         $status = $x->seq($key, $value, R_NEXT) )
#	{
##		print "$key -> $value\n"
#		print "$key -> ";
#		print unpack("A*", $value);
#		print "\n"
#
#	}

	print "entry for readname $readname: $hash->{$readname}\n";

	#### get_dup()
	#### 
	#### 	NB: CAREFUL WITH THE SYNTAX
	####
	####	$count = $x->get_dup($key) ;		<== OK
	####	@list  = $x->get_dup($key) ;		<== OK
	####	%list  = $x->get_dup($key, 1) ;  	<== OK
	####	%list  = $x->get_dup($key) ;  		<== BAD - RETURNS A TRUNCATED ARRAY!
	####	@list  = $x->get_dup($key, 1) ;		<== BAD - RETURNS HASH AS ARRAY!
	
	my $count = $x->get_dup($readname, 1);
	print "scalar = get_dup($readname, 1): $count\n";
	
	my @dupas = $x->get_dup($readname);
	print "array = get_dup($readname):\n";
	print join "\n", @dupas;
	print "\n";
	
	print "hash = get_dup($readname, 1):\n";
	my %duplos = $x->get_dup($readname, 1);
	print Dumper %duplos;
	
	
	#### find_dup()
	#### 
	my $found = ( $x->find_dup("Wall", "Larry") == 0 ? "" : "not") ; 
	print "Larry Wall is $found there\n" ;
	$found = ( $x->find_dup("Wall", "Harry") == 0 ? "" : "not") ; 
	print "Harry Wall is $found there\n" ;


	#### MATCH PARTIAL KEYS
	#### http://perldoc.perl.org/DB_File.html#Handling-Duplicate-Keys
	####
	#### $x->seq($key, $value, R_CURSOR);
	#### Here is the relevant quote from the dbopen man page where it defines
	#### the use of the R_CURSOR flag with seq:
	####    Note, for the DB_BTREE access method, the returned key is not
	####    necessarily an exact match for the specified key. The returned key
	####    is the smallest key greater than or equal to the specified key,
	####    permitting partial key matches and range searches.
	#### In the example script below, the match sub uses this feature to find
	#### and print the first matching key/value pair given a partial key.


    print "IN ORDER\n" ;
	my $st;
    for ($st = $x->seq($key, $value, R_FIRST) ;
		 $st == 0 ;
         $st = $x->seq($key, $value, R_NEXT) )
	{
		print "$key	-> $value\n";
	}
	
	
	sub match
	{
		my $x	=	shift;
		my $key = shift ;
		
		my $value = 0;
		my $orig_key = $key ;
		$x->seq($key, $value, R_CURSOR) ;
		print "$orig_key\t-> $key\t-> $value\n" ;
	}
	
	print "\nPARTIAL MATCH (Returns the smallest key greater than or equal to the specified key)\n" ;
    match($x, "Wa");
    match($x, "A");
    match($x, "a");



my @filedesc = $x->fd ;
print "filedesc: @filedesc\n";


	undef $x; # Forget object reference
	untie(%$hash); # release database
  
}

OUTPUT:

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/lookupRead.pl --readname Wall --dbfile dups1.db

    IndexRead::lookupRead    readname: Wall
    IndexRead::lookupRead    dbfile: dups1.db
    entry for readname Wall: Larry
    scalar = get_dup(Wall, 1): 9
    array = get_dup(Wall):
    Larry
    Brick
    Brick
    Larry
    Brick
    Brick
    Larry
    Brick
    Brick
    hash = get_dup(Wall, 1):
    $VAR1 = 'Brick';
    $VAR2 = 6;
    $VAR3 = 'Larry';
    $VAR4 = 3;
    Larry Wall is  there
    Harry Wall is not there
    IN ORDER
    Smith   -> John
    Smith   -> John
    Smith   -> John
    Wall    -> Larry
    Wall    -> Brick
    Wall    -> Brick
    Wall    -> Larry
    Wall    -> Brick
    Wall    -> Brick
    Wall    -> Larry
    Wall    -> Brick
    Wall    -> Brick
    mouse   -> mickey
    mouse   -> mickey
    mouse   -> mickey
    
    PARTIAL MATCH (Returns the smallest key greater than or equal to the specified key)
    Wa      -> Wall -> Larry
    A       -> Smith        -> John
    a       -> mouse        -> mickey
    filedesc: 3



BERKELEY DB IS ALREADY INSTALLED ON KRONOS
------------------------------------------

yum list db4

    Installed Packages
    db4.i386          4.3.29-10.el5                                installed
    db4.x86_64        4.3.29-10.el5                                installed


PERL IS GOOD FOR THIS
---------------------

        easily read and manipulate text files

        built-in support for fast B-Tree databases

        B-Tree files are designed specifically for fast random access to data on disk
      


http://www.drdobbs.com/184410819;jsessionid=AGMPRGK0HCA0RQE1GHRSKHWATMY32JVN
 
Full-Text Searching in Perl
By Tim Kientzle, January 01, 1999

0 Comments

Full-text search engines are popular these days, and not just on web sites. Tim shows how you can build a fast full-text search capability using Perl's built-in database support.
FULL-TEXT SEARCHING IN PERL
Tim is the senior technical editor for DDJ. He can be reached at kientzle@ddj.com.

I've had to build several full-text search engines recently, and found that Perl works extremely well for this. Not only can Perl easily read and manipulate text files, Perl also has built-in support for fast B-Tree databases. In this article, I'll present some Perl programs that handle very rapid full-text searching. With a little work, you could easily use these programs to provide full-text search capability for a web site.

Standing on Your Head
When you want to view a text file, you name the file and get back all of the words in the file. To perform full-text searching, you have to do the opposite -- name a word and get a list of all of the files containing that word.

The most effective way to do this is to simply build a database whose keys are words. When you look up a word, you get a list of all the files containing that word. Once you have this database, Example 1 can perform full-text searches. With just a little modification, this program can produce HTML search results suitable for use on a web site.

Although Example 1 is short, it is very fast. On a 266-MHz Pentium II, it takes about 0.2 seconds to perform a complete search against a large database (see Table 1). This time includes loading and initializing the Perl interpreter. Most of this speed comes simply from using the right disk access method -- B-Tree files are designed specifically for fast random access to data on disk. Even with the database on slow CD-ROM, searches take less than two seconds.

Conceptually, there are really two databases. The first maps each word to a list of 2-byte integers that will represent the files. Binary integers are the most compact way to store this information, and I don't expect to have more than 65,000 files anytime soon. The second database maps these numbers to file descriptions, which can include a title and a filename or URL. By storing the filename just once for each file, the total size of the index is reduced considerably.

To make the index easier to move around, I've collapsed them into a single file. File number keys are stored with a leading zero byte, which prevents word entries and file entries from colliding.

Working with Berkeley DB
Perl makes it easy to access database files. The tie() function attaches a hash name to an on-disk database file. Perl supports several simple database formats through this mechanism. The one I chose is the "Berkeley DB" package, which supports B-Tree files on disk. Because the C library implementing this file format is freely available, most Perl interpreters support it. Plus, Berkeley DB supports any byte ordering, so you can move database files across platforms with impunity. Berkeley DB supports C, C++, Java, and Perl APIs, for both UNIX and Windows 95/NT. Although Berkeley DB 2.0 is available from Sleepycat Software (http://www.sleepycat.com/), most Perl implementations still rely upon previous versions because of licensing and API changes. The Perl code I present here, for instance, is based on Berkeley DB 1.85/1.86, available from Sleepycat and The Comprehensive Perl Archive Network archives (http:// www.cpan.org/).

The tie() command in Example 1 is typical. The first three arguments are the hash to be bound, the database library to use, and the filename of the on-disk database. The next two arguments are file permissions, indicating whether you're going to read or write the database, and the file mode to be used if the database has to be created. The last argument is a reference to a special variable that specifies how this file should be opened. Example 2 shows how to set the cache and page sizes used by the DB library. (See the Perl documentation if you're unfamiliar with Perl references.)

The tie() call uses the contents of the $DB_BTREE variable when it calls the library to open a DB file, so you have to perform any such manipulations before you open the database file.

Building the Index Database
Perl's string-handling abilities make the basic indexing chore pretty easy. Listing One is indexer_basic.pl, a complete program to build the index. It uses Perl's find() function to visit every file in a directory tree. The IndexFile subroutine identifies HTML files by their extension, reads the entire file into a string in memory, strips the HTML tags, and gives the resulting text to IndexWords. If you wanted to add support for other file formats, it should be easy to do; all you need is a way to obtain raw text from the file. (For example, you might call the GhostScript programs to extract raw text from PostScript or PDF files.)

The IndexWords subroutine first uses Perl's split function to break the $words string into an array of separate words. It then uses Perl's grep command to discard certain nonwords and remove duplicates from the list. Finally, it simply iterates over the words, appending the file key to the database entry for each word.

Although the basic principles are the same, the indexer I currently use (indexer_ big.pl, available electronically; see "Resource Center," page 5) looks quite different from Listing One. To index DDJ articles, for instance, I use a more complex scheme to generate key numbers because I want to map words to articles, as opposed to files. That is, since a single article might contain multiple HTML files, I use some special-purpose Perl coding to convert any HTML filename into the name of the top-level file for that article. This also requires some additional complexity elsewhere, since the filename of the file -- which is needed to read the contents of the file -- is no longer the same as the name being entered into the index for a particular file.

Indexing Tips
The most important step in indexing a file is converting a text string into a list of relevant words. In practice, this is much more complex than Listing One suggests. Consider, for example, that "OS/2" and "C++" are single words, while "and/or" and "index+offset" are each two words separated by a punctuation mark.

To handle this particular problem, my first call to split is very liberal about what constitutes a word; any of the previous examples would be considered a single word. I then call a separate function that looks for compounds (entries that consist of two or more parts separated by /, -, or +) and adds the component pieces to the index as well. After this, the aforementioned examples would result in all of the following being added to the index: "OS/2," "OS," "2," "C++," "C," "and/or," "and," "or," "index+offset," "index," and "offset."

At several points in the indexing process, I examine the words being indexed to refine the final index. Some of these checks are generic. For example, I use a set of regular expressions to recognize and throw out certain nonwords, such as entries that consist only of punctuation and entries that contain only a single character.

Other index improvements require long lists of words. For example, users should get the same result if they search for "analyze" (American spelling) or "analyse" (British). The only way to ensure this is to manually build a list of synonyms and use this list to make sure those words are entered both ways. My complete indexer program includes over 9000 lines with information about words. This information includes:

Synonyms. Words that should be indexed identically.
Stop words. Words that should not be indexed at all.
Variant word forms. Derived forms, such as plurals or conjugated verbs, are also indexed under the root word.
This information was put together the hard way. After my initial indexer was working, I dumped the initial list of some 140,000 "words" to a text file and edited it manually to build the aforementioned lists. The lists are included at the end of the Perl program and read into hash tables when the program starts up. There's still a lot of room for improvement here. If you're serious about building a good index, you might want to spend a few days reviewing and improving these tables of word knowledge.

In general, I've tried to err on the side of including too many words in the database. If you look at the contents of the final database, it's clear that there are a lot of useless entries -- nonwords that are unlikely to ever be used. Unfortunately, I've found no automatic way to purge them. In particular, any text corpus will have enough names, made-up terms, and special words that verifying words against a standard dictionary is a bad idea.

About B-Trees
Recall that a B-Tree file consists of pages stored on disk. Each page is either an internal page, which has keys and pointers to other pages, or a leaf page, which stores keys and their associated data.

To find a particular entry, you start with the top-level page, usually an internal page. You compare the desired key to each key on the page. Your key will fall between two of the keys on that page, which determines the next page number to check. You may walk through several internal pages before you arrive at a leaf page that contains the data you want. Figure 1 illustrates this process.

The depth of this tree depends on the size of the pages. If you increase the page size, you can reduce the depth of the tree, thereby reducing the number of disk accesses needed to retrieve an item, and speeding up your program. In my case, I found that a 32-KB page size was sufficient to produce a two-level tree; any item in my database can be found with only two disk accesses. Better yet, since the top page remains in the database cache, only the first database request requires more than a single disk access. This juggling of page size was especially important because I wanted to put the final database on a CD-ROM. CD-ROMs are exceptionally slow at seeking, which makes it especially important to minimize the number of pages that must be read, since each page read requires a seek.

Because a B-Tree stores items in sorted order, you can speed up multiple searches tremendously by doing your searches in sorted order. If your next search happens to land on the same page, you won't have to go to disk at all, since the required pages will already be in the cache.

Performance
To try out my indexing tools, I used as a testbed 10-years worth of DDJ articles in HTML format. Even with this large collection, search time was simply never an issue. Building the index, however, presented some challenges.

As Table 1 shows, the indexer in Listing One has a serious speed problem. It required over three hours to index my sample corpus. However, it used only 14 minutes of CPU time, which suggests that the program is spending most of its time waiting on disk I/O.

Every time you add a word to the database, you have to find that word in the database first, then write it back with an additional key. Since the replacement is longer, the update is likely to require moving data to accommodate it. In addition, the words in a single file probably span much of the database, so if you're indexing a large number of files, you quickly get to the point where you're skimming through several megabytes of the database for every file you index.

To address this, the current version of my indexer defines %wordCache to be an ordinary in-memory hash, and adds new word entries to that. After indexing 500 files, the indexer calls FlushWordCache (Listing Two) to update the disk database from the in-memory hash. With this change, the total running time dropped from over three hours to a reasonable 20 minutes. The CPU time was practically unchanged.

Refining the Front End
The searcher in Example 1 may be fast, but it's not the ultimate in user friendliness. It currently uses a simplistic ranking scheme that could be improved in many ways:

Use 1 byte in each word's database entry to assign a weight. This weight could then be used to rank articles -- just add up the weights of the words in that article. (The ranking scheme in Example 1 essentially gives every word a weight of 1.) For example, you might weight nouns more heavily than verbs, or specific names (Windows) more heavily than generic terms (GUI).
In the absence of explicit weights, it's easy to modify Example 1 so that less-common words are weighted more heavily than more-common words.
Use 1 bit in each key to mark files that have words in special places. For example, you could set the high bit of the key if that file contains the word in the HTML <TITLE> tag. You could then assign such files a higher rank.
Choose the order of indexing. Example 1 uses the value of the file key as a tie breaker in the sort. I indexed the DDJ articles in reverse-chronological order so that more recent articles would appear earlier in the output.
Of course, the most obvious deficiency of Example 1 is that it simply picks out all of the files that contain at least one word. With a little bit of effort, you could support Boolean expressions or AltaVista-style "+" and "-" expressions.

Ranking and Boolean support are not independent decisions. If you use a more-powerful selection logic, then ranking may not be necessary, since users can quickly narrow their choice. If you use simpler selection logic, then effective ranking becomes more important. Also note that, because I'm using the Berkeley DB library, you could easily reimplement the front end in C or C++ if that's more convenient for you (for example, if you want to implement a yacc grammar to handle complex expressions).

Refining the Back End
The next big step is to make the indexing program more aware of the language it's working with. A program with a large built-in vocabulary and a knowledge of English grammar would be able to identify whether a word was being used as a noun, adjective, or verb. Generally, nouns and adjectives are much more important in an index than verbs. For example, users interested in skip lists would be much more interested in "use a skip list" (adjective, noun) than "skip the first and list the second" (verbs). Such a program might also be able to discriminate between similar-looking words -- compare "Windows have certain properties" to "Windows has certain properties." Such programs are hard to write, though, and require a large database of word knowledge to drive them.

If you're using this on a web site, it might be a good idea to log searches. By reviewing such a log, you can get a better idea what type of things people coming to your site are looking for. In particular, be certain to log searches that returned no results, since they might point out things that did not get properly indexed. A log of search requests is also a useful tool for planning future additions to your site.

Caveats
Although the Berkeley DB package is generally easy to use and quite fast, I have run across a few problems. One common process is to walk through the entries of index.db with Perl's each() command, and selectively modify certain items from the database. I've had several crashes when I've tried to modify items as I walked the database. Instead, I now walk through the database and accumulate a list of items to be modified, then modify those items in a separate pass. Also, I've found that Perl's string-concatenation assignment operator (.=) doesn't work correctly with tied hashes. In Listing One, I first read the database entry into a variable, append the data I want, then assign the result back into the database. Finally, I have had several crashes when the B-Tree file had very many pages (for example, a 13-MB database using 8-KB pages). Increasing the page size seemed to help in each case.

These comments apply to Version 1.85 of Berkeley DB, which is commonly built into Perl distributions. Version 2.0 has recently been released and may have addressed these issues.

Moving Ahead
Really good indexing is hard. If you want a truly compact index that only contains the important terms organized in a clear fashion, be prepared to build the entire thing manually. The programs I've presented here can automatically build a functional index database, but, as with any endeavor, the more work you put into it, the better the result will be. The best commercial programs can reduce the amount of manual work required, but can never entirely eliminate it.

The complete set of Perl scripts that I currently use is available electronically. Be aware that, as I described in this article, you might need to do some customization for your particular application.



3. SORTING BAM FILES BY READ NAME

http://samtools.sourceforge.net/samtools.shtml


sort	 samtools sort [-n] [-m maxMem] <in.bam> <out.prefix>
Sort alignments by leftmost coordinates. File <out.prefix>.bam will be created. This command may also create temporary files <out.prefix>.%d.bam when the whole alignment cannot be fitted into memory (controlled by option -m).

OPTIONS:
-n	 Sort by read names rather than by chromosomal coordinates
-m INT	 Approximately the maximum required memory. [500000000]



2. PERL B-TREES

http://www.drdobbs.com/184410819;jsessionid=AGMPRGK0HCA0RQE1GHRSKHWATMY32JVN
 
Full-Text Searching in Perl
By Tim Kientzle, January 01, 1999




0 Comments

Full-text search engines are popular these days, and not just on web sites. Tim shows how you can build a fast full-text search capability using Perl's built-in database support.
FULL-TEXT SEARCHING IN PERL
Tim is the senior technical editor for DDJ. He can be reached at kientzle@ddj.com.

I've had to build several full-text search engines recently, and found that Perl works extremely well for this. Not only can Perl easily read and manipulate text files, Perl also has built-in support for fast B-Tree databases. In this article, I'll present some Perl programs that handle very rapid full-text searching. With a little work, you could easily use these programs to provide full-text search capability for a web site.

Standing on Your Head
When you want to view a text file, you name the file and get back all of the words in the file. To perform full-text searching, you have to do the opposite -- name a word and get a list of all of the files containing that word.

The most effective way to do this is to simply build a database whose keys are words. When you look up a word, you get a list of all the files containing that word. Once you have this database, Example 1 can perform full-text searches. With just a little modification, this program can produce HTML search results suitable for use on a web site.

Although Example 1 is short, it is very fast. On a 266-MHz Pentium II, it takes about 0.2 seconds to perform a complete search against a large database (see Table 1). This time includes loading and initializing the Perl interpreter. Most of this speed comes simply from using the right disk access method -- B-Tree files are designed specifically for fast random access to data on disk. Even with the database on slow CD-ROM, searches take less than two seconds.

Conceptually, there are really two databases. The first maps each word to a list of 2-byte integers that will represent the files. Binary integers are the most compact way to store this information, and I don't expect to have more than 65,000 files anytime soon. The second database maps these numbers to file descriptions, which can include a title and a filename or URL. By storing the filename just once for each file, the total size of the index is reduced considerably.

To make the index easier to move around, I've collapsed them into a single file. File number keys are stored with a leading zero byte, which prevents word entries and file entries from colliding.

Working with Berkeley DB
Perl makes it easy to access database files. The tie() function attaches a hash name to an on-disk database file. Perl supports several simple database formats through this mechanism. The one I chose is the "Berkeley DB" package, which supports B-Tree files on disk. Because the C library implementing this file format is freely available, most Perl interpreters support it. Plus, Berkeley DB supports any byte ordering, so you can move database files across platforms with impunity. Berkeley DB supports C, C++, Java, and Perl APIs, for both UNIX and Windows 95/NT. Although Berkeley DB 2.0 is available from Sleepycat Software (http://www.sleepycat.com/), most Perl implementations still rely upon previous versions because of licensing and API changes. The Perl code I present here, for instance, is based on Berkeley DB 1.85/1.86, available from Sleepycat and The Comprehensive Perl Archive Network archives (http:// www.cpan.org/).

The tie() command in Example 1 is typical. The first three arguments are the hash to be bound, the database library to use, and the filename of the on-disk database. The next two arguments are file permissions, indicating whether you're going to read or write the database, and the file mode to be used if the database has to be created. The last argument is a reference to a special variable that specifies how this file should be opened. Example 2 shows how to set the cache and page sizes used by the DB library. (See the Perl documentation if you're unfamiliar with Perl references.)

The tie() call uses the contents of the $DB_BTREE variable when it calls the library to open a DB file, so you have to perform any such manipulations before you open the database file.

Building the Index Database
Perl's string-handling abilities make the basic indexing chore pretty easy. Listing One is indexer_basic.pl, a complete program to build the index. It uses Perl's find() function to visit every file in a directory tree. The IndexFile subroutine identifies HTML files by their extension, reads the entire file into a string in memory, strips the HTML tags, and gives the resulting text to IndexWords. If you wanted to add support for other file formats, it should be easy to do; all you need is a way to obtain raw text from the file. (For example, you might call the GhostScript programs to extract raw text from PostScript or PDF files.)

The IndexWords subroutine first uses Perl's split function to break the $words string into an array of separate words. It then uses Perl's grep command to discard certain nonwords and remove duplicates from the list. Finally, it simply iterates over the words, appending the file key to the database entry for each word.

Although the basic principles are the same, the indexer I currently use (indexer_ big.pl, available electronically; see "Resource Center," page 5) looks quite different from Listing One. To index DDJ articles, for instance, I use a more complex scheme to generate key numbers because I want to map words to articles, as opposed to files. That is, since a single article might contain multiple HTML files, I use some special-purpose Perl coding to convert any HTML filename into the name of the top-level file for that article. This also requires some additional complexity elsewhere, since the filename of the file -- which is needed to read the contents of the file -- is no longer the same as the name being entered into the index for a particular file.

Indexing Tips
The most important step in indexing a file is converting a text string into a list of relevant words. In practice, this is much more complex than Listing One suggests. Consider, for example, that "OS/2" and "C++" are single words, while "and/or" and "index+offset" are each two words separated by a punctuation mark.

To handle this particular problem, my first call to split is very liberal about what constitutes a word; any of the previous examples would be considered a single word. I then call a separate function that looks for compounds (entries that consist of two or more parts separated by /, -, or +) and adds the component pieces to the index as well. After this, the aforementioned examples would result in all of the following being added to the index: "OS/2," "OS," "2," "C++," "C," "and/or," "and," "or," "index+offset," "index," and "offset."

At several points in the indexing process, I examine the words being indexed to refine the final index. Some of these checks are generic. For example, I use a set of regular expressions to recognize and throw out certain nonwords, such as entries that consist only of punctuation and entries that contain only a single character.

Other index improvements require long lists of words. For example, users should get the same result if they search for "analyze" (American spelling) or "analyse" (British). The only way to ensure this is to manually build a list of synonyms and use this list to make sure those words are entered both ways. My complete indexer program includes over 9000 lines with information about words. This information includes:

Synonyms. Words that should be indexed identically.
Stop words. Words that should not be indexed at all.
Variant word forms. Derived forms, such as plurals or conjugated verbs, are also indexed under the root word.
This information was put together the hard way. After my initial indexer was working, I dumped the initial list of some 140,000 "words" to a text file and edited it manually to build the aforementioned lists. The lists are included at the end of the Perl program and read into hash tables when the program starts up. There's still a lot of room for improvement here. If you're serious about building a good index, you might want to spend a few days reviewing and improving these tables of word knowledge.

In general, I've tried to err on the side of including too many words in the database. If you look at the contents of the final database, it's clear that there are a lot of useless entries -- nonwords that are unlikely to ever be used. Unfortunately, I've found no automatic way to purge them. In particular, any text corpus will have enough names, made-up terms, and special words that verifying words against a standard dictionary is a bad idea.

About B-Trees
Recall that a B-Tree file consists of pages stored on disk. Each page is either an internal page, which has keys and pointers to other pages, or a leaf page, which stores keys and their associated data.

To find a particular entry, you start with the top-level page, usually an internal page. You compare the desired key to each key on the page. Your key will fall between two of the keys on that page, which determines the next page number to check. You may walk through several internal pages before you arrive at a leaf page that contains the data you want. Figure 1 illustrates this process.

The depth of this tree depends on the size of the pages. If you increase the page size, you can reduce the depth of the tree, thereby reducing the number of disk accesses needed to retrieve an item, and speeding up your program. In my case, I found that a 32-KB page size was sufficient to produce a two-level tree; any item in my database can be found with only two disk accesses. Better yet, since the top page remains in the database cache, only the first database request requires more than a single disk access. This juggling of page size was especially important because I wanted to put the final database on a CD-ROM. CD-ROMs are exceptionally slow at seeking, which makes it especially important to minimize the number of pages that must be read, since each page read requires a seek.

Because a B-Tree stores items in sorted order, you can speed up multiple searches tremendously by doing your searches in sorted order. If your next search happens to land on the same page, you won't have to go to disk at all, since the required pages will already be in the cache.

Performance
To try out my indexing tools, I used as a testbed 10-years worth of DDJ articles in HTML format. Even with this large collection, search time was simply never an issue. Building the index, however, presented some challenges.

As Table 1 shows, the indexer in Listing One has a serious speed problem. It required over three hours to index my sample corpus. However, it used only 14 minutes of CPU time, which suggests that the program is spending most of its time waiting on disk I/O.

Every time you add a word to the database, you have to find that word in the database first, then write it back with an additional key. Since the replacement is longer, the update is likely to require moving data to accommodate it. In addition, the words in a single file probably span much of the database, so if you're indexing a large number of files, you quickly get to the point where you're skimming through several megabytes of the database for every file you index.

To address this, the current version of my indexer defines %wordCache to be an ordinary in-memory hash, and adds new word entries to that. After indexing 500 files, the indexer calls FlushWordCache (Listing Two) to update the disk database from the in-memory hash. With this change, the total running time dropped from over three hours to a reasonable 20 minutes. The CPU time was practically unchanged.

Refining the Front End
The searcher in Example 1 may be fast, but it's not the ultimate in user friendliness. It currently uses a simplistic ranking scheme that could be improved in many ways:

Use 1 byte in each word's database entry to assign a weight. This weight could then be used to rank articles -- just add up the weights of the words in that article. (The ranking scheme in Example 1 essentially gives every word a weight of 1.) For example, you might weight nouns more heavily than verbs, or specific names (Windows) more heavily than generic terms (GUI).
In the absence of explicit weights, it's easy to modify Example 1 so that less-common words are weighted more heavily than more-common words.
Use 1 bit in each key to mark files that have words in special places. For example, you could set the high bit of the key if that file contains the word in the HTML <TITLE> tag. You could then assign such files a higher rank.
Choose the order of indexing. Example 1 uses the value of the file key as a tie breaker in the sort. I indexed the DDJ articles in reverse-chronological order so that more recent articles would appear earlier in the output.
Of course, the most obvious deficiency of Example 1 is that it simply picks out all of the files that contain at least one word. With a little bit of effort, you could support Boolean expressions or AltaVista-style "+" and "-" expressions.

Ranking and Boolean support are not independent decisions. If you use a more-powerful selection logic, then ranking may not be necessary, since users can quickly narrow their choice. If you use simpler selection logic, then effective ranking becomes more important. Also note that, because I'm using the Berkeley DB library, you could easily reimplement the front end in C or C++ if that's more convenient for you (for example, if you want to implement a yacc grammar to handle complex expressions).

Refining the Back End
The next big step is to make the indexing program more aware of the language it's working with. A program with a large built-in vocabulary and a knowledge of English grammar would be able to identify whether a word was being used as a noun, adjective, or verb. Generally, nouns and adjectives are much more important in an index than verbs. For example, users interested in skip lists would be much more interested in "use a skip list" (adjective, noun) than "skip the first and list the second" (verbs). Such a program might also be able to discriminate between similar-looking words -- compare "Windows have certain properties" to "Windows has certain properties." Such programs are hard to write, though, and require a large database of word knowledge to drive them.

If you're using this on a web site, it might be a good idea to log searches. By reviewing such a log, you can get a better idea what type of things people coming to your site are looking for. In particular, be certain to log searches that returned no results, since they might point out things that did not get properly indexed. A log of search requests is also a useful tool for planning future additions to your site.

Caveats
Although the Berkeley DB package is generally easy to use and quite fast, I have run across a few problems. One common process is to walk through the entries of index.db with Perl's each() command, and selectively modify certain items from the database. I've had several crashes when I've tried to modify items as I walked the database. Instead, I now walk through the database and accumulate a list of items to be modified, then modify those items in a separate pass. Also, I've found that Perl's string-concatenation assignment operator (.=) doesn't work correctly with tied hashes. In Listing One, I first read the database entry into a variable, append the data I want, then assign the result back into the database. Finally, I have had several crashes when the B-Tree file had very many pages (for example, a 13-MB database using 8-KB pages). Increasing the page size seemed to help in each case.

These comments apply to Version 1.85 of Berkeley DB, which is commonly built into Perl distributions. Version 2.0 has recently been released and may have addressed these issues.

Moving Ahead
Really good indexing is hard. If you want a truly compact index that only contains the important terms organized in a clear fashion, be prepared to build the entire thing manually. The programs I've presented here can automatically build a functional index database, but, as with any endeavor, the more work you put into it, the better the result will be. The best commercial programs can reduce the amount of manual work required, but can never entirely eliminate it.

The complete set of Perl scripts that I currently use is available electronically. Be aware that, as I described in this article, you might need to do some customization for your particular application.



</entry>



<entry [Tue Oct 26 16:07:00 EDT 2010] REDO BOWTIE SAV.pl>



RERAN MISSING BOWTIE.pl ALIGNMENTS
TO CHECK IF ABNORMAL hit.sam FILE DUE TO FAILED ALIGNMENT


FILE 1
------

screen -S bowtie-autochr22-1

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1 \
--params "--rf" \
--distance 2000 \
--species human \
--label bowtie-autochr22-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/bowtie-autochr22-1.out 


RUNNING Wed Oct 27 00:33:58 EDT 2010

    BOWTIE.pl    Run time: 00:32:14
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl
    BOWTIE.pl    1:06AM, 27 October 2010
    BOWTIE.pl    ****************************************



FILE 9
------

screen -S bowtie-autochr22-9

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9 \
--params "--rf" \
--distance 2000 \
--species human \
--label bowtie-autochr22-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/bowtie-autochr22-1.out 


    BOWTIE.pl    Run time: 00:35:09
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl
    BOWTIE.pl    9:48PM, 26 October 2010
    BOWTIE.pl    ****************************************


NOTE: RUN ON /scratch

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

ll ../../../maq/9/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 15:07 ../../../maq/9/chr22/hit.sam

ll ../../../eland/9/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 397M Oct 13 14:28 ../../../eland/9/chr22/hit.sam

ll hit.sam
    -rw-rw-rw- 1 syoung root 44M Oct 26 21:42 hit.sam


NOTE: RUN ON /ngs/bioinfo

RERAN BOWTIE.pl ON FILE 9 AND THIS TIME hit.sam WAS 6 GB:

    -rw-rw-r--+  1 syoung bioinfo 6.1G Oct 26 12:58 hit.sam

AND TRUNCATED:

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22
head -n 3 hit.sam

    6M      =       26851607        231     GCTGGAAACCATCATTCTCAGCAAACTATCGCAAGG    IHIII796II77:0)(-04,+/'..-1&*)%#"',)    XA:i:1  MD:Z:0A28T6     NM:i:2
    6M      =       26851607        231     GCTGGAAACCATCATTCTCAGCAAACTATCGCAAGG    IHIII796II77:0)(-04,+/'..-1&*)%#"',)    XA:i:1  MD:Z:0A28T6     NM:i:2
    1       CTGAGGTCAGGAGTTCCAGACCAGCCTGGCTAACCT    8IIIIIIF7CC,G:%/?,8..+$**+-%*$$&%%#'    XA:i:1  MD:Z:16G13C3A1  NM:i:3


PREDICT SNPS - CONVERT hit.bam TO hit.filter

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

/nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/hit.bam | tee /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/out.raw | /nethome/bioinfo/apps/samtools/0.1.6/samtools.pl varFilter -D100 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/out.filter


CONVERT hit.filter TO hit.snp

awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/out.filter > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/out.snp



NOTES
-----

CAN'T MANUALLY GENERATE MISSING FILE 1 hit.snp BECAUSE THE BAM FILE IS TRUNCATED AND IN ANY CASE THE hit.sam FILE IS ABNORMAL:


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
ll */chr22/hit.sam

    -rw-rw-r-- 1 syoung root 886M Oct 19 14:59 10/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 14:59 11/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:00 12/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:00 13/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:01 14/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:01 15/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:02 16/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:02 17/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:03 18/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:03 19/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 154M Oct 19 14:58 1/chr22/hit.sam  <==== HERE
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:04 20/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:05 21/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:05 22/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:06 23/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:06 24/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 889M Oct 19 15:07 25/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:07 26/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:08 27/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:08 28/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:09 29/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:04 2/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:10 30/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:10 31/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:11 32/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 889M Oct 19 15:11 33/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:09 3/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 908M Oct 19 15:12 4/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 925M Oct 19 15:12 5/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:13 6/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:13 7/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:14 8/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 5.3G Oct 19 15:16 9/chr22/hit.sam  <=== HERE


BAM FILE:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.bam

CUMULATIVE DIRECTORY:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/chr22


SORT BAM

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22time /nethome/bioinfo/apps/samtools/0.1.6/samtools sort \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.bam \
hit.sorted
    
    [bam_header_read] EOF marker is absent.
    [bam_sort_core] truncated file. Continue anyway.
    
    real    0m20.513s
    user    0m13.869s
    sys     0m1.052s








</entry>



<entry [Tue Oct 26 14:26:21 EDT 2010] REMOVED SRX000600 SEQUENCE FILES AFTER SAVING *.list AND *.info FILES>



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth
    
    -rw-rw-r-- 1 syoung root 7.2K Oct 26 14:11 info.tar.gz
    -rw-rw-r-- 1 syoung root 5.8G Oct 26 12:28 list.tar.gz
    -rw-rw-r-- 1 syoung root  39K Oct 21 14:21 stdout.tar.gz

DELETING ALL SRX006000 SEQUENCE FILES:

screen -S rm-srx600

RUNNING Tue Oct 26 14:26:21 EDT 2010



</entry>



<entry [Tue Oct 26 14:02:37 EDT 2010] SAVED MAQ BENCHMARK DATA AS TAR.GZ>



1. DISCARDED OLD ELAND RUNS AS MOST WERE INCOMPLETE AND USED OLD FILE HIERARCHY

2. MAQ ARCHIVED DATA:

cd /nethome/syoung/base/pipeline/benchmark

-rw-rw-r--  1 syoung bioinfo 676K Oct 26 11:50 benchmark-maq-usage.tar.gz
-rw-rw-r--  1 syoung bioinfo 948M Oct 26 13:53 s_1_sequence.txt




</entry>



<entry [Tue Oct 26 09:10:58 EDT 2010] CHECK MAQ RESULTS>




TWO PROBLEMS:


1. MISSING hit.sam FILES: 2 AND 7 

    - REDID ALIGNMENTS FOR FILES 2 AND 7


2. TRUNCATED hit.snp FILES: 4, 10, 26, 27 AND 32

FAILURE OF hit.sam SORTING JOB LED TO DOWNSTREAM FAILURE OF SNP CALLING.

    - RERUN ALL JOBS FROM samtoolsSnp SUBROUTINE ONWARDS
    
    - USE (FASTER) bamToSnp METHOD TO MINIMISE RISK OF JOB FAILURE






1. RERUN MAQ FILE 2 FROM BEGINNING

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/2
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/2

screen -S maq-autochr22-2

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-2.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-2.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/2 \
--species human \
--label maq-200bp-autochr22-2 \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/2/maq-200bp-autochr22-2.out 
    
    MAQ.pl    Run time: 02:25:10
    MAQ.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl
    MAQ.pl    10-10-26 11:41:59
    MAQ.pl    ****************************************



1. RERUN MAQ FILE 7 FROM BEGINNING

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7

screen -S maq-autochr22-7

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-2.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-2.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7 \
--species human \
--label maq-200bp-autochr22-7 \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/maq-200bp-autochr22-7.out 
    
    MAQ.pl    Run time: 02:30:18
    MAQ.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl
    MAQ.pl    10-10-26 23:25:35
    MAQ.pl    ****************************************



NOTE: AS IN FILE 2 RUN ABOVE, FAILED AT indexBam STAGE BECAUSE WRONG BAM FILE NAME out.bam IS SPECIFIED IN Cluster.pm. CORRECTED PROBLEM AND COMPLETED SNP CALLING MANUALLY

INDEX BAMFILE

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22

    -rw-r--r--  1 syoung root 1.2G Oct 26 23:24 hit.bam

time /nethome/bioinfo/apps/samtools/0.1.6/samtools index \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22/hit.bam
    
    real    0m38.773s
    user    0m24.758s
    sys     0m2.408s


SORT BAMFILE

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22

time /nethome/bioinfo/apps/samtools/0.1.6/samtools sort \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22/hit.bam \
hit.sorted
        
    [bam_sort_core] merging from 7 files...
    
    real    12m36.487s
    user    9m37.437s
    sys     0m24.767s


CALL SNPS




SNP CALLING USING SORTED hit.bam (hit.sorted.bam) FILE:

time /nethome/bioinfo/apps/samtools/0.1.6/samtools pileup \
-vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22/hit.sorted.bam \
| tee /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22/hit.raw \
| /nethome/bioinfo/apps/samtools/0.1.6/samtools.pl varFilter -D100 \
> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22/hit.filter


    real    7m24.666s
    user    10m59.455s
    sys     0m16.054s


CONVERTED hit.filter TO hit.snp (INSTANTANEOUS)


awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22/hit.filter > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7/chr22/hit.snp





RUNNING Tue Oct 26 20:55:48 EDT 2010








TROUBLESHOOT SNP CALLING
------------------------

REST OF MAQ ALIGNMENTS ARE OKAY:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
ll */chr22/hit.sam

    -rw-rw-rw- 1 syoung root 3.9G Oct 18 16:26 10/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 18:07 11/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 20:04 12/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 22:13 13/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 00:54 14/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 04:00 15/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 06:54 16/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 10:13 17/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 14:11 18/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 18:01 19/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 22:01 20/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 02:02 21/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 06:02 22/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 10:02 23/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 14:03 24/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 18:04 25/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 22:05 26/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 21 02:05 27/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 21 06:06 28/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 17 19:25 29/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 17 23:25 30/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 03:27 31/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 03:27 32/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 07:26 33/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 12:32 5/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 13:02 6/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 14:04 8/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 15:07 9/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 12:15 four/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 11:51 one/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 12:16 three/chr22/hit.sam


BUT SOME SNPS MAY BE BAD:

MISSING FILES: 2 AND 7 
TRUNCATED FILES: 4, 10, 26, 27 AND 32


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
ll */chr22/hit.snp
    
        -rw-rw-rw- 1 syoung root 1.1M Oct  8 02:43 1/chr22/hit.snp
    FILE 2 MISSING ***
        -rw-rw-rw- 1 syoung root 1.1M Oct  8 05:08 3/chr22/hit.snp
    4   -rw-rw-rw- 1 syoung root  12K Oct  8 06:06 4/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  8 08:25 5/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  8 11:00 6/chr22/hit.snp
    FILE 7 MISSING ***
        -rw-rw-rw- 1 syoung root 1.1M Oct  8 13:30 8/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  8 15:43 9/chr22/hit.snp
    10  -rw-rw-rw- 1 syoung root  12K Oct  8 16:41 10/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  8 21:27 11/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  9 00:17 12/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  9 02:37 13/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  9 05:29 14/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  9 07:51 15/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct  9 09:59 16/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 04:13 17/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 06:27 18/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 08:32 19/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 10:51 20/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 12:56 21/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 15:25 22/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 17:48 23/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 20:09 24/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 10 22:30 25/chr22/hit.snp
    26  -rw-rw-rw- 1 syoung root  12K Oct 10 23:25 26/chr22/hit.snp
    27  -rw-rw-rw- 1 syoung root  12K Oct 11 00:16 27/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 11 02:36 28/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 11 04:42 29/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 11 06:58 30/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 11 09:03 31/chr22/hit.snp
    32  -rw-rw-rw- 1 syoung root  11K Oct 11 09:59 32/chr22/hit.snp
        -rw-rw-rw- 1 syoung root 1.1M Oct 11 12:00 33/chr22/hit.snp


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4

    -rwxrwxrwx  1 syoung root  927 Oct  8 05:57 gzipFile.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  8 06:03 gzipFile-stdout.txt
    -rw-rw-rw-  1 syoung root  17K Oct  8 06:06 hit.filter
    -rwxrwxrwx  1 syoung root 1.1K Oct  8 05:40 hitIdFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  8 05:44 hitIdFiles-chr22-stdout.txt
    -rw-rw-rw-  1 syoung root 122M Oct  8 06:06 hit.raw
    -rw-rw-rw-  1 syoung root 3.9G Oct 18 12:15 hit.sam
    -rw-rw-rw-  1 syoung root 1.3G Oct  8 05:40 hit.sam.gz
    -rw-rw-rw-  1 syoung root 1.8K Oct  8 05:57 hit.sam.head
    -rw-rw-rw-  1 syoung root 1.8K Oct  8 05:57 hit.sam.tail
    -rw-rw-rw-  1 syoung root  12K Oct  8 06:06 hit.snp
    -rwxrwxrwx  1 syoung root 2.6K Oct  8 05:23 maq-chr22.sh
    -rwxrwxrwx  1 syoung root  17K Oct  8 05:38 mergeSam-chr22.sh
    -rw-rw-rw-  1 syoung root 7.2K Oct  8 05:40 mergeSam-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.6K Oct  8 06:04 samToSnp-chr22.sh
    -rw-rw-rw-  1 syoung root 944M Oct  8 06:06 samToSnp-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1023 Oct  8 05:44 sortHitFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  8 05:49 sortHitFiles-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.3K Oct  8 05:40 sortSam-chr22.sh
    -rw-rw-rw-  1 syoung root 1.9K Oct  8 06:07 sortSam-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.1K Oct  8 05:37 subdirMapToSam-chr22.sh
    -rwxrwxrwx  1 syoung root 1.3K Oct  8 05:37 subdirSamHits-chr22.sh

mv hit.snp hit.snp.bkp

RERAN samToSnp FOR FILE 4 BUT STILL GOT SAME SMALL FILE:

bsub -q small ./samToSnp-chr22.sh 
Job <2205650> is submitted to queue <small>.
Tue Oct 26 09:32:35 EDT 2010

    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    2205589   syoung  RUN   small      u01         n0024       *gnment[5] Oct 26 01:05
    ...
    2205589   syoung  RUN   small      u01         n0227       *nment[49] Oct 26 01:05
    2205589   syoung  RUN   small      u01         n0227       *nment[50] Oct 26 01:05
    2205650   syoung  RUN   small      u04         n0073       *-chr22.sh Oct 26 09:32



FILE 4 SNP FILE COMES UP SHORT COMPARED TO FILE 5 SNP FILE:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22

    -rw-rw-r-- 1 syoung root 12K Oct 26 09:35 hit.snp   

    -rw-rw-rw- 1 syoung root 1.1M Oct  8 08:25 ../../5/chr22/hit.snp



FILES 4 AND 5 SAM HITS FILES ARE THE SAME SIZE AND TYPE OF CONTENTS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
tail hit.sam

    SRR003962.1707603:4:19:1219:51#0        147     chr22   49591152        0       36M     *       0       -212    GTCCGGCCTGGGCGACAGAGGGAGACTCCGTCTCAA     %$%$(%$+"&#'(+#-'#&$$#.+,C".,2.>'A52    MF:i:18 AM:i:0  SM:i:0  NM:i:1  UQ:i:3  H0:i:13 H1:i:85
    SRR003964.1396276:6:15:677:1249#0       145     chr22   49591231        48      36M     *       0       -524    CAATAAAAATGTCAGAATATTGCTAGCTACATGCTG     *+))2+/60),+54/75,<-/68.=;635II>II3A    MF:i:2  AM:i:37 SM:i:48 NM:i:0  UQ:i:0  H0:i:1  H1:i:0
    SRR003962.8205067:4:89:1694:710#0       83      chr22   49591267        84      36M     *       0       -214    ATAAGAAGGACAAAGGGGACATTTTTAAGAGAAACC     IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    MF:i:18 AM:i:3  SM:i:81 NM:i:0  UQ:i:0  H0:i:1  H1:i:0
    RR003964.8496854:6:90:1343:1820#0       145     chr22   49591318        48      36M     *       0       -499    AGATTAGGGCAGAGAAAGACATTCAAAAGAGGCAGC     ++-''.2++&..A*35982/D.*G<8I=>I==DI3I    MF:i:2  AM:i:48 SM:i:48 NM:i:0  UQ:i:0  H0:i:1  H1:i:0

tail ../../5/chr22/hit.sam

    SRR004121.1686215:2:83:241:427#0        83      chr22   49591397        99      36M     *       0       -228    GCGGGAAGGAGGCTGGTGCCAGAGTGGATTCGGATT     2)03,465-;,;8(?I9>14AI<I=IIIIIIIIIII    MF:i:18 AM:i:51 SM:i:63 NM:i:0  UQ:i:0  H0:i:1  H1:i:0
    SRR004113.3890526:8:182:522:567#0       83      chr22   49591398        39      36M     *       0       -197    CGGGAAGGAGGCTGGTGCTAAAGTGGATTCAGATTG     %0.0135003942:<B:4IAIIIIIIIDIIIIIIII    MF:i:130        AM:i:39 SM:i:0  NM:i:3  UQ:i:120        H0:i:0  H1:i:0
    SRR004810.4720938:4:233:400:329#0       83      chr22   49591398        33      36M     *       0       -222    TTGGAAGGAGGCTGGTGCCAGAGTGGATTCGGATTG     !!/./'-1/351%<?)E5I8I;I3III8HIIIIIII    MF:i:130        AM:i:33 SM:i:0  NM:i:0  UQ:i:0  H0:i:0  H1:i:0
    SRR004828.6522932:2:303:95:277#0        147     chr22   49591398        63      36M     *       0       -207    CGGGAAGGAGGCTGGTGCCTGAGTGGATTCGGGTTG     <;$&.EA.I+.I060I*III%IIHDIIIIIIIIIII    MF:i:130        AM:i:63 SM:i:0  NM:i:2  UQ:i:80 H0:i:0  H1:i:0


BUT RAW FILES ARE VERY DIFFERENT IN SIZE:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
ll hit.raw
    -rw-rw-rw- 1 syoung root 17K Oct 26 09:35 hit.filter

[syoung@u04 chr22]$ ll hit.raw
    -rw-rw-rw- 1 syoung root 122M Oct 26 09:35 hit.raw

syoung@u04 chr22]$ ll ../../5/chr22/hit.raw
    -rw-rw-rw- 1 syoung root 1.3G Oct  8 08:25 ../../5/chr22/hit.raw


ALTHOUGH THEY HAVE SIMILAR CONTENT:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
tail hit.raw

    chr22   49591426        C       T       33      33      57      2       t$t     II
    chr22   49591428        T       G       30      30      53      1       g       B
    chr22   49591429        C       G       30      30      53      1       g       I
    chr22   49591431        C       T       30      30      53      1       t       I
    chr22   49591432        G       T       30      30      53      1       t       I
    chr22   49591433        T       G       30      30      53      1       g       I
    chr22   49591434        G       A       30      30      53      1       a       I
    chr22   49591435        C       T       30      30      53      1       t       I
    chr22   49591436        A       C       30      30      53      1       c       I
    chr22   49591437        G       A       30      30      53      1       a$      I


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
tail ../../5/chr22/hit.raw

    chr22   49591420        C       G       69      69      44      14      GGgggGggGggggg  ($III-C+$IIIII
    chr22   49591421        G       T       38      66      44      14      T.tttTttTttttt  $"IA0"0I"D=I3H
    chr22   49591424        G       A       54      54      45      9       A$aaAaaaaa      'II"IIIII
    chr22   49591425        A       T       51      51      48      8       t$tTttttt       =I%=ID8I
    chr22   49591426        C       T       48      48      46      7       tTttttt I&IIIHI
    chr22   49591428        T       G       6       42      49      6       Gggagg  $IIIII
    chr22   49591429        C       G       45      45      49      6       Gggggg  $IIIII
    chr22   49591431        C       T       42      42      52      5       t$tttt  IIIII
    chr22   49591432        G       T       39      39      50      4       t$ttt   IIII
    chr22   49591433        T       G       36      36      45      3       g$g$g$  III





RERAN SNP CALLING STEP-BY-STEP AND FOUND THAT *** FILE 4 SNP FILE IS NOT SORTED ***:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22

mv hit.raw hit.raw.bkp

time /nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa -t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.sam.gz > hit.raw
    
    [sam_header_read2] 1 sequences loaded.
    ...    
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    ...


FILE 4 SNP FILE IS NOT SORTED:

time sort -c -k 3,3 -k 4,4n hit.sam

    sort: hit.sam:5: disorder: SRR002271.13665948:7:13:389:67#0     153     chr22   14431024        5   36M      *       0       0       GGTGTCAGGCTCTCAGTTAATCTCTCCTAGATCTGG    "$$"$&'"&+&/).,,,.-2+A/706I<4189IID< MF:i:64 AM:i:0  SM:i:5  NM:i:3  UQ:i:65 H0:i:0  H1:i:0

    real    0m0.299s
    user    0m0.013s
    sys     0m0.017s



WHEREAS FILE 5 SNP FILE IS SORTED:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/5/chr22
sort -c -k 3,3 -k 4,4n hit.sam

    <NO ERROR OUTPUT>


AND SNP PREDICTION IS WITHOUT ERROR:

time /nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa -t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/5/chr22/hit.sam.gz > hit.raw

    [sam_header_read2] 1 sequences loaded.

    real    3m57.724s
    user    3m39.539s
    sys     0m3.946s


SO SORTED FILE 4 hit.sam FILE:

screen -S maq-4-sortsam

time sort -k 3,3 -k 4,4n hit.sam -o hit.sam

RERUNNING TO GET hit.sam

    real    66m41.197s
    user    0m0.000s
    sys     0m0.001s


SNP CALLING USING hit.sam.gz:

time /nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa -t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/5/chr22/hit.sam.gz > hit.raw
[sam_header_read2] 1 sequences loaded.

real    3m57.724s
user    3m39.539s
sys     0m3.946s



AND COMPARED SPEED WITH CONVERSION TO BAM AND SORTING BAM FILE:

screen -S maq-samToBam

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22



USE COPY OF hit.sam FROM hit.sam.gz WHILE hit.sam IS BEING SORTED:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
zcat hit.sam.gz > hit.sam2


CONFIRM hit.sam2 IS NOT SORTED:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
time sort -c -k 3,3 -k 4,4n hit.sam2
    
    sort: hit.sam2:5: disorder: SRR002271.13665948:7:13:389:67#0    153     chr22   14431024        5   36M      *       0       0       GGTGTCAGGCTCTCAGTTAATCTCTCCTAGATCTGG    "$$"$&'"&+&/).,,,.-2+A/706I<4189IID< MF:i:64 AM:i:0  SM:i:5  NM:i:3  UQ:i:65 H0:i:0  H1:i:0
    

CONVERT SAM TO BAM

time /nethome/bioinfo/apps/samtools/0.1.6/samtools view \
-bt /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.bam \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.sam2

    [sam_header_read2] 1 sequences loaded.

    real    5m12.524s
    user    4m37.171s
    sys     0m21.450s


SORT BAM

time /nethome/bioinfo/apps/samtools/0.1.6/samtools sort \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.bam \
hit.sorted
    
    real    9m35.144s
    user    8m49.184s
    sys     0m14.091s


SNP CALLING USING SORTED hit.bam (hit.sorted.bam) FILE:

time /nethome/bioinfo/apps/samtools/0.1.6/samtools pileup \
-vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.sorted.bam \
| tee /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.raw \
| /nethome/bioinfo/apps/samtools/0.1.6/samtools.pl varFilter -D100 \
> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.filter

    real    7m24.666s
    user    10m59.455s
    sys     0m16.054s


CONVERTED hit.filter TO hit.snp (INSTANTANEOUS)


awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.filter > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.snp


ll hit.snp

    -rw-rw-r--  1 syoung root 1.1M Oct 26 14:13 hit.snp

ll ../../5/chr22/hit.snp

    -rw-rw-rw- 1 syoung root 1.1M Oct  8 08:25 ../../5/chr22/hit.snp


CHECK SNPS:

head hit.snp

    chr22   16050657        a       G       36      36      60      3       g$g^~G  I+I
    chr22   16053823        *       +CA/+CA 50      119     41      4       +CA     *       1       3   0
    chr22   16053947        *       -G/-G   55      155     31      11      -G      *       2       9   0
    chr22   16053981        *       -AG/-AG 46      100     25      5       -AG     *       1       4   0
    chr22   16054939        G       A       29      39      29      5       A$.$a$A^~a      *$I)I
    chr22   16056573        T       G       28      33      48      3       C$g^~G  "4I
    chr22   16057770        T       A       33      33      37      3       a$^3A^+,        E)!
    chr22   16058590        a       C       36      36      45      3       CcC     &II
    chr22   16058591        a       T       36      36      45      3       TtT     +-I
    chr22   16060344        t       C       36      36      60      3       C$C^~c  /I5




SO, THE SOLUTION FOR THESE SNP FAILURES IS TO RERUN samtoolsSnp USING THE BAM FILE INTERMEDIARY



NOTES
-----



SNP FILE COMPARISON FILES 4 AND 5:


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
tail ../../5/chr22/hit.snp
    
    chr22   49590241        *       -A/*    172     1304    41      71      -A      *       3       68      0       0       0
    chr22   49590286        *       +TTG/+TTG       128     1095    53      30      +TTG    *       9       21      0       0       0
    chr22   49590724        *       -c/-c   68      683     50      22      -c      *       1       21      0       0       0
    chr22   49590860        *       +AGAA/+AGAA     128     838     47      30      +AGAA   *       1       29      0       0       0


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22
tail hit.snp
    
    chr22   46101291        t       C       39      39      28      4       CcCc    #I-I
    chr22   46359030        *       +AC/+AC 47      60      39      3       +AC     *       1       2       0       0       0
    chr22   46749364        C       T       25      25      28      3       ttt     I94
    chr22   46749365        C       G       24      24      28      3       g$gg    I*3
    chr22   46775178        C       G       36      36      26      3       gG^!G   @7I
    chr22   48462743        *       -atc/*  24      60      19      6       -atc    *       1       5       0       0       0
    chr22   48462902        a       T       36      36      25      3       ttt     B*+
    chr22   49573185        C       G       36      36      49      3       gg^|G   I-I
    chr22   49573186        T       A       36      36      49      3       aaA     I*I
    chr22   49577153        C       G       23      23      32      3       g$G^Qg  H+*




time /nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.sorted.bam | tee /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.raw | /nethome/bioinfo/apps/samtools/0.1.6/samtools.pl varFilter -D100 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.filter



/nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa -t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.sam.gz | tee /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.raw | /nethome/bioinfo/apps/samtools/0.1.6/samtools.pl varFilter -D100 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.filter
awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.filter > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4/chr22/hit.snp


</entry>



<entry [Mon Oct 25 20:53:38 EDT 2010] RAN BOWTIE SAV.pl WITH loop.pl AFTER REDOING FAILED subdirSamhits.sh>




BAD BOWTIE ALIGNMENTS FOR RUNS 1 AND 9:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie

    -rw-rw-r--+ 1 syoung bioinfo 154M Oct 19 12:58 1/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 5.3G Oct 19 12:34 9/chr22/hit.sam

COMPARED TO ALL RUNS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
    
    -rw-rw-r--+ 1 syoung bioinfo 886M Oct 19 12:13 10/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:14 11/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:14 12/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:15 13/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:16 14/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:16 15/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:17 16/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:18 17/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:18 18/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:19 19/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 154M Oct 19 12:58 1/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:20 20/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:21 21/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:21 22/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:22 23/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:23 24/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 889M Oct 19 12:23 25/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:24 26/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:24 27/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:25 28/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:26 29/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:19 2/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:27 30/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:27 31/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:28 32/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 889M Oct 19 12:28 33/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:26 3/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 908M Oct 19 12:29 4/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 925M Oct 19 12:29 5/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:30 6/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 887M Oct 19 12:30 7/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 888M Oct 19 12:31 8/chr22/hit.sam
    -rw-rw-r--+ 1 syoung bioinfo 5.3G Oct 19 12:34 9/chr22/hit.sam



RERUN BOWTIE FILE 9
-------------------

SUBDIRHITS FAILED FOR SEVERAL SPLIT FILES IN BOWTIE FILE 9 RUN AGAINST chr22:

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 10/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 11/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 12/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 13/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  16M Oct  4 19:19 14/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  17M Oct  4 19:19 15/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 16/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  20M Oct  4 19:19 17/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 18/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 19/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 248M Oct  4 19:21 1/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 20/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 21/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 22/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 23/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 24/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 25/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 26/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 27/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 28/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 29/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 245M Oct  4 19:21 2/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 30/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:22 31/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:21 32/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  17M Oct  4 19:21 33/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  16M Oct  4 19:21 34/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  16M Oct  4 19:21 35/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  17M Oct  4 19:21 36/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:21 37/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 38/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 39/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 250M Oct  4 19:21 3/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  17M Oct  4 19:20 40/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:20 41/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:20 42/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:20 43/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  16M Oct  4 19:20 44/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  17M Oct  4 19:20 45/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:20 46/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:20 47/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 48/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 49/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 263M Oct  4 19:21 4/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:19 50/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 246M Oct  4 19:21 5/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 227M Oct  4 19:21 6/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 217M Oct  4 19:21 7/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct 25 22:16 8/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 241M Oct  4 19:21 8/hit.sam.bkp
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 9/hit.sam


THESE ARE THE FAILED RUNS:

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

    -rw-rw-rw-+ 1 syoung bioinfo 248M Oct  4 19:21 1/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 245M Oct  4 19:21 2/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 250M Oct  4 19:21 3/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 263M Oct  4 19:21 4/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 246M Oct  4 19:21 5/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 227M Oct  4 19:21 6/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 217M Oct  4 19:21 7/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 241M Oct  4 19:21 8/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:19 9/hit.sam

HERE IS THE BATCH SCRIPT FILE COMMAND:

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/samHits.pl --inputfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/$LSB_JOBINDEX/out.sam --outputfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/$LSB_JOBINDEX/hit.sam --missfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/$LSB_JOBINDEX/miss.sam

TEST REDO SPLITFILE 8 OF BOWTIE FILE 9:

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/samHits.pl \
--inputfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/8/out.sam \
--outputfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/8/hit.sam \
--missfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/8/miss.sam

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct 25 22:16 8/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo 241M Oct  4 19:21 8/hit.sam.bkp

    OK!
    

LOOP subdirSamhits.pl FOR SPLITFILES 1 TO 9:

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

screen -r loop-bowtie-subdirSamhits

screen -S loop-bowtie-subdirSamhits

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/samHits.pl \
--replicates 1-9 \
--concurrent \
--inputfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/%REPLICATE%/out.sam \
--outputfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/%REPLICATE%/hit.sam \
--missfile /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22/%REPLICATE%/miss.sam
    
    Run time: 00:01:33
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    0:16AM, 26 October 2010
    ****************************************


OUTPUT FILES ARE NORMAL:

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22
ls -altrh  */hit.sam*

    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 29/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct  4 19:22 31/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 26/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 25/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct  4 19:22 28/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct 25 23:05 1/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct 25 23:05 2/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  20M Oct 25 23:05 3/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  20M Oct 25 23:05 4/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct 25 23:05 5/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct 25 23:05 6/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  18M Oct 25 23:05 7/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct 25 23:05 8/hit.sam
    -rw-rw-rw-+ 1 syoung bioinfo  19M Oct 25 23:05 9/hit.sam


MERGE hit.sam SPLIT FILES FOR FILE 9:

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

bsub -q small < mergeSam-chr22.sh

    Job <2205578> is submitted to queue <small>.





#### NB: THIS BATCH JOB DIDN'T WORK
#####bsub -q small -J  "subdirSamHits[1-9]" < subdirSamHits-chr22-ngs.sh



RERUN BOWTIE FILE 1
-------------------

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/chr22
msub -J eland-snp-1 




1-33 IN PARALLEL 
----------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-5
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-5

screen -r loop-bowtie-sav

screen -S loop-bowtie-sav

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--replicates 1-33 \
--concurrent \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/SAV.pl \
--tempfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-5/chr22/snp130-chr22-%REPLICATE%.dbl \
--inputfile hit-%REPLICATE%.snp \
--outputfile hit-%REPLICATE%.sav \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-5 \
--dbsnp snp130 \
--species human \
--maxjobs 1000 \
--queue small \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-5/sav-%REPLICATE%.out \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-5/loop.out






</entry>



<entry [Mon Oct 25 20:53:38 EDT 2010] RERAN ELAND SAV.pl WITH loop.pl AFTER FIXING SCRIPT FILE COLLISION>




CHANGES:
    
    1. CHANGED USAGEFILE AND SCRIPTFILE NAMES TO MAKE THEM REPLICATE-SPECIFIC
    
    2. ADDED RANDOM SLEEP BEFORE COPY DATABASE FILES TO AVOID COLLISION
    
    3. RENAMED pileupToSnp.pl TO annotateSnp.pl


RERAN FILE 26
Wed Oct 27 01:26:11 EDT 2010

cd  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22
ll hit-26.sav

    -rw-rw-rw- 1 syoung root 3.4M Oct 26 22:25 hit-26.sav




1-33 IN PARALLEL 
----------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative

screen -r loop-eland-sav

screen -S loop-eland-sav

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--replicates 1-33 \
--concurrent \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/SAV.pl \
--tempfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/snp130-chr22-%REPLICATE%.dbl \
--inputfile hit-%REPLICATE%.snp \
--outputfile hit-%REPLICATE%.sav \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative \
--dbsnp snp130 \
--species human \
--maxjobs 1000 \
--queue small \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/sav-%REPLICATE%.out \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/loop.out

    Run time: 13:19:38
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    2:49PM, 27 October 2010
    ****************************************


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22
ll *sav

    -rw-rw-rw- 1 syoung root 2.9M Oct 27 14:49 hit-1.sav
    -rw-rw-rw- 1 syoung root 2.4M Oct 27 05:19 hit-3.sav
    -rw-rw-rw- 1 syoung root 2.9M Oct 27 05:52 hit-4.sav
    -rw-rw-rw- 1 syoung root 2.9M Oct 27 05:52 hit-5.sav
    -rw-rw-rw- 1 syoung root 3.3M Oct 27 06:04 hit-6.sav
    -rw-rw-rw- 1 syoung root 3.5M Oct 27 06:11 hit-7.sav
    -rw-rw-rw- 1 syoung root 3.7M Oct 27 06:15 hit-8.sav
    -rw-rw-rw- 1 syoung root 3.8M Oct 27 06:18 hit-9.sav
    -rw-rw-rw- 1 syoung root 3.9M Oct 27 06:19 hit-10.sav
    -rw-rw-rw- 1 syoung root 3.9M Oct 27 06:31 hit-11.sav
    -rw-rw-rw- 1 syoung root 3.9M Oct 27 06:30 hit-12.sav
    -rw-rw-rw- 1 syoung root 4.0M Oct 27 06:30 hit-13.sav
    -rw-rw-rw- 1 syoung root 3.9M Oct 27 06:29 hit-14.sav
    -rw-rw-rw- 1 syoung root 3.9M Oct 27 09:17 hit-15.sav
    -rw-rw-rw- 1 syoung root 3.9M Oct 27 09:14 hit-16.sav
    -rw-rw-rw- 1 syoung root 3.8M Oct 27 09:11 hit-17.sav
    -rw-rw-rw- 1 syoung root 3.8M Oct 27 09:06 hit-18.sav
    -rw-rw-rw- 1 syoung root 3.7M Oct 27 09:03 hit-19.sav
    -rw-rw-rw- 1 syoung root 3.7M Oct 27 09:01 hit-20.sav
    -rw-rw-rw- 1 syoung root 3.7M Oct 27 08:58 hit-21.sav
    -rw-rw-rw- 1 syoung root 3.6M Oct 27 08:53 hit-22.sav
    -rw-rw-rw- 1 syoung root 3.6M Oct 27 06:07 hit-23.sav
    -rw-rw-rw- 1 syoung root 3.5M Oct 27 06:06 hit-24.sav
    -rw-rw-rw- 1 syoung root 3.5M Oct 27 06:04 hit-25.sav
    -rw-rw-rw- 1 syoung root 3.4M Oct 27 06:04 hit-26.sav
    -rw-rw-rw- 1 syoung root 3.4M Oct 27 06:03 hit-27.sav
    -rw-rw-rw- 1 syoung root 3.4M Oct 27 06:01 hit-28.sav
    -rw-rw-rw- 1 syoung root 3.4M Oct 27 06:00 hit-29.sav
    -rw-rw-rw- 1 syoung root 3.3M Oct 27 05:57 hit-30.sav
    -rw-rw-rw- 1 syoung root 3.3M Oct 27 05:03 hit-31.sav
    -rw-rw-rw- 1 syoung root 3.3M Oct 27 05:01 hit-32.sav
    -rw-rw-rw- 1 syoung root 3.3M Oct 27 05:00 hit-33.sav


NOTES
-----


MISSING FILE 1 MERGED BAM FILE:

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22
em cumulativeSnp-chr22-2-stdout.txt

    ------------------------------------------------------------
    # LSBATCH: User input
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/\
    chr22/cumulativeSnp-chr22-2.sh
    ------------------------------------------------------------
    
    TERM_RUNLIMIT: job killed after reaching LSF run time limit.
    Exited with exit code 140.
    
    Resource usage summary:
    
        CPU time   :  14305.00 sec.
        Max Memory :       751 MB
        Max Swap   :       992 MB
    
        Max Processes  :         6
        Max Threads    :         7
    
    The output (if any) follows:


grep "CPU time" *out.txt

    cumulativeSnp-chr22-10-stdout.txt:    CPU time   :   1000.24 sec.
    cumulativeSnp-chr22-11-stdout.txt:    CPU time   :   1103.36 sec.
    cumulativeSnp-chr22-12-stdout.txt:    CPU time   :   1205.71 sec.
    cumulativeSnp-chr22-13-stdout.txt:    CPU time   :   1325.48 sec.
    cumulativeSnp-chr22-14-stdout.txt:    CPU time   :   1431.98 sec.
    cumulativeSnp-chr22-15-stdout.txt:    CPU time   :   1535.52 sec.
    cumulativeSnp-chr22-16-stdout.txt:    CPU time   :   1645.29 sec.
    cumulativeSnp-chr22-17-stdout.txt:    CPU time   :   1759.75 sec.
    cumulativeSnp-chr22-18-stdout.txt:    CPU time   :   1878.34 sec.
    cumulativeSnp-chr22-19-stdout.txt:    CPU time   :   1986.51 sec.
    cumulativeSnp-chr22-1-stdout.txt:    CPU time   :    103.10 sec.
    cumulativeSnp-chr22-20-stdout.txt:    CPU time   :   2098.55 sec.
    cumulativeSnp-chr22-21-stdout.txt:    CPU time   :   2292.00 sec.
    cumulativeSnp-chr22-22-stdout.txt:    CPU time   :   2400.24 sec.
    cumulativeSnp-chr22-23-stdout.txt:    CPU time   :   2476.13 sec.
    cumulativeSnp-chr22-24-stdout.txt:    CPU time   :   2558.80 sec.
    cumulativeSnp-chr22-25-stdout.txt:    CPU time   :   2825.27 sec.
    cumulativeSnp-chr22-26-stdout.txt:    CPU time   :   2853.77 sec.
    cumulativeSnp-chr22-27-stdout.txt:    CPU time   :   2937.17 sec.
    cumulativeSnp-chr22-28-stdout.txt:    CPU time   :   3070.51 sec.
    cumulativeSnp-chr22-29-stdout.txt:    CPU time   :   3156.82 sec.
    cumulativeSnp-chr22-2-stdout.txt:    CPU time   :  14305.00 sec.
    cumulativeSnp-chr22-30-stdout.txt:    CPU time   :   3280.68 sec.
    cumulativeSnp-chr22-31-stdout.txt:    CPU time   :   3410.11 sec.
    cumulativeSnp-chr22-32-stdout.txt:    CPU time   :   3492.28 sec.
    cumulativeSnp-chr22-33-stdout.txt:    CPU time   :   3618.74 sec.
    cumulativeSnp-chr22-3-stdout.txt:    CPU time   :    288.89 sec.
    cumulativeSnp-chr22-4-stdout.txt:    CPU time   :    397.76 sec.
    cumulativeSnp-chr22-5-stdout.txt:    CPU time   :    398.09 sec.
    cumulativeSnp-chr22-6-stdout.txt:    CPU time   :    519.57 sec.
    cumulativeSnp-chr22-7-stdout.txt:    CPU time   :    631.32 sec.
    cumulativeSnp-chr22-8-stdout.txt:    CPU time   :    744.23 sec.
    cumulativeSnp-chr22-9-stdout.txt:    CPU time   :    859.36 sec.


SCRIPT FILE USED:

emacs cumulativeSnp-chr22-2.sh

    #!/bin/sh
    
    #BSUB -J cumulativeSnp-chr22-2                  # The name of the job
    #BSUB -W 48:00
    #BSUB -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/cumulativeSnp-chr22-2-stdout.txt                  # print STDOUT to this file
    #BSUB -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/cumulativeSnp-chr22-2-stderr.txt                  # print STDERR to this file
    
    
    echo "LS_JOBID: " $LS_JOBID
    echo "LS_JOBPID: " $LS_JOBPID
    echo "LSB_JOBINDEX: " $LSB_JOBINDEX
    echo "LSB_JOBNAME: " $LSB_JOBNAME
    echo "LSB_QUEUE: " $LSB_QUEUE
    echo "LSFUSER: " $LSFUSER
    echo "LSB_JOB_EXECUSER: " $LSB_JOB_EXECUSER
    echo "HOSTNAME: " $HOSTNAME
    echo "LSB_HOSTS: " $LSB_HOSTS
    echo "LSB_ERRORFILE: " $LSB_ERRORFILE
    echo "LSB_JOBFILENAME: " $LSB_JOBFILENAME
    echo "LD_LIBRARY_PATH: " $LD_LIBRARY_PATH
    
    time zcat /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit.sam.gz > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit.sam;
    time /nethome/bioinfo/apps/samtools/0.1.6/samtools view -bt /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit.bam /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit.sam;
    time /nethome/bioinfo/apps/samtools/0.1.6/samtools merge /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/merged.bam.temp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit.bam /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/merged.bam;
    time /nethome/bioinfo/apps/samtools/0.1.6/samtools sort /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/merged.bam.temp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit;
    time mv -f /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit.bam /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/merged.bam;
    time cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/merged.bam /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/merged.bam-2;
    cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22;
    /nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/merged.bam | tee hit-2.raw | /nethome/bioinfo/apps/samtools/0.1.6/samtools.pl varFilter -D100 > hit-2.filter;
    awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' hit-2.filter > hit-2.snp


    


CHECK IF SAM FILE IS SORTED:

screen -S samsort

time sort -c -k 3,3 -k 4,4n /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2/chr22/hit.sam
    
    real    2m35.256s
    user    0m52.015s
    sys     0m0.840s









</entry>



<entry [Mon Oct 25 14:18:33 EDT 2010] COVERAGE CONTINUED: RUN bamCoverage.pl (USES SAMTOOLS PIPELINE)>




RUNNING ON ELAND AND BOWTIE

INTERVAL: 1000000
TARGET: chr22


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam --window 1000000






INPUT FILE:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam

    -rw-rw-r-- 1 syoung root 53M Oct 20 21:40 hit.sorted.bam


WINDOW = 1 MILLION BASES
------------------------

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam --window 1000000




1       1000000 0
1000001 2000000 0
2000001 3000000 0
3000001 4000000 0
4000001 5000000 0
5000001 6000000 0
6000001 7000000 0
7000001 8000000 0
8000001 9000000 0
9000001 10000000        0
10000001        11000000        0
11000001        12000000        0
12000001        13000000        0
13000001        14000000        0
14000001        15000000        0
15000001        16000000        0
16000001        17000000        3.755517
17000001        18000000        2.344545
18000001        19000000        0.813669
19000001        20000000        0.430739
20000001        21000000        0.382188
21000001        22000000        0.484906
22000001        23000000        1.657693
23000001        24000000        0.541008
24000001        25000000        1.001016
25000001        26000000        0.745020
26000001        27000000        0.472859
27000001        28000000        0.467639
28000001        29000000        2.446978
29000001        30000000        1.508596
30000001        31000000        0.487979
31000001        32000000        0.767880
32000001        33000000        1.245888
33000001        34000000        0.812016
34000001        35000000        1.299888
35000001        36000000        2.231966
36000001        37000000        0.865942
37000001        38000000        0.330119
38000001        39000000        0.777024
39000001        40000000        0.601956
40000001        41000000        0.630262
41000001        42000000        0.619010
42000001        43000000        0.531972
43000001        44000000        0.475089
44000001        45000000        0.439921
45000001        46000000        0.508788
46000001        47000000        0.371123
47000001        48000000        0.764388
48000001        49000000        0.304343
49000001        50000000        0.844199
50000001        51000000        0.417960
51000001        51304566        1.816748

    Run time: 00:00:21
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl
    4:22PM, 25 October 2010
    ****************************************



WHOLE CHROMOSOME (NO WINDOW)
----------------------------

[syoung@u04 0.1.8]$ /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl --inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam 
average 0.641921

    Run time: 00:00:20
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl
    4:23PM, 25 October 2010
    ****************************************


INTERVALS
---------
    
/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam \
--begin 20000000 \
--end 30000000

    average 0.970790
    
    Run time: 00:00:09
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl
    4:47PM, 25 October 2010
    ****************************************


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam \
--begin 29000001 \
--end 30000000 \
--window 100000

    29000001        29100000        10.121651
    29100001        29200000        0.640076
    29200001        29300000        0.807118
    29300001        29400000        0.378084
    29400001        29500000        0.433344
    29500001        29600000        0.516015
    29600001        29700000        0.437254
    29700001        29800000        0.392034
    29800001        29900000        0.513715
    29900001        30000000        0.846718

    
    Run time: 00:00:09
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl
    4:46PM, 25 October 2010
    ****************************************




NOTES
-----


INSTALLED biosamtools 1.21 TO HERE:

/nethome/syoung/base/apps/samtools/biosamtools/1.21


cd /nethome/syoung/base/apps/samtools/biosamtools/
wget http://search.cpan.org/CPAN/authors/id/L/LD/LDS/Bio-SamTools-1.21.tar.gz
tar xvfz Bio*
mv Bio-SamTools-1.21 1.21



SAMTOOLS PILEUP USAGE

Usage:  samtools pileup [options] <in.bam>|<in.sam>

Option: -s        simple (yet incomplete) pileup format
        -S        the input is in SAM
        -A        use the MAQ model for SNP calling
        -2        output the 2nd best call and quality
        -i        only show lines/consensus with indels
        -m INT    filtering reads with bits in INT [1796]
        -M INT    cap mapping quality at INT [60]
        -d INT    limit maximum depth for indels [unlimited]
        -t FILE   list of reference sequences (force -S)
        -l FILE   list of sites at which pileup is output
        -f FILE   reference sequence in the FASTA format

        -c        output the SOAPsnp consensus sequence
        -v        print variants only (for -c)
        -g        output in the GLFv3 format (suppressing -c/-i/-s)
        -T FLOAT  theta in maq consensus calling model (for -c/-g) [0.850000]
        -N INT    number of haplotypes in the sample (for -c/-g) [2]
        -r FLOAT  prior of a difference between two haplotypes (for -c/-g) [0.001000]
        -G FLOAT  prior of an indel between two haplotypes (for -c/-g) [0.000150]
        -I INT    phred prob. of an indel in sequencing/prep. (for -c/-g) [40]



samtools pileup -s /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam
    
    ...
    chr22   16064716        N       3       Aa^~a   1:'     ~~~
    chr22   16064717        N       3       Gtg     8#%     ~~~
    chr22   16064718        N       3       Ggg     5.%     ~~~
    chr22   16064719        N       4       Ccc^~c  .($'    ~~~~
    chr22   16064720        N       4       Tttt    ,'%'    ~~~~
    chr22   16064721        N       4       Gggg    .+(0    ~~~~
    chr22   16064722        N       4       Aaaa    ++-8    ~~~~
    chr22   16064723        N       4       Ttgg    &9*<    ~~~~
    chr22   16064724        N       4       Gggg    &.+4    ~~~~
    chr22   16064725        N       4       Ctaa    +9,4    ~~~~
    chr22   16064726        N       4       Gggg    ((*.    ~~~~
    chr22   16064727        N       4       Gggg    -.)3    ~~~~
    chr22   16064728        N       5       Tttt^~T &+--I   ~~~~~
    chr22   16064729        N       5       CcccC   #D'0I   ~~~~~
    chr22   16064730        N       5       TtttT   +3-+I   ~~~~~
    chr22   16064731        N       5       CcccC   &2'9I   ~~~~~
    chr22   16064732        N       5       AaaaA   #I0>I   ~~~~~
    chr22   16064733        N       5       GgggG   *@23I   ~~~~~
    chr22   16064734        N       5       AaaaA   &I9:I   ~~~~~
    chr22   16064735        N       5       TtttT   %I22I   ~~~~~
    chr22   16064736        N       5       GgggG   (6A?I   ~~~~~
    chr22   16064737        N       5       GgggG   &F;5I   ~~~~~
    ...


samtools pileup -s /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam | cut -f 2,4
    
    16067085        2
    16067086        2
    16067087        2
    16067088        2
    16067089        2
    16067090        3
    16067091        3
    16067092        3
    16067093        3





PILEUP FORMAT

Pileup format is first used by Tony Cox and Zemin Ning at the Sanger Institute. It desribes the base-pair information at each chromosomal position. This format facilitates SNP/indel calling and brief alignment viewing by eyes.

The pileup format has several variants. The default output by SAMtools looks like this:

	seq1 272 T 24  ,.$.....,,.,.,...,,,.,..^+. <<<+;<<<<<<<<<<<=<;<;7<&
	seq1 273 T 23  ,.....,,.,.,...,,,.,..A <<<;<<<<<<<<<3<=<<<;<<+
	seq1 274 T 23  ,.$....,,.,.,...,,,.,...    7<7;<;<<<<<<<<<=<;<;<<6
	seq1 275 A 23  ,$....,,.,.,...,,,.,...^l.  <+;9*<<<<<<<<<=<<:;<<<<
	seq1 276 G 22  ...T,,.,.,...,,,.,....  33;+<<7=7<<7<&<<1;<<6<
	seq1 277 T 22  ....,,.,.,.C.,,,.,..G.  +7<;<<<<<<<&<=<<:;<<&<
	seq1 278 G 23  ....,,.,.,...,,,.,....^k.   %38*<<;<7<<7<=<<<;<<<<<
	seq1 279 C 23  A..T,,.,.,...,,,.,..... ;75&<<<<<<<<<=<<<9<<:<<

where each line consists of chromosome, 1-based coordinate, reference base, the number of reads covering the site, read bases and base qualities. At the read base column, a dot stands for a match to the reference base on the forward strand, a comma for a match on the reverse strand, `ACGTN' for a mismatch on the forward strand and `acgtn' for a mismatch on the reverse strand. A pattern `\+[0-9]+[ACGTNacgtn]+' indicates there is an insertion between this reference position and the next reference position. The length of the insertion is given by the integer in the pattern, followed by the inserted sequence.

Here is an example of 2bp insertions on three reads:

	seq2 156 A 11  .$......+2AG.+2AG.+2AGGG    <975;:<<<<<

Similarly, a pattern `-[0-9]+[ACGTNacgtn]+' represents a deletion from the reference. Here is an exmaple of a 4bp deletions from the reference, supported by two reads:

	seq3 200 A 20 ,,,,,..,.-4CACC.-4CACC....,.,,.^~. ==<<<<<<<<<<<::<;2<<

Also at the read base column, a symbol `^' marks the start of a read segment which is a contiguous subsequence on the read separated by `N/S/H' CIGAR operations. The ASCII of the character following `^' minus 33 gives the mapping quality. A symbol `$' marks the end of a read segment. Start and end markers of a read are largely inspired by Phil Green's CALF format. These markers make it possible to reconstruct the read sequences from pileup.

SAMtools can optionally append mapping qualities to each line of the output. This makes the output much larger, but is necessary when a subset of sites are selected.



</entry>



<entry [Mon Oct 25 11:57:06 EDT 2010] COVERAGE USING pysam>



1. INSTALL PYTHON LOCALLY


INSTALLED PYTHON

mkdir -p /nethome/syoung/base/apps/python/python/2.7
mkdir -p /nethome/syoung/base/apps/python/python/archive
cd /nethome/syoung/base/apps/python/python/archive
wget http://python.org/ftp/python/2.7/Python-2.7.tgz
tar xvfz *
cd Py*
./configure --prefix=/nethome/syoung/base/apps/python/python/2.7
make

    Python build finished, but the necessary bits to build these modules were not found:
    _bsddb             _sqlite3           _tkinter        
    bsddb185           dbm                dl              
    gdbm               imageop            sunaudiodev     
    To find the necessary bits, look in setup.py in detect_modules() for the module's name.


    ###Python build finished, but the necessary bits to build these modules were not found:
    ###_bsddb             _curses            _curses_panel   
    ###_sqlite3           _ssl               _tkinter        
    ###bsddb185           bz2                dbm             
    ###dl                 gdbm               imageop         
    ###readline           sunaudiodev                        
    ###To find the necessary bits, look in setup.py in detect_modules() for the module's name.
    ###...    
    
make install

    ...
    test -d /nethome/syoung/base/apps/python/python/2.7/lib/pkgconfig || /usr/bin/install -c -d -m 755 /nethome/syoung/base/apps/python/python/2.7/lib/pkgconfig
    rm -f /nethome/syoung/base/apps/python/python/2.7/lib/pkgconfig/python.pc
    (cd /nethome/syoung/base/apps/python/python/2.7/lib/pkgconfig; ln -s python-2.7.pc python.pc)
    Creating directory /nethome/syoung/base/apps/python/python/2.7/share/man
    Creating directory /nethome/syoung/base/apps/python/python/2.7/share/man/man1
    /usr/bin/install -c -m 644 ./Misc/python.man \
                    /nethome/syoung/base/apps/python/python/2.7/share/man/man1/python2.7.1



INSTALL PYTHON setuptools FOR PYTHON v 2.7
------------------------------------------

DOWNLOAD setuptools

mkdir -p /nethome/syoung/base/apps/python/python-setuptools/2.7
cd /nethome/syoung/base/apps/python/python-setuptools/2.7
wget http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c11-py2.7.egg#md5=bd639f9b0eac4c42497034dec2ec0c2b
chmod 755 setuptools-0.6c11-py2.7.egg


SET PATH TO python2.7 IN .bash_profile

export PATH=/nethome/syoung/base/apps/python/python/2.7/bin:$PATH


INSTALL LOCALLY

./setuptools-0.6c11-py2.7.egg \
--prefix=/nethome/syoung/base/apps/python/python/2.7 
    
    Processing setuptools-0.6c11-py2.7.egg
    Copying setuptools-0.6c11-py2.7.egg to /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    Adding setuptools 0.6c11 to easy-install.pth file
    Installing easy_install script to /nethome/syoung/base/apps/python/python/2.7/bin
    Installing easy_install-2.7 script to /nethome/syoung/base/apps/python/python/2.7/bin
    
    Installed /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg
    Processing dependencies for setuptools==0.6c11
    Finished processing dependencies for setuptools==0.6c11
    
    ##Copying setuptools-0.6c11-py2.7.egg to /usr/local/lib/python2.7/site-packages
    ##Adding setuptools 0.6c11 to easy-install.pth file
    ##Installing easy_install script to /usr/local/bin
    ##Installing easy_install-2.7 script to /usr/local/bin
    ##
    ##Installed /usr/local/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg
    ##Processing dependencies for setuptools==0.6c11
    ##Finished processing dependencies for setuptools==0.6c11


INSTALL PYTHON DEVEL
--------------------

yum install python-devel
    
    Installed:
      python-devel.i386 0:2.4.3-27.el5                  python-devel.x86_64 0:2.4.3-27.el5             Complete!



If you compile something that links to Python (eg. mod_wsgi) you have to tell it where to find your Python or it will use the system one instead. This is often done something like:

##./configure --prefix=/home/masi/.local --with-python=/home/masi/.local
##


INSTALL PYTHON HASHLIB LIBRARY
------------------------------

mkdir -p /nethome/syoung/base/apps/python/python-hashlib/20081119
cd /nethome/syoung/base/apps/python/python-hashlib/20081119
wget http://code.krypto.org/python/hashlib/hashlib-20081119.zip

*** DOWNLOAD WOULDN'T WORK SO COPIED FROM WINDOWS TO PEGASUS

/nethome/syoung/base/apps/python/python/2.7/bin/python2.7 setup.py install \
--prefix=/nethome/syoung/base/apps/python/python/2.7 

    ...
    copying build/lib.linux-x86_64-2.7/hashlib.py -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    copying build/lib.linux-x86_64-2.7/_sha.so -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    copying build/lib.linux-x86_64-2.7/_md5.so -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    copying build/lib.linux-x86_64-2.7/_sha256.so -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    copying build/lib.linux-x86_64-2.7/_sha512.so -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    byte-compiling /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/hashlib.py to hashlib.pyc
    running install_egg_info
    Writing /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/hashlib-20081119-py2.7.egg-info

    ###copying build/lib.linux-x86_64-2.7/_sha.so -> /usr/local/lib/python2.7/site-packages
    ###byte-compiling /usr/local/lib/python2.7/site-packages/hashlib.py to hashlib.pyc
    ###running install_egg_info
    ###Writing /usr/local/lib/python2.7/site-packages/hashlib-20081119-py2.7.egg-info



INSTALL CYTHON LIBRARY
----------------------


mkdir -p /nethome/syoung/base/apps/python/cython/0.13
cd /nethome/syoung/base/apps/python/cython/0.13
wget http://cython.org/release/Cython-0.13.tar.gz

*** DOWNLOAD WOULDN'T WORK SO COPIED FROM WINDOWS TO PEGASUS
tar xvfz *
cd Cython-0.13

/nethome/syoung/base/apps/python/python/2.7/bin/python2.7 setup.py install \
--prefix=/nethome/syoung/base/apps/python/python/2.7

    ...
    copying build/scripts-2.7/cython -> /nethome/syoung/base/apps/python/python/2.7/bin
    changing mode of /nethome/syoung/base/apps/python/python/2.7/bin/cython to 775
    running install_egg_info
    Writing /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/Cython-0.13-py2.7.egg-info


INSTALL PYSAM
-------------

DOWNLOAD PYSAM

mkdir -p /nethome/syoung/base/apps/pysam/0.3
mkdir -p /nethome/syoung/base/apps/pysam/archive
cd /nethome/syoung/base/apps/pysam/archive
wget http://pysam.googlecode.com/files/pysam-0.3.tar.gz
tar xvfz *
cd pysam-0.3

/nethome/syoung/base/apps/python/python/2.7/bin/python2.7 setup.py install \
--prefix=/nethome/syoung/base/apps/python/python/2.7 
    
    ...
    running install_lib
    creating /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam
    copying build/lib.linux-x86_64-2.7/pysam/__init__.py -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam
    copying build/lib.linux-x86_64-2.7/pysam/Pileup.py -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam
    copying build/lib.linux-x86_64-2.7/pysam/namedtuple.py -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam
    copying build/lib.linux-x86_64-2.7/pysam/version.py -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam
    copying build/lib.linux-x86_64-2.7/csamtools.so -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    copying build/lib.linux-x86_64-2.7/ctabix.so -> /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages
    byte-compiling /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam/__init__.py to __init__.pyc
    byte-compiling /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam/Pileup.py to Pileup.pyc
    byte-compiling /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam/namedtuple.py to namedtuple.pyc
    byte-compiling /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam/version.py to version.pyc
    running install_egg_info
    Writing /nethome/syoung/base/apps/python/python/2.7/lib/python2.7/site-packages/pysam-0.3-py2.7.egg-info




USE PYSAM
---------


import pysam
samfile = pysam.Samfile("ex1.bam", "rb" )
for pileupcolumn in samfile.pileup( 'chr1', 100, 120):
    print
    print 'coverage at base %s = %s' % (pileupcolumn.pos , pileupcolumn.n)
    for pileupread in pileupcolumn.pileups:
        print '\tbase in read %s = %s' % (pileupread.alignment.qname, pileupread.alignment.seq[pileupread.qpos])

samfile.close()
To give:


pysam - An interface for reading and writing SAM files
Pysam is a python module that makes it easy to read and manipulate mapped short read sequence data stored in SAM files. Its a lightweight wrapper of the samtools C-API.

To use the module to read a file in SAM format, just open the file with Samfile:

import pysam
samfile = pysam.Samfile( "ex1.bam", "rb" )
Now the file is open you can iterate over all of the read mapping to a specified region using fetch(). Each iteration returns a AlignedRead object which represents a single read along with its fields and optional tags:

for alignedread in samfile.fetch('chr1', 100, 120):
     print alignedread

samfile.close()
To give:

EAS56_57:6:190:289:82       0       99      <<<7<<<;<<<<<<<<8;;<7;4<;<;;;;;94<;     69      CTCAAGGTTGTTGCAAGGGGGTCTATGTGAACAAA     0       192     1
EAS56_57:6:190:289:82       0       99      <<<<<<;<<<<<<<<<<;<<;<<<<;8<6;9;;2;     137     AGGGGTGCAGAGCCGAGTCACGGGGTTGCCAGCAC     73      64      1
EAS51_64:3:190:727:308      0       102     <<<<<<<<<<<<<<<<<<<<<<<<<<<::<<<844     99      GGTGCAGAGCCGAGTCACGGGGTTGCCAGCACAGG     99      18      1
...
You can also write to a Samfile:

import pysam
samfile = pysam.Samfile("ex1.bam", "rb")
pairedreads = pysam.Samfile("allpaired.bam", "wb", template=samfile)
for read in samfile.fetch():
     if read.is_paired:
             pairedreads.write(read)

pairedreads.close()
samfile.close()
An alternative way of accessing the data in a SAM file is by iterating over each base of a specified region using the pileup() method. Each iteration returns a PileupColumn which represents all the reads in the SAM file that map to a single base in the reference sequence. The list of reads are represented as PileupRead objects in the PileupColumn.pileups property:

import pysam
samfile = pysam.Samfile("ex1.bam", "rb" )
for pileupcolumn in samfile.pileup( 'chr1', 100, 120):
    print
    print 'coverage at base %s = %s' % (pileupcolumn.pos , pileupcolumn.n)
    for pileupread in pileupcolumn.pileups:
        print '\tbase in read %s = %s' % (pileupread.alignment.qname, pileupread.alignment.seq[pileupread.qpos])

samfile.close()
To give:

coverage at base 99 = 1
    base in read EAS56_57:6:190:289:82 = A

coverage at base 100 = 1
    base in read EAS56_57:6:190:289:82 = G

coverage at base 101 = 1
    base in read EAS56_57:6:190:289:82 = G

coverage at base 102 = 2
    base in read EAS56_57:6:190:289:82 = G
    base in read EAS51_64:3:190:727:308 = G
...
Commands available in csamtools are available as simple function calls. For example:

pysam.sort( "ex1.bam", "output" )
corresponds to the command line:

samtools sort ex1.bam output

Note

Coordinates in pysam are always 0-based (following the python convention).
SAM text files use 1-based coordinates.


The above examples can be run in the /test directory of the installation directory. Type make before running them.
See also


The pysam Google code page, containing source code and download instructions
http://code.google.com/p/pysam/

The pysam website containing documentation
http://wwwfgu.anat.ox.ac.uk/~andreas/documentation/samtools/contents.html



NOTES
-----


INSTALLING LOCALLY


How can I install to a path under my home directory?
http://stackoverflow.com/questions/622744/unable-to-install-python-without-sudo-access

mkdir /home/masi/.local

cd Python-2.6.1
make clean
./configure --prefix=/home/masi/.local
make
make install

Then run using:

/home/masi/.local/bin/python

Similarly if you have scripts (eg. CGI) that require your own user version of Python you have to tell them explicitly:

#!/home/masi/.local/bin/python

instead of using the default system Python which #!/usr/bin/env python will choose.


You can alter your PATH setting to make just typing python from the console run that version, but it won't help for web apps being run under a different user.

If you compile something that links to Python (eg. mod_wsgi) you have to tell it where to find your Python or it will use the system one instead. This is often done something like:

./configure --prefix=/home/masi/.local --with-python=/home/masi/.local
For other setup.py-based extensions like MySQLdb you simply have to run the setup.py script with the correct version of Python:

/home/masi/.local/bin/python setup.py install




USING --prefix TO INSTALL LOCALLY


I was getting the following with python2.4. Solved this problem by following this guide and installing python26. http://www.question-defense.com/2009/12/25/how-to-install-python-2-6-on-centos-5-without-breaking-yum

Traceback (most recent call last):

File "VBoxWebSrv.py", line 32, in ?
import hashlib
ImportError?: No module named hashlib


Alternate installation: Unix (the prefix scheme)
The prefix scheme is useful when you wish to use one Python installation to perform the build/install (i.e., to run the setup script), but install modules into the third-party module directory of a different Python installation (or something that looks like a different Python installation). If this sounds a trifle unusual, it isthats why the home scheme comes first. However, there are at least two known cases where the prefix scheme will be useful.

First, consider that many Linux distributions put Python in /usr, rather than the more traditional /usr/local. This is entirely appropriate, since in those cases Python is part of the system rather than a local add-on. However, if you are installing Python modules from source, you probably want them to go in /usr/local/lib/python2.X rather than /usr/lib/python2.X. This can be done with

/usr/bin/python setup.py install --prefix=/usr/local
Another possibility is a network filesystem where the name used to write to a remote directory is different from the name used to read it: for example, the Python interpreter accessed as /usr/local/bin/python might search for modules in /usr/local/lib/python2.X, but those modules would have to be installed to, say, /mnt/@server/export/lib/python2.X. This could be done with

/usr/local/bin/python setup.py install --prefix=/mnt/@server/export
In either case, the --prefix option defines the installation base, and the --exec-prefix option defines the platform-specific installation base, which is used for platform-specific files. (Currently, this just means non-pure module distributions, but could be expanded to C libraries, binary executables, etc.) If --exec-prefix is not supplied, it defaults to --prefix. Files are installed as follows:

Type of file	Installation Directory	Override option
pure module distribution	prefix/lib/pythonX.Y/site-packages	--install-purelib
non-pure module distribution	exec-prefix/lib/pythonX.Y/site-packages	--install-platlib
scripts	prefix/bin	--install-scripts
data	prefix/share	--install-data




</entry>



<entry [Fri Oct 22 15:57:03 EDT 2010] COVERAGE CONTINUED: USE PERL SCRIPT AND SAMTOOLS UPPER LEVEL>



/nethome/apps/ccsngs/apps/samtools/0.1.8/samtools idxstats

    Usage: samtools idxstats <in.bam>

INPUT FILE:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam

    -rw-rw-r-- 1 syoung root 53M Oct 20 21:40 hit.sorted.bam


RUN bamCoverage.pl

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/bamCoverage.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam


NOTES
-----


SAMTOOLS FUNCTIONS

idxstats
--------

/nethome/apps/ccsngs/apps/samtools/0.1.8/samtools idxstats /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam

    chr22   51304566        914819  0
    *       0       0       0

flagstat
--------

/nethome/apps/ccsngs/apps/samtools/0.1.8/samtools flagstat /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam

    914819 in total
    0 QC failure
    0 duplicates
    914819 mapped (100.00%)
    914819 paired in sequencing
    457409 read1
    457410 read2
    914819 properly paired (100.00%)
    914819 with itself and mate mapped
    0 singletons (0.00%)
    0 with mate mapped to a different chr
    0 with mate mapped to a different chr (mapQ>=5)





</entry>



<entry [Fri Oct 22 02:42:18 EDT 2010] CLEAN UP /scratch BY REMOVING FROM autochr22>




NB: RETAIN MAQ ALIGNMENTS FOR FILES 1, 2, 3 AND 4 TO CHECK REASON FOR FAILED SNP PREDICTIONS

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22
ll *snp

    -rw-rw-rw- 1 syoung root 1.1M Oct 18 12:05 hit-1.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 12:14 hit-2.snp
    -rw-rw-rw- 1 syoung root    0 Oct 18 12:30 hit-3.snp
    -rw-rw-rw- 1 syoung root    0 Oct 18 12:30 hit-4.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 13:00 hit-5.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 18 13:48 hit-6.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 18 14:02 hit-7.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 18 15:05 hit-8.snp
    -rw-rw-rw- 1 syoung root 1.2M Oct 18 16:24 hit-9.snp



REMOVE SPLITFILES

screen -S rm-maq-autochr22

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then

        SPLITDIR=$(echo $DIR | egrep "^[0-9]+" ); 
        if [ "$SPLITDIR" != "" ]; then
    
            cd $PWD/$DIR;
            SUBDIRS="*"
            for SUBDIR in $SUBDIRS;
            do
                if [ -d `pwd`/$SUBDIR ]; then
    
                    SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
                    if [ "$SPLITSUBDIR" != "" ]; then
                        echo "SUBDIR: " $PWD/$SUBDIR
                        rm -fr $PWD/$SUBDIR 
                    fi;
                fi;
                
            done;
            cd ..

        fi;
    fi;
done;



REMOVE SUBFOLDER FILES
----------------------


REMOVE SPLITFILES

screen -S rm-maq-autochr22

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then

        SPLITDIR=$(echo $DIR | egrep "^[0-9]+" ); 
        if [ "$SPLITDIR" != "" ]; then
    
            cd $PWD/$DIR;
            SUBDIRS="*"
            for SUBDIR in $SUBDIRS;
            do
                if [ -d `pwd`/$SUBDIR ]; then
    
                    SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
                    if [ "$SPLITSUBDIR" != "" ]; then
                        echo "SUBDIR: " $PWD/$SUBDIR
                        rm -fr $PWD/$SUBDIR 
                    fi;
                fi;
                
            done;
            cd ..

        fi;
    fi;
done;


#
#
#cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
#
#PWD=`pwd`;
#DIRS="*"
#for DIR in $DIRS;
#do
#    if [ -d `pwd`/$DIR ]; then
#        
#        cd $DIR
#            
#        SUBDIRS="*"
#        for SUBDIR in $SUBDIRS;
#        do
#            echo $SUBDIR
#            SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
#            if [ "$SPLITSUBDIR" != "" ]; then
#                echo "SUBDIR: " $PWD/$SUBDIR
#                rm -fr $PWD/$SUBDIR 
#            fi;
#        done;
#
#        cd ../
#
#    fi;
#done;
#


##MOVE FILES TO /ngs/bioinfo
##
##cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
##mv chr1 chr1-part
##
##cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
##mv * /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq








</entry>



<entry [Fri Oct 22 00:18:58 EDT 2010] PREPARE CHROMOSOME-SPECIFIC SQLITE FILES FOR pileupToSnp.pl>





SQLITE TABLES POPULATED
-----------------------

ccdsGene, ccdsSeq AND ccdsSNP (snp130-chr*

sqlite> select count(*) from ccdsSNP;
156972
sqlite> select count(*) from ccdsGene;
20113
sqlite> select count(*) from ccdsSeq;
20091

select count(*) from ccdsSeq,ccdsGene where ccdsGene.name=ccdsSeq.id and ccdsGene.chrom='chr1';
    2238
select count(*) from ccdsSNP where chromosome='chr1';
    17285


WRITE SQL FILES
---------------


ccdsGene
--------

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/sql
emacs ccdsGene.sql
CREATE TABLE ccdsGene (
  bin smallint(5) NOT NULL,
  name varchar(255) NOT NULL,
  chrom varchar(255) NOT NULL,
  strand char(1) NOT NULL,
  txStart int(10) NOT NULL,
  txEnd int(10) NOT NULL,
  cdsStart int(10) NOT NULL,
  cdsEnd int(10) NOT NULL,
  exonCount int(10) NOT NULL,
  exonStarts longblob NOT NULL,
  exonEnds longblob NOT NULL,
  score int(11) NOT NULL,
  name2 varchar(255) NOT NULL,
  cdsStartStat TEXT NOT NULL,
  cdsEndStat TEXT NOT NULL,
  exonFrames longblob NOT NULL,
  PRIMARY KEY (chrom,bin, name)
);


snp130-chr*
-----------

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/sql

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "CREATE TABLE snp130_$CHROMO (
  chrom varchar(31) NOT NULL default '',
  chromStart int(10) NOT NULL default 0,
  chromEnd int(10) NOT NULL default 0,
  name varchar(15) NOT NULL default '',
  PRIMARY KEY (name, chrom, chromStart, chromEnd)
);
" > snp130_$CHROMO.sql

done;




ccdsSeq
-------


cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/sql
emacs ccdsSeq.sql
CREATE TABLE ccdsSeq (
    id VARCHAR(20),
    sequence TEXT,
    primary key(id)
);





USE ccdsInfo LATER?

##CREATE TABLE 'ccdsInfo' (
##    'ccds' char(12) NOT NULL default '',
##    'srcDb' char(1) NOT NULL default '',
##    'mrnaAcc' char(18) NOT NULL default '',
##    'protAcc' char(18) NOT NULL default '',
##    PRIMARY KEY ('ccds', 'srcDb')
##);
##
##sqlite> select count(*) from ccdsInfo;
##0





ccdsGene
--------


PRINT COMMAND FILES

mkdir /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/scripts
cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/scripts

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "chromo: " $CHROMO;
    
    echo ".mode tabs
.output /tmp/ccdsGene-$CHROMO.tsv
SELECT * FROM ccdsGene WHERE chrom='$CHROMO';
" > ccdsGene-$CHROMO.cmd
    chmod 755 ccdsGene-$CHROMO.cmd
    
done;


PROCESS COMMAND FILES

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "sqlite3 filtersnp.dbl '.read scripts/ccdsGene-$CHROMO.cmd'"
    sqlite3 filtersnp.dbl ".read scripts/ccdsGene-$CHROMO.cmd"    
done;


MOVE TO DBFILE FOLDER:

mv /tmp/ccdsGene* /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile



LOAD INTO CHROMOSOME-SPECIFIC DATABASE FILES

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo ".separator \"\t\" 
.read sql/ccdsGene.sql
.import ccdsGene-$CHROMO.tsv ccdsGene
" > scripts/ccdsGene-$CHROMO-LOAD.cmd
    chmod 755 scripts/ccdsGene-$CHROMO-LOAD.cmd

    echo "sqlite3 snp130-$CHROMO.dbl '.read scripts/ccdsGene-$CHROMO-LOAD.cmd'"
    sqlite3 snp130-$CHROMO.dbl ".read scripts/ccdsGene-$CHROMO-LOAD.cmd"
done;



CHECK LOADED

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "sqlite3 snp130-$CHROMO.dbl 'select count(*) from ccdsGene;'"
    sqlite3 snp130-$CHROMO.dbl "select count(*) from ccdsGene;"
done;

    OK


ccdsSeq
--------


PRINT COMMAND FILES

mkdir /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/scripts
cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/scripts

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "chromo: " $CHROMO;
    
    echo ".mode tabs
.output /tmp/ccdsSeq-$CHROMO.tsv
select ccdsSeq.* from ccdsSeq,ccdsGene where ccdsGene.name=ccdsSeq.id and ccdsGene.chrom='$CHROMO';
" > ccdsSeq-$CHROMO.cmd
    chmod 755 ccdsSeq-$CHROMO.cmd
    
done;



PROCESS COMMAND FILES

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "sqlite3 filtersnp.dbl '.read scripts/ccdsSeq-$CHROMO.cmd'"
    sqlite3 filtersnp.dbl ".read scripts/ccdsSeq-$CHROMO.cmd"    
done;



MOVE TO DBFILE FOLDER:

mv -f /tmp/ccdsSeq* /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile



LOAD INTO CHROMOSOME-SPECIFIC DATABASE FILES

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo ".mode tabs 
.read sql/ccdsSeq.sql
.import ccdsSeq-$CHROMO.tsv ccdsSeq
" > scripts/ccdsSeq-$CHROMO-LOAD.cmd
    chmod 755 scripts/ccdsSeq-$CHROMO-LOAD.cmd

    echo "sqlite3 snp130-$CHROMO.dbl '.read scripts/ccdsSeq-$CHROMO-LOAD.cmd'"
    sqlite3 snp130-$CHROMO.dbl ".read scripts/ccdsSeq-$CHROMO-LOAD.cmd"
done;


CHECK LOADED

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "sqlite3 snp130-$CHROMO.dbl 'select count(*) from ccdsSeq;'"
    sqlite3 snp130-$CHROMO.dbl "select count(*) from ccdsSeq;"
done;


    OK



snp130-chr*
----------

PRINT COMMAND FILES

mkdir /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/scripts

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile/scripts

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "SELECT * FROM snp130-$CHROMO";
    
    echo ".mode tabs
.output /tmp/snp130_$CHROMO.tsv
SELECT * FROM snp130_$CHROMO;
" > snp130_$CHROMO.cmd
    chmod 755 snp130_$CHROMO.cmd
    
done;



PROCESS COMMAND FILES

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "sqlite3 /nethome/syoung/base/pipeline/dbsnp/snp130-$CHROMO.dbl '.read scripts/snp130_$CHROMO.cmd'"

    sqlite3 /nethome/syoung/base/pipeline/dbsnp/snp130-$CHROMO.dbl ".read scripts/snp130_$CHROMO.cmd"    

done;




MOVE TO DBFILE FOLDER:

mv /tmp/snp130* /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile



LOAD INTO CHROMOSOME-SPECIFIC DATABASE FILES


cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo ".separator \"\t\" 
.read sql/snp130_$CHROMO.sql
.import snp130_$CHROMO.tsv snp130_$CHROMO
" > scripts/snp130-$CHROMO-LOAD.cmd
    chmod 755 scripts/snp130-$CHROMO-LOAD.cmd

    echo "sqlite3 snp130-$CHROMO.dbl '.read scripts/snp130-$CHROMO.cmd'"
    sqlite3 snp130-$CHROMO.dbl ".read scripts/snp130-$CHROMO-LOAD.cmd"
done;




CHECK LOADED

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile

for CHROMO in chr1 chr2 chr3 chr4 chr5 chr6 chr7 chr8 chr9 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19 chr20 chr21 chr22 chrX chrY;
do
    echo "sqlite3 snp130-$CHROMO.dbl 'select count(*) from snp130_$CHROMO;'"
    sqlite3 snp130-$CHROMO.dbl "select count(*) from snp130_$CHROMO;"
done;

    OK





</entry>



<entry [Thu Oct 21 14:27:41 EDT 2010] USE loop.pl TO RUN REFACTORED SAV.pl WITH COPY sqlite DB TO OUTDIR>




1-33 IN PARALLEL 
----------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative

screen -r loop-eland-sav

screen -S loop-eland-sav

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--replicates 1-33 \
--concurrent \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/SAV.pl \
--tempfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/snp130-chr22-%REPLICATE%.dbl \
--inputfile hit-%REPLICATE%.snp \
--outputfile hit-%REPLICATE%.sav \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative \
--dbsnp snp130 \
--species human \
--maxjobs 1000 \
--queue small \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/sav-%REPLICATE%.out \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/loop.out
    
    Run time: 06:46:12
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    10:34PM, 22 October 2010
    ****************************************

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative
grep "Run time"  sav-*.out

    sav-10.out:SAV.pl    Run time: 06:16:51
    sav-11.out:SAV.pl    Run time: 06:16:34
    sav-12.out:SAV.pl    Run time: 06:21:45
    sav-13.out:SAV.pl    Run time: 06:21:30
    sav-14.out:SAV.pl    Run time: 00:00:40
    sav-15.out:SAV.pl    Run time: 03:28:48
    sav-16.out:SAV.pl    Run time: 03:28:44
    sav-17.out:SAV.pl    Run time: 03:28:43
    sav-18.out:SAV.pl    Run time: 02:28:57
    sav-19.out:SAV.pl    Run time: 02:28:58
    sav-1.out:SAV.pl    Run time: 05:49:43
    sav-20.out:SAV.pl    Run time: 03:19:50
    sav-21.out:SAV.pl    Run time: 00:00:35
    sav-22.out:SAV.pl    Run time: 00:00:35
    sav-23.out:SAV.pl    Run time: 02:22:28
    sav-24.out:SAV.pl    Run time: 02:22:23
    sav-25.out:SAV.pl    Run time: 00:00:31 <==
    sav-26.out:SAV.pl    Run time: 00:00:56 <==
    sav-27.out:SAV.pl    Run time: 00:00:56
    sav-28.out:SAV.pl    Run time: 00:00:56
    sav-29.out:SAV.pl    Run time: 00:00:56
    sav-2.out:SAV.pl    Run time: 02:04:37
    sav-30.out:SAV.pl    Run time: 00:00:26
    sav-31.out:SAV.pl    Run time: 00:00:26
    sav-32.out:SAV.pl    Run time: 00:00:26
    sav-33.out:SAV.pl    Run time: 00:00:21
    sav-3.out:SAV.pl    Run time: 02:04:36
    sav-4.out:SAV.pl    Run time: 00:00:56
    sav-5.out:SAV.pl    Run time: 00:00:56
    sav-6.out:SAV.pl    Run time: 00:04:15
    sav-7.out:SAV.pl    Run time: 00:04:14
    sav-8.out:SAV.pl    Run time: 00:04:14
    sav-9.out:SAV.pl    Run time: 06:46:02


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative
ll chr22/*sav
-rw-rw-rw- 1 syoung root  14K Oct 22 15:52 chr22/hit-11.sav
-rw-rw-rw- 1 syoung root 3.0M Oct 22 22:09 chr22/hit-16.sav
-rw-rw-rw- 1 syoung root 2.9M Oct 22 22:33 chr22/hit-17.sav
-rw-rw-rw- 1 syoung root 2.8M Oct 22 18:17 chr22/hit-21.sav
-rw-rw-rw- 1 syoung root 2.8M Oct 22 19:16 chr22/hit-22.sav
-rw-rw-rw- 1 syoung root 2.6M Oct 22 19:08 chr22/hit-26.sav
-rw-rw-rw- 1 syoung root 3.1K Oct 22 15:48 chr22/hit-27.sav
-rw-rw-rw- 1 syoung root 3.7K Oct 22 15:49 chr22/hit-32.sav
-rw-rw-rw- 1 syoung root 3.3K Oct 22 15:48 chr22/hit-33.sav
-rw-rw-rw- 1 syoung root 2.1M Oct 22 21:37 chr22/hit-5.sav

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22
ll *out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 22:04 sav-10.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 22:04 sav-11.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 22:09 sav-12.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 22:09 sav-13.out
    -rw-rw-rw-  1 syoung root 3.6K Oct 22 15:48 sav-14.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 19:16 sav-15.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 19:16 sav-16.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 19:16 sav-17.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 18:17 sav-18.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 18:17 sav-19.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 21:37 sav-1.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 19:08 sav-20.out
    -rw-rw-rw-  1 syoung root 3.2K Oct 22 15:48 sav-21.out
    -rw-rw-rw-  1 syoung root 3.2K Oct 22 15:48 sav-22.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 18:10 sav-23.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 18:10 sav-24.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:48 sav-25.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:49 sav-26.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:49 sav-27.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:49 sav-28.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:49 sav-29.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 17:52 sav-2.out
    -rw-rw-rw-  1 syoung root 3.0K Oct 22 15:48 sav-30.out
    -rw-rw-rw-  1 syoung root 2.9K Oct 22 15:48 sav-31.out
    -rw-rw-rw-  1 syoung root 2.9K Oct 22 15:48 sav-32.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:48 sav-33.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 17:52 sav-3.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:48 sav-4.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:48 sav-5.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:52 sav-6.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:52 sav-7.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 15:52 sav-8.out
    -rw-rw-rw-  1 syoung root 2.7K Oct 22 22:34 sav-9.out



WHICH RUNS:


/nethome/bioinfo/apps/agua/0.5/bin/apps/snp/pileupToSnp.pl \
--dbfile /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/../t/04-Filter-SNP/dbfile/snp130-chr22.dbl \
--inputfile /scratch/syoung\
/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-33.snp \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-33.sav \
--inputtype pileup \
--tempfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/snp130-chr22-33.dbl




    
cd/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22

head hit-33.sav

    chr22   16050612        c       G       50      50      35      79      G$GgG.G,gggG.GgG,g.GGgg,GGg.gGgGG.GG.gGGGGg.gG..,..GGgggGGGGg.Gg,ggGg.g,Gt,,.,,a        !!+!!!+++&!!)+!++!!#+&+!(+!++$!+!+#!&+$++!&++$+!*+++!#!+&!+!++!!+!+!+!!+!!!+!!+ 0.662
    chr22   16053659        A       C       57      57      34      33      C$c$cccccccCcCCcCccCCCcCcCcCcccccc^Zc   !++++++++!+!!+!&++'$+!""!!+!!!!!!       0.943                                       chr22   16054740        A       G       50      50      38      40      G$GGGG,gg,GgGGgGGGG,ggGgg,.ggGGggg.GgGgG.       +!!%+++++"+!&+"+++"!!"!&!!%!"+!!(!+!+!++        0.805                       chr22   16055003        A       G       40      40      35      61      G$N$,$,.G..gg,GgGG.GG.GG,,.gG.ggG.G,gG,ggGG,.G,G,g.G,GGggg,.,,^4.^s,    !!++!+!!&+!!+++!"+!++++!"+!++!!+")*+*!++!"+!+!!!+!++!!"!+!!+"   0.516
    chr22   16055396        G       C       22      27      36      63      ,$c$CCcc.cC.cccC.ccC,C,c,C,,cCc.CcCc,,CcCC.,C,...CC,C..ccC,c^~.^~C^\,^5,^3c     ++!!++!++!+++!#++!+*!$+++$#!!$!"+!!!"""++'$!+++++"(++!#+!!++!!! 0.585
    chr22   16055570        T       C       21      23      38      62      .$,$,$,$..,C.c,C,Ccc,ccc,..cccCC.C,,cccCcC,Ccc.C..,,cCcCCgCCcc,CC,      ++++!!+!")+!+!*"%++++"!!#++!!+!!+"+"&"!+!++"++!!+!!#+!++!!!"+!  0.545
    chr22   16055913        G       T       22      22      39      42      CTTT.,TttTT.TTT.TT...TttTT,Tt...t..T,..c,t      +$!+!+!+!'%+!+"!++!""!+!++!+!++++"++!++!!!      0.548                       chr22   16055942        C       T       23      28      38      41      T$T$T$t..tttTTtTtt,Ttt,t.t..TTTt.t,TTttT.tg^XT  !!+!+*++++!!!"!+!!!!!!!(+#++!+!")+!!+++!+       0.682                       chr22   16058852        a       T       64      64      34      98      T$t$t$TTtTtttT.TTT,.tttT,TttTTtT.Ttt.,.T..Ttt,Ttt,,TT,ttTttttTTtttTtttttttTT.tTTtTT,TTtttTttTT,Tt,^fT^'t^`t     !++!!+!+++!!!!!%!+!+!+!!+!"+!!!+!!+!!!!!!*+!+!+$+"!!!$""!!!+!!!%%!!&!!!++!!!+!!!!+%!!!!!!++!+!!+!+      0.792
    chr22   16060239        a       M       30      33      28      93      .$,$TC,CCc..G,..,,,..,,..cC.t.,,ccc.CC,.c,CcCC.C.C.CC,,CCCCC,ccCt..,tT.CTT.Tt,tTTCTtt,Tt.tC.Tcc !+!!!"!+!!!+!!!++!!++!!+!!+&+!+!+"!!!!!+"++$"+!+"!+#!"++"+!!"+!!+!!!+$+++#!+!+*!+!%)+!+!&++&$   0.000
    chr22   16060744        g       C       15      25      28      72      C$C.CC.CCCccCCc.ccCCCCCCCCCCCCCC.CC.TC..t.CCT.CC...t..t,t,.,.AA.,cc,ccccc       !!!!!!!&++#!!+!+++!!!!!"!!!+++'!!+&!+!'"%!"!+!!"++!++!!!'++'+++!"!$!!!+"        0.575
    chr22   16060995        G       A       28      28      40      85      A$a$,$.$a$NAAAAA,aAAAAA..a,,AaA.A..aaa.AAaAAAAAAAA.A,,.aaa,aA,aAA.aAA.A.,Aa.Aaaa,.A,AAAAAa      !++"+!!!!!!(+!!"!!!+*++!+!+!!#+++%"!$!+"$!"!!+""!"+%%+"!!'+#""++#++++!++!++++"!++++%!   0.656
    chr22   16061992        a       C       47      47      39      91      C$c$c$CcCcCcCCC.C,,.CCCCccCCcC.CCCCCCCcccCCccccCC,c,,cCCccccCCCCcccCc,,c,cCCccc.cccC,cCCcCccc^9C        !++!+++!+!"!!!+!!+!!!++"!+"!!"++"+%+"&%!++"+$"!++!+%!"&"+$#!*"!%'!*+!!!+&$$+++!++'"++"+"!"+     0.830
    chr22   16063154        t       G       29      29      29      78      G$G$G$G$G$G$G$G$g$GGGGggGGGggggGGGGGGGg,GGGgG.Gg.G.,g.,gg.,,..,....GG.g.,,,.G..gngg^%g^]g^,g^'a !&!+!!!!$"!!!&+!!+++++!!!+++!++!+!+!!!&&"!+$+"!++!!"'!%+++++++'!!!+++$!!)!!+!!  0.586
    chr22   16070517        t       G       39      39      32      71      g....AA.,g.,,g,G,gGgGgggGgG,,gGgggggggggggG.gggGGgg.GgGGGGggGg.ggg^H,^8,^Ig^I,^4a       $!!%"!!!++!!&+++++'+!!+!!%+!"!+")!!$%"!!!%+!!!!++!!++!++++!"+!"!!(!!!!! 0.690   CCDS13742.1     50      exon    1       -       TTG     TGG     L       W       missense

MATCHED DBSNPS:

cd /nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile
sqlite3 snp130-chr22.dbl 

    SQLite version 3.3.6
    Enter ".help" for instructions
    sqlite> .schema snp130_chr22
    CREATE TABLE snp130_chr22 (
      chrom varchar(31) NOT NULL default '',
      chromStart int(10) NOT NULL default 0,
      chromEnd int(10) NOT NULL default 0,
      name varchar(15) NOT NULL default '',
      PRIMARY KEY (name, chrom, chromStart, chromEnd)
    );
    sqlite> select * from snp130_chr22 where chromStart > 16053650 and chromStart < 16053670;
    chr22|16053658|16053659|rs915675
    sqlite> select * from snp130_chr22 where chromStart =16054739;;
    chr22|16054739|16054740|rs55926024
    chr22|16054739|16054740|rs2844885
    sqlite> select * from snp130_chr22 where chromStart = 1605502;
    sqlite> select * from snp130_chr22 where chromStart = 16055395;
    chr22|16055395|16055396|rs71256249
    sqlite> select * from snp130_chr22 where chromStart = 16055569;
    chr22|16055569|16055570|rs1359599
    sqlite> select * from snp130_chr22 where chromStart = 16055912;
    chr22|16055912|16055913|rs6518433
    sqlite> .q

sqlite> SELECT * FROM ccdsGene WHERE txStart>= 16000000 AND txStart <= 16100000;



10th ENTRY

sqlite> SELECT * FROM ccdsGene WHERE txStart>= 16000000 AND txStart <= 16100000;

707|CCDS13742.1|chr22|-|16042372|16070567|16042372|16070567|9|16042372,16042709,16043493,16049228,16050831,16052572,16064452,16067960,16070245,|16042466,16042912,16043651,16049337,16050922,16052700,16064663,16068180,16070567,|0||cmpl|cmpl|2,0,1,0,2,0,2,1,0,

707|CCDS13743.1|chr22|-|16042372|16060468|16042372|16060468|7|16042372,16042709,16043493,16049228,16050831,16052572,16060438,|16042466,16042912,16043651,16049337,16050922,16052700,16060468,|0||cmpl|cmpl|2,0,1,0,2,0,0,






    
NOTES
-----

/nethome/bioinfo/apps/agua/0.5/bin/apps/t/04-Filter-SNP/dbfile


-rw-r--r-- 1 syoung bioinfo  63M May 17 20:46 snp130-chr10.dbl
-rw-r--r-- 1 syoung bioinfo  59M May 17 20:46 snp130-chr11.dbl
-rw-r--r-- 1 syoung bioinfo  58M May 17 20:46 snp130-chr12.dbl
-rw-r--r-- 1 syoung bioinfo  45M May 17 20:46 snp130-chr13.dbl
-rw-r--r-- 1 syoung bioinfo  40M May 17 20:46 snp130-chr14.dbl
-rw-r--r-- 1 syoung bioinfo  40M May 17 20:46 snp130-chr15.dbl
-rw-r--r-- 1 syoung bioinfo  43M May 17 20:46 snp130-chr16.dbl
-rw-r--r-- 1 syoung bioinfo  37M May 17 20:46 snp130-chr17.dbl
-rw-r--r-- 1 syoung bioinfo  34M May 17 20:46 snp130-chr18.dbl
-rw-r--r-- 1 syoung bioinfo  29M May 17 20:46 snp130-chr19.dbl
-rw-r--r-- 1 syoung bioinfo 108M May 17 20:46 snp130-chr1.dbl
-rw-r--r-- 1 syoung bioinfo  32M May 17 20:46 snp130-chr20.dbl
-rw-r--r-- 1 syoung bioinfo  20M May 17 20:46 snp130-chr21.dbl
-rw-r--r-- 1 syoung bioinfo  23M May 17 20:46 snp130-chr22.dbl
-rw-r--r-- 1 syoung bioinfo 102M May 17 20:46 snp130-chr2.dbl
-rw-r--r-- 1 syoung bioinfo  81M May 17 20:46 snp130-chr3.dbl
-rw-r--r-- 1 syoung bioinfo  82M May 17 20:46 snp130-chr4.dbl
-rw-r--r-- 1 syoung bioinfo  74M May 17 20:46 snp130-chr5.dbl
-rw-r--r-- 1 syoung bioinfo  81M May 17 20:46 snp130-chr6.dbl
-rw-r--r-- 1 syoung bioinfo  71M May 17 20:46 snp130-chr7.dbl
-rw-r--r-- 1 syoung bioinfo  63M May 17 20:46 snp130-chr8.dbl
-rw-r--r-- 1 syoung bioinfo  69M May 17 20:46 snp130-chr9.dbl
-rw-r--r-- 1 syoung bioinfo  46M May 17 20:46 snp130-chrX.dbl
-rw-r--r-- 1 syoung bioinfo 6.7M May 17 20:46 snp130-chrY.dbl




</entry>



<entry [Thu Oct 21 12:47:38 EDT 2010] RUN SAV.pl ON ELAND 3.3 BILLION READ SNP FILE>



ELAND
-----

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22

####rm -fr sav-33.sh 
####emacs sav-33.sh 
####
####
#####BSUB -J sav-eland-33               # The name of the job
#####BSUB -W 24:00
#####BSUB -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/sav-33.out
#####BSUB -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/sav-33.err
####
####echo "LS_JOBID: " $LS_JOBID
####echo "LS_JOBPID: " $LS_JOBPID
####echo "LSB_JOBINDEX: " $LSB_JOBINDEX
####echo "LSB_JOBNAME: " $LSB_JOBNAME
####echo "LSB_QUEUE: " $LSB_QUEUE
####echo "LSFUSER: " $LSFUSER
####echo "LSB_JOB_EXECUSER: " $LSB_JOB_EXECUSER
####echo "HOSTNAME: " $HOSTNAME
####echo "LSB_HOSTS: " $LSB_HOSTS
####echo "LSB_ERRORFILE: " $LSB_ERRORFILE
####echo "LSB_JOBFILENAME: " $LSB_JOBFILENAME
####echo "LD_LIBRARY_PATH: " $LD_LIBRARY_PATH


screen -S sav-eland-33

/nethome/bioinfo/apps/agua/0.5/bin/apps/snp/SAV.pl \
--dbsnp snp130 \
--species human \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chr22 \
--cluster LSF \
--inputfile hit-33.snp \
--outputfile hit-33.sav 
    
    ...
    Filter::SNP::referenceCodon    Filter::SNP::referenceCodon(reference_aa, variant_aa)
    Filter::SNP::referenceCodon    reference_aa: S
    Filter::SNP::variantCodon    variant_aa: W
    $VAR1 = { 
              'stop' => '19657653',
              'chromosome' => '22',
              'line' => 'chr22      19657652        t       G       29      29      38      27      ,,g,.gA,GgGGGgGg,GgGG.G,Ggg        +++++#"++&+++!+!+++++++!+"+     0.667   CCDS13786.1     88      exon       2       +',
              'start' => 19657652
            };
    Filter::SNP::geneLocation    Falls between exons
    Filter::SNP::geneLocation    Falls between exons
    ...

lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.sav

    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.sav: 24283


WHICH RUNS:

/nethome/bioinfo/apps/agua/0.5/bin/apps/snp/pileupToSnp.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.snp \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.sav \
--inputtype pileup





</entry>



<entry [Wed Oct 20 12:56:25 EDT 2010] COVERAGE CONTINUED: USE C PROGRAM TO DIRECTLY ACCESS THE LIBBAM LIBRARY>



Sam Library Usage Examples
http://genome.sph.umich.edu/wiki/Sam_Library_Usage_Examples

1 Usage Examples
1.1 Simple Read/Write SAM/BAM files
1.2 Read Only One Reference/Chromosome from Sorted/Indexed BAM Files
1.3 Read a Specified Region from a Sorted & Indexed BAM File
1.4 Validate SAM/BAM Files Continuing Processing After Allowed Errors
Usage Examples

This page contains examples on how to use the SAM/BAM Library.
Simple Read/Write SAM/BAM files



Read & Write BAM/SAM Library

The library is found in pipeline/bam, and is called libbam.a.
This library is dependent on two other libraries:

libcsg/libcsg.a
thirdParty/samtools/libbam.a

Be sure to include them all in the proper order:

<path to base pipeline directory>/libbam.a <path to base pipeline directory>/libcsg/libcsg.a <path to base pipeline directory>/thirdParty/samtools/libbam.a


Classes in the BAM/SAM Library

Class Name	 Description
SamFile	 Class used for reading/writing SAM/BAM files and their headers and records.
SamFileHeader	 Class used for storing the header. Allows access for getting and setting header values when both reading & writing SAM/BAM files.
SamHeaderRecord	 Class used for storing the tag/value pairs within a given header line.
SamRecord	 Class used for storing a SAM/BAM Record. Allows access for getting and setting record values when both reading & writing SAM/BAM files.
SamStatus	 Status value used by the libbam classes for returning the status of the operations.
SamValidator	 Validates a SAM/BAM Record.
SamValidationError	 Validation Error Information for a SamRecord.
SamValidationErrors	 Container for ValidationErrors.


Read Only One Reference/Chromosome from Sorted/Indexed BAM Files

This example reads in the inputFilename bam file and writes it back out section by section to the specified outputFilename, starting with section -1. It also prints a count of the number of records in each section.


#include "SamFile.h"
#include "SamValidation.h"
 
int ReadIndexedBam(const char* inputFilename,
                   const char* outputFilename,
                   const char* indexFilename)
{
   // Open the input file for reading.
   SamFile samIn;
   samIn.OpenForRead(inputFilename);
 
   // Open the bam index file for reading.
   samIn.ReadBamIndex(indexFilename);
 
   // Open the output file for writing.
   SamFile samOut;
   samOut.OpenForWrite(outputFilename);
 
   // Read the sam header.
   SamFileHeader samHeader;
   samIn.ReadHeader(samHeader);
 
   // Write the sam header.
   samOut.WriteHeader(samHeader);
 
   SamRecord samRecord;
   SamValidationErrors samInvalidErrors;
 
   // Loop through each Reference.
   for(int i = -1; i < 23; i++)
   {
      int numSectionRecords = 0;
      samIn.SetReadSection(i);

      // Keep reading records until they aren't more.
      while(samIn.ReadRecord(samHeader, samRecord))
      {
         numSectionRecords++;

         // Successfully read a record from the file, so write it.
         samOut.WriteRecord(samHeader, samRecord);
      }
 
      std::cout << "Reference ID " << i << " has " << numSectionRecords 
                << " records" << std::endl;
   }
 
   std::cout << "Number of records = " << samIn.GetCurrentRecordCount() << std::endl;
 
   return(0);
}



SET PATH TO INCLUDE FILES:

libcsg/libcsg.a
thirdParty/samtools/libbam.a

Be sure to include them all in the proper order:

Be sure to include them all in the proper order:

<path to base pipeline directory>/libbam.a <path to base pipeline directory>/libcsg/libcsg.a <path to base pipeline directory>/thirdParty/samtools/libbam.a


FILES AVAILABLE:

/nethome/apps/ccsngs/apps/samtools/0.1.8/lib/libbam.a 
<path to base pipeline directory>/libcsg/libcsg.a
<path to base pipeline directory>/thirdParty/samtools/libbam.a


LOCATIONS OF REQUIRED FILES:

libbam.a
--------
export PATH=/nethome/apps/ccsngs/apps/samtools/0.1.8/lib:$PATH


libcsg.a
--------

export PATH=/nethome/syoung/base/apps/verifybamid/0.0.5/include:$PATH



thirdParty/samtools/libbam.a
----------------------------
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/thirdParty/samtools-0.1.7a libbam.a


SamFile.h
SamValidation.h
---------------
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam


libbam.a AND libcsg.a
---------------------

/nethome/apps/ccsngs/apps/samtools/0.1.8/lib/libbam.a

#####/nethome/apps/ccsngs/apps/verifybamid/0.0.5/include/libcsg.a


thirdParty/samtools/libbam.a
----------------------------

export PATH=/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/thirdParty/samtools-0.1.7a:$PATH

export PATH=/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam:$PATH



g++ \
-g -Wall \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg \
-o coverage \
/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/String.o \
/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamHeaderRecord.o \
/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFileHeader.o \
/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.o \
coverage.cpp \



USE objdump TO DUMP AN OBJECT FROM AN OBJECT FILE:

objdump /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.o





g++ \
-g -Wall \
/nethome/apps/ccsngs/apps/samtools/0.1.8/lib/libbam.a \
coverage.cpp \
-lbam \
-lcsg \
/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/thirdParty/zlib/gzlib.o \
-o coverage \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg \
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg


    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg/libcsg.a(BgzfFileType.o): In function `BgzfFileType':
    /nethome/syoung/base/apps/verifybamid/verifyBamID-0.0.5/pipeline/libcsg/BgzfFileType.cpp:28: undefined reference to `bgzf_open'
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg/libcsg.a(BgzfFileType.o): In function `BgzfFileType::tell()':
    /nethome/syoung/base/apps/verifybamid/verifyBamID-0.0.5/pipeline/libcsg/BgzfFileType.h:118: undefined reference to `bgzf_tell'
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg/libcsg.a(BgzfFileType.o): In function `BgzfFileType':
    /nethome/syoung/base/apps/verifybamid/verifyBamID-0.0.5/pipeline/libcsg/BgzfFileType.cpp:35: undefined reference to `bgzf_check_EOF'


Join Date: Jul 2008
Location: Cambridge, UK
Posts: 82

The code for implementing bgzf is in the samtools C distribution (bgzf.c), although the API seems a bit unstable. I noticed bgzf_tell vanished in 0.1.8 but was in 0.1.7.

It's a reasonable interface though, essentially allowing some pretence at randomly seeking to notional file offsets as if the data was uncompressed. I assume the Java Picard class has a similar API to bgzf too.
  	
 09-09-2010, 09:22 AM	   #4
lh3
Senior Member
 
Join Date: Feb 2008
Location: Boston
Posts: 357

bgzf_tell becomes a macro in 0.1.8



1.4.5. File compression and random access in a compressed file
Typically, the size of a BAM file can be reduced by nearly a factor of four (to ~27%) under gzip/zlib compression. This
compression ratio is significant. To achieve smaller file size, we always compress a BAM file with the BGZF library,
developed by Bob Handsaker. BGZF is a stand-alone library that achieves similar compression ratio to gzip/zlib while
supporting random access using virtual file offsets. A file compressed with BGZF is also gzip/zlib compatible in that we
can use gzip/zlib to decompress the compressed file, although random file access is not supported in this case.
1.4.6. Ordering the alignments
An SAM/BAM file can be sorted by the reference coordinates, by query names, or unsorted. However, most operations
on the alignments only work on a BAM sorted by the leftmost reference coordinate. Such an order is crucial to data
processing on a stream and to indexing. A command-line tool is provided to sort an unsorted BAM in the required order.
1.4.7. Indexing alignments
Indexing paves the way for quick retrieval of alignments overlapping with a specified region. As BAM is supposed to work
with spliced alignments, indexing must be efficient for alignments spanning long distance on the reference genome. A
binning index as is used in the UCSC Genome Browser suits this goal better than a linear index alone. The binning index
is further improved by being coupled with a simple linear index. For short read alignments, one seek call is needed in
most cases to retrieve alignments.







g++ \
-g -Wall \
/nethome/apps/ccsngs/apps/samtools/0.1.8/lib/libbam.a \
coverage.cpp \
-o coverage \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg \
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg \
-L/nethome/apps/ccsngs/apps/samtools/0.1.8/lib/libbam.a 




g++ \
-g -Wall \
/nethome/apps/ccsngs/apps/samtools/0.1.8/lib/libbam.a \
coverage.cpp \
-o coverage \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg \
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg \

    /tmp/ccBzyh4g.o: In function `ReadIndexedBam(char const*, char const*, char const*)':
    /nethome/bioinfo/apps/agua/0.5/bin/apps/utils/coverage.cpp:12: undefined reference to `SamFile::SamFile()'
    /nethome/bioinfo/apps/agua/0.5/bin/apps/utils/coverage.cpp:13: undefined reference to `SamFile::OpenForRead(char const*)'
    /nethome/bioinfo/apps/agua/0.5/bin/apps/utils/coverage.cpp:16: undefined reference to `SamFile::ReadBamIndex(char const*)'






objdump /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.o
Usage: objdump <option(s)> <file(s)>
 Display information from object <file(s)>.
 At least one of the following switches must be given:
  -a, --archive-headers    Display archive header information
  -f, --file-headers       Display the contents of the overall file header
  -p, --private-headers    Display object format specific file header contents
  -h, --[section-]headers  Display the contents of the section headers
  -x, --all-headers        Display the contents of all headers
  -d, --disassemble        Display assembler contents of executable sections
  -D, --disassemble-all    Display assembler contents of all sections
  -S, --source             Intermix source code with disassembly
  -s, --full-contents      Display the full contents of all sections requested
  -g, --debugging          Display debug information in object file
  -e, --debugging-tags     Display debug information using ctags style
  -G, --stabs              Display (in raw form) any STABS info in the file
  -W, --dwarf              Display DWARF info in the file
  -t, --syms               Display the contents of the symbol table(s)
  -T, --dynamic-syms       Display the contents of the dynamic symbol table
  -r, --reloc              Display the relocation entries in the file
  -R, --dynamic-reloc      Display the dynamic relocation entries in the file
  @<file>                  Read options from <file>
  -v, --version            Display this program's version number
  -i, --info               List object formats and architectures supported
  -H, --help               Display this information




Expert: Ralph McArdell - 4/2/2007

Question
Hi Ralph,

I am new in the C++ world, and I have problems to solve a "undefined reference to class::method" when linking my program.

The program is very simple:

#ifndef XMLIMPT_UTILS_H
#define XMLIMPT_UTILS_H

#include <xercesc/dom/DOMNode.hpp>
#include <string.h>
XERCES_CPP_NAMESPACE_USE
class XMLIMPTutils
{
 public:
 XMLIMPTutils();
 ~XMLIMPTutils();
 XMLCh* getAttributeValue(DOMNode *node, string name);
};
#endif 

I have also defined XMLIMPTutils.cpp which I don't think I need to include.

I use this class from another class simply doing:

XMLIMPTutils utils;

utils.getAttributeValue(...);

and in this line I have the linking error... The more I look at the code the less I understand what could I be doing wrong. I google trying to find a possible cause for the error, but nothing works. If you could at least give a few hints to know what I'm doing wrong I will really appreciate it.

Thank you very much,
Marian.


Get the answer below
Sponsored Links
Analyze Embedded Code
Find and fix critical bugs with CodeSonar. Free evaluation.
www.GrammaTech.com
Need a Good IT Recruiter?
Hiring? Have our Tech Recruiter Fill Your Job Quickly - Guaranteed!
www.CyberCoders.com
C++ Programming Help
C++ Programming 3rd Edition Solutions. View Free!
Cramster.com/Malik

Answer
Without knowing exactly what you are doing - what files you are compiling, which you are linking I cannot say for sure what you are doing wrong. However I strongly suspect that you have misunderstood how the C++ code sharing and "module" system works as it is different from that employed by other currently popular languages such as Java or .NET/C#.

In C and C++ building an executable is performed in two stages: First code is compiled to object code files (note that object here is a different use to object oriented programming), next these object code files are linked together to form an executable. 

In addition you can have collections of object code placed together into files called libraries. In fact these are called static libraries as the code they contain are statically linked into each executable that uses them. This is in contract to dynamic libraries in which the code is not linked into each executable that uses them, but is mapped into the process space of each application that uses them at runtime. Such dynamic link libraries (called shared object libraries on some systems) are themselves a variation of an executable and need to be linked. Libraries are a useful mechanism for sharing code without having to distribute the source and require everyone to recompile it all before using it.

You are using the #include directive to share code at the source code level. The C/C++ #include directive however does _not_ work like a using or import statement in languages like C# or Java. It is merely a textual inclusion mechanism. 

Before a C or C++ compilation proper starts a phase called pre-processing is performed. The pre-processor produces the content that the compiler actually compiles. The pre-processing is controlled by placing pre-processor directives in the code. These are lines in which the first non-whitespace character is a # (hash) symbol. You have used at least four such pre-processing directives in your code:

   #ifdef
   #define
   #endif
   #include

These all work at a textual level. 

[you can skip the next two paragraphs on #ifdef..#endif and #define if you wish, they are an aside to your problem, and I include them only for background and completeness with the list of directives I show above.]

#ifdef..#endif are conditional compilation directives. The text between these two directives is only emitted (i.e. further pre-processed and passed to the compiler proper) if the pre-processor macro name after #ifdef is defined.

#define is used to define pre-processor macros. Anywhere in the text of the file(s) the pre-processor finds the name of a defined macro it substitutes the textual definition of the macro. Note that macros can also have parameters in which case the pre-processor will perform parameter substitution on the macro text. The compiler sees the text _after_ macro expansion. Macros are useful, but have two major drawbacks: First, because by the time compiler sees the code the pre-processor has replaced the macro names with the expanded macro text compilation errors due to macros cannot include the name of the macro. Second, the pre-processor has no idea of C or C++ syntax; when it expands a macro it will do so whatever the context without regard to scope or namespace. This can cause problems if macros use simple names that look like variables or class names or function names or class member names as it is very likely that such a name will be used without knowingly clashing with a macro name. If this happens the result is that such a name is replaced by the macro text during pre-processing, which then leads to some rather unexpected and often odd and baffling compiler errors. Your use here though is just for controlling the inclusion of the body of your header file and is in fact a standard form in C and C++. You have also followed the guideline of using long, all uppercase names for macros to help reduce name clashes to a minimum.

#include causes the pre-processor to replace the line on which the #include directive appears with the whole contents of the specified file. It then continues pre-processing at the start of the included file contents. Such a file can contain anything, and can be called anything.

Hence the code the compiler sees is the fully pre-processed text from the file being compiled and all the included files.

Most importantly #include does _not_ mean that you are using or importing any compiled implementation of the entities defined in the header file. Including file.h does not imply that a compiled version of file.cpp is to be linked with to form an executable. For a start extensions are not fixed, C++ header files commonly use .h, .H, .hpp, .hxx. C++ implementation files commonly use .cpp, .C, .cxx. C implementation files commonly use a .c suffix. There is no rule that states that if something is declared in file.h it will be defined in file.cpp (or other extension). The definition could be in someotherfile.cpp.

Assuming your program consists of the following files (or similar):

XMLIMPTutils.hpp
XMLIMPTutils.cpp
main.cpp

The two .cpp files I expect to both include XMLIMPTutils.hpp. This means they both have access to the definition of class XMLIMPTutils. 

XMLIMPTutils.hpp defines the XMLIMPTutils class.

XMLIMPTutils.cpp defines the member functions of the XMLIMPTutils class.

main.cpp defines main, the program entry point and uses the XMLIMPTutils class.

I then expect you have compiled main.cpp, producing main.o or main.obj (the compiled object file).

Maybe you have also compiled XMLIMPTutils.cpp to produce XMLIMPTutils.o or XMLIMPTutils.obj, but I'll guess that you have not. So you also need to explicitly compile XMLIMPTutils.cpp.

You then have to link against _both_ main.o and XMLIMPTutils.o (or main.obj and XMLIMPTutils.obj) plus any additional libraries required (such as whatever library or libraries support the facilities of the Xerces XML parser you are using). 

The exact syntax and names of object files and libraries depend on the compiler and linker you are using, usually tied to the platform you are using. Particularly MS Windows differs from Linux/UN*X.

Why is this? Well when you call XMLIMPTutils::getAttributeValue from your program all the compiler has to work with is the declaration of the member function in the class definition from the inclusion of the XMLIMPTutils.hpp header file. The compiler checks the call is consistent with the declaration and leaves a record in the object file indicating that it needs the address of the definition of this function to be provided by the linker. That is it is expected that the definition of the function is provided in some object code file (or library) and the address of this definition filled in by the linker.

If you do not give the linker the XMLIMPTutils.o or XMLIMPTutils.obj object file to link against then it finds the main.o (or main.obj) file has a reference to a function that needs to be resolved, i.e. that needs to have the address filled in, but it has not been told to link any file that contains the definition of such an externally visible function (all defined functions in C and C++ are externally visible to the linker unless specified otherwise).

Hope this helps and sorry if I missed the problem and you already know some of







-lstdc++

-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam \
-L/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg \

-lbam
    
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/libbam.a(SamFileHeader.o): In function `SamFileHeader::GetReferenceLabel(int)':
    SamFileHeader.cpp:(.text+0x139): undefined reference to `String::String(char const*)'
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/libbam.a(SamFileHeader.o): In function `SamFileHeader::GetReferenceID(String const&)':
    SamFileHeader.cpp:(.text+0x257): undefined reference to `String::Compare(char const*) const'
    SamFileHeader.cpp:(.text+0x28c): undefined reference to `StringIntHash::Find(String const&) const'
    SamFileHeader.cpp:(.text+0x2ac): undefined reference to `StringArray::Add(String const&)'
    SamFileHeader.cpp:(.text+0x2b7): undefined reference to `IntArray::Append(int)'
    SamFileHeader.cpp:(.text+0x2c5): undefined reference to `StringIntHash::Add(String const&, int)'
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/libbam.a(SamFileHeader.o): In function `SamFileHeader::getPG(char const*)':
    SamFileHeader.cpp:(.text+0x5c5): undefined reference to `String::String(char const*)'






USING -c OPTION
 -c  Compile or assemble the source files, but do not link.  The linking stage simply is not done.  The ulti-
           mate output is in the form of an object file for each source file.

           By default, the object file name for a source file is made by replacing the suffix .c, .i, .s, etc., with
           .o.

           Unrecognized input files, not requiring compilation or assembly, are ignored.

g++ -c coverage.cpp -g -Wall -o coverage -I /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam -I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg

[syoung@u04 utils]$ ./coverage 
-bash: ./coverage: cannot execute binary file




PROBLEM

g++ coverage.c  -I /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam -I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg

    /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crt1.o: In function `_start':
    (.text+0x20): undefined reference to `main'

SOLUTION

ADD A MAIN FUNCTION:

int main(int argc, char *argv[]) {}





PROBLEM:

g++ coverage.c  -I /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam -l InputFile -I/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg
/usr/bin/ld: cannot find -lSamStatus
collect2: ld returned 1 exit status

SOLUTION

DISCARD -l InputFile




g++ coverage.c  -l SamStatus -I /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam -l iostream 

SOLUTION: 

/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg
    #include "InputFile.h"


/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam


    #include "SamStatus.h"
    #include "SamFileHeader.h"
    #include "SamRecord.h"
    #include "GenericSamInterface.h"
    #include "BamIndex.h"
    #include "SamStatistics.h"


    In file included from coverage.c:1:

    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.h:22:23: error: InputFile.h: No such file or directory

    In file included from /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.h:23,
                     from coverage.c:1:
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFileHeader.h:24:22: error: IntArray.h: No such file or directory
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFileHeader.h:25:25: error: StringArray.h: No such file or directory
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFileHeader.h:26:24: error: StringHash.h: No such file or directory
    In file included from /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.h:24,
                     from coverage.c:1:
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamRecord.h:24:22: error: LongHash.h: No such file or directory
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamRecord.h:25:24: error: MathVector.h: No such file or directory
    ...
    

SOLUTION

ADD -I OPTION WITH PATH TO InputFile.h, IntArray.h, StringArray.h, StringHash.h, LongHash.h AND MathVector.h:

-I /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/libcsg
    #include "InputFile.h"


/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam


    #include "SamStatus.h"
    #include "SamFileHeader.h"
    #include "SamRecord.h"
    #include "GenericSamInterface.h"
    #include "BamIndex.h"
    #include "SamStatistics.h"






FINDING SamStatus.h BUT NOT ITS INCLUDED iostream.h AT LINE 21:

emacs /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamStatus.h

    #include <iostream>


WITH THIS COMMAND:

gcc coverage.c  -l SamStatus -I /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam -l iostream



In file included from /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.h:21,
                 from coverage.c:1:
/nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamStatus.h:21:20: error: iostream: No such file or directory


SOLUTION:

USE

g++ coverage.c  -l SamStatus -I /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam -l iostream

    In file included from coverage.c:1:
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.h:22:23: error: InputFile.h: No such file or directory
    In file included from /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFile.h:23,
                     from coverage.c:1:
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFileHeader.h:24:22: error: IntArray.h: No such file or directory
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFileHeader.h:25:25: error: StringArray.h: No such file or directory
    /nethome/syoung/base/apps/verifybamid/0.0.5/pipeline/bam/SamFileHeader.h:26:24: error: StringHash.h: No such file or directory
    ...


iostream is a C++ header, so you need to use g++ to compile it. Using <iosteam.h> is depreciated. Use <iostream> instead and
either explicitly precede the commands with the namespace or use the line "using namespace std;".

Another option is to not include iostream.h. The stdio.h header includes the printf function.

Just an FYI: The standard C functions have there own manpages (may need to install a document package) so you can enter "man 3 printf" or example. The function definition will include which header needs to be included.




gcc coverage.c 

    coverage.c:1:21: error: SamFile.h: No such file or directory
    coverage.c:2:27: error: SamValidation.h: No such file or directory




DOWNLOAD VerifyBamID TO GET SAMTOOLS AND libcsg HEADER FILES:

mkdir -p /nethome/syoung/base/apps/verifybamid
cd /nethome/syoung/base/apps/verifybamid

wget http://www.sph.umich.edu/csg/kang/verifyBamID/download/verifyBamID-0.0.5.tar.gz



</entry>



<entry [Wed Oct 20 12:56:25 EDT 2010] GENERATE COVERAGE USING GATK>




TEST DEPTH OF COVERAGE

http://www.broadinstitute.org/gsa/wiki/index.php/Depth_of_Coverage_v3.0


INPUT FILE:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.bam

-rw-r--r-- 1 syoung root  56M Oct 19 18:08 hit.bam


/usr/local/java/bin/java \
-jar /nethome/syoung/base/apps/gatk/1.0.4418/GenomeAnalysisTK.jar \
-T DepthOfCoverage \
-I /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam \
-R /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chr22.fa \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.coverage

    
    INFO  00:16:20,655 HelpFormatter - --------------------------------------------------------------------------- 
    INFO  00:16:20,658 HelpFormatter - The Genome Analysis Toolkit (GATK) v1.0.4418, Compiled 2010/10/03 21:55:47 
    INFO  00:16:20,658 HelpFormatter - Copyright (c) 2010 The Broad Institute 
    INFO  00:16:20,659 HelpFormatter - Please view our documentation at http://www.broadinstitute.org/gsa/wiki 
    INFO  00:16:20,659 HelpFormatter - For support, please view our support site at http://getsatisfaction.com/gsa 
    INFO  00:16:20,659 HelpFormatter - Program Args: -T DepthOfCoverage -I /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam -R /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chr22.fa -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.coverage  
    INFO  00:16:20,660 HelpFormatter - Date/Time: 2010/10/21 00:16:20 
    INFO  00:16:20,660 HelpFormatter - --------------------------------------------------------------------------- 
    INFO  00:16:20,660 HelpFormatter - --------------------------------------------------------------------------- 
    INFO  00:16:20,677 AbstractGenomeAnalysisEngine - Strictness is SILENT 
    INFO  00:16:21,833 TraversalEngine - [PROGRESS] Traversed to chr22:1, processing 1 sites in 0.71 secs (711000.00 secs per 1M sites) 
    INFO  00:16:51,830 TraversalEngine - [PROGRESS] Traversed to chr22:685387, processing 685,387 sites in 30.71 secs (44.81 secs per 1M sites) 
    INFO  00:17:05,315 TraversalEngine - [PROGRESS] Traversed to chr22:1000000, processing 1,000,000 sites in 44.20 secs (44.20 secs per 1M sites) 
    INFO  00:17:35,316 TraversalEngine - [PROGRESS] Traversed to chr22:1696145, processing 1,696,145 sites in 74.20 secs (43.75 secs per 1M sites) 
    INFO  00:17:47,925 TraversalEngine - [PROGRESS] Traversed to chr22:2000000, processing 2,000,000 sites in 86.81 secs (43.40 secs per 1M sites) 
    INFO  00:18:17,926 TraversalEngine - [PROGRESS] Traversed to chr22:2712643, processing 2,712,643 sites in 116.81 secs (43.06 secs per 1M sites) 
    INFO  00:18:29,915 TraversalEngine - [PROGRESS] Traversed to chr22:3000000, processing 3,000,000 sites in 128.80 secs (42.93 secs per 1M sites)
    ...
    
        
    
    ##### ERROR MESSAGE:
    SAM/BAM file SAMFileReader{/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam} is malformed:
    Read SRR002283.6606116:3:42:881:433#0 lacks read group information;
    Please associate all reads with read groups
    
    
SEARCHED IN CODE FOR OFFENDING SUBROUTINE, IN utils/sam/GATKSAMRecord.java:104


emacs /nethome/syoung/base/apps/gatk/archive/1.10.4418/Sting/java/src/org/broadinstitute/sting/utils/sam/GATKSAMRecord.java

    public SAMReadGroupRecord getReadGroup() {
        if ( !retrievedReadGroup ) {
            SAMReadGroupRecord tempReadGroup = mRecord.getReadGroup();
            mReadGroup = (tempReadGroup == null ? tempReadGroup : new GATKSAMReadGroupRecord(tempReadGroup));
            retrievedReadGroup = true;
        }
        return mReadGroup;
    }


BEING CALLED FROM

emacs /nethome/syoung/base/apps/gatk/archive/1.10.4418/Sting/java/src/org/broadinstitute/sting/gatk/walkers/coverage/CoverageUtils.java

    private static SAMReadGroupRecord getReadGroup(SAMRecord r) {
        SAMReadGroupRecord rg = r.getReadGroup();
        if ( rg == null ) {
            String msg = "Read "+r.getReadName()+" lacks read group information; Please associate all reads with read groups";
            throw new UserException.MalformedBam(r, msg);
        }

        return rg;
    }



WHERE mRecord IS "the underlying SAMRecord which we are wrapping"

    private final SAMRecord mRecord;


WHICH IS DEFINED AT TOP OF

emacs /nethome/syoung/base/apps/gatk/archive/1.10.4418/Sting/java/src/org/broadinstitute/sting/gatk/walkers/coverage/CoverageUtils.java


    import org.broadinstitute.sting.utils.exceptions.UserException;
    
    /**                                                                                                                                                                                    
     * @author ebanks                                                                                                                                                                      
     * GATKSAMRecord                                                                                                                                                                       
     *                                                                                                                                                                                     
     * this class extends the samtools SAMRecord class and caches important                                                                                                                
     * (and oft-accessed) data that's not already cached by the SAMRecord class                                                                                                            
     *                                                                                                                                                                                     
     * IMPORTANT NOTE: Because ReadGroups are not set through the SAMRecord,                                                                                                               
     *   if they are ever modified externally then one must also invoke the                                                                                                                
     *   setReadGroup() method here to ensure that the cache is kept up-to-date.                                                                                                           
     *                                                                                                                                                                                     
     * 13 Oct 2010 - mhanna - this class is fundamentally flawed: it uses a decorator                                                                                                      
     *                        pattern to wrap a heavyweight object, which can lead                                                                                                         
     *                        to heinous side effects if the wrapping is not carefully                                                                                                     
     *                        done.  Hopefully SAMRecord will become an interface and                                                                                                      
     *                        this will eventually be fixed.                                                                                                                               
     */
    public class GATKSAMRecord extends SAMRecord {
    
        // the underlying SAMRecord which we are wrapping                                                                                                                                  
        private final SAMRecord mRecord;



SO THE SAMRecord REFERRED TO ABOVE IS FROM SAMTOOLS...


emacs /nethome/syoung/base/apps/gatk/archive/1.10.4418/Sting/java/src/org/broadinstitute/sting/utils

/nethome/syoung/base/apps/gatk/archive/1.10.4418/Sting/scala/src/org/broadinstitute/sting/queue/extensions/samtools





    
PRINT BAM TO SAM
    
$samtools/samtools view \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.bam



SEARCH SAM FILE FOR OFFENDING READ:

grep -n "SRR002283.6606116:3:42:881:433#0" /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam

    445160:SRR002283.6606116:3:42:881:433#0 99      chr22   16050137        255     36M     =       16050314        213     TCACCTTTAAAAGTTTATTGATCTTTTGTGACATGC    IIIIIIIIIBIII7II<GBDGIIII53=3+2@?1.;   XA:i:0  MD:Z:36 NM:i:0
    445161:SRR002283.6606116:3:42:881:433#0 147     chr22   16050314        255     36M     =       16050137        -213    ACCAGCTAAAATACAGCTATCATTCATTTTCCTTGA    %%)*6..24029094I/6@5II=/II&I>IIIHIII   XA:i:0  MD:Z:36 NM:i:0
    

grep "SRR002283.6606116:3:42:881:433#0" /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam
    
    SRR002283.6606116:3:42:881:433#0        99      chr22   16050137        255     36M     =       16050314        213     TCACCTTTAAAAGTTTATTGATCTTTTGTGACATGC    IIIIIIIIIBIII7II<GBDGIIII53=3+2@?1.;   XA:i:0  MD:Z:36 NM:i:0
    SRR002283.6606116:3:42:881:433#0        147     chr22   16050314        255     36M     =       16050137        -213    ACCAGCTAAAATACAGCTATCATTCATTTTCCTTGA    %%)*6..24029094I/6@5II=/II&I>IIIHIII   XA:i:0  MD:Z:36 NM:i:0


WHICH LOOKS THE SAME AS READS IN THE TOP OF THE FILE:

head /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam

    SRR002271.923:1:1:772:358#0     99      chr22   39613521        255     36M     =       39613697        212     GCAAAGCTGGAGGCATCATGCTACCTGACTTCAAAC    IIIIIIIIIIIIIIIIIIIIIIIIIICIIIII7=I.   XA:i:1  MD:Z:0A35       NM:i:1
    SRR002271.923:1:1:772:358#0     147     chr22   39613697        255     36M     =       39613521        -212    AAGAAACGGGGAAAGGATTCCCTATTTAATAAATGG    II>IIIIBIGIIIIIIIIIIIIIIIIIIIIIIIIII   XA:i:1  MD:Z:6A4G24 



EXTRACT ACTUAL LINES

getlines.pl -f /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam -n 445156 -l 4

    SRR002283.6605935:3:42:936:777#0        99      chr22   27880630        255     36M     =       27880799        205     TTTTTGAGACGGAGTCTCACTGTGTTGCCCAGGCTG    IIIIIIIIIIIIIII9I9I,>..@97)*')(%(%*'   XA:i:1  MD:Z:21C14      NM:i:1
    SRR002283.6605935:3:42:936:777#0        147     chr22   27880799        255     36M     =       27880630        -205    TAGTAGAGATGGGTTTTCACCATGTTAGCCAGGATG    )0&+++4,5%+1+=6=6@5I9=I:IIIIIIIIIIII   XA:i:2  MD:Z:9C3G22     NM:i:2
    SRR002283.6606116:3:42:881:433#0        99      chr22   16050137        255     36M     =       16050314        213     TCACCTTTAAAAGTTTATTGATCTTTTGTGACATGC    IIIIIIIIIBIII7II<GBDGIIII53=3+2@?1.;   XA:i:0  MD:Z:36 NM:i:0
    SRR002283.6606116:3:42:881:433#0        147     chr22   16050314        255     36M     =       16050137        -213    ACCAGCTAAAATACAGCTATCATTCATTTTCCTTGA    %%)*6..24029094I/6@5II=/II&I>IIIHIII   XA:i:0  MD:Z:36 NM:i:0





NOTES
-----


GATK DEPTH OF COVERAGE USAGE
----------------------------


DEFAULT BINS:  [1,2,3,...,500]

Depth of Coverage v3.0
http://www.broadinstitute.org/gsa/wiki/index.php/Depth_of_Coverage_v3.0

Contents [hide]

1 Depth of Coverage v3.0
2 Standard GATK Arguments
3 DepthOfCoverage Specific Arguments
3.1 Default Mapping and Base Quality Settings
3.2 Coverage by Gene

Depth of Coverage v3.0

Version 3.0 of Depth of Coverage is a coverage profiler for a (possibly multi-sample) bam file. It uses a granular histogram that can be user-specified to present useful aggregate coverage data. It reports the following metrics over the entire .bam file:
Total, mean, median, and quartiles for each partition type: aggregate
Total, mean, median, and quartiles for each partition type: for each interval
A series of histograms of the number of bases covered to Y depth for each partition type (granular; e.g. Y can be a range, like 16 to 22)
A matrix of counts of the number of intervals for which at least Y samples and/or read groups had a median coverage of at least X
A matrix of counts of the number of bases that were covered to at least X depth, in at least Y groups (e.g. # of loci with ?15x coverage for ?12 samples)
A matrix of proportions of the number of bases that were covered to at least X depth, in at least Y groups (e.g. proportion of loci with ?18x coverage for ?15 libraries)
Because the common question "What proportion of my targeted bases are well-powered to discover SNPs?" is answered by the last matrix on the above list, it is strongly recommended that this walker be run on all samples simultaneously.

For humans, Depth of Coverage can also be configured to output these statistics aggregated over genes, by providing it with a RefSeq ROD.

Depth of Coverage also outputs, by default, the total coverage at every locus, and the coverage per sample and/or read group. This behavior can optionally be turned off, or switched to base count mode, where base counts will be output at each locus, rather than total depth.
Standard GATK Arguments

DepthOfCoverage requires:

-T DepthOfCoverage
-R /path/to/your/reference.fasta
-I /path/to/your/bam_file.bam
-o /path/to/your/output_file

and will optionally take the standard

-L chr#:#-#

or

-L /path/to/your/intervals.interval_list

interval arguments.



DepthOfCoverage Specific Arguments

DepthOfCoverage can be passed the following arguments:
--minMappingQuality x   [-mmq x]                   // ignores reads with mapping quality below x (not counted in coverage or base counts)
--minBaseQuality x   [-mbq x]                      // ignores bases with base quality below x (not counted in coverage or base counts)
--printBaseCounts  [-baseCounts]                   // switches CoverageStatistics to base count mode (rather than coverage) for per-every-locus output
--omitLocusTable   [-omitLocusTable]               // does not print out the table of locus counts for X samples covered to at least Y depth
--omitIntervals    [-omitIntervals]                // does not output any of the per-interval statistics; only the aggregate
--omitDepthOutputAtEachBase   [-omitBaseOutput]    // does not output depth of coverage at every base; results in big speedup
--omitSampleSummary  [-omitSampleSummary]          // does not output the sample summary table
--includeDeletions   [-dels]                       // indels will be included in coverage and base counts
--ignoreDeletionSites                              // sites consisting only of deletions will be entirely ignored (no coverage)
--outputFormat                                     // alters the output format of the output tables. can be rtable, table, or csv. Defaults to r-readable table (rtable)
--partitionType [-pt]                              // selects partitions by which to calculate coverages. Can be any combination of { sample, readgroup, library }. For example: "-pt sample -pt readgroup"
--summaryCoverageThreshold [-ct]                   // summary files will include a %_bases_covered_to_[VALUE] column. Can be given multiple times ("-ct 10 -ct 20")


Special care is to be taken with the following arguments that alter granular binning behavior:

--start x
--stop y
--nbins z


These arguments when specified override the default binning of [1,2,3,...,500], and instead use z bins, logarithmically spaced between x and y. Note that these variables have a default, so setting just one of them is likely to cause an error. The defaults for these values are x=1,y=500,z=499; so all coverage below 500 gets its own count.

--printBinEndpointsAndExit

This will print the array of left-endpoints for the granular bins. Use this in conjunction with --start, --stop, and --nbins to get the spacing that you like.

Default Mapping and Base Quality Settings

Depth of Coverage v3.0 no longer uses default read mapping or base quality cutoffs to exclude reads or bases. It is strongly suggested that you use the -mmq [--minMappingQuality] and -mbq [--minBaseQuality] flags to adjust these settings for your data.

Coverage by Gene

To get a summary of coverage by each gene, you may supply a refseq (or alternative) gene list via the argument

-geneList /path/to/gene/list.txt

The provided gene list must be of the following format:
585     NM_001005484    chr1    +       58953   59871   58953   59871   1       58953,  59871,  0       OR4F5   cmpl    cmpl    0,
587     NM_001005224    chr1    +       357521  358460  357521  358460  1       357521, 358460, 0       OR4F3   cmpl    cmpl    0,
587     NM_001005277    chr1    +       357521  358460  357521  358460  1       357521, 358460, 0       OR4F16  cmpl    cmpl    0,
587     NM_001005221    chr1    +       357521  358460  357521  358460  1       357521, 358460, 0       OR4F29  cmpl    cmpl    0,
589     NM_001005224    chr1    -       610958  611897  610958  611897  1       610958, 611897, 0       OR4F3   cmpl    cmpl    0,
589     NM_001005277    chr1    -       610958  611897  610958  611897  1       610958, 611897, 0       OR4F16  cmpl    cmpl    0,
589     NM_001005221    chr1    -       610958  611897  610958  611897  1       610958, 611897, 0       OR4F29  cmpl    cmpl    0,

If you are on the broad network, the properly-formatted file containing refseq genes and transcripts is located at

/humgen/gsa-hpprojects/GATK/data/refGene.sorted.txt

If you supply the -geneList argument, DepthOfCoverage v3.0 will output an additional summary file that looks as follows:

Gene_Name     Total_Cvg       Avg_Cvg       Sample_1_Total_Cvg    Sample_1_Avg_Cvg    Sample_1_Cvg_Q3       Sample_1_Cvg_Median      Sample_1_Cvg_Q1
SORT1    594710  238.27  594710  238.27  165     245     330
NOTCH2  3011542 357.84  3011542 357.84  222     399     >500
LMNA    563183  186.73  563183  186.73  116     187     262
NOS1AP  513031  203.50  513031  203.50  91      191     290
Note that the gene coverage will be aggregated only over samples (not read groups, libraries, or other types). Because by-gene aggregation looks for intervals that overlap genes, -geneList is ignored if -omitIntervals is thrown.
Category: GATK commands




COVERAGE USING SAMTOOLS
-----------------------


http://www.mail-archive.com/genome@lists.soe.ucsc.edu/msg03541.html

Hi Daniel,

Thank you for the suggestion -- it is on our radar as a feature enhancement.  I 
can't predict when it will be done unfortunately, and in the meantime, samtools 
pileup to wiggle (possibly piped to bedGraphToBigWig) is the only way to get a 
proper coverage graph from BAM.  

In case it helps, here is a little perl that does the translation to fixedStep, 
a more compact format than bedGraph when long runs of consecutive bases are 
covered:

        samtools pileup $bamFile \
        | perl -pe '($c, $start, undef, $depth) = split; \
                    if ($c ne $lastC || $start != $lastStart+1) { \
                      print "fixedStep chrom=chr$c start=$start step=1 
span=1\n"; \
                    } \
                    $_ = "$depth\n"; \
                    ($lastC, $lastStart) = ($c, $start);' \
          > $wigFile


Or, instead of "> $wigFile", pipe: "| wigToBigWig stdin hg18.sizes 
$bigWigFile".  Like BAM, bigWig is a binary indexed format so only the 
displayed portions of the file are fetched.  If you are loading these as custom 
tracks, here is doc on wig and bigWig:

http://genome.ucsc.edu/goldenPath/help/wiggle.html
http://genome.ucsc.edu/goldenPath/help/bigWig.html

hg18.sizes can be fetched using fetchChromSizes as described in the second 
link.  If you are loading local database tracks, use the hgLoadWiggle program 
for fixedStep wiggle, or hgBbiDbLink for bigWig.

Hope that helps, and sorry we don't have an easier answer at this point.  
Please contact the list again if you have any more questions.  

Angie



</entry>



<entry [Wed Oct 20 12:56:25 EDT 2010] GENERATE COVERAGE USING Ace2 BAM UTILITY>



INPUT FILE:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.bam

-rw-r--r-- 1 syoung root  56M Oct 19 18:08 hit.bam

SORT BAMFILE:

TO AVOID THIS ERROR:
[bam_index_core] the alignment is not sorted (SRR002271.1398:1:1:532:128#0): 39613696 > 16441193 in 1-th chr

/nethome/apps/ccsngs/apps/samtools/0.1.8/samtools sort \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.bam \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted




CREATE INDEX:

/nethome/apps/ccsngs/apps/samtools/0.1.8/samtools index \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.bam




1. INSTALL Ace2 AND OTHER UCSC BAM UTILITIES IN av.jar FILE

[
    SEE Notes-apps-ace2.txt
    Wed Oct 20 18:39:52 EDT 2010
    INSTALL AND TEST Ace2 
]

INSTALLED HERE:

/nethome/syoung/base/apps/ace2/101020/av.jar



2. INSTALL PICARD

[
    SEE Notes-apps-picard.txt
    Wed Oct 20 16:45:04 EDT 2010
    INSTALL PICARD
]

sam-*.jar IS INSTALLED HERE:

/nethome/syoung/base/apps/picard/1.33/sam-1.33.jar



3. RUN Ace2

BAM utilities documentation
https://cgwb.nci.nih.gov/goldenPath/bamview/documentation/bam_utils.html#cov


export CLASSPATH=/nethome/syoung/base/apps/ace2/101020/av.jar:/nethome/syoung/base/apps/picard/1.33/sam-1.33.jar



/usr/local/java/bin/java Ace2.SAMCoverage -bam /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sorted.bam -tname chr22 -tstart 1 -tend 2000000

    ...
    10529,0
    10530,0
    10531,0
    10532,0
    10533,0
    10534,0
    10535,06,0
    ...
    
    

 java Ace2.SAMCoverage -bam [INPUT BAMFILE] -tname CHR -tstart START -tend END [-of [OUTPUT FILENAME]]
 
 


NOTES
-----


https://cgwb.nci.nih.gov/goldenPath/bamview/documentation/bam_utils.html#cov
Generating text-format coverage files

Example invocation:

    java Ace2.SAMCoverage -bam [INPUT BAMFILE] -tname CHR -tstart START -tend END [-of [OUTPUT FILENAME]]

Produces text-format report of genome coverage in a .bam file. Only data for genome-aligned regions having a base quality of 15 or higher are included. "-tname" specifies chromosome (in format chrX, i.e. "chr1"), -tstart and -tend specify nucleotide numbers.
Generating binary-format coverage files

Example invocation:
    java Ace2.SAMFinneyCoverage -bam [INPUT BAMFILE] [-of [OUTPUT FILENAME]]
Creates binary-format genome coverage files. Each nucleotide in the genome is assigned one short value (i.e. 2 bytes) showing the number of reads covering that position. Only data for genome-aligned regions having a base quality of 15 or higher are included. Output filename by default is input file plus ".coverage" (this may be overridden with the "-of" parameter).
Troubleshooting / error messages

Some Java crash messages and what they may mean:
"Exception in thread "main" java.lang.UnsupportedClassVersionError: Bad version number in .class file": you are probably using a version of Java earlier than Java 6 (1.6 or higher). See installation.
"OutOfMemoryError": the program probably needs to be allocated more memory when it starts. See memory requirements and invocation.
"Could not create the Java virtual machine", and the program doesn't start: it's possible you are trying to start the program with more memory than is available for use on your system. Try starting the program with less memory, see memory requirements and invocation.





PROBLEM

GET THIS ERROR:
Could not find the main class: Ace2.SAMCoverage.  Program will exit.

FULL ERROR:
Exception in thread "main" java.lang.NoClassDefFoundError: net/sf/samtools/util/CloseableIterator
Caused by: java.lang.ClassNotFoundException: net.sf.samtools.util.CloseableIterator
        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
Could not find the main class: Ace2.SAMCoverage.  Program will exit.


DIAGNOSIS

HAVE TO SET 'CLASSPATH' ENVIRONMENT VARIABLE WITH FULL PATH OF *.jar FILES


SOLUTION

USE THIS:

export CLASSPATH=/nethome/syoung/base/apps/ace2/101020/av.jar:/nethome/syoung/base/apps/picard/1.33/sam-1.33.jar




</entry>



<entry [Wed Oct 20 12:55:25 EDT 2010] RERAN NOVOALIGN WITH FILE 1>



mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/1

screen -S novoalign-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/1 \
--distance 2000 \
--deviation 300 \
--species human \
--label novoalign-autochr22-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/1/novoalign.out 


    
    NOVOALIGN.pl    Run time: 04:28:01
    NOVOALIGN.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl
    NOVOALIGN.pl    5:24PM, 20 October 2010
    NOVOALIGN.pl    ****************************************





</entry>



<entry [Wed Oct 20 12:51:10 EDT 2010] BREAKDANCER FOR STRUCTURAL REARRANGEMENTS>



BreakDancer
WashU SV detection algorithm for paired-end data. 
http://genome.wustl.edu/tools/cancer-genomics#variant-detection-tools

Ken Chen et al. BreakDancer: an algorithm for high-resolution mapping of genomic structural variation. Nature Methods. 2009 Sep. Epub 2009 Aug 9.
http://breakdancer.sourceforge.net/


</entry>



<entry [Wed Oct 20 12:51:10 EDT 2010] CASAVA 1.7 POSSIBLE FIX WITH lgsmake-gap>




http://www.politigenomics.com/2008/03/illumina-genome-analyzer-pipeline-and.html

Illumina Genome Analyzer Pipeline and LSF

March 7th, 2008

Many centers who use Platform LSF to manage their computational cluster have had trouble running the Illumina (Solexa) Genome Analyzer Pipeline (GAPipeline). The GAPipeline is the series of programs, scripts, and shell commands that performs the primary analysis (image analysis and base calling) and alignment for the Illumina Genome Analyzer. The GAPipeline is tied together using fairly complex Makefiles. The GAPipeline is very modular, i.e., it uses a lot of short-running scripts and programs to process the information from each image (tile) in parallel. Unfortunately, the processes are so short and there are potentially so many of them, that they overwhelm the back-end messaging system that LSFs parallel make utility, lsmake, uses. Eventually, you end up with two processes each waiting for a message from the other and the whole thing eventually just hangs. So you end up having to kill the processes and restart the pipeline. Fortunately, the fact that GAPipeline is based on make allows you to restart from where you left off, but it is more than just annoying if you have to do this several times for each execution of the pipeline and you have a dozen or so runs being analyzed at any given time. This eventually became such a problem that we wrote a little script that manually parallelizes the GAPipeline on LSF, lsgmake-gap. I would highly recommend using it if you have an Illumina Genome Analyzer and run LSF.


</entry>



<entry [Wed Oct 20 10:26:43 EDT 2010] FIXED NOVOALIGN.pl USAGE OUTPUT>



FIXED BY SETTING sleep TO 10 WITH 20 TRIES IN Cluster::parseUsagefile

ON PEGASUS

QUEUE_NAME      PRIO STATUS          MAX JL/U JL/P JL/H NJOBS  PEND   RUN  SUSP 
debug           200  Open:Active       -    -    -    -     0     0     0     0
small           100  Open:Active       -    -    -    -   287     0   287     0
medium           90  Open:Active       -    -    -    -    13     0    13     0
large            80  Open:Active       -    -    -    -   251     0   251     0
xlarge           70  Open:Active       -    -    -    -     0     0     0     0
longrun          60  Open:Active       -    -    -    -     1     0     1     0
ngs              60  Open:Active       -    -    -    -     0     0     0     0
amd              60  Open:Active       -    -    -    -  2648  1589  1032     0
eris             60  Open:Active       -    -    -    -    20     0    20     0
hermes           60  Open:Active       -    -    -    -    72     0    72     0
atlas            60  Open:Active       -    -    -    -     0     0     0     0



1. INPUT FILES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader
ll *MICRO*

    -rw-rw-r-- 1 syoung root 2.9K Sep 27 01:22 srx001539-1.MICRO.reads_1.sequence.txt
    -rw-rw-r-- 1 syoung root 2.9K Sep 27 01:22 srx001539-1.MICRO.reads_2.sequence.txt


/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_1.sequence.txt
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_2.sequence.txt


2. CREATE DIRECTORIES

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro


3. RUN

#screen -S novoalign-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro \
--distance 2000 \
--deviation 300 \
--species human \
--label novoalign-autochr22 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro/novoalign-micro-autochr22.out 



WHICH RUNS:

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro/chr22/1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/chr22/micro/1

time /nethome/syoung/base/apps/novoalign/2.05.33/novoalign \
-o SAM \
-i 2000 300 \
-d /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign/chr22/chr22.idx \
-f /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro/1/novoalign-autochr22_1.1.txt /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro/1/novoalign-autochr22_2.1.txt  > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro/chr22/1/out.sam


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/micro/chr22






</entry>



<entry [Tue Oct 19 15:55:49 EDT 2010] RUN cumulativeSNP.pl ON BOWTIE hit.sam FILES>




BOWTIE
------

INPUT DIRS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
ll -tr  */chr22/hit.sam

    -rw-rw-r-- 1 syoung root 154M Oct 19 14:58 1/chr22/hit.sam <=== NOTE: TOO SMALL
    -rw-rw-r-- 1 syoung root 886M Oct 19 14:59 10/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 14:59 11/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:00 12/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:00 13/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:01 14/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:01 15/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:02 16/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:02 17/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:03 18/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:03 19/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:04 2/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:04 20/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:05 21/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:05 22/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:06 23/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:06 24/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 889M Oct 19 15:07 25/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:07 26/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:08 27/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:08 28/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:09 29/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:09 3/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:10 30/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:10 31/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:11 32/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 889M Oct 19 15:11 33/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 908M Oct 19 15:12 4/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 925M Oct 19 15:12 5/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:13 6/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 887M Oct 19 15:13 7/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 888M Oct 19 15:14 8/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 5.3G Oct 19 15:16 9/chr22/hit.sam <=== NOTE: TOO BIG



CREATE OUTPUTDIR

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8

screen -S cumulative-8-bowtie

perl /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl \
--inputdirs \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/2,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/3,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/4,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/5,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/6,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/7,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/8,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/10,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/11,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/12,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/13,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/14,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/15,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/16,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/17,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/18,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/19,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/20,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/21,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/22,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/23,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/24,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/25,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/26,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/27,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/28,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/29,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/30,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/31,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/32,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/33 \
--samfile hit.sam \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8 \
--species human \
--label cumulative-8 \
--walltime 48 \
--cluster LSF \
--queue large \
--cpus 1 \
--maxjobs 1000 \
--clean \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/cumulativeSNP-stdout.txt


    Cluster::runJobs    Completed cumulativeSNPs at 10-10-20 03:10:33, duration: 00:09:40
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    cumulativeSNP.pl    Run time: 09:02:08
    cumulativeSNP.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl
    cumulativeSNP.pl    3:10AM, 20 October 2010
    cumulativeSNP.pl    ****************************************



PROBLEM WITH INPUT FILE 1:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/chr22
ll *snp

    -rw-rw-rw- 1 syoung root        0 Oct 19 18:08 hit-1.snp
    -rw-rw-rw- 1 syoung root  6162853 Oct 19 18:14 hit-2.snp
    -rw-rw-rw- 1 syoung root  9594190 Oct 19 18:24 hit-3.snp
    -rw-rw-rw- 1 syoung root 10614784 Oct 19 18:34 hit-4.snp
    -rw-rw-rw- 1 syoung root 13321172 Oct 19 18:49 hit-5.snp
    -rw-rw-rw- 1 syoung root 15244453 Oct 19 19:07 hit-6.snp
    -rw-rw-rw- 1 syoung root 16723918 Oct 19 19:29 hit-7.snp
    -rw-rw-rw- 1 syoung root 17820366 Oct 19 19:54 hit-8.snp
    -rw-rw-rw- 1 syoung root 17820366 Oct 19 20:13 hit-9.snp
    -rw-rw-rw- 1 syoung root 18625938 Oct 19 20:42 hit-10.snp
    -rw-rw-rw- 1 syoung root 19238702 Oct 19 21:14 hit-11.snp
    -rw-rw-rw- 1 syoung root 19631943 Oct 19 21:50 hit-12.snp
    -rw-rw-rw- 1 syoung root 19905333 Oct 19 22:30 hit-13.snp
    -rw-rw-rw- 1 syoung root  1017163 Oct 19 22:43 hit-14.snp
    -rw-rw-rw- 1 syoung root  1017163 Oct 19 22:43 hit-15.snp
    -rw-rw-rw- 1 syoung root  6157151 Oct 19 22:50 hit-16.snp
    -rw-rw-rw- 1 syoung root  9398010 Oct 19 23:01 hit-17.snp
    -rw-rw-rw- 1 syoung root 12129146 Oct 19 23:16 hit-18.snp
    -rw-rw-rw- 1 syoung root 14074762 Oct 19 23:33 hit-19.snp
    -rw-rw-rw- 1 syoung root 15565164 Oct 19 23:55 hit-20.snp
    -rw-rw-rw- 1 syoung root 16688994 Oct 20 00:20 hit-21.snp
    -rw-rw-rw- 1 syoung root 17500101 Oct 20 00:48 hit-22.snp
    -rw-rw-rw- 1 syoung root 18180492 Oct 20 01:20 hit-23.snp
    -rw-rw-rw- 1 syoung root 18681187 Oct 20 01:56 hit-24.snp
    -rw-rw-rw- 1 syoung root 19029685 Oct 20 02:36 hit-25.snp
    -rw-rw-rw- 1 syoung root   161848 Oct 20 02:49 hit-26.snp
    -rw-rw-rw- 1 syoung root   161848 Oct 20 02:49 hit-27.snp
    -rw-rw-rw- 1 syoung root    71707 Oct 20 02:53 hit-28.snp
    -rw-rw-rw- 1 syoung root    71707 Oct 20 02:53 hit-29.snp
    -rw-rw-rw- 1 syoung root    71707 Oct 20 02:53 hit-30.snp
    -rw-rw-rw- 1 syoung root  5451415 Oct 20 03:01 hit-31.snp
    -rw-rw-rw- 1 syoung root  5451415 Oct 20 03:00 hit-32.snp
    -rw-rw-rw- 1 syoung root  8926373 Oct 20 03:10 hit-33.snp


    #-rw-rw-rw- 1 syoung root    0 Oct 19 18:08 hit-1.snp
    #-rw-rw-rw- 1 syoung root 5.9M Oct 19 18:14 hit-2.snp
    #-rw-rw-rw- 1 syoung root 9.2M Oct 19 18:24 hit-3.snp
    #-rw-rw-rw- 1 syoung root  11M Oct 19 18:34 hit-4.snp
    #-rw-rw-rw- 1 syoung root  13M Oct 19 18:49 hit-5.snp
    #-rw-rw-rw- 1 syoung root  15M Oct 19 19:07 hit-6.snp




BACKUP:

TARRED AND ZIPPED *.bam AND *.snp FILES

screen -S bowtie-tar
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/chr22
tar cvfz bowtie-cumulative-8-snp.tar.gz *.snp

    OK
    
tar cvfz bowtie-cumulative-8-bam.tar.gz merged.bam*

    FAILED

    merged.bam
    merged.bam-1
    merged.bam-10
    merged.bam-11
    merged.bam-12
    merged.bam-13
    merged.bam-14
    merged.bam-15
    merged.bam-16
    merged.bam-18
    merged.bam-2
    merged.bam-20
    merged.bam-26
    merged.bam-28
    merged.bam-3
    merged.bam-30
    merged.bam-4
    merged.bam-5
    merged.bam-6
    merged.bam-7
    merged.bam-8
    merged.bam-9
    merged.bam.temp
    tar: merged.bam.temp: file changed as we read it


COPIED TO nethome ON PEGASUS

mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/chr22/bowtie-cumulative-8-snp.tar.gz \
/nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8




#cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/chr22/bowtie-cumulative-8-bam.tar.gz \
#/nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8



MOVED TO /ngs/bioinfo

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/cumulative-8/chr22/bowtie-cumulative-8-snp.tar.gz \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie














</entry>



<entry [Sun Oct 10 01:26:37 EDT 2010] COPY BOWTIE hit.sam FILES TO /scratch AND RUN cumulativeSNP.pl ON BOWTIE SNPs>




1. COPY FILES TO /scratch

E.G.: COPY
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam

TO
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam



NGSDIR=/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
SCRATCHDIR=/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
SUBDIR=chr22
cd $NGSDIR
DIRS="*"
for DIR in $DIRS;
do
    if [ -d $NGSDIR/$DIR ]; then
    
        echo "NGSDIR/DIR: " $NGSDIR/$DIR
        echo "creating directory: " $SCRATCHDIR/$DIR/$SUBDIR;
        mkdir -p $SCRATCHDIR/$DIR/$SUBDIR;
    fi;

    echo "cp $NGSDIR/$DIR/$SUBDIR/hit.sam $SCRATCHDIR/$DIR/$SUBDIR"
    cp $NGSDIR/$DIR/$SUBDIR/hit.sam $SCRATCHDIR/$DIR/$SUBDIR
    
done;

OUTPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
    
    -rw-rw-r-- 1 syoung root  928783223 Oct 19 14:59 10/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929413244 Oct 19 14:59 11/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929568893 Oct 19 15:00 12/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930339934 Oct 19 15:00 13/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929541626 Oct 19 15:01 14/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929559245 Oct 19 15:01 15/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929941768 Oct 19 15:02 16/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930678452 Oct 19 15:02 17/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929967448 Oct 19 15:03 18/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929832617 Oct 19 15:03 19/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  160646033 Oct 19 14:58 1/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930521898 Oct 19 15:04 20/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930743237 Oct 19 15:05 21/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929171243 Oct 19 15:05 22/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930494936 Oct 19 15:06 23/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930839543 Oct 19 15:06 24/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  931631545 Oct 19 15:07 25/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929900975 Oct 19 15:07 26/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930226203 Oct 19 15:08 27/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930921444 Oct 19 15:08 28/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930641797 Oct 19 15:09 29/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929934357 Oct 19 15:04 2/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930139807 Oct 19 15:10 30/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929668672 Oct 19 15:10 31/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930081166 Oct 19 15:11 32/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  931182131 Oct 19 15:11 33/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929891783 Oct 19 15:09 3/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  951297836 Oct 19 15:12 4/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  969208922 Oct 19 15:12 5/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930629122 Oct 19 15:13 6/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  929823141 Oct 19 15:13 7/chr22/hit.sam
    -rw-rw-r-- 1 syoung root  930240265 Oct 19 15:14 8/chr22/hit.sam
    -rw-rw-r-- 1 syoung root 5604035056 Oct 19 15:16 9/chr22/hit.sam




</entry>



<entry [Tue Oct 19 13:10:09 EDT 2010] HITS AGAINST chr22 FOR ALL ALIGNERS USING 3,3 BILLION READS>




ELAND
-----
cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/1
emacs ELAND-USAGE.txt

    Completed: /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl
    Date:      10-10-01 00:33:54
    Duration:  00:40:17
    Command:   ARRAY(0x7e2e100)
    
    USAGE STATISTICS
    
    BATCH          doBatchAlignment
    DURATION       00:15:28
    CPUTIME MIN    532.47   sec.
    CPUTIME MAX    891.19   sec.
    CPUTIME TOTAL  30551.34 sec.
    MAXMEMORY MIN  339      MB
    MAXMEMORY MAX  445      MB
    MAXSWAP MIN    588      MB
    MAXSWAP MAX    702      MB


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland
[syoung@u01 eland]$ lines */chr22/hit.sam
1/chr22/hit.sam: 3906337
2/chr22/hit.sam: 2614710
3/chr22/hit.sam: 2614178
4/chr22/hit.sam: 2615181
5/chr22/hit.sam: 2615336
6/chr22/hit.sam: 2615129
7/chr22/hit.sam: 2613024
8/chr22/hit.sam: 2615003
9/chr22/hit.sam: 2617296
10/chr22/hit.sam: 2617141
11/chr22/hit.sam: 2614598
12/chr22/hit.sam: 2613336
13/chr22/hit.sam: 2616198
14/chr22/hit.sam: 2619815
15/chr22/hit.sam: 2612650
16/chr22/hit.sam: 2611901
17/chr22/hit.sam: 2611811
18/chr22/hit.sam: 2612371
19/chr22/hit.sam: 2613598
20/chr22/hit.sam: 2613787
21/chr22/hit.sam: 2615407
22/chr22/hit.sam: 2610292
23/chr22/hit.sam: 2613407
24/chr22/hit.sam: 2616451
25/chr22/hit.sam: 2615875
26/chr22/hit.sam: 2612774
27/chr22/hit.sam: 2616732
28/chr22/hit.sam: 2618765
29/chr22/hit.sam: 2612817
30/chr22/hit.sam: 2616998
31/chr22/hit.sam: 2613874
32/chr22/hit.sam: 2616507
33/chr22/hit.sam: 2614753


MAQ
---

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/1
emacs MAQ-USAGE.txt

    Completed: /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl
    Date:      10-10-08 02:43:45
    Duration:  02:05:10
    
    BATCH          doBatchAlignment
    DURATION       00:11:35
    CPUTIME MIN    350.04   sec.
    CPUTIME MAX    638.06   sec.
    CPUTIME TOTAL  23185.23 sec.
    MAXMEMORY MIN  837      MB
    MAXMEMORY MAX  838      MB
    MAXSWAP MIN    1017     MB
    MAXSWAP MAX    1017     MB


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
[syoung@u03 maq]$ lines */chr22/hit.sam
10/chr22/hit.sam: 23241300
11/chr22/hit.sam: 23247130
12/chr22/hit.sam: 23250344
13/chr22/hit.sam: 23247938
14/chr22/hit.sam: 23244072
15/chr22/hit.sam: 23249020
16/chr22/hit.sam: 23253144
17/chr22/hit.sam: 23250446
19/chr22/hit.sam: 23242738
1/chr22/hit.sam: 23235818
20/chr22/hit.sam: 23242756
21/chr22/hit.sam: 23246438
22/chr22/hit.sam: 23243332
23/chr22/hit.sam: 23252704
24/chr22/hit.sam: 23258486
25/chr22/hit.sam: 23248606
26/chr22/hit.sam: 23244608
27/chr22/hit.sam: 23246286
28/chr22/hit.sam: 23246100
29/chr22/hit.sam: 23241348
30/chr22/hit.sam: 23240584
31/chr22/hit.sam: 23242184
32/chr22/hit.sam: 23236596
33/chr22/hit.sam: 23257222


BOWTIE
------


cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1


COPY hit.sam.gz TO hit.sam FOR EACH INPUT FILE

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        echo $DIR
        SPLITDIR=$(echo $DIR | egrep "^[0-9]+" ); 
        if [ "$SPLITDIR" != "" ]; then

            echo "copying $DIR/chr22/hit.sam.gz to $DIR/chr22/hit.sam"
            `zcat $DIR/chr22/hit.sam.gz > $DIR/chr22/hit.sam`;

        fi;
    fi;
done;


cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
lines */chr22/hit.sam


1/chr22/hit.sam: 0
20/chr22/hit.sam: 5315958
21/chr22/hit.sam: 5317239
22/chr22/hit.sam: 5308174
23/chr22/hit.sam: 5315798
24/chr22/hit.sam: 5317708
25/chr22/hit.sam: 5322298
26/chr22/hit.sam: 5312460
27/chr22/hit.sam: 5314198
28/chr22/hit.sam: 5318246
29/chr22/hit.sam: 5316563
2/chr22/hit.sam: 5312585
30/chr22/hit.sam: 5313727
31/chr22/hit.sam: 5311129
32/chr22/hit.sam: 5313449
33/chr22/hit.sam: 5319750
3/chr22/hit.sam: 5312395
4/chr22/hit.sam: 5434362
5/chr22/hit.sam: 5536492
6/chr22/hit.sam: 5316520
7/chr22/hit.sam: 5311811
8/chr22/hit.sam: 5314247
9/chr22/hit.sam: 31905792
10/chr22/hit.sam: 5305978
11/chr22/hit.sam: 5309639
12/chr22/hit.sam: 5310411
13/chr22/hit.sam: 5314822
14/chr22/hit.sam: 5310313
15/chr22/hit.sam: 5310450
16/chr22/hit.sam: 5312625
17/chr22/hit.sam: 5316793
18/chr22/hit.sam: 5312692
19/chr22/hit.sam: 5311997






</entry>



<entry [Mon Oct 18 14:12:26 EDT 2010] CREATED NOVOALIGN.pl, TESTED ON chr22 WITH LONG INSERT (2000BP) NA18507 DATA AND RAN LOOP ON SHORT (200BP) DATA>




1. INDEX FILES ALREADY GENERATED

[
    Notes-project31-snps.txt
    Wed Jun  9 16:48:12 EDT 2010
    NOVOALIGN TESTS
]

/nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign



2. TEST NOVOALIGN.pl ON FILE 1


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign


screen -S novoalign-autochr22


/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign \
--distance 2000 \
--deviation 300 \
--species human \
--label novoalign-autochr22 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/autochr22-1.out 


    NOVOALIGN.pl    Run time: 00:13:04
    NOVOALIGN.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl
    NOVOALIGN.pl    12:39AM, 19 October 2010
    NOVOALIGN.pl    ****************************************

    (NOT COUNTING ALIGNMENT TIME)


WHICH RUNS:

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/chr22/1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/chr22/1

time /nethome/syoung/base/apps/novoalign/2.05.33/novoalign \
-o SAM \
-i 2000 300 \
-d /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign/chr22/chr22.idx \
-f /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/1/novoalign-autochr22_1.1.txt /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/1/novoalign-autochr22_2.1.txt  > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/novoalign/chr22/1/out.sam



3. RUN NOVOALIGN WITH loop.pl


FIRST ROUND (2-16) (1 ALREADY DONE IN TEST ABOVE)
-------------------------------------------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign

screen -r loop-novoalign-autochr22

screen -S loop-novoalign-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl \
--replicates 2-16 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/%REPLICATE% \
--distance 2000 \
--deviation 300 \
--species human \
--label novoalign-autochr22-%REPLICATE% \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/%REPLICATE%/novoalign.out 


    RUNNING Tue Oct 19 12:37:56 EDT 2010
    
    Run time: 66:34:18
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    9:15AM, 22 October 2010
    ****************************************


EACH RUN TOOK APPROXIMATELY 4.5 HOURS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/1
tail novoalign.out

    ...
    NOVOALIGN.pl    Run time: 04:28:01
    NOVOALIGN.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl
    NOVOALIGN.pl    5:24PM, 20 October 2010
    NOVOALIGN.pl    ****************************************



NB: FILES 17, 18 AND 20 TOOK 25 HOURS:

    ==> 17/novoalign.out <==
    NOVOALIGN::run    Doing printUsage       10-10-22 09:42:14
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/17/novoalign-USAGE.txt
    NOVOALIGN::run    After printUsage       10-10-22 09:42:15
    NOVOALIGN.pl    Run time: 25:40:33
    NOVOALIGN.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl
    NOVOALIGN.pl    9:42AM, 22 October 2010
    NOVOALIGN.pl    ****************************************
    
    ==> 18/novoalign.out <==
    NOVOALIGN::run    Doing printUsage       10-10-23 11:27:25
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/18/novoalign-USAGE.txt
    NOVOALIGN::run    After printUsage       10-10-23 11:27:25
    NOVOALIGN.pl    Run time: 25:45:06
    NOVOALIGN.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl
    NOVOALIGN.pl    11:27AM, 23 October 2010
    NOVOALIGN.pl    ****************************************

    ==> 20/novoalign.out <==
    NOVOALIGN::run    Doing printUsage       10-10-24 23:23:33
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/20/novoalign-USAGE.txt
    NOVOALIGN::run    After printUsage       10-10-24 23:23:33
    NOVOALIGN.pl    Run time: 25:30:15
    NOVOALIGN.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl
    NOVOALIGN.pl    11:23PM, 24 October 2010
    NOVOALIGN.pl    ****************************************



FILE 19 TOOK 10 HOURS:

    ==> 19/novoalign.out <==
    NOVOALIGN::run    Doing printUsage       10-10-23 21:53:16
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/19/novoalign-USAGE.txt
    NOVOALIGN::run    After printUsage       10-10-23 21:53:16
    NOVOALIGN.pl    Run time: 10:25:50
    NOVOALIGN.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl
    NOVOALIGN.pl    9:53PM, 23 October 2010
    NOVOALIGN.pl    ****************************************


AND MANY FILES SEEM TO HAVE BEEN INTERRUPTED:

    
    ==> 21/novoalign.out <==
    Cluster::readHits    Cluster::readHits(outputdir, references, splitfiles, label)
    Cluster::hitIdFiles    Cluster::hitIdFiles(outputdir, tsvfiles, sqlite, cluster, label)
    Creating hit files in parallel for reference: chr22
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/21/chr22/hitIdFiles-chr22.sh
    Job <2205579> is submitted to queue <small>.
    Cluster::runJobs    Completed hitIdFiles at 10-10-26 00:39:22, duration: 00:00:05
    Cluster::parseUsagefile    Cluster::parseUsagefile(file)
    Cluster::parseUsagefile    file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/21/chr22/hitIdFiles-chr22-stdout.txt
    Cluster::parseUsagefile    Try number 1 looking for usage file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/21/chr22/hitIdFiles-chr22-stdout.txt
    
    ==> 2/novoalign.out <==
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/2/chr22/samToSnp-chr22.sh
    Job <2189853> is submitted to queue <large>.
    Cluster::runJobs    Completed samToSnp at 10-10-19 18:54:01, duration: 00:00:41
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After samToSnp      10-10-19 18:54:01
    NOVOALIGN::runInParallel    After samtoolSnps      10-10-19 18:54:01
    NOVOALIGN::run    Doing printUsage       10-10-19 18:54:01
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/2/novoalign-USAGE.txt
    
    ==> 3/novoalign.out <==
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/3/chr22/samToSnp-chr22.sh
    Job <2189915> is submitted to queue <large>.
    Cluster::runJobs    Completed samToSnp at 10-10-19 23:08:26, duration: 00:00:36
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After samToSnp      10-10-19 23:08:26
    NOVOALIGN::runInParallel    After samtoolSnps      10-10-19 23:08:26
    NOVOALIGN::run    Doing printUsage       10-10-19 23:08:26
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/3/novoalign-USAGE.txt
    
    ==> 4/novoalign.out <==
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/4/chr22/samToSnp-chr22.sh
    Job <2189950> is submitted to queue <large>.
    Cluster::runJobs    Completed samToSnp at 10-10-20 03:22:47, duration: 00:00:41
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After samToSnp      10-10-20 03:22:47
    NOVOALIGN::runInParallel    After samtoolSnps      10-10-20 03:22:47
    NOVOALIGN::run    Doing printUsage       10-10-20 03:22:47
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/4/novoalign-USAGE.txt
    
    ==> 5/novoalign.out <==
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/5/chr22/samToSnp-chr22.sh
    Job <2189963> is submitted to queue <large>.
    Cluster::runJobs    Completed samToSnp at 10-10-20 07:36:59, duration: 00:00:41
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After samToSnp      10-10-20 07:36:59
    NOVOALIGN::runInParallel    After samtoolSnps      10-10-20 07:36:59
    NOVOALIGN::run    Doing printUsage       10-10-20 07:36:59
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/5/novoalign-USAGE.txt
    
    ==> 6/novoalign.out <==
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/6/chr22/samToSnp-chr22.sh
    Job <2190121> is submitted to queue <large>.
    Cluster::runJobs    Completed samToSnp at 10-10-20 11:51:33, duration: 00:00:41
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After samToSnp      10-10-20 11:51:33
    NOVOALIGN::runInParallel    After samtoolSnps      10-10-20 11:51:33
    NOVOALIGN::run    Doing printUsage       10-10-20 11:51:33
    Cluster::printUsage    usagefile absent
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/6/novoalign-USAGE.txt


ALTHOUGH THE OUTPUT FILES ARE PRESENT:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign
ll -tr */chr22/hit.sam.gz

    -rw-rw-rw- 1 syoung root 126M Oct 19 18:51 2/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 122M Oct 19 23:04 3/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 126M Oct 20 03:19 4/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 124M Oct 20 07:32 5/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 124M Oct 20 11:47 6/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 119M Oct 20 16:01 7/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 126M Oct 20 17:19 1/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 121M Oct 20 20:27 8/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 124M Oct 21 00:59 9/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 123M Oct 21 05:43 10/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 124M Oct 21 10:22 11/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 124M Oct 21 15:03 12/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 125M Oct 21 19:38 13/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 126M Oct 22 00:09 14/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 126M Oct 22 04:40 15/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 124M Oct 22 09:10 16/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 720M Oct 22 09:24 17/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 722M Oct 23 11:09 18/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 297M Oct 23 21:45 19/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 723M Oct 24 23:09 20/chr22/hit.sam.gz



NOTE: FILES 17, 18, 19 AND 20 HAVE UNUSUALLY LARGE hit.sam.gz FILES


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign
ll */chr22/hit.snp
    
    -rw-rw-rw- 1 syoung root 1.4M Oct 20 17:24 1/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 19 18:54 2/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 19 23:08 3/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 20 03:22 4/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 20 07:36 5/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 20 11:51 6/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 20 16:05 7/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 20 20:32 8/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 21 01:04 9/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 21 05:49 10/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 21 10:27 11/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 21 15:08 12/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 21 19:43 13/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 22 00:16 14/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 22 04:45 15/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.3M Oct 22 09:15 16/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 4.4M Oct 22 09:42 17/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 4.4M Oct 23 11:27 18/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 2.6M Oct 23 21:53 19/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 4.4M Oct 24 23:23 20/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 4.4M Oct 26 00:53 21/chr22/hit.snp




SECOND ROUND (17-33)
-------------------


screen -r loop2-novoalign-autochr22

screen -S loop2-novoalign-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl \
--replicates 17-33 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/%REPLICATE% \
--distance 2000 \
--deviation 300 \
--species human \
--label novoalign-autochr22-%REPLICATE% \
--maxjobs 1000 \
--queue small \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign/%REPLICATE%/novoalign.out 


    #Run time: 34:42:19
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    #11:53AM, 11 October 2010
    #****************************************

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/novoalign
ls -al */chr22/hit.snp







###mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/novoalign
###cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/novoalign
###
###screen -S novoalign-autogenome-1
###
###/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/NOVOALIGN.pl \
###--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
###--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
###--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/novoalign \
###--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/novoalign \
###--params "--fr" \
###--distance 2000 \
###--species human \
###--label novoalign-autogenome-1 \
###--maxjobs 1000 \
###--queue large \
###--cluster LSF \
###--walltime 24 \
###--cpus 1 \
###--reads 1000000 \
###--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/novoalign/autogenome-1.out 




</entry>



<entry [Mon Oct 18 10:10:17 EDT 2010] RUN SAV SNP ANNOTATION FOR ELAND, MAQ AND BOWTIE>




1. CREATE FASTA SUBDIRS
CREATE A SUBDIR chrN FOR EACH chrN.fa AND LINK chrN.fa TO chrN/chrN.fa

cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta
FILES="*";
for FILE in $FILES;
do
    CHROM=$(echo $FILE | egrep "^chr[0-9XYM]+.fa");
    if [ "$CHROM" != "" ]; then
        CHROM=${CHROM/.fa/};
        echo MAKING DIR: $CHROM;
        mkdir $CHROM
        ln -s `pwd`/$CHROM.fa `pwd`/$CHROM/$CHROM.fa
    fi;
done;





2. RUN SAV.pl ON ALL

ELAND
-----

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative

screen -S sav-eland

/nethome/bioinfo/apps/agua/0.5/bin/apps/snp/SAV.pl \
--dbsnp snp130 \
--species human \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chr22 \
--cluster LSF \
--inputfile hit-1.snp \
--outputfile hit-1.sav 
    
    ...
    Filter::SNP::referenceCodon    Filter::SNP::referenceCodon(reference_aa, variant_aa)
    Filter::SNP::referenceCodon    reference_aa: S
    Filter::SNP::variantCodon    variant_aa: W
    $VAR1 = { 
              'stop' => '19657653',
              'chromosome' => '22',
              'line' => 'chr22      19657652        t       G       29      29      38      27      ,,g,.gA,GgGGGgGg,GgGG.G,Ggg        +++++#"++&+++!+!+++++++!+"+     0.667   CCDS13786.1     88      exon       2       +',
              'start' => 19657652
            };
    Filter::SNP::geneLocation    Falls between exons
    Filter::SNP::geneLocation    Falls between exons
    ...

lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.sav

    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.sav: 24283


WHICH RUNS:

/nethome/bioinfo/apps/agua/0.5/bin/apps/snp/pileupToSnp.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.snp \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/hit-1.sav \
--inputtype pileup



OUTPUT FILES
------------

TOTAL SNPS:

lines hit-1.sav 
    hit-1.sav: 24283
    


340 EXONIC:    
    
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22
egrep "exon" hit-1.sav > hit-1.exon.sav
lines hit-1.exon.sav 

    hit-1.exon.sav: 340

    ...
    chr22   49334076        g       A       26      26      37      10      a,a,A.AAAA      +!++!+++++      0.700   CCDS14097.1     318     exon    1       +       CTG     ATG     L       M       start
    chr22   49334479        G       A       28      28      57      5       aAA,a   +!+!+   0.800   CCDS14097.1     721     exon    1       +       GAG     GAG     E       E       synonymous
    chr22   49357548        g       C       28      28      41      5       CCCCc   !!+++   1.000   CCDS14098.1     1407    exon    11      -       CTC     CTC     L       L       synonymous
    ...



NO INTRONIC:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22
egrep "intron" hit-1.sav

    NONE









</entry>



<entry [Sat Oct 16 00:42:03 EDT 2010] CLEAN UP FILES ON /scratch>





COPY OUTPUT FILES TO /ngs/bioinfo
---------------------------------

mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chr22
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chr22/hit.sam* /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chr22 
cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chr22


mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chr22
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chr22/hit.sam* /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chr22 
cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chr22



MAQ: REMOVE SPLIT FILES
-----------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq

PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        SPLITDIR=$(echo $DIR | egrep "^[0-9]+" ); 
        if [ "$SPLITDIR" != "" ]; then
            echo "DIR: " $PWD/$DIR
            rm -fr $PWD/$DIR 
        fi;
    fi;
done;



MAQ: REMOVE SUBFOLDER FILES
---------------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq

PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        cd $DIR
            
        SUBDIRS="*"
        for SUBDIR in $SUBDIRS;
        do
            echo $SUBDIR
            SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
            if [ "$SPLITSUBDIR" != "" ]; then
                echo "SUBDIR: " $PWD/$SUBDIR
                rm -fr $PWD/$SUBDIR 
            fi;
        done;

        cd ../

    fi;
done;



MOVE FILES TO /ngs/bioinfo

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
mv chr1 chr1-part

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
mv * /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq




ELAND: REMOVE SPLIT FILES
-----------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland

PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        SPLITDIR=$(echo $DIR | egrep "^[0-9]+" ); 
        if [ "$SPLITDIR" != "" ]; then
            echo "DIR: " $PWD/$DIR
            rm -fr $PWD/$DIR 
        fi;
    fi;
done;



ELAND: REMOVE SUBFOLDER FILES
---------------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland

PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        cd $DIR
            
        SUBDIRS="*"
        for SUBDIR in $SUBDIRS;
        do
            echo $SUBDIR
            SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
            if [ "$SPLITSUBDIR" != "" ]; then
                echo "SUBDIR: " $PWD/$SUBDIR
                rm -fr $PWD/$SUBDIR 
            fi;
        done;

        cd ../

    fi;
done;


MOVE REMAINING FOLDERS TO /ngs/bioinfo

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/* \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland



RUNNING Mon Oct 18 01:20:58 EDT 2010








BOWTIE: REMOVE SPLIT FILES
-----------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        SPLITDIR=$(echo $DIR | egrep "^[0-9]+" ); 
        if [ "$SPLITDIR" != "" ]; then
            echo "DIR: " $PWD/$DIR
            rm -fr $PWD/$DIR 
        fi;
    fi;
done;



BOWTIE: REMOVE SUBFOLDER FILES
---------------------------

KEEP CHR1

mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie
cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chr1 \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

    OK
    

REMOVE NUMERIC SUBFOLDERS

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie
PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        cd $DIR
            
        SUBDIRS="*"
        for SUBDIR in $SUBDIRS;
        do
            echo $SUBDIR
            SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
            if [ "$SPLITSUBDIR" != "" ]; then
                echo "SUBDIR: " $PWD/$SUBDIR
                rm -fr $PWD/$SUBDIR 
            fi;
        done;

        cd ../

    fi;
done;



*** RUNNING 
Mon Oct 18 11:38:18 EDT 2010



MOVE REMAINING FOLDERS TO /ngs/bioinfo

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/* \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie









</entry>



<entry [Wed Oct 13 18:45:39 EDT 2010] BOWTIE DEFAULTS>



http://bowtie-bio.sourceforge.net/manual.shtml#the--n-alignment-mode

NB: Bowtie does not yet report gapped alignments; this is future work.


By default, Bowtie enforces an alignment policy similar to Maq's default quality-aware policy (-n 2 -l 28 -e 70)

  -n/--seedmms <int> max mismatches in seed (can be 0-3, default: -n 2)
  -e/--maqerr <int>  max sum of mismatch quals across alignment for -n (def: 70)
  -l/--seedlen <int> seed length for -n (default: 28)
  


Paired-end colorspace alignment

When colorspace alignment is enabled, the default paired-end orientation setting is --ff. This is because most SOLiD datasets have that orientation.



ALSO NEED TO USE:


-I/--minins <int>

The minimum insert size for valid paired-end alignments. E.g. if -I 60 is specified and a paired-end alignment consists of two 20-bp alignments in the appropriate orientation with a 20-bp gap between them, that alignment is considered valid (as long as -X is also satisfied). A 19-bp gap would not be valid in that case. If trimming options -3 or -5 are also used, the -I constraint is applied with respect to the untrimmed mates. Default: 0.

-X/--maxins <int>

The maximum insert size for valid paired-end alignments. E.g. if -X 100 is specified and a paired-end alignment consists of two 20-bp alignments in the proper orientation with a 60-bp gap between them, that alignment is considered valid (as long as -I is also satisfied). A 61-bp gap would not be valid in that case. If trimming options -3 or -5 are also used, the -X constraint is applied with respect to the untrimmed mates, not the trimmed mates. Default: 250.

--fr/--rf/--ff

The upstream/downstream mate orientations for a valid paired-end alignment against the forward reference strand. E.g., if --fr is specified and there is a candidate paired-end alignment where mate1 appears upstream of the reverse complement of mate2 and the insert length constraints are met, that alignment is valid. Also, if mate2 appears upstream of the reverse complement of mate1 and all other constraints are met, that too is valid. --rf likewise requires that an upstream mate1 be reverse-complemented and a downstream mate2 be forward-oriented. --ff requires both an upstream mate1 and a downstream mate2 to be forward-oriented.

Default: --fr when -C (colorspace alignment) is not specified, --ff when -C is specified.

                   DISTANCE OKAY
--fr    ------>.....................<-------

--rf    <------.....................------->

--ff    ------>.....................------->



ALL ALIGNMENT ARGUMENTS:

Alignment

-v <int>
Report alignments with at most <int> mismatches. -e and -l options are ignored and quality values have no effect on what alignments are valid. -v is mutually exclusive with -n.

-n/--seedmms <int>
Maximum number of mismatches permitted in the "seed", i.e. the first L base pairs of the read (where L is set with -l/--seedlen). This may be 0, 1, 2 or 3 and the default is 2. This option is mutually exclusive with the -v option.

-e/--maqerr <int>
Maximum permitted total of quality values at all mismatched read positions throughout the entire alignment, not just in the "seed". The default is 70. Like Maq, bowtie rounds quality values to the nearest 10 and saturates at 30; rounding can be disabled with --nomaqround.

-l/--seedlen <int>
The "seed length"; i.e., the number of bases on the high-quality end of the read to which the -n ceiling applies. The lowest permitted setting is 5 and the default is 28. bowtie is faster for larger values of -l.

--nomaqround
Maq accepts quality values in the Phred quality scale, but internally rounds values to the nearest 10, with a maximum of 30. By default, bowtie also rounds this way. --nomaqround prevents this rounding in bowtie.

-I/--minins <int>
The minimum insert size for valid paired-end alignments. E.g. if -I 60 is specified and a paired-end alignment consists of two 20-bp alignments in the appropriate orientation with a 20-bp gap between them, that alignment is considered valid (as long as -X is also satisfied). A 19-bp gap would not be valid in that case. If trimming options -3 or -5 are also used, the -I constraint is applied with respect to the untrimmed mates. Default: 0.

-X/--maxins <int>
The maximum insert size for valid paired-end alignments. E.g. if -X 100 is specified and a paired-end alignment consists of two 20-bp alignments in the proper orientation with a 60-bp gap between them, that alignment is considered valid (as long as -I is also satisfied). A 61-bp gap would not be valid in that case. If trimming options -3 or -5 are also used, the -X constraint is applied with respect to the untrimmed mates, not the trimmed mates. Default: 250.

--fr/--rf/--ff
The upstream/downstream mate orientations for a valid paired-end alignment against the forward reference strand. E.g., if --fr is specified and there is a candidate paired-end alignment where mate1 appears upstream of the reverse complement of mate2 and the insert length constraints are met, that alignment is valid. Also, if mate2 appears upstream of the reverse complement of mate1 and all other constraints are met, that too is valid. --rf likewise requires that an upstream mate1 be reverse-complemented and a downstream mate2 be forward-oriented. --ff requires both an upstream mate1 and a downstream mate2 to be forward-oriented. Default: --fr when -C (colorspace alignment) is not specified, --ff when -C is specified.

--nofw/--norc
If --nofw is specified, bowtie will not attempt to align against the forward reference strand. If --norc is specified, bowtie will not attempt to align against the reverse-complement reference strand. For paired-end reads using --fr or --rf modes, --nofw and --norc apply to the forward and reverse-complement pair orientations. I.e. specifying --nofw and --fr will only find reads in the R/F orientation where mate 2 occurs upstream of mate 1 with respect to the forward reference strand.

--maxbts
The maximum number of backtracks permitted when aligning a read in -n 2 or -n 3 mode (default: 125 without --best, 800 with --best). A "backtrack" is the introduction of a speculative substitution into the alignment. Without this limit, the default parameters will sometimes require that bowtie try 100s or 1,000s of backtracks to align a read, especially if the read has many low-quality bases and/or has no valid alignments, slowing bowtie down significantly. However, this limit may cause some valid alignments to be missed. Higher limits yield greater sensitivity at the expensive of longer running times. See also: -y/--tryhard.

--pairtries <int>
For paired-end alignment, this is the maximum number of attempts bowtie will make to match an alignment for one mate up with an alignment for the opposite mate. Most paired-end alignments require only a few such attempts, but pairs where both mates occur in highly repetitive regions of the reference can require significantly more. Setting this to a higher number allows bowtie to find more paired- end alignments for repetitive pairs at the expense of speed. The default is 100. See also: -y/--tryhard.

-y/--tryhard
Try as hard as possible to find valid alignments when they exist, including paired-end alignments. This is equivalent to specifying very high values for the --maxbts and --pairtries options. This mode is generally much slower than the default settings, but can be useful for certain problems. This mode is slower when (a) the reference is very repetitive, (b) the reads are low quality, or (c) not many reads have valid alignments.

--chunkmbs <int>
The number of megabytes of memory a given thread is given to store path descriptors in --best mode. Best-first search must keep track of many paths at once to ensure it is always extending the path with the lowest cumulative cost. Bowtie tries to minimize the memory impact of the descriptors, but they can still grow very large in some cases. If you receive an error message saying that chunk memory has been exhausted in --best mode, try adjusting this parameter up to dedicate more memory to the descriptors. Default: 64.




</entry>



<entry [Wed Oct 13 14:54:11 EDT 2010] TEST BOWTIE USING --rf/--fr/--ff AND ELAND AGAINST 100K READS>




1. REDUCE INPUT FILES TO 100,000M READS

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test

chopfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt yoruba1-1.reads_1.100K.sequence.txt 100000 

chopfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt yoruba1-1.reads_2.100K.sequence.txt 100000


INPUT FILES:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.-100K.sequence.txt



2. RUN rf, fr AND ff

rf
--


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rf
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rf

screen -S bowtie-test-rf

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rf \
--params "--rf" \
--distance 2000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rf/autogenome-1.out 



fr
--

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/fr
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/fr

screen -S bowtie-test-fr

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/fr \
--params "--fr" \
--distance 2000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/fr/autogenome-1.out 


ff
--


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ff
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ff

screen -S bowtie-test-ff

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ff \
--params "--ff" \
--distance 2000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ff/autogenome-1.out 



eland
-----

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/eland
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/eland

screen -S bowtie-test-eland

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/eland \
--inputtype fastq \
--species human \
--label bowtie-test-eland \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--readhits \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/eland/autogenome-1.out 
    
    Run time: 00:16:18
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/ELAND.pl
    4:59PM, 13 October 2010
    ****************************************


maq
-----

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq

screen -S bowtie-test-maq

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq \
--species human \
--label bowtie-test-maq \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/autogenome-1.out 
    


WHICH RUNS:

time \
/nethome/bioinfo/apps/maq/0.7.1/maq match \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/chr1/$LSB_JOBINDEX/out.map \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr1.bfa \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/$LSB_JOBINDEX/bowtie-test-maq_1.$LSB_JOBINDEX.bfq \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/$LSB_JOBINDEX/bowtie-test-maq_2.$LSB_JOBINDEX.bfq \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/chr1/$LSB_JOBINDEX/maq-chr1-outerr.txt





rfx
---


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rfx
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rfx

screen -S bowtie-test-rfx

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rfx \
--params "--rf -X 3000" \
--distance 3000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rfx/autogenome-1.out 



frx
---

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/frx
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/frx

screen -S bowtie-test-frx

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/frx \
--params "--fr -X 3000" \
--distance 3000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/frx/autogenome-1.out 


ffx
---


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ffx
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ffx

screen -S bowtie-test-ffx

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_1.100K.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/yoruba1-1.reads_2.100K.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ffx \
--params "--ff -X 3000" \
--distance 3000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/ffx/autogenome-1.out 



COMPARE RESULTS
---------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-ffx

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-ffx


CHECK hit.sam FILE SIZES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
ll */chrY/*/hit.sam

279K    eland/chr22/1/hit.sam
135K    ff/chr22/1/hit.sam
186K    ffx/chr22/1/hit.sam
 37K    fr/chr22/1/hit.sam
110K    frx/chr22/1/hit.sam
2.1M    maq/chr22/1/hit.sam
 25K    rf/chr22/1/hit.sam
214K    rfx/chr22/1/hit.sam


GET FIRST 5 UNIQUE READS FROM ELAND HITS OUTPUT:

head -n 6 eland/chrY/1/hit.sam

==> eland/chrY/1/hit.sam <==
SRR005718.11:1:1:465:225        73      chrY    2394143 69      36M     *       0       0     GCCTCCCAAAGCACTGGGGTTACAGGTATGAGTCAC     +++++++++++++++++++++++++++++++++#(&    MD:Z:22T3C5C3 SM:i:69
SRR005718.17:1:1:770:515        97      chrY    23153370        114     36M     =       23151090       -2244   GAAACATTTCTGCAAAGGATAAAACATAATAAAAGA    ++++++++++++++++++++++++++++++*+++++  MD:Z:36  SM:i:114
SRR005718.17:1:1:770:515        145     chrY    23151090        95      36M     =       23153370       2244    GAGCTGCACAGAGGTATATGTCACAATTCACCTCTG    !+%*!"++#++++++++++(++++++++++++++++  MD:Z:36  SM:i:95
SRR005718.20:1:1:371:125        137     chrY    1884567 4       36M     *       0       0     TTTATTTTATCTTATTTTATTTTATTTTGAGACAAG     ++++++++++++++++++++++++++++!%!&"+"+    MD:Z:10T23GA  SM:i:4
SRR005718.119:1:1:987:103       137     chrY    13644594        77      36M     *       0     TTCCATTCGATTCCGTTCAATGATTATTCCATTCGA     +++++++++++++++++++++++++++++"++++!(    MD:Z:14A3G15A1SM:i:77
SRR005718.145:1:1:681:588       137     chrY    58974834        61      36M     *       0     TCAATTCCATTCCTTTCGTTTCCATTACATTTGATG     ++++++++++++++++++++++++++++++++!$+$    MD:Z:18A7C7GT SM:i:61



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
head ffx/chrY/1/hit.sam


SRR005718.279:1:1:57:614#0      67      chrY    8826679 255     36M     =       8826682 39      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA        IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:0  MD:Z:29C1G4     NM:i:2
SRR005718.279:1:1:57:614#0      131     chrY    8826682 255     36M     =       8826679 -39     AAAAAAAAAAAAAAAAAAAAAAAAAACAACAAAACA        II,IIIIIIIIIII)I7III8IIIII4I)GIIIA(I    XA:i:0  MD:Z:28G0A4G1   NM:i:3
SRR005718.333:1:1:188:110#0     67      chrY    19310257        255     36M     =       19312611        239GATGTTCCCCTTCCTGTGTCCATGTGTTCTCATTGT     IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:1  MD:Z:11C24      NM:i:1
SRR005718.333:1:1:188:110#0     131     chrY    19312611        255     36M     =       19310257        -2390       TATCCTTTGTAGGGACATGGATGAAGCTGGAAACCA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII?7AI    XA:i:1  MD:Z:1G34  NM:i:1
SRR005718.373:1:1:21:747#0      67      chrY    25207829        255     36M     =       25207844        51 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA     IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:0  MD:Z:36 NM:i:0
SRR005718.373:1:1:21:747#0      131     chrY    25207844        255     36M     =       25207829        -51AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA     IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:0  MD:Z:30G1T3     NM:i:2
SRR005718.480:1:1:808:333#0     179     chrY    28457480        255     36M     =       28458481        103GGCTCACGCCTGTAATCCCAGCACTTTGGGAGGCCA     +373@D:9I5I:IIIIIIIIIIIIIIIIIIIIIIII    XA:i:1  MD:Z:35G0       NM:i:1
SRR005718.480:1:1:808:333#0     115     chrY    28458481        255     36M     =       28457480        -1037       CACCAACATGGCACATGTATACATATATAACAAACC    0FGEIIIII>IIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:1  MD:Z:26G9  NM:i:1
SRR005718.525:1:1:748:730#0     179     chrY    7001005 255     36M     =       7003781 2812    AAATGTGTCCCAGAGATTCTGGTATGTTGTGTCTTT        A32%*-1",1-87?,410ICDII1;28II$IHI2I.    XA:i:0  MD:Z:36 NM:i:0
SRR005718.525:1:1:748:730#0     115     chrY    7003781 255     36M     =       7001005 -2812   GAGAATGACTTTGACGAGTTGAGAGAAGAAGGCTTC        485AC-5:>'&+<::II249IGIIII4IIIIIIIII    XA:i:1  MD:Z:3G9G22     NM:i:2




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
head -n 5 ff/chrY/1/hit.sam

==> ff/chrY/1/hit.sam <==
SRR005718.279:1:1:57:614#0      67      chrY    8826679 255     36M     =       8826682 39    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA     IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:0  MD:Z:29C1G4    NM:i:2
SRR005718.279:1:1:57:614#0      131     chrY    8826682 255     36M     =       8826679 -39   AAAAAAAAAAAAAAAAAAAAAAAAAACAACAAAACA     II,IIIIIIIIIII)I7III8IIIII4I)GIIIA(I    XA:i:0  MD:Z:28G0A4G1  NM:i:3
SRR005718.373:1:1:21:747#0      67      chrY    25207829        255     36M     =       25207844       51      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII  XA:i:0   MD:Z:36 NM:i:0
SRR005718.373:1:1:21:747#0      131     chrY    25207844        255     36M     =       25207829       -51     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII  XA:i:0   MD:Z:30G1T3     NM:i:2
SRR005718.568:1:1:366:41#0      67      chrY    14056476        255     36M     =       14056485       45      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII  XA:i:0   MD:Z:36 NM:i:0


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
head -n 5 rfx/chrY/1/hit.sam

==> rfx/chrY/1/hit.sam <==
SRR005718.17:1:1:770:515#0      147     chrY    23151090        255     36M     =       23153370   2316    GAGCTGCACAGAGGTATATGTCACAATTCACCTCTG    6IAH/9II>IIIIIIIIIIFIIIIIIIIIIIIIIII       XA:i:0  MD:Z:36 NM:i:0
SRR005718.17:1:1:770:515#0      99      chrY    23153370        255     36M     =       23151090   -2316   GAAACATTTCTGCAAAGGATAAAACATAATAAAAGA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIHIIIII       XA:i:0  MD:Z:36 NM:i:0
SRR005718.279:1:1:57:614#0      83      chrY    24420880        255     36M     =       24422479   1635    TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII       XA:i:0  MD:Z:36 NM:i:0
SRR005718.279:1:1:57:614#0      163     chrY    24422479        255     36M     =       24420880   -1635   AAAAAAAAAAAAAAAAAAAAAAAAAACAACAAAACA    II,IIIIIIIIIII)I7III8IIIII4I)GIIIA(I       XA:i:1  MD:Z:26A2A4A1   NM:i:3
SRR005718.316:1:1:886:179#0     83      chrY    13457352        255     36M     =       13458790   1474    CATTCCTTTCCATTTCATTCCATTCCATTCCATTCC    I322II7.?IIIC+III=IIIII;IIIIIIIIIIII       XA:i:1  MD:Z:6A7C21     NM:i:2


head -n 5 maq/chrY/1/hit.sam

==> maq/chrY/1/hit.sam <==
SRR005718.42448:1:3:244:883#0   137     chrY    5220    0       36M     *       0       0     CTCTGTCGTCCAGGCTGGAGTGCAGTGGCGCTATCT     IIIIIIIIIIIIIIIIII-I6II>IIIID;IG+;BI    MF:i:64 AM:i:0SM:i:0   NM:i:1  UQ:i:30 H0:i:5  H1:i:85
SRR005718.34166:1:2:971:666#0   73      chrY    5381    6       36M     *       0       0     TTTGGAGAGACGGGGTTTCACCATGTTTGCCAGGAT     IIIIIIIIIIIIII@(II8>226.>69.8>(/,+&6    MF:i:64 AM:i:0SM:i:6   NM:i:2  UQ:i:43 H0:i:0  H1:i:0
SRR005718.34166:1:2:971:666#0   133     chrY    5381    0       *       *       0       0     GCAGTACAGTACACAGCCTGCGTGGCCAATCATAGC     I$=I(.+=IIIFE)75056.,2*/(0,).$$+'')&    MF:i:192
SRR005718.15046:1:1:542:372#0   73      chrY    11727   0       36M     *       0       0     CCGGGCGCGGTGGCGGGCGCCTTTAGTCCCAGCTAC     IIIIIIIIIIIIIIIIIII7?I@I5?7.>5*,.5+1    MF:i:64 AM:i:0SM:i:0   NM:i:1  UQ:i:30 H0:i:0  H1:i:30
SRR005718.15046:1:1:542:372#0   133     chrY    11727   0       *       *       0       0     AAATTAAGGTTGGATATTTTTCATATCATAAAGTGT     IIIIIIIIIIIIIIIIIIIII=IIDIIAI;526;.H    MF:i:192



LOOK FOR ELAND HITS IN MAQ AND BOWTIE:


NO HITS IN BOWTIE FF

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test

grep -n "SRR005718.11:1:1:465:225" ff/chrY/1/hit.sam
grep -n "SRR005718.17:1:1:770:515" ff/chrY/1/hit.sam
grep -n "SRR005718.20:1:1:371:125" ff/chrY/1/hit.sam
grep -n "SRR005718.119:1:1:987:103" ff/chrY/1/hit.sam
grep -n "SRR005718.145:1:1:681:588" ff/chrY/1/hit.sam


NO HITS IN BOWTIE FFX

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test

grep -n "SRR005718.11:1:1:465:225" ffx/chrY/1/hit.sam
grep -n "SRR005718.17:1:1:770:515" ffx/chrY/1/hit.sam
grep -n "SRR005718.20:1:1:371:125" ffx/chrY/1/hit.sam
grep -n "SRR005718.119:1:1:987:103" ffx/chrY/1/hit.sam
grep -n "SRR005718.145:1:1:681:588" ffx/chrY/1/hit.sam


ONE HIT IN BOWTIE RFX

grep -n "SRR005718.11:1:1:465:225" rfx/chrY/1/hit.sam
grep -n "SRR005718.17:1:1:770:515" rfx/chrY/1/hit.sam
grep -n "SRR005718.20:1:1:371:125" rfx/chrY/1/hit.sam
grep -n "SRR005718.119:1:1:987:103" rfx/chrY/1/hit.sam
grep -n "SRR005718.145:1:1:681:588" rfx/chrY/1/hit.sam


grep -n "SRR005718.11:1:1:465:225" rfx/chrY/1/hit.sam
grep -n "SRR005718.17:1:1:770:515" rfx/chrY/1/hit.sam
grep -n "SRR005718.20:1:1:371:125" rfx/chrY/1/hit.sam
[syoung@u04 bowtie-test]$ grep -n "SRR005718.17:1:1:770:515" rfx/chrY/1/hit.sam
1:SRR005718.17:1:1:770:515#0    147     chrY    23151090        255     36M     =       23153370        231GAGCTGCACAGAGGTATATGTCACAATTCACCTCTG     6IAH/9II>IIIIIIIIIIFIIIIIIIIIIIIIIII    XA:i:0  MD:Z:36 NM:i:0
2:SRR005718.17:1:1:770:515#0    99      chrY    23153370        255     36M     =       23151090        -2316       GAAACATTTCTGCAAAGGATAAAACATAATAAAAGA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIHIIIII    XA:i:0  MD:Z:36 NM:i:0

TWO HITS IN MAQ

grep -n "SRR005718.11:1:1:465:225" maq/chrY/1/hit.sam
grep -n "SRR005718.17:1:1:770:515" maq/chrY/1/hit.sam
grep -n "SRR005718.20:1:1:371:125" maq/chrY/1/hit.sam
grep -n "SRR005718.119:1:1:987:103" maq/chrY/1/hit.sam
grep -n "SRR005718.145:1:1:681:588" maq/chrY/1/hit.sam

grep -n "SRR005718.17:1:1:770:515" maq/chrY/1/hit.sam

    10225:SRR005718.17:1:1:770:515#0        145     chrY    21560478        86      36M     *     2246     GAGCTGCACAGAGGTATATGTCACAATTCACCTCTG    6IAH/9II>IIIIIIIIIIFIIIIIIIIIIIIIIII    MF:i:4AM:i:86  SM:i:86 NM:i:0  UQ:i:0  H0:i:1  H1:i:0
    10227:SRR005718.17:1:1:770:515#0        97      chrY    21562758        89      36M     *     -2246    GAAACATTTCTGCAAAGGATAAAACATAATAAAAGA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIHIIIII    MF:i:4AM:i:86  SM:i:89 NM:i:0  UQ:i:0  H0:i:1  H1:i:0

grep -n "SRR005718.145:1:1:681:588" maq/chrY/1/hit.sam

    6661:SRR005718.145:1:1:681:588#0        73      chrY    12356460        16      36M     *     GAATGGAATGCAATAGTATGGAATGGAATCGAATGG     IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII53III    MF:i:64 AM:i:0SM:i:16  NM:i:0  UQ:i:0  H0:i:5  H1:i:26
    6662:SRR005718.145:1:1:681:588#0        133     chrY    12356460        0       *       *     TCAATTCCATTCCTTTCGTTTCCATTACATTTGATG     IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII6?I?    MF:i:192







CREATE INPUT FILES FOR TESTING samVenn.pl
-----------------------------------------

ELAND

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/data
rm -fr eland.sam
emacs eland.sam
SRR005718.11:1:1:465:225        73      chrY    2394143 69      36M     *       0       0     GCCTCCCAAAGCACTGGGGTTACAGGTATGAGTCAC     +++++++++++++++++++++++++++++++++#(&    MD:Z:22T3C5C3 SM:i:69
SRR005718.17:1:1:770:515        97      chrY    23153370        114     36M     =       23151090       -2244   GAAACATTTCTGCAAAGGATAAAACATAATAAAAGA    ++++++++++++++++++++++++++++++*+++++  MD:Z:36  SM:i:114
SRR005718.17:1:1:770:515        145     chrY    23151090        95      36M     =       23153370       2244    GAGCTGCACAGAGGTATATGTCACAATTCACCTCTG    !+%*!"++#++++++++++(++++++++++++++++  MD:Z:36  SM:i:95
SRR005718.20:1:1:371:125        137     chrY    1884567 4       36M     *       0       0     TTTATTTTATCTTATTTTATTTTATTTTGAGACAAG     ++++++++++++++++++++++++++++!%!&"+"+    MD:Z:10T23GA  SM:i:4
SRR005718.119:1:1:987:103       137     chrY    13644594        77      36M     *       0     TTCCATTCGATTCCGTTCAATGATTATTCCATTCGA     +++++++++++++++++++++++++++++"++++!(    MD:Z:14A3G15A1SM:i:77
SRR005718.145:1:1:681:588       137     chrY    58974834        61      36M     *       0     TCAATTCCATTCCTTTCGTTTCCATTACATTTGATG     ++++++++++++++++++++++++++++++++!$+$    MD:Z:18A7C7GT SM:i:61


BOWTIE --rf -X 3000

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/data
rm -fr rfx.sam
emacs rfx.sam
SRR005718.17:1:1:770:515#0      147     chrY    23151090        255     36M     =       23153370   2316    GAGCTGCACAGAGGTATATGTCACAATTCACCTCTG    6IAH/9II>IIIIIIIIIIFIIIIIIIIIIIIIIII       XA:i:0  MD:Z:36 NM:i:0
SRR005718.17:1:1:770:515#0      99      chrY    23153370        255     36M     =       23151090   -2316   GAAACATTTCTGCAAAGGATAAAACATAATAAAAGA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIHIIIII       XA:i:0  MD:Z:36 NM:i:0
SRR005718.279:1:1:57:614#0      83      chrY    24420880        255     36M     =       24422479   1635    TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII       XA:i:0  MD:Z:36 NM:i:0
SRR005718.279:1:1:57:614#0      163     chrY    24422479        255     36M     =       24420880   -1635   AAAAAAAAAAAAAAAAAAAAAAAAAACAACAAAACA    II,IIIIIIIIIII)I7III8IIIII4I)GIIIA(I       XA:i:1  MD:Z:26A2A4A1   NM:i:3
SRR005718.316:1:1:886:179#0     83      chrY    13457352        255     36M     =       13458790   1474    CATTCCTTTCCATTTCATTCCATTCCATTCCATTCC    I322II7.?IIIC+III=IIIII;IIIIIIIIIIII       XA:i:1  MD:Z:6A7C21     NM:i:2


MAQ

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/data
rm -fr maq.sam
emacs maq.sam
SRR005718.42448:1:3:244:883#0   137     chrY    5220    0       36M     *       0       0     CTCTGTCGTCCAGGCTGGAGTGCAGTGGCGCTATCT     IIIIIIIIIIIIIIIIII-I6II>IIIID;IG+;BI    MF:i:64 AM:i:0SM:i:0   NM:i:1  UQ:i:30 H0:i:5  H1:i:85
SRR005718.34166:1:2:971:666#0   73      chrY    5381    6       36M     *       0       0     TTTGGAGAGACGGGGTTTCACCATGTTTGCCAGGAT     IIIIIIIIIIIIII@(II8>226.>69.8>(/,+&6    MF:i:64 AM:i:0SM:i:6   NM:i:2  UQ:i:43 H0:i:0  H1:i:0
SRR005718.34166:1:2:971:666#0   133     chrY    5381    0       *       *       0       0     GCAGTACAGTACACAGCCTGCGTGGCCAATCATAGC     I$=I(.+=IIIFE)75056.,2*/(0,).$$+'')&    MF:i:192
SRR005718.15046:1:1:542:372#0   73      chrY    11727   0       36M     *       0       0     CCGGGCGCGGTGGCGGGCGCCTTTAGTCCCAGCTAC     IIIIIIIIIIIIIIIIIII7?I@I5?7.>5*,.5+1    MF:i:64 AM:i:0SM:i:0   NM:i:1  UQ:i:30 H0:i:0  H1:i:30
SRR005718.15046:1:1:542:372#0   133     chrY    11727   0       *       *       0       0     AAATTAAGGTTGGATATTTTTCATATCATAAAGTGT     IIIIIIIIIIIIIIIIIIIII=IIDIIAI;526;.H    MF:i:192



TEST samVenn.pl ELAND VS RFX
----------------------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-rfx
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-rfx

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/samVenn.pl \
--queryfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/data/eland.sam \
--targetfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/data/rfx.sam \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-rfx \
--querylabel eland \
--targetlabel rfx



COMPARE 1M READ HIT FILES
-------------------------

GET MAQ HITS:

/nethome/bioinfo/apps/agua/0.5/bin/apps/samHits.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/out.sam \
 | cut -f 1 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/hit.sam


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
ll */chrY/*/hit.sam

    -rw-rw-rw- 1 syoung root 279K Oct 13 16:52 eland/chr22/1/hit.sam
    -rw-rw-rw- 1 syoung root 2.1M Oct 13 18:19 maq/chr22/1/hit.sam
    -rw-rw-rw- 1 syoung root 214K Oct 13 18:42 rfx/chr22/1/hit.sam

    -rw-rw-rw- 1 syoung root 135K Oct 13 15:11 ff/chr22/1/hit.sam
    -rw-rw-rw- 1 syoung root 186K Oct 13 18:28 ffx/chr22/1/hit.sam
    -rw-rw-rw- 1 syoung root  37K Oct 13 15:12 fr/chr22/1/hit.sam
    -rw-rw-rw- 1 syoung root 110K Oct 13 18:28 frx/chr22/1/hit.sam
    -rw-rw-rw- 1 syoung root  25K Oct 13 15:12 rf/chr22/1/hit.sam

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
lines */chrY/*/hit.sam
    
    eland/chrY/1/hit.sam: 1518
    maq/chrY/1/hit.sam: 12193
    rfx/chrY/1/hit.sam: 1852

    ff/chrY/1/hit.sam: 788
    ffx/chrY/1/hit.sam: 1080
    fr/chrY/1/hit.sam: 238
    frx/chrY/1/hit.sam: 710
    rf/chrY/1/hit.sam: 212


lines */chr22/*/hit.sam

    eland/chr22/1/hit.sam: 1837
    maq/chr22/1/hit.sam: 12373
    rfx/chr22/1/hit.sam: 1276

    rf/chr22/1/hit.sam: 144
    ff/chr22/1/hit.sam: 820
    ffx/chr22/1/hit.sam: 1118
    fr/chr22/1/hit.sam: 216
    frx/chr22/1/hit.sam: 650

SUMMARY

    ELAND VS BOWTIE
    -rw-rw-rw- 1 syoung root 115K Oct 15 20:22 bowtie-NOT-eland
    -rw-rw-rw- 1 syoung root  79K Oct 15 20:22 eland-AND-bowtie
    -rw-rw-rw- 1 syoung root 206K Oct 15 20:22 eland-NOT-bowtie

    ELAND VS MAQ
    -rw-rw-rw- 1 syoung root 268K Oct 15 20:35 eland-AND-maq
    -rw-rw-rw- 1 syoung root  44K Oct 15 20:35 eland-NOT-maq
    -rw-rw-rw- 1 syoung root 1.6M Oct 15 20:35 maq-NOT-eland
    
    BOWTIE VS MAQ
    -rw-rw-rw- 1 syoung root 237K Oct 15 20:40 bowtie-AND-maq
    -rw-rw-rw- 1 syoung root  338 Oct 15 20:40 bowtie-NOT-maq
    -rw-rw-rw- 1 syoung root 1.8M Oct 15 20:40 maq-NOT-bowtie


    ELAND VS BOWTIE
    bowtie-NOT-eland: 680
    eland-AND-bowtie: 472
    eland-NOT-bowtie: 1365

    ELAND VS MAQ
    eland-AND-maq: 1554
    eland-NOT-maq: 283
    maq-NOT-eland: 9739    
    
    BOWTIE VS MAQ
    bowtie-AND-maq: 1274
    bowtie-NOT-maq: 2
    maq-NOT-bowtie: 11099


ELAND VS BOWTIE
---------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-bowtie
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-bowtie

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/samVenn.pl \
--queryfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/eland/chr22/1/hit.sam \
--targetfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rfx/chr22/1/hit.sam \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-bowtie \
--querylabel eland \
--targetlabel bowtie


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-bowtie

    -rw-rw-rw- 1 syoung root 115K Oct 15 20:22 bowtie-NOT-eland
    -rw-rw-rw- 1 syoung root  79K Oct 15 20:22 eland-AND-bowtie
    -rw-rw-rw- 1 syoung root 206K Oct 15 20:22 eland-NOT-bowtie

lines *
    
    bowtie-NOT-eland: 680
    eland-AND-bowtie: 472
    eland-NOT-bowtie: 1365

    eland/chr22/1/hit.sam: 1837
    maq/chr22/1/hit.sam: 12373
    rfx/chr22/1/hit.sam: 1276


ELAND VS MAQ 
------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-maq
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-maq

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/samVenn.pl \
--queryfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/eland/chr22/1/hit.sam \
--targetfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/chr22/1/hit.sam \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-maq \
--querylabel eland \
--targetlabel maq


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/eland-maq
    
    -rw-rw-rw- 1 syoung root 268K Oct 15 20:35 eland-AND-maq
    -rw-rw-rw- 1 syoung root  44K Oct 15 20:35 eland-NOT-maq
    -rw-rw-rw- 1 syoung root 1.6M Oct 15 20:35 maq-NOT-eland

lines *
    
    eland-AND-maq: 1554
    eland-NOT-maq: 283
    maq-NOT-eland: 9739    



PROBLEM





BOWTIE VS MAQ 
-------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/bowtie-maq
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/bowtie-maq

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/samVenn.pl \
--queryfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rfx/chr22/1/hit.sam \
--targetfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/chr22/1/hit.sam \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/bowtie-maq \
--querylabel bowtie \
--targetlabel maq

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/compare/bowtie-maq
    
    -rw-rw-rw- 1 syoung root 237K Oct 15 20:40 bowtie-AND-maq
    -rw-rw-rw- 1 syoung root  338 Oct 15 20:40 bowtie-NOT-maq
    -rw-rw-rw- 1 syoung root 1.8M Oct 15 20:40 maq-NOT-bowtie

lines *
    
    bowtie-AND-maq: 1274
    bowtie-NOT-maq: 2
    maq-NOT-bowtie: 11099


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test
lines */chrY/*/hit.sam
    
    eland/chrY/1/hit.sam: 1518
    maq/chrY/1/hit.sam: 12193
    rfx/chrY/1/hit.sam: 1852




SORT FILES
----------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/rfx/chr22/1
sort -t "." -k 1,1 -k 2,2n hit.sam -o hit.sam


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/maq/chr22/1
sort -t "." -k 1,1 -k 2,2n hit.sam -o hit.sam


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie-test/eland/chr22/1
sort -t "." -k 1,1 -k 2,2n hit.sam -o hit.sam




NOTES
-----

TRIED USING --fr AGAINST WHOLE GENOME BUT NO LUCK:


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

screen -S bowtie-autogenome-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie \
--params "--fr" \
--distance 2000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/autogenome-1.out 



</entry>



<entry [Tue Oct 12 14:12:44 EDT 2010] CHECK HIT COUNTS IN BOWTIE, ELAND AND MAQ autogenome RUNS >




INPUT FILES ARE 50M READS EACH:

lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt: 199999988


BOWTIE
------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

lines chr
/out.hitid
    
    chr1/out.hitid	820,531
    chr2/out.hitid	846,847
    chr3/out.hitid	563,993
    chr4/out.hitid	887,643
    chr5/out.hitid	521,603
    chr6/out.hitid	535,063
    chr7/out.hitid	670,337
    chr8/out.hitid	515,207
    chr9/out.hitid	553,121
    chr10/out.hitid	871,558
    chr11/out.hitid	535,721
    chr12/out.hitid	538,521
    chr13/out.hitid	368,727
    chr14/out.hitid	422,127
    chr15/out.hitid	441,977
    chr16/out.hitid	993,255
    chr17/out.hitid	493,843
    chr18/out.hitid	433,488
    chr19/out.hitid	539,393
    chr20/out.hitid	495,913
    chr21/out.hitid	422,774
    chr22/out.hitid	415,871
    chrX/out.hitid	497,919
    chrY/out.hitid	481,963
    
         total   13,867,395


ELAND
-----

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
lines chr*/out.hitid
    

MAQ
---

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
lines chr
/out.hitid

 cd ..
[syoung@u01 maq]$ lines chr*/out.hitid

chr10/out.hitid	31002599
chr11/out.hitid	28921277
chr12/out.hitid	29069073
chr13/out.hitid	25919309
chr14/out.hitid	26746333
chr15/out.hitid	26365969
chr16/out.hitid	28079171
chr17/out.hitid	26854845
chr18/out.hitid	26217341
chr19/out.hitid	25914969
chr1/out.hitid	33922743
chr20/out.hitid	26073083
chr21/out.hitid	24145945
chr22/out.hitid	23835811
chr2/out.hitid	33788003
chr3/out.hitid	30724293
chr4/out.hitid	30830123
chr5/out.hitid	29918393
chr6/out.hitid	29709187
chr7/out.hitid	30993015
chr8/out.hitid	29333487
chr9/out.hitid	28860297
chrX/out.hitid	27478955
chrY/out.hitid	23421325



bash-3.2$ cat out.hitct.bins

    71	1
    30667721	2
    41	3
    2018889	4
    10	5
    920136	6
    35	7
    665147	8
    8	9
    498875	10
    27	11
    432730	12
    73	13
    412526	14
    91	15
    285934	16
    9	17
    238916	18
    21	19
    214097	20
    20	21
    201115	22
    23	23
    182437	24
    28	25
    170915	26
    19	27
    199871	28
    14	29
    191802	30
    23	31
    269945	32
    20	33
    197600	34
    26	35
    201798	36
    64	37
    223609	38
    52	39
    261186	40
    228	41
    320580	42
    58	43
    413774	44
    27	45
    716053	46
    178	47
    9123997	48





TEST cumulative-7
----



mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-7

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-7

screen -S cumulative-7

perl /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl \
--inputdirs /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/1,/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2 \
--zipped gzip \
--samfile hit.sam.gz \
--outputdir /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-7 \
--species human \
--label cumulative-7 \
--walltime 24 \
--cluster LSF \
--queue large \
--cpus 1 \
--maxjobs 1000 \
--clean \
--stdout /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-7/cumulativeSNP-stdout.txt



</entry>



<entry [Sun Oct 10 01:26:37 EDT 2010] CREATED cumulativeSNP.pl TO GENERATE SNPs CUMULATIVELY FROM A SERIES OF OUTPUT .sam FILES>





1. COPY FILES TO /scratch

E.G.: COPY
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/1

TO
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/1

COMMAND:

NGSDIR=/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland
SCRATCHDIR=/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland
SUBDIR=chr22
cd $NGSDIR
DIRS="*"
for DIR in $DIRS;
do
    if [ -d $NGSDIR/$DIR ]; then
    
        echo "NGSDIR/DIR: " $NGSDIR/$DIR
        echo "creating directory: " $SCRATCHDIR/$DIR/$SUBDIR;
        mkdir -p $SCRATCHDIR/$DIR/$SUBDIR;
    fi;

    echo "cp $NGSDIR/$DIR/$SUBDIR/hit.sam* $SCRATCHDIR/$DIR/$SUBDIR"
    cp $NGSDIR/$DIR/$SUBDIR/hit.sam* $SCRATCHDIR/$DIR/$SUBDIR
    
done;


OUTPUT:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland
ll */chr22/hit.sam.gz

    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 10/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 11/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 12/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 13/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 14/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 15/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 16/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 17/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 18/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 19/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 157M Oct 13 13:22 1/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 20/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 21/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 22/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 23/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 24/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 25/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 26/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 27/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 28/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 29/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:23 2/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 30/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 31/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 32/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 33/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 3/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 4/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 5/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 6/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 7/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 8/chr22/hit.sam.gz
    -rw-rw-r-- 1 syoung root 119M Oct 13 13:24 9/chr22/hit.sam.gz


ELAND
-----

screen -r cumulative-5-eland

screen -S cumulative-5-eland

perl /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl \
--inputdirs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/1,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/3,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/4,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/5,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/6,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/7,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/8,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/9,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/10,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/11,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/12,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/13,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/14,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/15,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/16,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/17,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/18,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/19,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/20,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/21,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/22,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/23,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/24,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/25,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/26,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/27,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/28,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/29,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/30,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/31,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/32,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/33 \
--zipped gzip \
--samfile hit.sam.gz \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative \
--species human \
--label cumulative-5 \
--walltime 48 \
--cluster LSF \
--queue large \
--cpus 1 \
--maxjobs 1000 \
--clean \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/cumulativeSNP-stdout.txt

    cumulativeSNP.pl    Run time: 17:07:19
    cumulativeSNP.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl
    cumulativeSNP.pl    6:48AM, 14 October 2010
    cumulativeSNP.pl    ****************************************

cd 

    -rw-rw-rw- 1 syoung root 2.5M Oct 13 15:00 hit-10.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 15:20 hit-11.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 15:41 hit-12.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 16:05 hit-13.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 16:30 hit-14.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 16:56 hit-15.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 17:25 hit-16.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 17:56 hit-17.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 18:28 hit-18.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 19:04 hit-19.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 13 13:42 hit-1.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 19:40 hit-20.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 20:19 hit-21.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 21:00 hit-22.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 21:44 hit-23.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 22:28 hit-24.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 23:17 hit-25.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 14 00:06 hit-26.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 00:57 hit-27.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 01:50 hit-28.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 02:45 hit-29.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 03:41 hit-30.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 04:42 hit-31.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 05:45 hit-32.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 06:48 hit-33.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 13 13:47 hit-3.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 13 13:55 hit-4.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 13 13:55 hit-5.snp
    -rw-rw-rw- 1 syoung root 2.0M Oct 13 14:04 hit-6.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 14:15 hit-7.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 14:28 hit-8.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 14:42 hit-9.snp


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland
ll */chr22/hit*.snp
        
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 15:00 cumulative-5/chr22/hit-10.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 15:20 cumulative-5/chr22/hit-11.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 15:41 cumulative-5/chr22/hit-12.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 16:05 cumulative-5/chr22/hit-13.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 16:30 cumulative-5/chr22/hit-14.snp
    -rw-rw-rw- 1 syoung root 2.5M Oct 13 16:56 cumulative-5/chr22/hit-15.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 17:25 cumulative-5/chr22/hit-16.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 17:56 cumulative-5/chr22/hit-17.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 18:28 cumulative-5/chr22/hit-18.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 19:04 cumulative-5/chr22/hit-19.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 13 13:42 cumulative-5/chr22/hit-1.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 19:40 cumulative-5/chr22/hit-20.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 20:19 cumulative-5/chr22/hit-21.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 21:00 cumulative-5/chr22/hit-22.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 21:44 cumulative-5/chr22/hit-23.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 22:28 cumulative-5/chr22/hit-24.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 23:17 cumulative-5/chr22/hit-25.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 14 00:06 cumulative-5/chr22/hit-26.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 00:57 cumulative-5/chr22/hit-27.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 01:50 cumulative-5/chr22/hit-28.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 02:45 cumulative-5/chr22/hit-29.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 03:41 cumulative-5/chr22/hit-30.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 04:42 cumulative-5/chr22/hit-31.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 05:45 cumulative-5/chr22/hit-32.snp
    -rw-rw-rw- 1 syoung root 2.1M Oct 14 06:48 cumulative-5/chr22/hit-33.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 13 13:47 cumulative-5/chr22/hit-3.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 13 13:55 cumulative-5/chr22/hit-4.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 13 13:55 cumulative-5/chr22/hit-5.snp
    -rw-rw-rw- 1 syoung root 2.0M Oct 13 14:04 cumulative-5/chr22/hit-6.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 13 14:15 cumulative-5/chr22/hit-7.snp
    -rw-rw-rw- 1 syoung root 2.3M Oct 13 14:28 cumulative-5/chr22/hit-8.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 13 14:42 cumulative-5/chr22/hit-9.snp
    


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland
lines */chr22/hit*.snp

    cumulative-5/chr22/hit-1.snp: 24284
    cumulative-5/chr22/hit-2.snp: -     #### MANUALY ADDED THIS MISSING ONE
    cumulative-5/chr22/hit-3.snp: 18250
    cumulative-5/chr22/hit-4.snp: 21206
    cumulative-5/chr22/hit-5.snp: 21206
    cumulative-5/chr22/hit-6.snp: 22896
    cumulative-5/chr22/hit-7.snp: 24081
    cumulative-5/chr22/hit-8.snp: 24676
    cumulative-5/chr22/hit-9.snp: 25129
    cumulative-5/chr22/hit-10.snp: 25330
    cumulative-5/chr22/hit-11.snp: 25418
    cumulative-5/chr22/hit-12.snp: 25339
    cumulative-5/chr22/hit-13.snp: 25249
    cumulative-5/chr22/hit-14.snp: 25086
    cumulative-5/chr22/hit-15.snp: 24827
    cumulative-5/chr22/hit-16.snp: 24524
    cumulative-5/chr22/hit-17.snp: 24287
    cumulative-5/chr22/hit-18.snp: 23855
    cumulative-5/chr22/hit-19.snp: 23599
    cumulative-5/chr22/hit-20.snp: 23338
    cumulative-5/chr22/hit-21.snp: 23145
    cumulative-5/chr22/hit-22.snp: 22840
    cumulative-5/chr22/hit-23.snp: 22611
    cumulative-5/chr22/hit-24.snp: 22261
    cumulative-5/chr22/hit-25.snp: 21930
    cumulative-5/chr22/hit-26.snp: 21815
    cumulative-5/chr22/hit-27.snp: 21656
    cumulative-5/chr22/hit-28.snp: 21414
    cumulative-5/chr22/hit-29.snp: 21221
    cumulative-5/chr22/hit-30.snp: 21000
    cumulative-5/chr22/hit-31.snp: 20816
    cumulative-5/chr22/hit-32.snp: 20619
    cumulative-5/chr22/hit-33.snp: 20468


1	24284
2	-     
3	18250
4	21206
5	21206
6	22896
7	24081
8	24676
9	25129
10	25330
11	25418
12	25339
13	25249
14	25086
15	24827
16	24524
17	24287
18	23855
19	23599
20	23338
21	23145
22	22840
23	22611
24	22261
25	21930
26	21815
27	21656
28	21414
29	21221
30	21000
31	20816
32	20619
33	20468


    
head -n 3 *snp

==> hit-1.snp <==
chr22   16050612        c       G       35      35      60      4       GGGg    ++++
chr22   16051724        c       A       20      30      49      31      A..,...AaAaaa.aAaaaa.aaaaaa^zG^iA^Ja^zG ++++++#+'++!&+"+!!"++!+#!&+++"+
chr22   16051777        g       A       38      38      46      21      A$A$A$A$ACAAttAAA.A.AAAA^.a     !"++!!(!++!+&+!+++++$

==> hit-3.snp <==
chr22   16050612        c       G       34      34      51      7       GgGG.Gg #++++++
chr22   16051724        c       A       46      54      43      54      A..,,...a.aaAaAaaaAaaaa.AAaAaAaaaa.aAa,AaaaAAaaaa^BA^zG^iA^Ja^zG        ++++!++#!++!+!+!+'+"+!&+++"+!+!!"++!+!!++!#++!!&++++"+
chr22   16051777        g       A       31      31      39      33      A$A$A$A$A$AACAA,A.ttAAA,..AAA.,AAAaaA^.a        !!"++!!!(!$#!++!+&++!!+!+!+++!(+$

==> hit-4.snp <==
chr22   16050408        T       C       25      25      47      9       .cc,cCc.^pc     !++!$#+++
chr22   16050612        c       G       40      41      48      9       GggGGG.Gg       #&+++++++
chr22   16051107        c       A       21      21      41      13      A.AaaA,a.a,Aa   +!!++++!+(%"%

==> hit-5.snp <==
chr22   16050408        T       C       25      25      47      9       .cc,cCc.^pc     !++!$#+++
chr22   16050612        c       G       40      41      48      9       GggGGG.Gg       #&+++++++
chr22   16051107        c       A       21      21      41      13      A.AaaA,a.a,Aa   +!!++++!+(%"%

==> hit-6.snp <==
chr22   16050408        T       C       23      23      44      14      .cc.,.,CcCcc.^pc        !++!+!!&$#&+++
chr22   16050612        c       G       35      35      43      12      G$,GggGGG.Ggg   !+#&+++++++!
chr22   16051107        c       A       25      25      40      22      A$AA.AAaaA,,a.a,AaaA,,, !+!!#!+++++!+(%""%+!!!

==> hit-7.snp <==
chr22   16050612        c       G       32      32      41      17      G$.G,GgggGGG.Gggg.      !!!+#+&+++++++!!+
chr22   16050678        c       T       20      20      43      20      .$ttttT.t...ttT,t,,tT   !++"+++"!+!"!+!!+"!+
chr22   16051107        c       A       23      23      38      25      A$AaA.AAaaA,,,a.a,Aa.aA,,,      !++!!#!++++'+!+(%""#%+!!!

==> hit-8.snp <==
chr22   16050612        c       G       37      41      39      19      G$.G,gGgggGGG.GGggg.    !!!++#+&++++++++!!+
chr22   16051107        c       A       24      24      38      27      A$AaA.AAAaaA,a,,a.a,Aa.aA,,,    !++!!!#!++++"'+!+(%""#%+!!!
chr22   16051209        a       G       7       20      41      83      .$g$t$G.GgGG.,GGGG.GGGGGG,.,gTGGcG,gtGT,G.G.g.G.GG,T,Gg,g.G.GG.GT.gGgG..GGGG,Gg,G..G,^vg        !++!!!!!!++!!!!!!!!!!++!++!!#+!++)!!"!!!!!!&!+"%!+!++!"!!$!!%!!!+$+!+!#"+$"+!++!+++

==> hit-9.snp <==
chr22   16050612        c       G       36      42      38      23      G$.G,gGgggGGG..GGGggggt.        !!!++#+&++++$++++!+!!!+
chr22   16051107        c       A       26      27      39      31      A$AaA.AAAaaA,a,,a.a,AaA.aAa,,,.A        !++!!!#!++++"'+!+(%""+#%+!!!!++
chr22   16051209        a       G       11      24      42      92      G$.$g$t$GG.GgGG.GG.,GGGG.GGGGGG,.,gTGGcG,gtGGT,G.G.g.G.GGg,T,Gg,g.G.GG.GT.gGgGG..GGGG,Gg,G..GG,^vg      !!++!!!!!!!!!+++!!!!!!!!!!++!++!!#+!++)!!!"!!!!!!&!+"!%!+!++!"!!$!!%!!!+$+!!+!#"+$"+!++!++++

==> hit-10.snp <==
chr22   16050612        c       G       41      48      38      26      G$.gG,gGggGgGGG..GGGggggt,.     !!+!++#+&(++++$++++!+!!!!+
chr22   16051107        c       A       28      31      38      36      A$AaaA.AaAAaaA,a,,a.,a,AAaA.aAAa,,,.A   !+++!!!+#!++++"'+!++(%"""+#%++!!!!++
chr22   16052777        c       T       23      23      36      52      ,$T$TTTTTTTTTTTTTTTTTTTTttt,T,T,,t,TTG,,T.,T,.,T,TTt,,  ++!!"!!#!#+"%+'+"!+%!+++++!+"++++++!'*(!+&++'+"++!!"

==> hit-11.snp <==
chr22   16050408        T       C       22      22      43      27      .cCc.,.,cC,cCC,..cCcc..c,c^pc   !+!+!+!!+&&$+#!+%'+&+++"!!+
chr22   16050612        c       G       45      53      36      29      G$g.GgG,gGggGgGGG..GGGg,gggt,.  !+!)+!++#+&(++++$++++!!+!!!!+
chr22   16051107        c       A       30      33      38      40      A$AaaA.AaAAaaA,a,,a.,aa,AAaA.aaAAa,,a,.A^5,     !+++!!!+#!++++"'+!+++(%"""+#!%++!!!!!++!

==> hit-12.snp <==
chr22   16050408        T       C       22      22      42      28      .cCc.,.,cC,cCC.,..cCcc..c,c^pc  !+!+!+!!+&&$+#%!+%'+&+++"!!+
chr22   16050612        c       G       47      52      36      30      G$g.GgG,gGggGgGGGG..GGGg,gggt,. !+!)+!++#+&(+++$+$++++!!+!!!!+
chr22   16051107        c       A       31      34      38      44      A$AaaA.aAaAAaaA,a,,Aa.,a,a,AAaAa.aaAAa,,a,.A^5, !+++!!!!+#!++++"'+!!++++(%"""+'#!%++!!!!!++!

==> hit-13.snp <==
chr22   16050036        a       C       22      22      43      30      CCCCcC.CtcCcC.c.cCc,,.c,CctCC^iC        !!$!+!!!++!+&+"+!+"+++!!&!!+++
chr22   16050408        T       C       20      20      43      31      .ccCc.,.c,cC,cCC..,..cCcc..c,c^pc       !++!+!+!+!+&&$+#%+!+%'+&+++"!!+
chr22   16050612        c       G       49      54      36      32      G$g.GgG,gGggGgGG.GGG..GGGg,gggt,.       !+!)+!++#+&(+++!$++$++++!!+!!!!+

==> hit-14.snp <==
chr22   16050036        a       C       29      32      44      32      CCCCcC.CCtcCcC.c.cCc,,.c,CcctCC^iC      !!$!+!!!+++!+&+"+!+"+++!!&+!!+++
chr22   16050408        T       C       28      28      43      36      .ccCc.,.c,CcC,cCC..,..cCcc.C,C.,c,c^pc  !++!+!+!+!"+&&$+#%+!+%'+&+++!!+!"!!+
chr22   16050612        c       G       56      61      36      36      G$g.gGgG,gGggGgGG.GGGg..GgGGg,gggt,.a   !+!&)+!++#+&(+++!$+++$++!++!!+!!!!++

==> hit-15.snp <==
chr22   16050036        a       C       29      32      44      32      CCCCcC.CCtcCcC.c.cCc,,.c,CcctCC^iC      !!$!+!!!+++!+&+"+!+"+++!!&+!!+++
chr22   16050408        T       C       31      31      44      39      .cccCc.,.c,CcC,cCC..,..cCcc..C,C.c,c,c^pc       !+++!+!+!+!"+&&$+#%+!+%'+&++++!!++!"!!+
chr22   16050612        c       G       61      62      36      38      G$g.gGgG,gGggGgGG.GGGGg..GgGGGg,gggt,.a !+!&)+!++#+&(+++!+$+++$++!&++!!+!!!!++

==> hit-16.snp <==
chr22   16050036        a       C       29      32      44      33      CCCCcC.CCCtcCcC.c.cCc,,.c,CcctCC^iC     !!$!+!!!+!++!+&+"+!+"+++!!&+!!+++
chr22   16050408        T       C       31      31      44      39      .cccCc.,.c,CcC,cCC..,..cCcc..C,C.c,c,c^pc       !+++!+!+!+!"+&&$+#%+!+%'+&++++!!++!"!!+
chr22   16050612        c       G       61      61      36      40      G$g.gGgG,gGggGgGG.GGGGg..GggGG.Gg,gggt,.a       !+!&)+!++#+&(+++!+$+++$++#!&+++!!+!!!!++

==> hit-17.snp <==
chr22   16050036        a       C       29      32      44      33      CCCCcC.CCCtcCcC.c.cCc,,.c,CcctCC^iC     !!$!+!!!+!++!+&+"+!+"+++!!&+!!+++
chr22   16050612        c       G       62      62      36      43      G$g.gGgG,gGggGgGG.GGGGgg..GGggGG.Gg,gggt,.,a    !+!&)+!++#+&(+++!+$++!+$+++#!&+++!!+!!!!+!+
chr22   16051107        c       A       34      35      38      67      A$t$a$Aa,aaA.aa.AAaaAAAAAAaaA,a,a,,,Aa..,.aaA,Aa,,aAA,aAa.aaAAa,,a,.A^5,        !+++++++!!+!"!!++#!!!!+++++++"'"+!!+++!++++!(%$!""#"+'#!%++!!!!!++!

==> hit-18.snp <==
chr22   16050036        a       C       29      32      44      33      CCCCcC.CCCtcCcC.c.cCc,,.c,CcctCC^iC     !!$!+!!!+!++!+&+"+!+"+++!!&+!!+++
chr22   16050612        c       G       64      64      36      45      G$g.gGgG,gGggGgGG.GGGGgg..GGggGGG.Gg,ggGgt,.,a  !+!&)+!++#+&(+++!+$++!+$+++#!&!+++!!+!+!!!+!+
chr22   16051107        c       A       33      33      38      71      A$a$t$a$Aa,aaA.aaa.AAaaAAAAAAaaA,a,a,,,Aa..,.aaA,Aa,,aAA,aAa.,aaAAa,,a,,.A^5,   !"+++++++!!++!"!!++#!!!!+++++++"'"+!!+++!++++!(%$!""#"+'#+!%++!!!!%!++!

==> hit-19.snp <==
chr22   16050036        a       C       32      35      44      34      CCCCcC.CCCtcCccC.c.cCc,,.c,CcctCC^iC    !!$!+!!!+!++!++&+"+!+"+++!!&+!!+++
chr22   16050612        c       G       57      57      35      47      G$g.,gGgG,gGggGgGG.GGGGgg..GGgggGGG.Gg,ggGgt,.,a        !+!+&)+!++#+&(+++!+$++!+$+++!#!&!+++!!+!+!!!+!+
chr22   16051107        c       A       30      30      38      75      A$a$t$a$Aa,aaA.aaaA.AAaaAAAAAAAaaA,a,a,,,Aa..,.,aaA,Aa,.,aAA,aAa.,aaAAa,,a,,.A^5,       !"+++++++!!++!!"!!++!#!!!!+++++++"'"+!!+++!+++++!(%!$!""#"+'#+!%++!!!!%!++!

==> hit-20.snp <==
chr22   16050036        a       C       34      38      43      35      CCCCcC.CCCtcCccCC.c.cCc,,.c,CcctCC^iC   !!$!+!!!+!++!++&*+"+!+"+++!!&+!!+++
chr22   16050612        c       G       58      58      36      50      G$g.,g.GgG,gGggGgGG.GGGGggG..GGgggGGG.Gg,ggGgGt,.,a     !+!+&!)+!++#+&(+++!+$++!++$+++!#!&!+++!!+!+!+!!+!+
chr22   16051107        c       A       28      28      38      77      A$a$t$a$Aa,aaA.aaaA.AAaaAAAAAAAaaA,,a,a,,,Aa..,.,aaA,Aa,.,aAA,aA,a.,aaAAa,,a,,.A^5,     !"+++++++!!++!!"!!++!#!!!!++++++++"'"+!!+++!+++++!(%!$!""#"+''#+!%++!!!!%!++!

==> hit-21.snp <==
chr22   16050036        a       C       37      42      42      37      CCCCcC.CCCctcCccCCC.c.cCc,,.c,CcctCC^iC !!$!+!!!+!+++!++!&*+"+!+"+++!!&+!!+++
chr22   16050408        T       C       21      21      42      49      .$.c.ccCc.,,,.c,CcC,cCC.C.C.,.C.cC,cc..C,C..c,c,c^pc    $!+"++!+!!++!+!"+&&$+"+#%'+!+%%'++&++++!!+$+!"!!+
chr22   16050612        c       G       55      55      36      52      G$g.,g.GgG,gGggGgGGG.GGGGggG...GGgggGGG.Gg,ggGgGt,.,a   !+!+&!)+!++#+&(++++!+$++!++$++++!#!&!+++!!+!+!+!!+!+

==> hit-22.snp <==
chr22   16050036        a       C       37      42      41      39      CCCCcC.CCCctcCccCCC.cC.cCc,,.c,CcctCCc^iC       !!$!+!!!+!+++!++!&*+"!+!+"+++!!&+!!++!+
chr22   16050612        c       G       55      55      36      53      G$g.,g.GgG,gGGggGgGGG.GGGGggG...GGgggGGG.Gg,ggGgGt,.,a  !+!+&!)+!++!#+&(++++!+$++!++$++++!#!&!+++!!+!+!+!!+!+
chr22   16051107        c       A       31      31      38      87      A$a$a$t$a$Aa,aaA.aaaaTA.AAaaAAAAAAAAAAAaaA,,a,a,,,Aa..,.,aaA,Aa,.,aAA,a.A,a.,aaAAa,a,aA,,.A^5,  !+"+++++++!!+++!!!"!!++!!!#!!!!!!++++++++"'"+!!+++!+++++!(%!$!""#"%+''#+!%++!!!!!+%!++!

==> hit-23.snp <==
chr22   16050036        a       C       37      42      41      40      CCCCcC.CCCctcCccCCCC.cC.cCc,,.c,CcctCCc^iC      !!$!+!!!+!+++!++!&!*+"!+!+"+++!!&+!!++!+
chr22   16050612        c       G       59      59      37      58      G$Gg.,gg.GgG,gGGggGg.gGG.G.GGGGggG...GGgggGGG.Gg,ggGgGt,.,a     !!+!++&!)+!++!#+&(+!+++!+!+$++!++$++++!#!&!+++!!+!+!+!!+!+
chr22   16051107        c       A       24      24      38      90      A$a$a$t$a$Ata,aaA.aaaaTA.AAaaaAAAAAAAAAAAaaA,,a,a,,,A,a..,.,aaA,Aa,.,aAA,a.A,a.,aaAAa,a,aA,,.A^5,       !+"+++"++++!!+++!!!"!!&++!!!#!!!!!!++++++++"'"+!+!+++!+++++!(%!$!""#"%+''#+!%++!!!!!+%!++!

==> hit-24.snp <==
chr22   16050036        a       C       37      42      41      40      CCCCcC.CCCctcCccCCCC.cC.cCc,,.c,CcctCCc^iC      !!$!+!!!+!+++!++!&!*+"!+!+"+++!!&+!!++!+
chr22   16050612        c       G       59      59      36      60      G$Gg.G,gg.GgG,gGGggGg.gGgG.G.GGGGggG...GGgggGGG.Gg,ggGgGt,.,a   !!+!!++&!)+!++!#+&(+!++$+!+!+$++!++$++++!#!&!+++!!+!+!+!!+!+
chr22   16051107        c       A       30      30      38      96      A$a$a$t$a$Ata,aaA.aaaaaTA.AAaaaAAAAAAAAAAAAaaAa,,a,a,,,AA,a..,.,aaAA,Aa,.,aAA,a.A,a.,aaAAa,a,aA,,.A^8a^5,       !+"+++"++++!!'+++!!!"!!&++!!!#!!!!+!!+++++++++"'"++!+!+++!++++++!(%!$!""#"%+''#+!%++!!!!!+%!++!!

==> hit-25.snp <==
chr22   16050036        a       C       37      42      40      44      .$CCCCcC.CCCCctcCCccCCCC.cC.cCc,,.c,CcctCCcc^iC !!!$!+!!!+!!+++!!++!&!*+"!+!+"+++!!&+!!++!!+
chr22   16050612        c       G       56      56      36      63      G$Gg.G,gg.GgG,g.GGggGg.gGgG.G.GGGGggG..,.GGgggGGG.Gg,ggG.gGt,.,a        !!+!!++&!)+!++!!#+&(+!++$+!+!+$++!++$+!+++!#!&!+++!!+!++!+!!+!+
chr22   16051107        c       A       27      27      38      100     A$a$a$t$a$Ata,aaA.aaaaaTA.AAaaaAAAAAAAAAAAAaaAa,,a,a,,,AA,a..,.,aaAA,Aa,.,aAAA,a.A,a.,aa.AAa,a,aA,,A.A^+a^8a^5, !+"+++"++++!!'+++!!!"!!&++!!!#!!!!+!!+++++++++"'"++!+!+++!++++++!(%!$!""$#"%+''#+!%*++!!!!!+%!+++!!!

==> hit-26.snp <==
chr22   16050036        a       C       40      44      40      46      .$CCCCcC.CCCCctcCCccCCCCc.cC.cCc,,c.c,CcctCCcc^iC       !!!$!+!!!+!!+++!!++!&!*!+"!+!+"++)+!!&+!!++!!+
chr22   16050612        c       G       56      56      36      65      G$Gg.G,gg.GgG,g.GGggGg.gGgGG.G.GGGGggG..,.GGgggGGG.Gg,ggGg.gGt,.,a      !!+!!++&!)+!++!!#+&(+!++$!+!+!+$++!++$+!+++!#!&!+++!!+!+!+!+!!+!+
chr22   16053317        G       C       37      37      35      33      c$,.C.CcCccccCC,ccCCCCCcc,,.cccc.^5,    ++!+!!+!++++!+!+!"+++'"!!++!!!"+!

==> hit-27.snp <==
chr22   16050036        a       C       40      44      39      49      .$CCCCcC.CCCCctcCCcccCCCCc.cC.cCc,,,c.c,CcctCCccc^iC    !!!$!+!!!+!!+++!!++!!&!*!+"!+!+"++!)+!!&+!!++!!!+
chr22   16050612        c       G       56      56      35      67      G$Gg.G,gg.GgG,g.GGggGGg.gGgGG.G.GGGGggG..,.GGgggGGG.Gg,ggGg.gGt,.,,a    !!+!!++&!)+!++!!#+&!(+!++$!+!+!+$++!++$+!+++!#!&!+++!!+!+!+!+!!+!!+
chr22   16053317        G       C       40      40      34      35      c$,.CC.CcCccccCC,ccCCCCCcc,,C.cccc.^5,  ++!!+!!+!++++!+!+!"+++'"!!+++!!!"+!

==> hit-28.snp <==
chr22   16050036        a       C       33      47      40      51      .$CCCCcC.CCTCCctcCCcccCCCCc.cC.cCc,,,c.cc,CcctCCccc^iC  !!!$!+!!!++!!+++!!++!!&!*!+"!+!+"++!)+!!!&+!!++!!!+
chr22   16050612        c       G       59      59      35      69      G$Gg.G,ggg.GgG,g.GGggGGg.gGgGG.G.GGGGggG..,.GGgggGGGG.Gg,ggGg.gGt,.,,a  !!+!!+++&!)+!++!!#+&!(+!++$!+!+!+$++!++$+!+++!#!+&!+++!!+!+!+!+!!+!!+
chr22   16053317        G       C       40      40      34      35      c$,.CC.CcCccccCC,ccCCCCCcc,,C.cccc.^5,  ++!!+!!+!++++!+!+!"+++'"!!+++!!!"+!

==> hit-29.snp <==
chr22   16050036        a       C       36      47      39      53      .$CCCCcC.CCCTCCctcCCcccCCCCc.cC.cCc,,,c.cc,cCcctCCccc^iC        !!!$!+!!!+&+!!+++!!++!!&!*!+"!+!+"++!)+!!!!&+!!++!!!+
chr22   16050408        T       C       20      22      43      72      .$.c.ccCc...c,,,.cc,Cc.CC,cCCCC.cC,..C.,.,c,,.C.cC,ccc..CC,C...cc.c,c,c^Oc^pc   $!+"++!+$(!+!++!++!"+!+&&$++"+++#!+%'+!+!!($+%%'++&+!++++!!+++$"$+!"!!++
chr22   16050612        c       G       58      58      35      71      G$Gg.G,ggg.GgG,g.GGggGGg.gGgGG.GG.GGGGggG..,.GGgggGGGG.Gg,ggGg.gGt,,.,,a        !!+!!+++&!)+!++!!#+&!(+!++$!+!+#!+$++!++$+!+++!#!+&!+++!!+!+!+!+!!!+!!+

==> hit-30.snp <==
chr22   16050036        a       C       36      47      39      54      .$CCCCcC.CCCTCCctcCCcccCCCCc.cC.ccCc,,,c.cc,cCcctCCccc^iC       !!!$!+!!!+&+!!+++!!++!!&!*!+"!+!!+"++!)+!!!!&+!!++!!!+
chr22   16050612        c       G       58      58      35      72      G$GgG.G,ggg.GgG,g.GGggGGg.gGgGG.GG.GGGGggG..,.GGgggGGGG.Gg,ggGg.gGt,,.,,a       !!+!!!+++&!)+!++!!#+&!(+!++$!+!+#!+$++!++$+!+++!#!+&!+++!!+!+!+!+!!!+!!+
chr22   16053317        G       C       35      35      34      40      c$,,..CC.CcCcccccCC,C,ccCCCCCcc,,C.cccc.^5,     +++!!!+!!+!+++++!++%!+!"+++'"!!+++!!!"+!

==> hit-31.snp <==
chr22   16050036        a       C       36      47      39      55      .$CCCCcCC.CCCTCCctcCCcccCCCCc.cC.ccCc,,,c.cc,cCcctCCccc^iC      !!!$!+!!!!+&+!!+++!!++!!&!*!+"!+!!+"++!)+!!!!&+!!++!!!+
chr22   16050612        c       G       56      56      36      76      G$GgG.G,ggg.GgG,g.GGggGGg.gGgGG.GG.gGGGGg.gG..,..GGgggGGGG.Gg,ggGg.g,Gt,,.,,a   !!+!!!+++&!)+!++!!#+&!(+!++$!+!+#!&+$++!&++$+!*+++!#!+&!+++!!+!+!+!!+!!!+!!+
chr22   16053317        G       C       32      32      33      41      c$,,..CC.CcCcccccCC,C,ccCCCCCcc,,.C.cccc.^5,    +++!!!+!!+!+++++!++%!+!"+++'"!!++++!!!"+!

==> hit-32.snp <==
chr22   16050036        a       C       42      48      38      59      .$CCCCcCC.CCCTCCctcTCCCcccCCCCCc.ccC.ccCc,,,c.cc,cCcctCCccc^iC  !!!$!+!!!!+&+!!+++!!!!++!!&"!*!+""!+!!+"++!)+!!!!&+!!++!!!+
chr22   16050612        c       G       50      50      36      77      G$GgG.G,ggg.GgG,g.GGgg,GGg.gGgGG.GG.gGGGGg.gG..,..GGgggGGGG.Gg,ggGg.g,Gt,,.,,a  !!+!!!+++&!)+!++!!#+&+!(+!++$!+!+#!&+$++!&++$+!*+++!#!+&!+++!!+!+!+!!+!!!+!!+
chr22   16053317        G       C       24      24      34      44      c$,,..CC.CCcCcccccCC,C,ccCCCC.Ccc,,.C..cccc.^5, +++!!!+!!!+!+++++!++%!+!"++++'"!!+++++!!!"+!

==> hit-33.snp <==
chr22   16050036        a       C       45      51      38      60      .$CCCCcCC.CCCTCCctcTCCcCcccCCCCCc.ccC.ccCc,,,c.cc,cCcctCCccc^iC !!!$!+!!!!+&+!!+++!!!+!++!!&"!*!+""!+!!+"++!)+!!!!&+!!++!!!+
chr22   16050612        c       G       50      50      35      79      G$GgG.G,gggG.GgG,g.GGgg,GGg.gGgGG.GG.gGGGGg.gG..,..GGgggGGGGg.Gg,ggGg.g,Gt,,.,,a        !!+!!!+++&!!)+!++!!#+&+!(+!++$!+!+#!&+$++!&++$+!*+++!#!+&!+!++!!+!+!+!!+!!!+!!+
chr22   16053659        A       C       57      57      34      33      C$c$cccccccCcCCcCccCCCcCcCcCcccccc^Zc   !++++++++!+!!+!&++'$+!""!!+!!!!!!




PILEUP FORMAT (USES -c OPTION OF samtools pileup)
http://samtools.sourceforge.net/cns0.shtml
    
    
    The `ten-column`__ pileup incoroporates additional consensus information generated with *-c* option of *samtools pileup* command::
    
    
        1    2  3  4   5   6   7   8       9       10
     ------------------------------------------------
     chrM  412  A  A  75   0  25  2       .,       II
     chrM  413  G  G  72   0  25  4     ..t,     IIIH
     chrM  414  C  C  75   0  25  4     ...a     III2
     chrM  415  C  T  75  75  25  4     TTTt     III7
    
    where::
    
      Column Definition
     ------- ----------------------------
           1 Chromosome
           2 Position (1-based)
           3 Reference base at that position
           4 Consensus bases
           5 Consensus quality
           6 SNP quality
           7 Maximum mapping quality
           8 Coverage (# reads aligning over that position)
           9 Bases within reads where (see Galaxy wiki for more info)
          10 Quality values (phred33 scale, see Galaxy wiki for more)


BACKUP:

TARRED AND ZIPPED *.bam FILES

screen -S eland-tar
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22
tar cvfz eland-cumulative-5-bam.tar.gz merged.bam*
tar cvfz eland-cumulative-5-snp.tar.gz *.snp

    -rw-rw-r-- 1 syoung root   62G Oct 19 12:41 eland-cumulative-5-bam.tar.gz
    -rw-rw-r-- 1 syoung root   28M Oct 18 11:43 eland-cumulative-5-snp.tar.gz


COPIED TO nethome ON PEGASUS

mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/eland-cumulative-5-snp.tar.gz \
/nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative
    
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative/chr22/eland-cumulative-5-bam.tar.gz \
/nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative


MOVED TO /ngs/bioinfo

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland






MAQ
---

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6


screen -S cumulative-6-maq

perl /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl \
--inputdirs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/1,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/2,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/3,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/4,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/5,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/6,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/7,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/8,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/9,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/10,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/11,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/12,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/13,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/14,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/15,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/16,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/17,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/18,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/19,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/20,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/21,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/22,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/23,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/24,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/25,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/26,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/27,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/28,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/29,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/30,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/31,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/32,\
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/33 \
--zipped gzip \
--samfile hit.sam.gz \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6 \
--species human \
--label cumulative-6 \
--walltime 48 \
--cluster LSF \
--queue large \
--cpus 1 \
--maxjobs 1000 \
--clean \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/cumulativeSNP-stdout.txt


    ...
    > --stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/cumulativeSNP-stdout.txt
    cumulativeSNP.pl    Printing STDOUT to stdoutfile:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/cumulativeSNP-stdout.txt
    
    LSF is down. Please wait ...


***** RERAN. RUNNING Mon Oct 18 11:49:22 EDT 2010

KILLED AT FILE 28 BECAUSE WAS HANGING AT hit-18.snp


    SNP::bamSnps    Running jobs:
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22/cumulativeSnp-chr22-28.sh
    Job <2190593> is submitted to queue <large>.


    
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22

    -rw-rw-rw- 1 syoung root 1.1M Oct 18 12:05 hit-1.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 12:14 hit-2.snp
    -rw-rw-rw- 1 syoung root    0 Oct 18 12:30 hit-4.snp
    -rw-rw-rw- 1 syoung root    0 Oct 18 12:30 hit-3.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 13:00 hit-5.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 18 13:48 hit-6.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 18 14:02 hit-7.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 18 15:05 hit-8.snp
    -rw-rw-rw- 1 syoung root 1.2M Oct 18 16:24 hit-9.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 18:05 hit-10.snp
    -rw-rw-rw- 1 syoung root 994K Oct 18 20:02 hit-11.snp
    -rw-rw-rw- 1 syoung root 973K Oct 18 22:10 hit-12.snp
    -rw-rw-rw- 1 syoung root 996K Oct 19 00:52 hit-13.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 19 03:58 hit-14.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 19 06:53 hit-15.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 19 10:09 hit-16.snp



STILL RUNNING
Tue Oct 19 10:34:24 EDT 2010

OUTPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22

    -rw-rw-rw- 1 syoung root 1.1M Oct 18 12:05 hit-1.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 12:14 hit-2.snp
    -rw-rw-rw- 1 syoung root    0 Oct 18 12:30 hit-3.snp
    -rw-rw-rw- 1 syoung root    0 Oct 18 12:30 hit-4.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 13:00 hit-5.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 18 13:48 hit-6.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 18 14:02 hit-7.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 18 15:05 hit-8.snp
    -rw-rw-rw- 1 syoung root 1.2M Oct 18 16:24 hit-9.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 18 18:05 hit-10.snp
    -rw-rw-rw- 1 syoung root 994K Oct 18 20:02 hit-11.snp
    -rw-rw-rw- 1 syoung root 973K Oct 18 22:10 hit-12.snp
    -rw-rw-rw- 1 syoung root 996K Oct 19 00:52 hit-13.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 19 03:58 hit-14.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 19 06:53 hit-15.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 19 10:09 hit-16.snp
    -rw-rw-rw- 1 syoung root 1.2M Oct 19 17:59 hit-18.snp




CHECK INPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq

ll */chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 16:26 10/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 18:07 11/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 20:04 12/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 22:13 13/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 00:54 14/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 04:00 15/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 06:54 16/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 10:13 17/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 14:11 18/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 18:01 19/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 11:51 1/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 19 22:01 20/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 02:02 21/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 06:02 22/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 10:02 23/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 14:03 24/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 18:04 25/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 20 22:05 26/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 21 02:05 27/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 21 06:06 28/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 17 19:25 29/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 17 23:25 30/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 03:27 31/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 03:27 32/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 07:26 33/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 12:16 3/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 12:15 4/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 12:32 5/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 13:02 6/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 14:04 8/chr22/hit.sam
    -rw-rw-rw- 1 syoung root 3.9G Oct 18 15:07 9/chr22/hit.sam

ll */chr22/hit.snp
    -rw-rw-rw- 1 syoung root  12K Oct  8 16:41 10/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 21:27 11/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 00:17 12/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 02:37 13/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 05:29 14/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 07:51 15/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 09:59 16/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 04:13 17/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 06:27 18/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 08:32 19/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 02:43 1/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 10:51 20/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 12:56 21/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 15:25 22/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 17:48 23/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 20:09 24/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 22:30 25/chr22/hit.snp
    -rw-rw-rw- 1 syoung root  12K Oct 10 23:25 26/chr22/hit.snp
    -rw-rw-rw- 1 syoung root  12K Oct 11 00:16 27/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 11 02:36 28/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 11 04:42 29/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 11 06:58 30/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 11 09:03 31/chr22/hit.snp
    -rw-rw-rw- 1 syoung root  11K Oct 11 09:59 32/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 11 12:00 33/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 05:08 3/chr22/hit.snp
    -rw-rw-rw- 1 syoung root  12K Oct  8 06:06 4/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 08:25 5/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 11:00 6/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 13:30 8/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 15:43 9/chr22/hit.snp

ll */chr22/hit.bam
    -rw-r--r-- 1 syoung root 1.2G Oct 18 11:55 1/chr22/hit.bam
    -rw-r--r-- 1 syoung root  20G Oct 20 18:02 24/chr22/hit.bam
    -rw-r--r-- 1 syoung root  15G Oct 20 22:02 25/chr22/hit.bam
    -rw-r--r-- 1 syoung root 8.9G Oct 21 02:03 26/chr22/hit.bam
    -rw-r--r-- 1 syoung root  15G Oct 21 06:03 27/chr22/hit.bam
    -rw-r--r-- 1 syoung root 1.2G Oct 21 06:12 28/chr22/hit.bam
    -rw-r--r-- 1 syoung root  21G Oct 17 23:23 29/chr22/hit.bam
    -rw-r--r-- 1 syoung root  14G Oct 18 07:24 31/chr22/hit.bam
    -rw-r--r-- 1 syoung root  15G Oct 18 07:24 32/chr22/hit.bam
    -rw-r--r-- 1 syoung root  20G Oct 18 11:25 33/chr22/hit.bam

ll */chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.3G Oct  8 16:16 10/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 21:02 11/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 23:48 12/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  9 02:05 13/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  9 05:01 14/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  9 07:17 15/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  9 09:33 16/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 03:37 17/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 06:00 18/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 08:07 19/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 02:15 1/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 10:17 20/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 12:38 21/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 14:44 22/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 17:16 23/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 19:38 24/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 21:57 25/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.3G Oct 10 22:58 26/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.3G Oct 10 23:49 27/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 11 02:04 28/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 11 04:13 29/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 11 06:28 30/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 11 08:45 31/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 11 09:34 32/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 11 11:46 33/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 04:36 3/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.3G Oct  8 05:40 4/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 07:58 5/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 10:36 6/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 13:06 8/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct  8 15:21 9/chr22/hit.sam.gz


SINGLE *.snp FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
ls -al */chr22/hit.sam.gz

    -rw-rw-rw- 1 syoung root 1288652954 Oct  8 16:16 10/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236569586 Oct  8 21:02 11/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236760659 Oct  8 23:48 12/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236725498 Oct  9 02:05 13/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236421617 Oct  9 05:01 14/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236679034 Oct  9 07:17 15/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236822497 Oct  9 09:33 16/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236719660 Oct 10 03:37 17/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236478843 Oct 10 06:00 18/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236463600 Oct 10 08:07 19/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1235991440 Oct  8 02:15 1/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236396717 Oct 10 10:17 20/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236635803 Oct 10 12:38 21/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236416918 Oct 10 14:44 22/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236953280 Oct 10 17:16 23/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1237188179 Oct 10 19:38 24/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236712973 Oct 10 21:57 25/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1288743778 Oct 10 22:58 26/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1288897171 Oct 10 23:49 27/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236549301 Oct 11 02:04 28/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236284499 Oct 11 04:13 29/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236357485 Oct 11 06:28 30/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236281063 Oct 11 08:45 31/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1288372252 Oct 11 09:34 32/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1237136044 Oct 11 11:46 33/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236404952 Oct  8 04:36 3/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1289006310 Oct  8 05:40 4/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236777790 Oct  8 07:58 5/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236463132 Oct  8 10:36 6/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1236635374 Oct  8 13:06 8/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1237028340 Oct  8 15:21 9/chr22/hit.sam.gz


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
ls -al */chr22/hit.snp

    -rw-rw-rw- 1 syoung root   12044 Oct  8 16:41 10/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1118993 Oct  8 21:27 11/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1106089 Oct  9 00:17 12/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1109184 Oct  9 02:37 13/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1126690 Oct  9 05:29 14/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1114866 Oct  9 07:51 15/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1115884 Oct  9 09:59 16/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1119023 Oct 10 04:13 17/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1114382 Oct 10 06:27 18/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1122947 Oct 10 08:32 19/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1112021 Oct  8 02:43 1/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1115895 Oct 10 10:51 20/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1131859 Oct 10 12:56 21/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1129464 Oct 10 15:25 22/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1117707 Oct 10 17:48 23/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1124960 Oct 10 20:09 24/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1125130 Oct 10 22:30 25/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   11596 Oct 10 23:25 26/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   12175 Oct 11 00:16 27/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1113852 Oct 11 02:36 28/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1109066 Oct 11 04:42 29/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1104549 Oct 11 06:58 30/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1121934 Oct 11 09:03 31/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   10760 Oct 11 09:59 32/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1109548 Oct 11 12:00 33/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1127413 Oct  8 05:08 3/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   11301 Oct  8 06:06 4/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1122911 Oct  8 08:25 5/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1121805 Oct  8 11:00 6/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1131667 Oct  8 13:30 8/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1120749 Oct  8 15:43 9/chr22/hit.snp


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
lines */chr22/hit.snp

    1/chr22/hit.snp: 25164
    3/chr22/hit.snp: 25453
    4/chr22/hit.snp: 261
    5/chr22/hit.snp: 25424
    6/chr22/hit.snp: 25412
    8/chr22/hit.snp: 25615
    9/chr22/hit.snp: 25423
    10/chr22/hit.snp: 281
    11/chr22/hit.snp: 25362
    12/chr22/hit.snp: 25024
    13/chr22/hit.snp: 25135
    14/chr22/hit.snp: 25525
    15/chr22/hit.snp: 25309
    16/chr22/hit.snp: 25309
    17/chr22/hit.snp: 25357
    18/chr22/hit.snp: 25248
    19/chr22/hit.snp: 25498
    20/chr22/hit.snp: 25255
    21/chr22/hit.snp: 25633
    22/chr22/hit.snp: 25574
    23/chr22/hit.snp: 25372
    24/chr22/hit.snp: 25555
    25/chr22/hit.snp: 25533
    26/chr22/hit.snp: 274
    27/chr22/hit.snp: 283
    28/chr22/hit.snp: 25272
    29/chr22/hit.snp: 25150
    30/chr22/hit.snp: 25025
    31/chr22/hit.snp: 25454
    32/chr22/hit.snp: 246
    33/chr22/hit.snp: 25187



1	25164
3	25453
4	261
5	25424
6	25412
8	25615
9	25423
10	281
11	25362
12	25024
13	25135
14	25525
15	25309
16	25309
17	25357
18	25248
19	25498
20	25255
21	25633
22	25574
23	25372
24	25555
25	25533
26	274
27	283
28	25272
29	25150
30	25025
31	25454
32	246
33	25187



BACKUP:

TARRED AND ZIPPED *.bam AND *.snp FILES

screen -S maq-tar
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22
tar cvfz maq-cumulative-6-snp.tar.gz *.snp

    OK
    
tar cvfz maq-cumulative-6-bam.tar.gz merged.bam*

    FAILED

    merged.bam
    merged.bam-1
    merged.bam-10
    merged.bam-11
    merged.bam-12
    merged.bam-13
    merged.bam-14
    merged.bam-15
    merged.bam-16
    merged.bam-18
    merged.bam-2
    merged.bam-20
    merged.bam-26
    merged.bam-28
    merged.bam-3
    merged.bam-30
    merged.bam-4
    merged.bam-5
    merged.bam-6
    merged.bam-7
    merged.bam-8
    merged.bam-9
    merged.bam.temp
    tar: merged.bam.temp: file changed as we read it


COPIED TO nethome ON PEGASUS

mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22/maq-cumulative-6-snp.tar.gz \
/nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6




#cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22/maq-cumulative-6-bam.tar.gz \
#/nethome/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6



MOVED TO /ngs/bioinfo

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22/maq-cumulative-6-snp.tar.gz \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq




#mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/cumulative-6/chr22/maq-cumulative-6-bam.tar.gz \
#/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq





NOTES
----- 



PROBLEM

RUN FAILS WITHOUT ANY STDOUT OR ERROR MESSAGE 


DIAGNOSIS

/ngs IS NOT MOUNTED ON THE EXECUTION HOSTS
RUN SHOWS THAT EXECUTION HOST CANNOT LIST FILES ON /ngs:

emacs test3.sh
#!/bin/sh

echo "running"
echo "list /scratch"
echo `ls /scratch/syoung/base/pipeline`;
echo "list /ngs"
echo `ls /ngs/bioinfo/syoung/base/pipeline`;
echo "completed"


bsub -q large -o /scratch/syoung/base/pipeline/lsf/out.txt -e /scratch/syoung/base/pipeline/lsf/err.txt < test3.sh

OUTPUT:

    running
    list /scratch
    catfilter data du.txt hiseq lemmon lsf piqa SRA
    list /ngs
    
    completed


SOLUTION

COPY INPUT FILES FROM /ngs/bioinfo TO /scratch 






COMPARISON OF SAM AND BAM INTERMEDIARY FILE MERGE METHODS
---------------------------------------------------------
SAM MERGE METHOD
----------------

mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-3

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-3

screen -S cumulative-SAM

perl /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl \
--inputdirs /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/1,/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2 \
--zipped gzip \
--samfile hit.sam.gz \
--outputdir /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-3 \
--species human \
--label cumulative-3 \
--walltime 48 \
--cluster LSF \
--queue large \
--cpus 1 \
--maxjobs 1000 \
--clean \
--stdout /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-3/cumulativeSNP-stdout.txt



time ./cumulativeSnp-chr22-1.sh 

FILE 1

    MERGE SAM
    real    0m13.131s
    user    0m5.409s
    sys     0m1.304s
    
    COPY SAM
    real    0m7.959s
    user    0m0.023s
    sys     0m1.475s
    
    GZIP FILE
    real    0m49.938s
    user    0m48.798s
    sys     0m0.520s
    
    CALL SNPS
    ?
    
    TOTAL
    real    1m58.604s
    user    2m5.424s
    sys     0m4.285s


FILE 2

    MERGE SAM    
    real    0m9.369s
    user    0m3.936s
    sys     0m1.046s
    
    SORT SAM
    real    16m8.603s
    user    16m1.518s
    sys     0m5.332s
    
    COPY SAM
    real    0m12.653s
    user    0m0.045s
    sys     0m1.982s
    
    GZIP FILE
    real    1m24.399s
    user    1m22.547s
    sys     0m1.059s
    
    CALL SNPS
    ?
    
    TOTAL
    real    19m4.199s
    user    19m8.937s
    sys     0m10.816s






BAM MERGE METHOD
----------------

mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-4

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-4

screen -S cumulative-BAM

perl /nethome/bioinfo/apps/agua/0.5/bin/apps/snp/cumulativeSnp.pl \
--inputdirs /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/1,/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/2 \
--zipped gzip \
--samfile hit.sam.gz \
--outputdir /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-4 \
--species human \
--label cumulative-4 \
--walltime 48 \
--cluster LSF \
--queue large \
--cpus 1 \
--maxjobs 1000 \
--clean \
--stdout /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-4/cumulativeSNP-stdout.txt



cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-4/chr22
./cumulativeSnp-chr22-1.sh

FILE 1

    UNZIP SAM
    real    0m12.951s
    user    0m5.523s
    sys     0m0.804s
    
    CONVERT SAM TO BAM
    real    0m48.136s
    user    0m46.186s
    sys     0m1.170s
    
    COPY BAM
    real    0m2.236s
    user    0m0.014s
    sys     0m0.357s
    
    COPY TO merged-1.bam
    real    0m2.223s
    user    0m0.011s
    sys     0m0.357s
    
    CALL SNPS
    ?
    
    TOTAL
    ?


FILE 2

    UNZIP SAM
    real    0m9.836s
    user    0m3.996s
    sys     0m0.844s
    
    CONVERT SAM TO BAM
    real    0m37.411s
    user    0m35.487s
    sys     0m1.446s
    
    MERGE BAM
    real    1m19.502s
    user    1m16.989s
    sys     0m1.609s
    
    SORT BAM
    real    2m44.449s
    user    2m40.816s
    sys     0m2.493s
    
    MOVE TO MERGEDFILE
    real    0m0.035s
    user    0m0.001s
    sys     0m0.019s
    
    COPY MERGEDFILE
    real    0m3.955s
    user    0m0.018s
    sys     0m0.630s
    
    TOTAL
    real    5m52.448s
    user    6m1.643s
    sys     0m8.111s



COMPARE OUTPUT FOR MERGE SAM AND MERGE BAM METHODS
--------------------------------------------------

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-2/chr22

ls -al *

    -rw-rw-r--+ 1 syoung bioinfo   6076692 Oct 12 20:30 hit-1.filter
    -rw-rw-r--+ 1 syoung bioinfo  46067154 Oct 12 20:30 hit-1.raw
    -rw-rw-r--+ 1 syoung bioinfo   1558623 Oct 12 20:30 hit-1.snp
    -rw-rw-r--+ 1 syoung bioinfo 178443232 Oct 12 17:33 merged.bam
    -rw-rw-r--+ 1 syoung bioinfo 178443232 Oct 12 20:29 merged.bam-1


ls -al ../../cumulative-1/chr22/
    -rw-rw-r--+ 1 syoung bioinfo    6076692 Oct 12 12:38 hit-1.filter
    -rw-rw-r--+ 1 syoung bioinfo   46067154 Oct 12 12:38 hit-1.raw
    -rw-rw-r--+ 1 syoung bioinfo    1558623 Oct 12 12:41 hit-1.snp
    -rw-rw-r--+ 1 syoung bioinfo    7931776 Oct 12 16:14 hit-2.filter
    -rw-rw-r--+ 1 syoung bioinfo   60092814 Oct 12 16:14 hit-2.raw
    -rw-rw-r--+ 1 syoung bioinfo    1962981 Oct 12 16:14 hit-2.snp
    -rw-rw-r--+ 1 syoung bioinfo 1040750811 Oct 12 14:09 merged.sam
    -rw-rw-r--+ 1 syoung bioinfo  164286753 Oct 12 12:33 merged.sam-1.gz
    -rw-rw-r--+ 1 syoung bioinfo  285198202 Oct 12 16:00 merged.sam-2.gz

diff hit-1.snp ../../cumulative-1/chr22/hit-1.snp
    
    OK!


cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-2/chr22
ll
    -rw-rw-r--+ 1 syoung bioinfo 5.8M Oct 12 20:30 hit-1.filter
    -rw-rw-r--+ 1 syoung bioinfo  44M Oct 12 20:30 hit-1.raw
    -rw-rw-r--+ 1 syoung bioinfo 1.5M Oct 12 20:30 hit-1.snp
    -rw-rw-r--+ 1 syoung bioinfo 7.6M Oct 12 20:53 hit-2.filter
    -rw-rw-r--+ 1 syoung bioinfo  58M Oct 12 20:53 hit-2.raw
    -rw-rw-r--+ 1 syoung bioinfo 1.9M Oct 12 20:53 hit-2.snp
    -rw-r--r--+ 1 syoung bioinfo 295M Oct 12 20:50 merged.bam
    -rw-rw-r--+ 1 syoung bioinfo 171M Oct 12 20:29 merged.bam-1
    -rw-r--r--+ 1 syoung bioinfo 295M Oct 12 20:52 merged.bam-2
    -rw-r--r--+ 1 syoung bioinfo 295M Oct 12 20:44 merged.bam.temp
    -rw-rw-r--+ 1 syoung bioinfo 2.6M Oct 12 20:55 out

diff hit-2.snp ../../cumulative-1/chr22/hit-2.snp > out

    2,4c2,4
    < chr22 16051724        c       A       21      33      46      45      AA.,,.,...AAaaAaaaa.aA\
    Aaaaa.aaaAaaAaaa^zG^iA^7a^Ja^zG^)a^Pa     !++++++++#+++'++!!&+"++!!"++!!!++#+!&+++!"+!!
    < chr22 16051777        g       A       41      41      41      33      A$A$A$A$A$A$ACA.AAttAA\
    A.,,A.aaAAAAAA^.a^.a^8a   !!!"++!!(!!+++!+&+(%!+*!+++"++!$"
    < chr22 16051778        g       A       45      45      40      29      A$A$A$.AAttAAAA,,A.aaA\
    AAAAAaaa^mA^/A    "!!!!+++!+++&++*""++++++$!!++
    ---
    > chr22 16051724        c       A       21      33      46      45      AA.,,.,...AAaaAaaaa.aA\
    AaaaaaaA.aaaAaaa^7a^)a^Pa^zG^iA^Ja^zG     !++++++++#+++'++!!&+"++!!"+!!++!+#+!&+!!!++"+
    > chr22 16051777        g       A       41      41      41      33      A$A$A$A$A$A$ACA.AAttAA\
    A.,,A.aaAAAAAA^.a^.a^8a   !!!"++!!(!+!++!+&+(%!+*!+++"++$!"
    > chr22 16051778        g       A       45      45      40      29      A$A$A$.AAttAAAA,,A.aaA\
    AAAAAaaa^/A^mA    "!!!+!++!+++&++*""++++++!$!++
    8,9c8,9
    < chr22 16058064        a       G       22      23      32      42      G$GG,.GgGggGggGgG.,gGG\
    G.GG.,gg,,g..,GG,..,G     +'!+!"+!+!"+"!+)"+%!+"!"+!++"+++!++!"!'+++
    < chr22 16058332        t       C       17      20      39      33      A$C$C$C$CC.cC,.ccCCCC.\
    c.cc,,.CcC,C,,^~. !!!!!!!+!!++$!")+'++++!+++++""!++
    ---
    > chr22 16058064        a       G       22      23      32      42      G$GG,.GgGgGggggGG.,gGG\
    .GGG.,gg,,g..,GG,,..G     +'!+!"+!!"+"++!)"+%!+!""+!++"+++!++!"!+'++
    > chr22 16058332        t       C       17      20      39      33      C$C$A$C$CC.cC,.ccCCC.C\
    c.c,c,.Cc,CC,,^~. !!!!!!!+!!++$!")'++++!+++++"+"!++
    11,14c11,14
    < chr22 16058706        a       G       16      29      46      20      ,$C.gG.GGCGg.ggg,,.GG \
      ++$+"+&!+++!++++#"++
    < chr22 16058883        a       G       33      33      42      18      G.GGGGggG,ggggg^eg^Cg^\
    Rg        !$++"+&%+!&!!!!+!+
    < chr22 16059725        g       T       14      29      42      32      A.t,..Tt,T,,TTt,ttTTTA\
    ATTT.AC,.,        !!++!!++++"++++++%!+++++!+!+%#+!
    < chr22 16060278        t       A       37      40      36      16      ,,.AaAaAaa,aaAAA      \
      ++!++!+!"+!!++"+
    ---
    > chr22 16058706        a       G       16      29      46      20      ,$C.gG.GGCGggg.g,,.GG \
      ++$+"+&!+++++!++#"++
    > chr22 16058883        a       G       33      33      42      18      G.GGGGggG,ggggg^eg^Cg^\
    Rg        !$++"+&%+!!&!!!+!+
    > chr22 16059725        g       T       14      29      42      32      .At,..Tt,,T,TT,tttTTTA\
    ATTT.CA,.,        !!++!!+++"+++++++%!+++++!+!%+#+!
    > chr22 16060278        t       A       37      40      36      16      ,,.AaAaaaAa,aAAA      \
      ++!++!"++!!!++"+
    16,17c16,17


ALTHOUGH THE HEAD AND TAIL ARE ESSENTIALLY THE SAME (NOTE THE SLIGHT DIFFERENCE AT THE END OF RECORD 16051778):

ls -al hit-2.snp ../../cumulative-1/chr22/hit-2.snp

    -rw-rw-r--+ 1 syoung bioinfo 1962981 Oct 12 16:14 ../../cumulative-1/chr22/hit-2.snp
    -rw-rw-r--+ 1 syoung bioinfo 1962981 Oct 12 20:53 hit-2.snp


head hit-2.snp ../../cumulative-1/chr22/hit-2.snp

    ==> hit-2.snp <==
    chr22   16050612        c       G       40      40      47      7       GG,Gg,G ++!++!+
    chr22   16051724        c       A       21      33      46      45      AA.,,.,...AAaaAaaaa.aAAaaaa.aaaAaaAaaa^zG^iA^7a^Ja^zG^)a^Pa    !++++++++#+++'++!!&+"++!!"++!!!++#+!&+++!"+!!
    chr22   16051777        g       A       41      41      41      33      A$A$A$A$A$A$ACA.AAttAAA.,,A.aaAAAAAA^.a^.a^8a  !!!"++!!(!!+++!+&+(%!+*!+++"++!$"
    chr22   16051778        g       A       45      45      40      29      A$A$A$.AAttAAAA,,A.aaAAAAAAaaa^mA^/A   "!!!!+++!+++&++*""++++++$!!++
    chr22   16053624        G       A       28      28      52      3       aAA     +++
    chr22   16053659        A       C       39      39      52      8       cccCcCcc        ++++!$!"
    chr22   16054740        A       G       30      30      59      5       GGggg   %++%(
    chr22   16058064        a       G       22      23      32      42      G$GG,.GgGggGggGgG.,gGGG.GG.,gg,,g..,GG,..,G    +'!+!"+!+!"+"!+)"+%!+"!"+!++"+++!++!"!'+++
    chr22   16058332        t       C       17      20      39      33      A$C$C$C$CC.cC,.ccCCCC.c.cc,,.CcC,C,,^~.        !!!!!!!+!!++$!")+'++++!+++++""!++
    chr22   16058415        a       G       28      28      56      4       gGgG    +"(+
    
    ==> ../../cumulative-1/chr22/hit-2.snp <==
    chr22   16050612        c       G       40      40      47      7       GG,Gg,G ++!++!+
    chr22   16051724        c       A       21      33      46      45      AA.,,.,...AAaaAaaaa.aAAaaaaaaA.aaaAaaa^7a^)a^Pa^zG^iA^Ja^zG    !++++++++#+++'++!!&+"++!!"+!!++!+#+!&+!!!++"+
    chr22   16051777        g       A       41      41      41      33      A$A$A$A$A$A$ACA.AAttAAA.,,A.aaAAAAAA^.a^.a^8a  !!!"++!!(!+!++!+&+(%!+*!+++"++$!"
    chr22   16051778        g       A       45      45      40      29      A$A$A$.AAttAAAA,,A.aaAAAAAAaaa^/A^mA   "!!!+!++!+++&++*""++++++!$!++
    chr22   16053624        G       A       28      28      52      3       aAA     +++
    chr22   16053659        A       C       39      39      52      8       cccCcCcc        ++++!$!"
    chr22   16054740        A       G       30      30      59      5       GGggg   %++%(
    chr22   16058064        a       G       22      23      32      42      G$GG,.GgGgGggggGG.,gGG.GGG.,gg,,g..,GG,,..G    +'!+!"+!!"+"++!)"+%!+!""+!++"+++!++!"!+'++
    chr22   16058332        t       C       17      20      39      33      C$C$A$C$CC.cC,.ccCCC.Cc.c,c,.Cc,CC,,^~.        !!!!!!!+!!++$!")'++++!+++++"+"!++
    chr22   16058415        a       G       28      28      56      4       gGgG    +"(+


tail hit-2.snp ../../cumulative-1/chr22/hit-2.snp

    ==> hit-2.snp <==
    chr22   51242559        c       T       52      53      46      31      T$t$t.tt.tT,T,,TTtTttTTTtTt,tttt^7.    &+#+++!!%!+++!)++!"+++++!!+%!!!
    chr22   51242616        a       C       62      62      44      43      c$,$CcCccCCcccC.ccc,CccC,cCCcccCcCCCCcccccC^7C^-c      ++!++++!!++&!+#+++(+*+++!+#!&"!++++"!"+!++!
    chr22   51243045        a       G       27      35      50      40      ggG,,ggGgGgG.g,gggGgg,g,,GG.gg,gGGggg,,^<g     +"!++++++++"+!++"#++++!+!++++!++++!!!++!
    chr22   51243181        c       T       76      76      43      43      t$t$t$t$T$TTTTttT.t.TTTTTTTtTTATTTT,TTTTTTtT,tTt       ++++*!!"!++*!+!+!!!"!+!!!!!"++!+!+)+#!+!"++
    chr22   51243297        a       T       57      65      44      35      t$t$T$TTTtTtTTTTTtTTTTtTtTTTTTTTtTtcT^bt       ++"$#"+"++++++++%++%&++++++++!+&++"
    chr22   51243373        a       G       39      42      47      49      .$,gGGGggG.gg,.,,g,tGG,G,gg,g,gg.GG.g,gg,gGgggg,g^F,   !++++++!'+++#!+++"+!++++++!++++!++(+++!!+++"+!++"
    chr22   51243520        g       A       56      56      42      42      T$AAaaaAA,aAaAAAa,aaaAAAa.aa,A,AA,AAAaaaAAa    !!!+++!#++!+"!'"!+&+++++"+'#+!++"+'++)!++!
    chr22   51243639        c       T       53      53      44      49      T$T$T$t$ttTTTTt.,TtTTTtt.TTT.tTttTTTTTTTttTTtTttttt^2T^`T      !"!+++!!(!++++%!+!++")!""+!!+!"+++$+"$"+!+"!!$+++
    chr22   51244018        A       G       21      21      55      16      G$G$.ggGg.g,.g,,,,    +++++"+!+++++!!!
    chr22   51244424        t       C       66      66      51      51      c$C$C$cCCCc.,cCccc,ccCc.cCc,cCcCcccCCCCCcCcC,cCccccC^Oa^`C     +++++!&++++++++++++++!"#+++++!!(+++++!+++!!+!!+++"+

    ==> ../../cumulative-1/chr22/hit-2.snp <==
    chr22   51242559        c       T       52      53      46      31      T$t$t.tt.tT,T,,TTtTttTTTtTt,tttt^7.    &+#+++!!%!+++!)++!"+++++!!+%!!!
    chr22   51242616        a       C       62      62      44      43      c$,$CcCccCCcccC.ccc,Ccc,CcCcCccCcCCCCcccccC^7C^-c      ++!++++!!+&+!+#+++(+*+++!#+!&"!++++"!"+!++!
    chr22   51243045        a       G       27      35      50      40      ggG,,ggGgGgGg.,gggGgg,g,,GG.gg,gGGggg,,^<g     +"!++++++++"!++"+#++++!+!++++!++++!!!++!
    chr22   51243181        c       T       76      76      43      43      t$t$t$t$T$TTTTttT.t.TTTTTTtTTTATTTT,TTTTTTtT,tTt       ++++*!!"!++*!+!+!!"!!!!+!!!"++!!++)+#!+!"++
    chr22   51243297        a       T       57      65      44      35      t$T$t$TTTttTTTTTTtTTTTtTtTTTTTTTtTtcT^bt       +"+$#"++"+++++++%++%&++++++++!+&++"
    chr22   51243373        a       G       39      42      47      49      .$,gGGGggGg.,g.,,g,,tGGGg,g,g,gg.GG.,ggg,gGgggg,g^F,   !++++++!'++#+!+++"++!+++++!++++!++(+++!!++"++!++"
    chr22   51243520        g       A       56      56      42      42      T$AaAaaA,aAAaAAAa,aaaAAAaa.a,AA,,AAAAaaaAaA    !!+!++!++#!+"!'"!+&++++++"'!++"#++'+)+!+!+
    chr22   51243639        c       T       53      53      44      49      T$T$T$t$ttTTTTt.,tTTTTtt.TTTt.TttTTTTTTTttTTtTttttt^2T^`T      !"!+++!!(!+++%!++!++"!)"+"!!+!"+++$+"$"+!+"!!$+++
    chr22   51244018        A       G       21      21      55      16      G$G$g.gGg.g,.g,,,,    +++++"+!+++++!!!
    chr22   51244424        t       C       66      66      51      51      c$C$C$cCCcC.,cCcc,ccccC.cCc,cCcCcccCCCCCcC,cCcCccccC^Oa^`C     +++++!+&+++++++++++++!"#+++++!!(+++++!+!++!+!!+++"+



SAME RESULTS FOR cumulative-3 (AUTORUN OF SAM MERGE METHOD) AND cumulative-4 (AUTORUN OF BAM MERGE METHOD):

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/cumulative-4/chr22

head -n 5 hit-2.snp ../../cumulative-3/chr22/hit-2.snp

    ==> hit-2.snp <==
    chr22   16050612        c       G       40      40      47      7       GG,Gg,G ++!++!+
    chr22   16051724        c       A       21      33      46      45      AA.,,.,...AAaaAaaaa.aAAaaaa.aaaAaaAaaa^zG^iA^7a^Ja^zG^)a^Pa    !++++++++#+++'++!!&+"++!!"++!!!++#+!&+++!"+!!
    chr22   16051777        g       A       41      41      41      33      A$A$A$A$A$A$ACA.AAttAAA.,,A.aaAAAAAA^.a^.a^8a  !!!"++!!(!!+++!+&+(%!+*!+++"++!$"
    chr22   16051778        g       A       45      45      40      29      A$A$A$.AAttAAAA,,A.aaAAAAAAaaa^mA^/A   "!!!!+++!+++&++*""++++++$!!++
    chr22   16053624        G       A       28      28      52      3       aAA     +++
    
    ==> ../../cumulative-3/chr22/hit-2.snp <==
    chr22   16050612        c       G       40      40      47      7       GG,Gg,G ++!++!+
    chr22   16051724        c       A       21      33      46      45      AA.,,.,...AAaaAaaaa.aAAaaaaaaA.aaaAaaa^7a^)a^Pa^zG^iA^Ja^zG    !++++++++#+++'++!!&+"++!!"+!!++!+#+!&+!!!++"+
    chr22   16051777        g       A       41      41      41      33      A$A$A$A$A$A$ACA.AAttAAA.,,A.aaAAAAAA^.a^.a^8a  !!!"++!!(!+!++!+&+(%!+*!+++"++$!"
    chr22   16051778        g       A       45      45      40      29      A$A$A$.AAttAAAA,,A.aaAAAAAAaaa^/A^mA   "!!!+!++!+++&++*""++++++!$!++
    chr22   16053624        G       A       28      28      52      3       aAA     +++


tail  -n 5 hit-2.snp ../../cumulative-3/chr22/hit-2.snp 

    ==> hit-2.snp <==
    chr22   51243373        a       G       39      42      47      49      .$,gGGGggG.gg,.,,g,tGG,G,gg,g,gg.GG.g,gg,gGgggg,g^F,   !++++++!'+++#!+++"+!++++++!++++!++(+++!!+++"+!++"
    chr22   51243520        g       A       56      56      42      42      T$AAaaaAA,aAaAAAa,aaaAAAa.aa,A,AA,AAAaaaAAa    !!!+++!#++!+"!'"!+&+++++"+'#+!++"+'++)!++!
    chr22   51243639        c       T       53      53      44      49      T$T$T$t$ttTTTTt.,TtTTTtt.TTT.tTttTTTTTTTttTTtTttttt^2T^`T      !"!+++!!(!++++%!+!++")!""+!!+!"+++$+"$"+!+"!!$+++
    chr22   51244018        A       G       21      21      55      16      G$G$.ggGg.g,.g,,,,    +++++"+!+++++!!!
    chr22   51244424        t       C       66      66      51      51      c$C$C$cCCCc.,cCccc,ccCc.cCc,cCcCcccCCCCCcCcC,cCccccC^Oa^`C     +++++!&++++++++++++++!"#+++++!!(+++++!+++!!+!!+++"+
    
    ==> ../../cumulative-3/chr22/hit-2.snp <==
    chr22   51243373        a       G       39      42      47      49      .$,gGGGggGg.,g.,,g,,tGGGg,g,g,gg.GG.,ggg,gGgggg,g^F,   !++++++!'++#+!+++"++!+++++!++++!++(+++!!++"++!++"
    chr22   51243520        g       A       56      56      42      42      T$AaAaaA,aAAaAAAa,aaaAAAaa.a,AA,,AAAAaaaAaA    !!+!++!++#!+"!'"!+&++++++"'!++"#++'+)+!+!+
    chr22   51243639        c       T       53      53      44      49      T$T$T$t$ttTTTTt.,tTTTTtt.TTTt.TttTTTTTTTttTTtTttttt^2T^`T      !"!+++!!(!+++%!++!++"!)"+"!!+!"+++$+"$"+!+"!!$+++
    chr22   51244018        A       G       21      21      55      16      G$G$g.gGg.g,.g,,,,    +++++"+!+++++!!!
    chr22   51244424        t       C       66      66      51      51      c$C$C$cCCcC.,cCcc,ccccC.cCc,cCcCcccCCCCCcC,cCcCccccC^Oa^`C     +++++!+&+++++++++++++!"#+++++!!(+++++!+!++!+!!+++"+


[syoung@u04 chr22]$ ls -al hit-2.snp ../../cumulative-3/chr22/hit-2.snp 
-rw-rw-r--+ 1 syoung bioinfo 1962981 Oct 12 21:32 ../../cumulative-3/chr22/hit-2.snp
-rw-rw-r--+ 1 syoung bioinfo 1962981 Oct 12 22:23 hit-2.snp





SO MOST LIKELY SOME DIFFERENCE IN THE CODE OR RULES APPLIED TO SNP CALLING USING BAM AND SAM FILES BUT NOT ENOUGH OF A DIFFERENCE TO WORRY ABOUT... (?)




NOTES
-----


    APPLICATION     cumulativeSNP

    PURPOSE
  
		GIVEN THE PROVIDED LIST OF DIRECTORIES CONTAINING chr
 SUBDIRECTORIES,
		
		EACH CONTAINING A CHROMOSOME 
.sam FILE, STARTING WITH ONE DIRECTORY
		
		AND ENDING WITH ALL DIRECTORIES TOGETHER:
		
			1. CUMULATIVELY CONCAT THE FILES INTO A NEW merged.sam FILE
		
			2. COPY THE merged.sam FILE AND CONVERT IT INTO A merged.sam.gz FILE
		
			3. CALL SNPS USING THE merged.sam.gz FILE
			
			4. RETAIN THE merged.sam FILE FOR USE IN THE NEXT ITERATION
		
	VERSION		0.01

	HISTORY
	
		0.01 BASIC VERSION MERGING SAM FILES
		
    INPUTS

        1. 'N' NUMBER OF COMMA SEPARATED LIST OF 'INPUTFILES' (E.G., '/Full/path/to/hit.sam')
        
        2. SPECIES NAME TO DETERMINE CORRECT SAMTOOLS INDEXES
        
    OUTPUTS
    
        1. 'N' NUMBER OF SNP FILES IN INCREASING ORDER OF READ HIT QUANTITY
		
		2. ONE FOR EACH CHROMOSOME
        
    USAGE
    
    ./cumulativeSNP.pl \
	<--inputdirs String> \
	<--outputdir String> <--reference String> <--label Integer>
    [--keep] [--queue String] [--maxjobs Integer] [--cpus Integer ][--help]
    
    --inputdirs          :   Comma-separated '
sequence.txt' file names (e.g., 's_1_1_sequence.txt,s_2_1_sequence.txt')
    --outputdir           :   Create this directory and write output files to it
    --reference           :   Location of indexed reference file
                              (NB: Use file stub, e.g., /some/path/hg19)
    --species             :   Name of the reference species (e.g., 'human', 'mouse')
    --label               :   Name to used to submit maxjobs to cluster
    --keep                :   Keep intermediate files
    --queue               :   Cluster queue options
    --maxjobs                :   Max. number of concurrent cluster maxjobs (DEFAULT: 30)
    --cpus                :   Max. number of cpus per job (DEFAULT: 4)
    --help                :   print help info

    EXAMPLES













</entry>



<entry [Sun Oct 10 01:26:37 EDT 2010] RUN ELAND, BOWTIE, MAQ AND NOVOALIGN ON 100M READS (2000BP INSERT) AGAINST WHOLE GENOME>



INPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader
ls -al 
sequence.txt

    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_2.sequence.txt

ll 

    -rw-rw-rw- 1 syoung root 6.9G Sep 28 11:25 yoruba1-1.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 6.9G Sep 28 11:25 yoruba1-1.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 6.9G Sep 28 11:25 yoruba1-2.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 6.9G Sep 28 11:25 yoruba1-2.reads_2.sequence.txt

(FOR PREPARATION OF INPUT FILES, SEE:
Sat Sep 25 20:14:35 EDT 2010
RUN READ SAMPLING WITH 2,000 BP INSERT READS)



RESULTS
-------

INPUT SPLIT FILES ARE IDENTICAL:

diff \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/1/srx001539-autogenome-1_1.1.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/1/maq-autogenome-1_1.1.txt

    OK!


BUT THE NUMBER OF ALIGNED READS IS VERY DIFFERENT:

lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY/1/hit.sam

ERROR   8408

lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/1/hit.sam

    478999

lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chrY/1/hit.sam

    61751



AND THE NUMBER OF TOTAL READS MATCHED ALSO DIFFERS:

MAQ

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/
~/base/bin/utils/lines.pl out.hitct.sorted
    
    49030819

    98% OF READS HAD HITS

    -rw-rw-rw-  1 syoung root  2039726629 Oct 10 18:33 out.hitct.sorted
    -rw-rw-rw-  1 syoung root 22778611633 Oct 10 17:04 out.hitid


ELAND

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/
~/base/bin/utils/lines.pl out.hitct.sorted

    6328847

    

    -rw-rw-rw-  1 syoung root  252964273 Oct 13 00:18 out.hitct.sorted
    -rw-rw-rw-  1 syoung root 4172619156 Oct 13 00:53 out.hitid






AND THE OUTPUT HITS ARE ALSO DIFFERENT:

head -n 5 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY/1/hit.sam

	SRR005718.333:1:1:188:110#0     99      chrY    27746608        255     36M     =       27746715143      GATGTTCCCCTTCCTGTGTCCATGTGTTCTCATTGT    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:1  MD:Z:10A25       NM:i:1
	SRR005718.333:1:1:188:110#0     147     chrY    27746715        255     36M     =       27746608-143     TGGTTTCCAGCTTCATCCATGTCCCTACAAAGGATA    IA7?IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    XA:i:0  MD:Z:6A29        NM:i:1
	SRR005718.344:1:1:982:172#0     99      chrY    1475304 255     36M     =       1475511 243     GATGGATGCATGGATGAGATGGATGGGGGAATAGAT     IIIIIIIIIIIII?II;I<IIIIIIII$I2EI*I+0    XA:i:1  MD:Z:26A2G2G1G1  NM:i:4
	SRR005718.344:1:1:982:172#0     147     chrY    1475511 255     36M     =       1475304 -243    AGATGTTTGCATGGATGTTATGGATGGATGGGTGAA     I:I,G&52>&C/I=II6<'I+III9.IIIII<IIII    XA:i:1  MD:Z:5G0A11G17   NM:i:3
	SRR005718.1657:1:1:540:700#0    99      chrY    17204303        255     36M     =       1720431245       GTGGCACGAGCCTGTAATCCCAGCTACTCAGGAGGC    IIII/IIIIIIIII?9@I5=6:CI<0AA9338+54)    XA:i:1  MD:Z:7A28        NM:i:1



head -n 5 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/1/hit.sam

	SRR005718.1992842:1:114:963:138#0       137     chrY    2       0       36M     *       0       TAACCCTAACCCTAACCCTAACCCTAACCCTAACCC     >IDIIGI=I&73IAI-3=9<2&4'9+1-((6&)'%+    MF:i:64 AM:i:0  SM:i:0   NM:i:0  UQ:i:0  H0:i:58 H1:i:7
	SRR005718.626474:1:35:570:431#0 85      chrY    156     0       *       *       0       0       ATGTTATCATGTTTCTTAATGTGAAAGAGATGCTAA     II@IIIIIIIIFIIIIIIIIIIIIIIIIIIIIIIII    MF:i:192
	SRR005718.626474:1:35:570:431#0 153     chrY    156     0       36M     *       0       0       TCTTTCGCTCTTTGCAATAAATCTTGCTATTGCTCA     85,2<A<6G9B??<FIIFIII=I=BIIIIIIIIIII    MF:i:64 AM:i:0  SM:i:0   NM:i:1  UQ:i:27 H0:i:1  H1:i:11
	SRR005718.1645580:1:94:663:965#0        81      chrY    200     26      36M     *       0       19502358 GTCCACACTGCCTTTATGAGCTGTGACACTTACCGT    2-0@88AC8=IIICIIIHIIIIIIIIIIIIIIIII+    MF:i:4  AM:i:26  SM:i:26 NM:i:2  UQ:i:60 H0:i:0  H1:i:0
	SRR005718.268919:1:15:666:273#0 69      chrY    215     0       *       *       0       0       TTGAAAATATTTCAATGCCAAGAAAAACGTGACCCC     IIIIIIIIIIIIIIIIII3<IIIICIIIIIII-I18    MF:i:192



head -n 5 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chrY/1/hit.sam

    SRR005718.11:1:1:465:225        73      chrY    2394143 69      36M     *       0       0       GCCTCCCAAAGCACTGGGGTTACAGGTATGAGTCAC     +++++++++++++++++++++++++++++++++#(&    MD:Z:22T3C5C3   SM:i:69
    SRR005718.17:1:1:770:515        97      chrY    23153370        114     36M     =       23151090-2244    GAAACATTTCTGCAAAGGATAAAACATAATAAAAGA    ++++++++++++++++++++++++++++++*+++++    MD:Z:36 SM:i:114
    SRR005718.17:1:1:770:515        145     chrY    23151090        95      36M     =       231533702244     GAGCTGCACAGAGGTATATGTCACAATTCACCTCTG    !+%*!"++#++++++++++(++++++++++++++++    MD:Z:36 SM:i:95
    SRR005718.20:1:1:371:125        137     chrY    1884567 4       36M     *       0       0       TTTATTTTATCTTATTTTATTTTATTTTGAGACAAG     ++++++++++++++++++++++++++++!%!&"+"+    MD:Z:10T23GA    SM:i:4
    SRR005718.119:1:1:987:103       137     chrY    13644594        77      36M     *       0       TTCCATTCGATTCCGTTCAATGATTATTCCATTCGA     +++++++++++++++++++++++++++++"++++!(    MD:Z:14A3G15A1  SM:i:77












ELAND
-----

SAVE PREVIOUS chr22 RUN

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland

screen -S eland-autogenome-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label srx001539-autogenome-1 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--readhits \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/autogenome-1.out 
    
    
    Run time: 02:09:22
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/ELAND.pl
    3:52AM, 10 October 2010
    


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland
ll */hit.sam

    -rw-rw-rw- 1 syoung root 958M Oct 10 03:33 chr10/hit.sam
    -rw-rw-rw- 1 syoung root 900M Oct 10 03:33 chr11/hit.sam
    -rw-rw-rw- 1 syoung root 868M Oct 10 03:31 chr12/hit.sam
    -rw-rw-rw- 1 syoung root 681M Oct 10 03:25 chr13/hit.sam
    -rw-rw-rw- 1 syoung root 712M Oct 10 03:25 chr14/hit.sam
    -rw-rw-rw- 1 syoung root 701M Oct 10 03:25 chr15/hit.sam
    -rw-rw-rw- 1 syoung root 768M Oct 10 03:28 chr16/hit.sam
    -rw-rw-rw- 1 syoung root 740M Oct 10 03:26 chr17/hit.sam
    -rw-rw-rw- 1 syoung root 715M Oct 10 03:26 chr18/hit.sam
    -rw-rw-rw- 1 syoung root 660M Oct 10 03:24 chr19/hit.sam
    -rw-rw-rw- 1 syoung root 1.3G Oct 10 03:45 chr1/hit.sam
    -rw-rw-rw- 1 syoung root 695M Oct 10 03:34 chr20/hit.sam
    -rw-rw-rw- 1 syoung root 615M Oct 10 03:33 chr21/hit.sam
    -rw-rw-rw- 1 syoung root 596M Oct 10 03:23 chr22/hit.sam
    -rw-rw-rw- 1 syoung root 1.3G Oct 10 03:43 chr2/hit.sam
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 03:36 chr3/hit.sam
    -rw-rw-rw- 1 syoung root 971M Oct 10 03:35 chr4/hit.sam
    -rw-rw-rw- 1 syoung root 977M Oct 10 03:33 chr5/hit.sam
    -rw-rw-rw- 1 syoung root 972M Oct 10 03:33 chr6/hit.sam
    -rw-rw-rw- 1 syoung root 962M Oct 10 03:32 chr7/hit.sam
    -rw-rw-rw- 1 syoung root 881M Oct 10 03:29 chr8/hit.sam
    -rw-rw-rw- 1 syoung root 797M Oct 10 03:30 chr9/hit.sam
    -rw-rw-rw- 1 syoung root 618M Oct 10 03:22 chrX/hit.sam
    -rw-rw-rw- 1 syoung root 488M Oct 10 03:19 chrY/hit.sam


ll chr*/hit.snp

    -rw-rw-rw- 1 syoung root 1.9M Oct 10 03:51 chr10/hit.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 10 03:50 chr11/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 03:50 chr12/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:50 chr13/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:50 chr14/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:49 chr15/hit.snp
    -rw-rw-rw- 1 syoung root 1.9M Oct 10 03:49 chr16/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 03:50 chr17/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 03:49 chr18/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 03:49 chr19/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:52 chr1/hit.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 10 03:49 chr20/hit.snp
    -rw-rw-rw- 1 syoung root 1.9M Oct 10 03:49 chr21/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:49 chr22/hit.snp
    -rw-rw-rw- 1 syoung root 2.0M Oct 10 03:52 chr2/hit.snp
    -rw-rw-rw- 1 syoung root 1.6M Oct 10 03:51 chr3/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 03:51 chr4/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:51 chr5/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 10 03:51 chr6/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 03:51 chr7/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:51 chr8/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 03:50 chr9/hit.snp
    -rw-rw-rw- 1 syoung root 1.4M Oct 10 03:50 chrX/hit.snp
    -rw-rw-rw- 1 syoung root 2.2M Oct 10 03:49 chrY/hit.snp



BOWTIE
------


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

screen -S bowtie-autogenome-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie \
--params "--fr" \
--distance 2000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/autogenome-1.out 


    BOWTIE::run    After printUsage       10-10-10 10:45:57
    BOWTIE.pl    Run time: 01:04:29
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl
    BOWTIE.pl    10:45AM, 10 October 2010
    BOWTIE.pl    


BOWTIE HAS MUCH LESS HITS THAN MAQ


/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY
ll */hit.sam

    -rw-rw-rw- 1 syoung root 1.7M Oct 10 10:16 10/hit.sam
    -rw-rw-rw- 1 syoung root 1.8M Oct 10 10:16 11/hit.sam
    -rw-rw-rw- 1 syoung root 2.1M Oct 10 10:16 12/hit.sam
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 10:16 13/hit.sam



/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY
ll */hit.sam

    -rw-rw-rw- 1 syoung root 74M Oct 10 13:04 10/hit.sam
    -rw-rw-rw- 1 syoung root 82M Oct 10 13:04 11/hit.sam
    -rw-rw-rw- 1 syoung root 86M Oct 10 13:06 12/hit.sam
    -rw-rw-rw- 1 syoung root 77M Oct 10 13:06 13/hit.sam


head -n 5 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY/1/hit.sam

head -n 5 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/1/hit.sam

head -n 5 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland/chrY/1/hit.sam



BOWTIE COMMAND:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY
cat bowtie-chrY.sh


NOTE, DEFAULT ANALYSIS USES THE '--rf' OPTION:

  --fr/--rf/--ff     -1, -2 mates align fw/rev, rev/fw, fw/fw (default: --fr)





time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 1 \
--fr \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY
/1/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY/1/unaligned.txt \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chrY \                            -1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/1/bowtie-autogenome-1_1.1.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/1/bowtie-autogenome-1_2.1.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/chrY/1/out.sam




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie
ll chr
/hit.snp

    -rw-rw-rw- 1 syoung root 1011K Oct 10 10:45 chr10/hit.snp
    -rw-rw-rw- 1 syoung root  832K Oct 10 10:45 chr11/hit.snp
    -rw-rw-rw- 1 syoung root  716K Oct 10 10:45 chr12/hit.snp
    -rw-rw-rw- 1 syoung root  738K Oct 10 10:45 chr13/hit.snp
    -rw-rw-rw- 1 syoung root  819K Oct 10 10:45 chr14/hit.snp
    -rw-rw-rw- 1 syoung root  770K Oct 10 10:45 chr15/hit.snp
    -rw-rw-rw- 1 syoung root  1.2M Oct 10 10:45 chr16/hit.snp
    -rw-rw-rw- 1 syoung root  735K Oct 10 10:45 chr17/hit.snp
    -rw-rw-rw- 1 syoung root  880K Oct 10 10:45 chr18/hit.snp
    -rw-rw-rw- 1 syoung root  889K Oct 10 10:45 chr19/hit.snp
    -rw-rw-rw- 1 syoung root  558K Oct 10 10:45 chr1/hit.snp
    -rw-rw-rw- 1 syoung root  992K Oct 10 10:45 chr20/hit.snp
    -rw-rw-rw- 1 syoung root  1.2M Oct 10 10:45 chr21/hit.snp
    -rw-rw-rw- 1 syoung root  1.1M Oct 10 10:45 chr22/hit.snp
    -rw-rw-rw- 1 syoung root  837K Oct 10 10:45 chr2/hit.snp
    -rw-rw-rw- 1 syoung root  608K Oct 10 10:45 chr3/hit.snp
    -rw-rw-rw- 1 syoung root  838K Oct 10 10:45 chr4/hit.snp
    -rw-rw-rw- 1 syoung root  663K Oct 10 10:45 chr5/hit.snp
    -rw-rw-rw- 1 syoung root  589K Oct 10 10:45 chr6/hit.snp
    -rw-rw-rw- 1 syoung root  838K Oct 10 10:45 chr7/hit.snp
    -rw-rw-rw- 1 syoung root  722K Oct 10 10:45 chr8/hit.snp
    -rw-rw-rw- 1 syoung root  765K Oct 10 10:45 chr9/hit.snp
    -rw-rw-rw- 1 syoung root  754K Oct 10 10:45 chrX/hit.snp
    -rw-rw-rw- 1 syoung root  1.2M Oct 10 10:45 chrY/hit.snp





RERUN BOWTIE WITH --rf -X 3000
------------------------------


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

screen -S bowtie-autogenome-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie \
--params "--rf -X 3000 " \
--distance 2000 \
--species human \
--label bowtie-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie/autogenome-1.out 
  
    BOWTIE.pl    Run time: 06:10:31
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl
    BOWTIE.pl    5:42AM, 16 October 2010
    BOWTIE.pl    ****************************************


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/bowtie

ll */chrY/hit.sam.gz

    -rw-rw-rw- 1 syoung root 104M Oct 16 04:20 bowtie/chrY/hit.sam.gz
    -rw-rw-rw- 1 syoung root 899M Oct 10 14:52 maq/chrY/hit.sam.gz

ll */chrY/hit.sam

    -rw-rw-rw- 1 syoung root 488M Oct 10 03:19 eland/chrY/hit.sam


ll bowtie/*/hit.sam.gz

    -rw-rw-rw- 1 syoung root 330M Oct 16 04:44 bowtie/chr1/hit.sam.gz
    -rw-rw-rw- 1 syoung root 321M Oct 16 04:42 bowtie/chr2/hit.sam.gz
    -rw-rw-rw- 1 syoung root 256M Oct 16 04:35 bowtie/chr3/hit.sam.gz
    -rw-rw-rw- 1 syoung root 250M Oct 16 04:36 bowtie/chr4/hit.sam.gz
    -rw-rw-rw- 1 syoung root 235M Oct 16 04:33 bowtie/chr5/hit.sam.gz
    -rw-rw-rw- 1 syoung root 231M Oct 16 04:33 bowtie/chr6/hit.sam.gz
    -rw-rw-rw- 1 syoung root 238M Oct 16 04:34 bowtie/chr7/hit.sam.gz
    -rw-rw-rw- 1 syoung root 211M Oct 16 04:30 bowtie/chr8/hit.sam.gz
    -rw-rw-rw- 1 syoung root 202M Oct 16 04:30 bowtie/chr9/hit.sam.gz
    -rw-rw-rw- 1 syoung root 239M Oct 16 04:37 bowtie/chr10/hit.sam.gz
    -rw-rw-rw- 1 syoung root 216M Oct 16 04:34 bowtie/chr11/hit.sam.gz
    -rw-rw-rw- 1 syoung root 210M Oct 16 04:33 bowtie/chr12/hit.sam.gz
    -rw-rw-rw- 1 syoung root 145M Oct 16 04:25 bowtie/chr13/hit.sam.gz
    -rw-rw-rw- 1 syoung root 159M Oct 16 04:26 bowtie/chr14/hit.sam.gz
    -rw-rw-rw- 1 syoung root 161M Oct 16 04:27 bowtie/chr15/hit.sam.gz
    -rw-rw-rw- 1 syoung root 186M Oct 16 04:29 bowtie/chr16/hit.sam.gz
    -rw-rw-rw- 1 syoung root 172M Oct 16 04:29 bowtie/chr17/hit.sam.gz
    -rw-rw-rw- 1 syoung root 145M Oct 16 04:24 bowtie/chr18/hit.sam.gz
    -rw-rw-rw- 1 syoung root 153M Oct 16 04:25 bowtie/chr19/hit.sam.gz
    -rw-rw-rw- 1 syoung root 140M Oct 16 04:23 bowtie/chr20/hit.sam.gz
    -rw-rw-rw- 1 syoung root 111M Oct 16 04:20 bowtie/chr21/hit.sam.gz
    -rw-rw-rw- 1 syoung root 116M Oct 16 04:21 bowtie/chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 151M Oct 16 04:23 bowtie/chrX/hit.sam.gz
    -rw-rw-rw- 1 syoung root 104M Oct 16 04:20 bowtie/chrY/hit.sam.gz






MAQ
---

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq

screen -S maq-autogenome-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq \
--species human \
--label maq-autogenome-1 \
--maxjobs 1000 \
--queue large \
--cluster LSF \
--walltime 24 \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/autogenome-1.out 


tail /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/autogenome-1.out

    Job <1987403> is submitted to queue <large>.
    Cluster::runJobs    Completed samToSnp at 10-10-10 19:35:41, duration: 00:39:01
    Out of memory!




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
ll */hit.sam.gz

    -rw-rw-rw- 1 syoung root 1.3G Oct 10 15:25 chr10/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 15:20 chr11/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 15:18 chr12/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:08 chr13/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:08 chr14/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:08 chr15/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:13 chr16/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:11 chr17/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:09 chr18/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:07 chr19/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.4G Oct 10 15:35 chr1/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:19 chr20/hit.sam.gz
    -rw-rw-rw- 1 syoung root 940M Oct 10 15:04 chr21/hit.sam.gz
    -rw-rw-rw- 1 syoung root 936M Oct 10 15:05 chr22/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.4G Oct 10 15:34 chr2/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.3G Oct 10 15:25 chr3/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.3G Oct 10 15:23 chr4/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.3G Oct 10 15:23 chr5/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 15:21 chr6/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.4G Oct 10 13:28 chr7/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 15:17 chr8/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.2G Oct 10 15:15 chr9/hit.sam.gz
    -rw-rw-rw- 1 syoung root 1.1G Oct 10 15:18 chrX/hit.sam.gz
    -rw-rw-rw- 1 syoung root 899M Oct 10 14:52 chrY/hit.sam.gz


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq
ll chr*/hit.snp

    -rw-rw-rw- 1 syoung root 3.0M Oct 10 19:21 chr10/hit.snp
    -rw-rw-rw- 1 syoung root 3.0M Oct 10 19:22 chr11/hit.snp
    -rw-rw-rw- 1 syoung root 2.8M Oct 10 19:20 chr12/hit.snp
    -rw-rw-rw- 1 syoung root 1.9M Oct 10 19:13 chr13/hit.snp
    -rw-rw-rw- 1 syoung root 2.0M Oct 10 19:15 chr14/hit.snp
    -rw-rw-rw- 1 syoung root 1.9M Oct 10 19:13 chr15/hit.snp
    -rw-rw-rw- 1 syoung root 2.0M Oct 10 19:14 chr16/hit.snp
    -rw-rw-rw- 1 syoung root 2.0M Oct 10 19:13 chr17/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 19:10 chr18/hit.snp
    -rw-rw-rw- 1 syoung root 1.5M Oct 10 19:11 chr19/hit.snp
    -rw-rw-rw- 1 syoung root 4.9M Oct 10 19:35 chr1/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 19:09 chr20/hit.snp
    -rw-rw-rw- 1 syoung root 941K Oct 10 19:03 chr21/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct 10 19:04 chr22/hit.snp
    -rw-rw-rw- 1 syoung root 4.9M Oct 10 19:34 chr2/hit.snp
    -rw-rw-rw- 1 syoung root 3.9M Oct 10 19:27 chr3/hit.snp
    -rw-rw-rw- 1 syoung root 3.3M Oct 10 19:22 chr4/hit.snp
    -rw-rw-rw- 1 syoung root 3.5M Oct 10 19:23 chr5/hit.snp
    -rw-rw-rw- 1 syoung root 3.4M Oct 10 19:22 chr6/hit.snp
    -rw-rw-rw- 1 syoung root  17K Oct 10 19:01 chr7/hit.snp
    -rw-rw-rw- 1 syoung root 3.0M Oct 10 19:21 chr8/hit.snp
    -rw-rw-rw- 1 syoung root 2.4M Oct 10 19:18 chr9/hit.snp
    -rw-rw-rw- 1 syoung root 1.7M Oct 10 19:15 chrX/hit.snp
    -rw-rw-rw- 1 syoung root 381K Oct 10 19:01 chrY/hit.snp












cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY
cat maq-chrY.sh

#!/bin/sh

#BSUB -J maq-chrY               # The name of the job
#BSUB -W 24:00
#BSUB -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/%I/maq-chrY-stdout.txt                       # print STDOUT to this file
#BSUB -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/%I/maq-chrY-stderr.txt                       # print STDERR to this file


echo "LS_JOBID: " $LS_JOBID
echo "LS_JOBPID: " $LS_JOBPID
echo "LSB_JOBINDEX: " $LSB_JOBINDEX
echo "LSB_JOBNAME: " $LSB_JOBNAME
echo "LSB_QUEUE: " $LSB_QUEUE
echo "LSFUSER: " $LSFUSER
echo "LSB_JOB_EXECUSER: " $LSB_JOB_EXECUSER
echo "HOSTNAME: " $HOSTNAME
echo "LSB_HOSTS: " $LSB_HOSTS
echo "LSB_ERRORFILE: " $LSB_ERRORFILE
echo "LSB_JOBFILENAME: " $LSB_JOBFILENAME
echo "LD_LIBRARY_PATH: " $LD_LIBRARY_PATH


echo "Creating outputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX"
mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX;

echo "Moving to outputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX"
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX;

echo "Running MAQ: time /nethome/bioinfo/apps/maq/0.7.1/maq match /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX/out.map /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chrY.bfa /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/$LSB_JOBINDEX/maq-autogenome-1_1.$LSB_JOBINDEX.bfq /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/$LSB_JOBINDEX/maq-autogenome-1_2.$LSB_JOBINDEX.bfq  &> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX/maq-chrY-outerr.txt"
time /nethome/bioinfo/apps/maq/0.7.1/maq match /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX/out.map /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chrY.bfa /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/$LSB_JOBINDEX/maq-autogenome-1_1.$LSB_JOBINDEX.bfq /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/$LSB_JOBINDEX/maq-autogenome-1_2.$LSB_JOBINDEX.bfq  &> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/maq/chrY/$LSB_JOBINDEX/maq-chrY-outerr.txt

exit;




NOVO
----







</entry>



<entry [Sun Oct 10 01:25:37 EDT 2010] RUN LOOP ON MAQ.pl>




FIRST ROUND (1-16)
-----------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq

screen -r loop-maq-autochr22

screen -S loop-maq-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--replicates 1-16 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/%REPLICATE% \
--species human \
--label maq-200bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/%REPLICATE%/maq-200bp-autochr22-%REPLICATE%.out 

    Run time: 33:21:18
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    9:59AM, 9 October 2010
    ****************************************

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
ll */chr22/hit.snp

NOTE:

FILE 2 AND FILE 7 OUTPUTS ARE MISSING
FILE 4 AND FILE 10 OUTPUTS ARE SHORT

    -rw-rw-rw- 1 syoung root  12K Oct  8 16:41 10/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 21:27 11/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 00:17 12/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 02:37 13/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 05:29 14/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 07:51 15/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  9 09:59 16/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 02:43 1/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 05:08 3/chr22/hit.snp
    -rw-rw-rw- 1 syoung root  12K Oct  8 06:06 4/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 08:25 5/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 11:00 6/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 13:30 8/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1.1M Oct  8 15:43 9/chr22/hit.snp



SECOND ROUND (17-33)
-------------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq

screen -r loop-maq-autochr22

screen -S loop-maq-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--replicates 17-33 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/%REPLICATE% \
--species human \
--label maq-200bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq/%REPLICATE%/maq-200bp-autochr22-%REPLICATE%.out 

    Run time: 34:42:19
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    11:53AM, 11 October 2010
    ****************************************

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/maq
ls -al */chr22/hit.snp

    -rw-rw-rw- 1 syoung root   12044 Oct  8 16:41 10/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1118993 Oct  8 21:27 11/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1106089 Oct  9 00:17 12/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1109184 Oct  9 02:37 13/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1126690 Oct  9 05:29 14/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1114866 Oct  9 07:51 15/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1115884 Oct  9 09:59 16/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1119023 Oct 10 04:13 17/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1114382 Oct 10 06:27 18/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1122947 Oct 10 08:32 19/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1112021 Oct  8 02:43 1/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1115895 Oct 10 10:51 20/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1131859 Oct 10 12:56 21/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1129464 Oct 10 15:25 22/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1117707 Oct 10 17:48 23/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1124960 Oct 10 20:09 24/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1125130 Oct 10 22:30 25/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   11596 Oct 10 23:25 26/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   12175 Oct 11 00:16 27/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1113852 Oct 11 02:36 28/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1109066 Oct 11 04:42 29/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1104549 Oct 11 06:58 30/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1121934 Oct 11 09:03 31/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   10760 Oct 11 09:59 32/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1127413 Oct  8 05:08 3/chr22/hit.snp
    -rw-rw-rw- 1 syoung root   11301 Oct  8 06:06 4/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1122911 Oct  8 08:25 5/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1121805 Oct  8 11:00 6/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1131667 Oct  8 13:30 8/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 1120749 Oct  8 15:43 9/chr22/hit.snp



</entry>



<entry [Thu Oct  7 23:54:23 EDT 2010] MOVE DATA TO /ngs/bioinfo/syoung/base/pipeline/SRA>




LOOPED ALIGNMENT RUNS
---------------------

TAKE FILE 1 ALIGNMENTS FROM EACH AS BACKUP


BOWTIE
------

mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie

screen -S mv-bowtie-file1

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1 \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/


SAVE FILE 9

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9 \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/


RUNNING
Fri Oct  8 00:19:01 EDT 2010

screen -S mv-bowtie9


REMOVE NUMBERED DIRECTORIES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie

PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        cd $DIR
            
        SUBDIRS="*"
        for SUBDIR in $SUBDIRS;
        do
            echo $SUBDIR
            SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
            if [ "$SPLITSUBDIR" != "" ]; then
                echo "SUBDIR: " $PWD/$SUBDIR
                rm -fr $PWD/$SUBDIR 
            fi;
        done;

        cd ../

    fi;
done;


MOVE TO /ngs/bioinfo

screen -S mv-bowtie
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
mv * /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie

RUNNING
Mon Oct 11 12:05:55 EDT 2010

cd /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie




ELAND
-----

mkdir -p /ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland

screen -S mv-eland-file1

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1 \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/

RUNNING
Fri Oct  8 00:19:01 EDT 2010

screen -S rm-eland

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland

REMOVE NUMBERED DIRECTORIES

PWD=`pwd`;
DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then
        
        cd $DIR
            
        SUBDIRS="*"
        for SUBDIR in $SUBDIRS;
        do
            SPLITSUBDIR=$(echo $SUBDIR | egrep "^[0-9]+" ); 
            if [ "$SPLITSUBDIR" != "" ]; then
                echo "SUBDIR: " $PWD/$SUBDIR
                rm -fr $PWD/$SUBDIR 
            fi;
        done;

        cd ../..

    fi;
done;


MOVE ELAND TO /ngs/bioinfo

screen -S mv-bowtie

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1 \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/


AFTER REMOVING NUMBERED DIRECTORIES:

mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/* \
/ngs/bioinfo/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/eland/





MAQ
---











</entry>



<entry [Mon Oct  4 22:45:56 EDT 2010] DOWNLOADED TEST DATA SETS FROM CLCBIO>




MAIN DATA FOLDER
----------------

/scratch/syoung/base/pipeline/data

    drwxrwxr-x 3 syoung root  15 Oct  1 14:15 454
    drwxrwxr-x 3 syoung root  15 Oct  1 14:13 illumina
    drwxrwxr-x 4 syoung root  47 Oct  1 14:24 solid


E.COLI 454 DATA
---------------

cd /scratch/syoung/base/pipeline/data/454/ecoli
wget http://download.clcbio.com/testdata/raw_data/454.zip; unzip *zip

    -rw-rw-r-- 1 syoung root  95926993 Mar 18  2009 454.zip
    -rw-rw-r-- 1 syoung root 111196690 Feb  2  2007 Ecoli.FLX.fna
    -rw-rw-r-- 1 syoung root 313042847 Feb  2  2007 Ecoli.FLX.qual
    -rw-rw-r-- 1 syoung root  10770304 Mar 17  2009 NC_010473.gbk


STREPTOCOCCUS SOLID DATA
------------------------

cd /scratch/syoung/base/pipeline/data/solid/streptococcus
wget -c http://download.clcbio.com/testdata/raw_data/solid.zip

    -rw-rw-r-- 1 syoung bioinfo 214921363 May  1  2007 GRACE20070409_Suis-frag-20070425_F3_sequence.csfasta
    -rw-rw-r-- 1 syoung bioinfo 482680742 May  1  2007 GRACE20070409_Suis-frag-20070425_F3_sequence.QV.qual
    -rw-rw-r-- 1 syoung bioinfo   2040970 Oct 12  2006 Streptococcus suis genome.fasta


miRNA SOLID DATA
----------------

cd /scratch/syoung/base/pipeline/data/solid/mirna
    
    -rw-rw-r-- 1 syoung root 2228706315 Apr 14 18:23 R1a007_20080206_1_ABNmi_BC3a_F3.csfasta
    -rw-rw-r-- 1 syoung root  431398128 Apr 15 18:21 R1a007_20080206_1_ABNmi_BC3a_F3.csfasta_extend.ma.35.2.all.gz
    -rw-rw-r-- 1 syoung root 4562145801 Apr 14 19:28 R1a007_20080206_1_ABNmi_BC3a_F3_QV.qual
    -rw-rw-r-- 1 syoung root  503316297 Apr 15 18:32 R1a007_20080206_1_ABNmi_BC3b_F3.csfasta_extend.ma.35.2.all.gz
    -rw-rw-r-- 1 syoung root  624890715 Apr 14 19:46 R1a007_20080206_1_ABNmi_BC3b_F3.csfasta.gz
    -rw-rw-r-- 1 syoung root 1401112493 Apr 14 20:16 R1a007_20080206_1_ABNmi_BC3b_F3_QV.qual.gz
    -rw-rw-r-- 1 syoung root  476351470 Apr 16 12:52 R1a007_20080206_1_ABNmi_BC3n_F3.csfasta_extend.ma.35.2.all.gz
    -rw-rw-r-- 1 syoung root  629003809 Apr 15 13:53 R1a007_20080206_1_ABNmi_BC3n_F3.csfasta.gz
    -rw-rw-r-- 1 syoung root 1412036301 Apr 15 14:25 R1a007_20080206_1_ABNmi_BC3n_F3_QV.qual.gz
    -rw-rw-r-- 1 syoung root  370981892 Apr 16 12:58 R1a007_20080206_1_ABNmi_BC4a_F3.csfasta_extend.ma.35.2.all.gz
    -rw-rw-r-- 1 syoung root  535817931 Apr 15 15:49 R1a007_20080206_1_ABNmi_BC4a_F3.csfasta.gz
    -rw-rw-r-- 1 syoung root 1231849525 Apr 15 16:11 R1a007_20080206_1_ABNmi_BC4a_F3_QV.qual.gz



E.COLI ILLUMINA DATA
--------------------

cd /scratch/syoung/base/pipeline/data/illumina/ecoli
wget -c http://download.clcbio.com/testdata/raw_data/solexa.zip
    
    -rw-rw-r-- 1 syoung root  10770304 Mar 17  2009 NC_010473.gbk
    -rw-rw-r-- 1 syoung root 342203522 Dec  5  2007 s_1_1_sequence.txt
    -rw-rw-r-- 1 syoung root 342203522 Dec  5  2007 s_1_2_sequence.txt
    -rw-rw-r-- 1 syoung root 176352372 Mar 18  2009 solexa.zip





</entry>



<entry [Mon Oct  4 01:34:25 EDT 2010] GROUP bioinfo OVER QUOTA>



IO error writing /nethome/syoung/base/pipeline/casava/sample2/casava-1/test.txt: Disk quota exceeded


Disk quotas for group bioinfo (gid 1072):
                         Block Limits                                    |     File Limits
Filesystem type             KB      quota      limit   in_doubt    grace |    files   quota    limit in_doubt    grace  Remarks
homelv     GRP      2869543936  300639232 3058642944  155273792  expired |  1732346       0        0       79     none 


/nethome/bioinfo FOLDER  : 0.5 TB 
---------------------------------

[bioinfo@u01 nethome]$ du -hs bioinfo
du: `bioinfo/apps/GSMapper/2.0.01.12/apps/gsSupportTool/usr': Permission denied
du: `bioinfo/apps/454/2.0.00.20-64/apps/gsSupportTool/usr': Permission denied
du: `bioinfo/data/sequence/demo/maq': Permission denied
du: `bioinfo/data/sequence/demo/splitace': Permission denied
543G    bioinfo

[zjiang@u01 home]$ du -hs zjiang
231G    zjiang

[cvaldes@u01 /nethome]$ du -hs cvaldes
114G    cvaldes

[syoung@u01 nethome]$ du -hs syoung
du: `syoung/base/apps/complete/1.0.1/doc': Permission denied
du: `syoung/base/apps/complete/1.0.1/etc': Permission denied
du: `syoung/base/apps/complete/1.0.1/examples': Permission denied
du: `syoung/base/apps/complete/1.0.1/src': Permission denied
1.3T    syoung


[zjiang@u01 syoung]$ cd 
[zjiang@u01 ~]$ du -hs *
1.1G    454_de_novo_assembling_novel_plasmid
1.3G    454_reads_coverage
54M     74755_EST_and_194_mRNA.fasta
128K    alignment
164M    annotation
62M     Annotation_verification
3.0M    bin
22G     blastdb
147M    BLAST_verified_prediction_against_KEGG_pathway_proteins
1.8G    BLAST_verified_prediction_against_NCBI_and_APS
24M     Buchnera_genome_comparison
4.7G    correct_seq_by_Solexa
890M    from_Victor
23G     gap_filling_for_novle_plasmid
16K     GS Run Browser.properties
16K     id_rsa.pub
16K     job_script
57G     maq-0.7.1
15G     Marine_genome
16K     mouse_mm9_chromosome_information
2.8M    nedit
1.3M    Parallel-MPI-0.03
4.2M    paup4b10-x86-linux
3.9M    paup4b10-x86-linux.tar
86G     peak_detection
7.3M    sending
19G     seqmap-1.0.13-src
468M    ssake_v3-4
683M    temp
416K    threads-1.77
870M    velvet_0.7.59



[cvaldes@u01 ~]$ du -hs * 
5.6G    Apps
14G     Collaborations
6.3G    Data
89G     NGS
144K    R
98M     temp


/nethome/bioinfo/data/sequence

[bioinfo@u01 sequence]$ du -hs * 
185M    cdna
115G    chromosomes
80K     controls
du: `demo/maq': Permission denied
du: `demo/splitace': Permission denied
3.9G    demo
0       du.txt
24G     genomes
4.1G    gsmapper
368G    labs
144K    mtdna


/nethome/bioinfo/apps
[bioinfo@u01 apps]$ du -hs *
du: `454/2.0.00.20-64/apps/gsSupportTool/usr': Permission denied
594M    454
12G     agua
16K     ajax-gbrowse
716M    amos
27M     aqwa
0       aqwa,
22M     baccardi
1.8M    bedtools
5.5G    bowtie
33M     BOWTIE
8.4M    cufflinks
90M     CUFFLINKS
0       du.txt
5.2G    erange
127M    euler-sr
115M    fire
5.8M    FIRE-1.1.zip
34M     GAPipeline-1.0
71M     genomics.workbench
3.1M    gff2aplot
du: `GSMapper/2.0.01.12/apps/gsSupportTool/usr': Permission denied
422M    GSMapper
517M    jbrowse
16K     libs
2.4G    maq
4.7M    maq-0.7.1
69M     mira
14M     mummer
322M    mysql
7.0M    ngs
16M     ngscell
41M     novocraft
15M     pygr
87M     qt3
337M    reactome
87M     sam
8.8M    samtools
592K    seqmap
9.2M    shore
8.3M    shrimp
7.8M    shrimp2
528K    soap
64K     soap_1.11.tar.gz
816K    ssaha
129M    ssaha1.0.9
287M    ssaha2
1.4M    ssaha2-i64
129M    ssaha2-i686
0       test.txt
18M     tophat
9.0M    TOPHAT
4.5M    vcake
17M     velvet






</entry>



<entry [Fri Oct  1 03:39:57 EDT 2010] RUN loop.pl ON BOWTIE.pl>





FIRST ROUND (1-10)
-----------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie

screen -r loop-bowtie-autochr22

screen -S loop-bowtie-autochr22


/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--replicates 1-10 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/%REPLICATE% \
--species human \
--distance 200 \
--label bowtie-200bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--keep \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/%REPLICATE%/bowtie-200bp-autochr22-%REPLICATE%.out 


    Run time: 07:00:51
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    9:46PM, 4 October 2010
    ****************************************



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
ll */chr22/hit.snp



SECOND ROUND (11-33)
-----------------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie

screen -S loop-bowtie-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--replicates 11-33 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/%REPLICATE% \
--species human \
--distance 200 \
--label bowtie-200bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--keep \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/%REPLICATE%/bowtie-200bp-autochr22-%REPLICATE%.out 

    Run time: 19:49:07
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/logic/loop.pl
    8:14PM, 5 October 2010
    ****************************************


/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/bowtie-200bp-autochr22-1.out 


OUTPUT FILES (NOTE: FILE 9 MISSING)

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
ll */chr22/hit.snp

    -rw-rw-rw- 1 syoung root 5.3M Oct  4 21:46 10/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 01:26 11/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 02:19 12/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 03:12 13/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 04:01 14/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.2M Oct  5 04:52 15/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 05:44 16/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 06:34 17/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 07:23 18/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 08:11 19/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 17:18 1/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 09:03 20/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 09:52 21/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 10:42 22/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 11:31 23/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 12:21 24/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 13:12 25/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 14:05 26/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 14:59 27/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 15:51 28/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 16:45 29/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 15:46 2/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 17:38 30/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 18:33 31/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 19:24 32/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  5 20:14 33/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 16:30 3/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 2.0M Oct  5 07:28 4/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.6M Oct  5 00:34 5/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 23:56 6/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 18:31 7/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 19:11 8/chr22/hit.snp
    -rw-rw-rw- 1 syoung root    0 Oct  5 03:01 9/chr22/hit.snp




BOWTIE HAS A PROBLEM WITH FILE 4 AND FILE 9 SAM OUTPUT:

ALTHOUGH FILE 4 ACTUALLY PRODUCES A hit.snp FILE, IT MAY BE TRUNCATED

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/4/chr22
    
bash-3.2$ ./sortSam-chr22.sh
    LS_JOBID:
    LS_JOBPID:
    LSB_JOBINDEX:
    LSB_JOBNAME:
    LSB_QUEUE:
    LSFUSER:
    LSB_JOB_EXECUSER:
    HOSTNAME:  u01
    LSB_HOSTS:
    LSB_ERRORFILE:
    LSB_JOBFILENAME:
    LD_LIBRARY_PATH:

bash-3.2$ ./gzipFile.sh
    LS_JOBID:
    LS_JOBPID:
    LSB_JOBINDEX:
    LSB_JOBNAME:
    LSB_QUEUE:
    LSFUSER:
    LSB_JOB_EXECUSER:
    HOSTNAME:  u01
    LSB_HOSTS:
    LSB_ERRORFILE:
    LSB_JOBFILENAME:
    LD_LIBRARY_PATH:
    gzipFile completed

bash-3.2$ ./samToSnp-chr22.sh
    LS_JOBID:
    LS_JOBPID:
    LSB_JOBINDEX:
    LSB_JOBNAME:
    LSB_QUEUE:
    LSFUSER:
    LSB_JOB_EXECUSER:
    HOSTNAME:  u01
    LSB_HOSTS:
    LSB_ERRORFILE:
    LSB_JOBFILENAME:
    LD_LIBRARY_PATH:
    [sam_header_read2] 1 sequences loaded.
    Parse error at line 1871996: CIGAR and sequence length are inconsistent



NOTES
-----


PROBLEM

BOWTIE ALIGNMENT COMPLETED SUCCESSFULLY BUT MISSING hit.snp FILES BECAUSE OF FREQUENT 'Stale NFS file handle' AND POSSIBLY OTHER ERRORS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie
ll */chr22/hit.snp

    -rw-rw-rw- 1 syoung root 5.3M Oct  4 21:46 10/chr22/hit.snp
    -rw-rw-rw- 1 syoung root    0 Oct  4 17:18 1/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 15:46 2/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 16:30 3/chr22/hit.snp
    -rw-rw-rw- 1 syoung root    0 Oct  4 16:46 4/chr22/hit.snp
    -rw-rw-rw- 1 syoung root    0 Oct  4 17:06 5/chr22/hit.snp
    -rw-rw-rw- 1 syoung root    0 Oct  4 17:49 6/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 18:31 7/chr22/hit.snp
    -rw-rw-rw- 1 syoung root 5.3M Oct  4 19:11 8/chr22/hit.snp
    -rw-rw-rw- 1 syoung root    0 Oct  4 21:00 9/chr22/hit.snp


'STALE NFS FILE HANDLE' ERRORS:

    sort: read failed: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam: Stale NFS file handle
    mv: cannot stat `/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/1/chr22/hit.sam.temp': No such file or directory

    sort: read failed: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/4/chr22/hit.sam: Stale NFS file handle
    mv: cannot stat `/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/4/chr22/hit.sam.temp': No such file or directory

    sort: read failed: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/5/chr22/hit.sam: Stale NFS file handle
    mv: cannot stat `/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/5/chr22/hit.sam.temp': No such file or directory


SNP CALLING ERROR reference '26851607' is recognized as '*':

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22
emacs samToSnp-chr22-stdout.txt

    [sam_header_read2] 1 sequences loaded.
    [sam_read1] reference '26851607' is recognized as '*'.
    Parse error at line 1: invalid CIGAR character


CHECK IF '26851607' IS FOUND IN CHROMOSOME COLUMN IN hit.sam FILE:

zcat hit.sam.gz > hit.sam
grep -n 26851607 hit.sam


MANGLED FIRST LINE:

head hit.sam
6M      =       26851607        231     GCTGGAAACCATCATTCTCAGCAAACTATCGCAAGG    IHIII796II77:0)(-04,+/'..-1&*)%#"',)        XA:i:1  MD:Z:0A28T6     NM:i:2
1       CTGAGGTCAGGAGTTCCAGACCAGCCTGGCTAACCT    8IIIIIIF7CC,G:%/?,8..+$**+-%*$$&%%#'    XA:i:1  MD:Z:16G13C3A1      NM:i:3


SHOWS UP IN CORRECTLY FORMATTED FIRST SUBDIR hit.sam FILE:

grep -n 26851607 1/hit.sam
867919:SRR002271.21530668:8:168:959:203#0       163     chr22   26851447        255     36M     =  26851607 196     GACAGGAAACCAAACACCACATGTTCTCACTCACAG    I<5FII;8I-2+/0+2+-')++4)(%&&&*'%&$$.    XA:i:2      MD:Z:4A0A27T2   NM:i:3
867920:SRR002271.21530668:8:168:959:203#0       83      chr22   26851607        255     36M     =  26851447 -196    GTTAATGGGTGCAGCACACCAACATGGCACATGTAT    %,'2&$.&%+$*:%433.2?I9H>.8;I?IIIBIIH    XA:i:1      MD:Z:29A6       NM:i:1





SOLUTION


RERAN MANUALLY FROM MERGE SUBDIR hit.sam TO SNP CALLING


FILE 6 hit.sam IS PRESENT BUT NOT SORTED:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/6/chr22
sort -c -k 3,3 -k 4,4n hit.sam

    sort: hit.sam:2: disorder: SRR002271.589:1:1:550:272#0  99      chr22   42172572        255     36M42172737 201     TGTGGGAAGAAGAAAGTGAGAAATCTGGAGGAGGAT    IIIIIIIIIIIIIIIIIIIIBIII?II77:0)@B%1    XA:i:0      MD:Z:36 NM:i:0


screen -S bowtie-4

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/4/chr22

./mergeSam-chr22.sh    
./sortSam-chr22.sh
./gzipFile.sh      
./samToSnp-chr22.sh      


screen -S bowtie-5

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/5/chr22

./mergeSam-chr22.sh    
./sortSam-chr22.sh
./gzipFile.sh      
./samToSnp-chr22.sh      



screen -S bowtie-6

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/6/chr22

./mergeSam-chr22.sh    
./sortSam-chr22.sh
./gzipFile.sh      
./samToSnp-chr22.sh      



screen -S bowtie-9

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/autochr22/bowtie/9/chr22

./mergeSam-chr22.sh    
./sortSam-chr22.sh
./gzipFile.sh      
./samToSnp-chr22.sh      






EARLIER RUN ON FILE 1 (OK):
---------------------------

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1 \
--params "-k 40" \
--distance 2000 \
--species human \
--label bowtie-autochr22-1 \
--maxjobs 1000 \
--queue large \
--keep \
--cluster LSF \
--cpus 4 \
--reads 1000000


\
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/bowtie-autochr22-1.out 


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/chr22
ll

    
    -rwxrwxrwx  1 syoung root 2.9K Sep 30 01:08 BOWTIE-chr22.sh
    -rwxrwxrwx  1 syoung root 2.9K Sep 28 22:02 chr22.sh
    -rwxrwxrwx  1 syoung root  888 Sep 30 01:27 gzipFile.sh
    -rw-rw-rw-  1 syoung root 1.7K Sep 30 01:28 gzipFile-stdout.txt
    -rw-rw-rw-  1 syoung root  13M Sep 30 01:28 hit.filter
    -rwxrwxrwx  1 syoung root 1.1K Sep 30 00:42 hitIdFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Sep 30 00:42 hitIdFiles-chr22-stdout.txt
    -rw-rw-rw-  1 syoung root  27M Sep 30 01:28 hit.raw
    -rw-rw-r--  1 syoung root 533M Oct  1 01:19 hit.sam
    -rw-rw-r--  1 syoung root 123M Oct  1 01:18 hit.sam.bkp.gz
    -rw-rw-rw-  1 syoung root 123M Sep 30 01:27 hit.sam.gz
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 01:27 hit.sam.head
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 01:27 hit.sam.tail
    -rw-rw-rw-  1 syoung root 9.4M Sep 30 01:28 hit.snp
    -rwxrwxrwx  1 syoung root  18K Sep 30 01:13 mergeSam-chr22.sh
    -rw-rw-rw-  1 syoung root 7.5K Sep 30 01:13 mergeSam-chr22-stdout.txt
    -rw-rw-r--  1 syoung root  14M Sep 30 00:42 out.hitid.bkp
    -rwxrwxrwx  1 syoung root 1.6K Sep 30 01:28 samToSnp-chr22.sh
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 01:28 samToSnp-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.0K Sep 30 00:42 sortHitFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 00:42 sortHitFiles-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.3K Sep 30 01:14 sortSam-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Sep 30 01:27 sortSam-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.3K Sep 30 01:11 subdirSamHits-chr22.sh



USING -k 40 PARAMETER
---------------------

SETTING --params "-k 40" RESULTED IN 12GB out.hitid FILE!!!





</entry>



<entry [Fri Oct  1 12:45:26 EDT 2010] DOWNLOAD NA18507 DATA IN SRA FORMAT AND CONVERT INTO BOTH CSFASTA AND FASTQ>




1. DOWNLOAD SRA FILE

MAKE DIRS:

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374/fastq
mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374/sra

DOWNLOAD FASTQ:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374/fastq
wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000726/SRX003913/SRR015374.fastq.bz2
wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000726/SRX003913/SRR015374_1.fastq.bz2
wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000726/SRX003913/SRR015374_2.fastq.bz2


DOWNLOAD SRA:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374/sra
wget ftp://ftp.ncbi.nlm.nih.gov/sra/sra-instant/sra/ByExp/SRX/SRX003/SRX003913/SRR015374/SRR015374.sra



####NB: THIS RUN IS FASTQ ORIGINALLY, SO CAN'T BE CONVERTED TO CSFASTA???
####
####USE SMALLER FILE (1.4GB)
####
####mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sra/SRX000601/SRR003971
####cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sra/SRX000601/SRR003971
####wget ftp://ftp.ncbi.nlm.nih.gov/sra/sra-instant/sra/ByExp/SRX/SRX000/SRX000601/SRR003971/SRR003971.sra
####ll 
####    -rw-rw-r-- 1 syoung root 1.4G Oct  1 15:48 SRR003971.sra
####



#### NB: USES .sra FILE AS INPUT, NOT FASTQ
####
####ftp://ftp.ncbi.nlm.nih.gov/sra/SeqSamples/SRS000/SRS000101/ERX000187
####
####
####mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRS000101/ERX00018
####cd /scratch/syoung/base/pipeline/SRA/NA18507/SRS000101/ERX00018
####wget ftp://ftp.ncbi.nlm.nih.gov/sra/SeqSamples/SRS000/SRS000101/ERX000187/ERR002186_1.fastq.bz2
####bzip2 -dc ERR002186_1.fastq.bz2 > ERR002186_1.fastq
####



2. CONVERT TO FASTQ USING fastq-dump

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374/sra

/nethome/syoung/base/apps/sra/sra_toolkit-1.0.0-b10/glibc.6/x86_64/fastq-dump \
--dumpbase \
-A SRR015374 \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374/sra/SRR015374.sra

    2010-10-02 03:56:27 PID 15382 INFO: Success SRR015374 138874654 spots

OUTPUT FILE:

    @SRR015374.32 BARB_20071114_1_YorubanMP-BC4_1_12_520 length=25
    CATACCAACCATGTGCATGTCTATG
    +SRR015374.32 BARB_20071114_1_YorubanMP-BC4_1_12_520 length=25
    *9('(''-7')5447%653%'45-/
    @SRR015374.33 BARB_20071114_1_YorubanMP-BC4_1_12_580 length=25
    ATATGTCAGATTGATAGGGTGTTTC
    +SRR015374.33 BARB_20071114_1_YorubanMP-BC4_1_12_580 length=25
    -(*%%%,1%-8<65''&%*/3.+8'
    @SRR015374.34 BARB_20071114_1_YorubanMP-BC4_1_12_687 length=25
    CTTTCATTATTCCACCCCACCTTCC


2. CONVERT TO CSFASTA USING abi-dump

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374

/nethome/syoung/base/apps/sra/sra_toolkit-1.0.0-b10/glibc.6/x86_64/abi-dump \
-path /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374 \
SRR015374.sra

head SRR015374.sra_F3.csfasta
    
    # Title: BARB_20071114_1_YorubanMP-BC4_
    >SRR015374.sra.1 1_6_678_F3
    T0030011000002120322220223
    >SRR015374.sra.2 1_6_1142_F3
    T1011010321313123321022222
    >SRR015374.sra.3 1_6_1616_F3
    T2220012213121322223113320
    >SRR015374.sra.4 1_6_1634_F3
    T0022212130120220011110111
    >SRR015374.sra.5 1_6_1701_F3
    ...
    >SRR015374.sra.32 1_12_520_F3
    T2133101010131113131122331
    >SRR015374.sra.33 1_12_580_F3
    T3333112122301233200111002
    >SRR015374.sra.34 1_12_687_F3
    T2200213033020110001102020
    >SRR015374.sra.35 1_12_1026_F3
    T2310200331002012333203120
    >SRR015374.sra.36 1_12_1139_F3
    T0012001130003021331312133
    >SRR015374.sra.37 1_12_1563_F3
    T3030022222222220021222320



head SRR015374.sra_F3_QV.qual

    # Title: BARB_20071114_1_YorubanMP-BC4_
    >SRR015374.sra.1 1_6_678_F3
    26 4 6 27 25 17 13 8 5 26 27 27 4 5 23 24 9 4 15 22 26 5 11 9 11 
    >SRR015374.sra.2 1_6_1142_F3
    13 14 27 23 26 19 18 21 26 7 4 19 20 24 7 13 23 18 4 23 5 12 22 25 21 
    >SRR015374.sra.3 1_6_1616_F3
    26 27 5 16 27 11 21 27 4 27 8 18 17 10 25 14 8 15 4 27 8 12 25 19 24 
    >SRR015374.sra.4 1_6_1634_F3
    23 15 25 25 26 25 26 24 27 26 25 26 20 21 20 9 24 26 24 27 22 27 26 27 27 
    >SRR015374.sra.5 1_6_1701_F3
    ...
    >SRR015374.sra.32 1_12_520_F3
    9 24 7 6 7 6 6 12 22 6 8 20 19 19 22 4 21 20 18 4 6 19 20 12 14 
    >SRR015374.sra.33 1_12_580_F3
    12 7 9 4 4 4 11 16 4 12 23 27 21 20 6 6 5 4 9 14 18 13 10 23 6 
    >SRR015374.sra.34 1_12_687_F3
    21 27 17 6 13 6 5 13 13 23 12 7 5 24 6 19 9 23 16 10 5 14 9 23 22 
    >SRR015374.sra.35 1_12_1026_F3
    27 27 16 19 26 20 25 23 24 26 22 27 26 14 27 27 26 23 16 24 22 26 18 17 8 
    >SRR015374.sra.36 1_12_1139_F3
    27 27 27 24 27 27 27 25 27 14 25 26 27 4 18 18 27 27 21 26 21 25 7 20 12 
    >SRR015374.sra.37 1_12_1563_F3
    8 11 21 27 26 18 23 17 8 9 14 4 21 4 24 7 23 19 22 7 6 24 4 7 16 




/nethome/syoung/base/apps/sra/sra_toolkit-1.0.0-b10/glibc.6/x86_64/abi-dump \
-path /scratch/syoung/base/pipeline/SRA/NA18507/SRP000726/SRX003913/SRR015374/sra/SRR015374.sra \
-origfmt \
SRR015374
    
    2010-10-01 20:29:49 PID 28382 ERROR: path invalid while opening manager within database module  - Failed for accession SRR015374
    






####cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sra/SRX000601/SRR003971
####/nethome/syoung/base/apps/sra/sra_toolkit-1.0.0-b10/glibc.6/x86_64/fastq-dump -C -A SRR003971 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sra/SRX000601/SRR003971/SRR003971.sra
####    
####    2010-10-01 19:51:42 PID 27475 ERROR: param empty while validating argument list  - Expected table path
####    [syoung@u02 SRR003971]$ /nethome/syoung/base/apps/sra/sra_toolkit-1.0.0-b10/glibc.6/x86_64/fastq-dump -C /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sra/SRX000601/SRR003971/SRR003971.sra
####    2010-10-01 19:52:26 PID 27478 ERROR: param empty while validating argument list  - Expected accession
####    [syoung@u02 SRR003971]$ /nethome/syoung/base/apps/sra/sra_toolkit-1.0.0-b10/glibc.6/x86_64/fastq-dump -C -A SRR003971 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sra/SRX000601/SRR003971/SRR003971.sra
####    
####    
####    2010-10-01 19:54:09 PID 27479 INFO: Success SRR003971 1697825 spots
####
####
####
####BUT OUTPUT FASTQ FILES ONLY (NO CSFASTA):
####
####cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sra/SRX000601/SRR003971
####ll
####
####    -rw-rw-r-- 1 syoung root 290M Oct  1 15:54 SRR003971_1.fastq
####    -rw-rw-r-- 1 syoung root 290M Oct  1 15:54 SRR003971_2.fastq
####    -rw-rw-r-- 1 syoung root  15M Oct  1 15:54 SRR003971.fastq
####    -rw-rw-r-- 1 syoung root 1.4G Oct  1 15:48 SRR003971.sra



NOTES
-----

1. fastq-dump USAGE

/nethome/syoung/base/apps/sra/sra_toolkit-1.0.0-b10/glibc.6/x86_64/fastq-dump
    
    Version: 1.2.0    Usage:

      ./fastq-dump [options] [ -A ] <accession>
      ./fastq-dump [options] <path>
    
        -A, --accession             Accession.

Options:

        -D, --table-path            Path to accession data.
        -O, --outdir                Output directory. Default: '.'
        -N, --minSpotId             Minimum spot id to output.
        -X, --maxSpotId             Maximum spot id to output.
        -G, --spot-group            Split into files by SPOT_GROUP (member).
        -T, --group-in-dirs         Split into subdirectories instead of files.
        -K, --keep-empty-files      Do not delete empty files.
        -L, --log-level             Logging level: 0-13 or fatal|sys|int|err|warn|info|debug[1-10]. Default:  info
        -H, --help                  Prints this message.

Format options:

        -M, --minReadLen            Minimum read length to output. Default: 25
        -W, --noclip                Do not clip quality right for spot.
        -F, --origfmt               Excludes SRR accession & length on defline.
        -C, --dumpcs [cskey]        Dump color space sequence (default for ABI SOLID), single letter color space key is optional.
        -B, --dumpbase              Dump base sequence (default for other than ABI SOLID).
        -Q, --offset                Offset to use for quality conversion. Default: 33
        -I, --readids               Append read id after spot id as 'accession.spot.readid' on defline.
        -E, --no-qual-filter        Disable filtering by leading/trailng low quality.
        -SF, --complete              Dump ALL reads in a single file.
        -DB, --defline-seq           sequence defline format specification. String of characters and/or variables.

            Variables are one of:
              $ac - accession, $si - spot id, $sn - spot name, $sg - spot group (barcode),
              $sl - spot length in bases, $ri - read id, $rn - read name, $rl - read length in bases.
            '[]' could be used for an optional output: if all variables in [] yield empty values whole group is not printed.
            Empty value is empty string or 0 for numeric variables.
            Ex: @$sn[_$rn]/$ri - '_$rn' is omitted if name is empty

        -DQ, --defline-qual          quailty defline format specification. If -DB is provided but -DQ ommitted, -DB value is used.
        -alt [n]                    alternative formatting version [1].






2. SRA DATA FORMAT CHANGED TO bz2 

2010-09-07:   The way sequencing data are being presented on the static fastq download pages has been changed.
In order to make more efficient use of disk space resources, NCBI has changed the way sequencing data is presented on the static fastq download pages, as reached here at NCBI.

fastq dumps are provisioned as a convenience to users who want filtered, clipped, and split data. Run objects in native SRA format (SRR, ERR, DRR) are unaffected by this change. fastq files that are provisioned by the other SRAs, European Read Archive (ERA) at EBI and DDBJ Sequence Read Archive (DRA) in Japan, are not affected by this change.

The following changes were implemented:

Removed the length parameter in the defline
Removed the read name in the quality header (i.e. no text following the + character)
Changed the compression method to bzip2
Changed the filename suffix to .bz2
This conversion process invalidated the index tree of downloadable objects. If you get an "invalid tree" error, use the force reload feature of your browser (shift-reload in Firefox or Ctrl-Refresh in Internet Explorer).

We regret any inconvenience this may have caused.





2. NA18507 SOLID SEQUENCING


DOWNLOAD FASTQ:

ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000726/SRX003913

wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000726/SRX003913/SRR015374.fastq.bz2
wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000726/SRX003913/SRR015374_1.fastq.bz2
wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000726/SRX003913/SRR015374_2.fastq.bz2


DOWNLOAD SRA:

wget ftp://ftp.ncbi.nlm.nih.gov/sra/sra-instant/sra/ByExp/SRX/SRX003/SRX003913/SRR015374/SRR015374.sra


PROJECT PAGE

http://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?study=SRP000726

SRP000726  Genome variability analysis of Yoruba in Ibadan, Nigeria (NA18507) by SOLiD mediated whole genome re-sequencing.

Study Type:  Whole Genome Sequencing
Submission:  SRA000272 by ABHTD on 2009-04-15 12:00:00
Abstract:  High-throughput sequencing technologies have greatly increased the power of human genome variability studies. We have prepared multiple paired end libraries with insert sizes ranging from 500 bp to 10 kb and fragment libraries with average insert size of 60-100bp using the NA18507 DNA belonging to a Yoruba individual. These libraries were extensively sequenced using SOLiD (ABI's next generation sequencing platform). The deep sequence coverage obtained from these diverse libraries not only helps identify SNPs in this genome but also submicroscopic structural variations like insertions/deletions. In this high density genome re-sequencing effort we address the challenges of constructing multiple sized mate pair libraries of complex genomes.
Description:  n/a
Project:  28957
Center Project:  n/a
NCBI Link:  /pubmed:19546169
External Links:  Poster Genome Variability Analysis


SHORT READ ARCHIVE EXPERIMENT PAGE
http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR016121

Experiment: SRX004555
A collection of four instrument runs derived from a single library preparation.
Run:
Accession:     
Alias: AB_JOAN_20080911_2
Instrument model: AB SOLiD System
Date of run: 2008-09-11 06:02:00
Run center: ABHTD
Statistics:
Number of spots: 321229438
Number of reads: 642458876
Other:
Study: Genome variability analysis of Yoruba in Ibadan, Nigeria (NA18507) by SOLiD mediated whole genome re-sequencing.
Design: A collection of four instrument runs derived from a single library preparation.
Platform: ABI_SOLID
Sample: SRS000101
Library Name: NA18507 CRC
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'Reverse,5'-3'Forward, NOMINAL_LENGTH=1500, NOMINAL_SDEV=200)
Library Construction Protocol: We prepared four libraries by shearing 200g of NA18507 genomic DNA to 1.5kb. Libraries were prepared as a single sample until circularization, and then the sample was split into two parts to compare library excision when using S1 nuclease alone or a combination of T7 exonuclease and S1 nuclease. Prior to amplification the two libraries were once again divided in half to compare amplification efficiencies and bias between Invitrogen's Platinum Supermix and Applied Biosystem's SOLiD Library Amplification Master Mix. The slides correspond to the library prep as follows: CLARA_20080903_1 S1-Supermix, JOAN_20080829_1 S1-Master Mix, CLARA_20080903_2 T7/S1-Supermix, JOAN_20080911_2 T7/S1-Master Mix.



</entry>



<entry [Fri Oct  1 03:39:57 EDT 2010] RUN loop.pl ON ELAND.pl>





FIRST ROUND (2-5)
-----------------

screen -S loop-eland-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--replicates 2-5 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label eland-2000bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/%REPLICATE% \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/%REPLICATE%/eland-2000bp-autochr22-%REPLICATE%.out 

    
    Loop::run     replicates_array: 2 3 4 5
    Loop::run     /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl --inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-2.reads_1.sequence.txt --matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-2.reads_2.sequence.txt --inputtype fastq --species human --label eland-2000bp-autochr22-2 --maxjobs 1000 --walltime 24 --queue large --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2 --referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 --cluster LSF --cpus 1 --reads 1000000 --stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/eland-2000bp-autochr22-2.out
    Loop::run     /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl --inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-3.reads_1.sequence.txt --matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-3.reads_2.sequence.txt --inputtype fastq --species human --label eland-2000bp-autochr22-3 --maxjobs 1000 --walltime 24 --queue large --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/3 --referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 --cluster LSF --cpus 1 --reads 1000000 --stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/3/eland-2000bp-autochr22-3.out
    Loop::run     /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl --inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-4.reads_1.sequence.txt --matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-4.reads_2.sequence.txt --inputtype fastq --species human --label eland-2000bp-autochr22-4 --maxjobs 1000 --walltime 24 --queue large --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/4 --referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 --cluster LSF --cpus 1 --reads 1000000 --stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/4/eland-2000bp-autochr22-4.out
    Loop::run     /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl --inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-5.reads_1.sequence.txt --matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-5.reads_2.sequence.txt --inputtype fastq --species human --label eland-2000bp-autochr22-5 --maxjobs 1000 --walltime 24 --queue large --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/5 --referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 --cluster LSF --cpus 1 --reads 1000000 --stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/5/eland-2000bp-autochr22-5.out
    
    Run time: 02:33:31
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl
    6:29AM, 1 October 2010
    ****************************************




SECOND ROUND (6-20)
-------------------

screen -S loop-eland-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--replicates 6-20 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label eland-2000bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/%REPLICATE% \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/%REPLICATE%/eland-2000bp-autochr22-%REPLICATE%.out 

    
    Run time: 11:03:37
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl
    6:54AM, 2 October 2010
    ****************************************



THIRD ROUND (21-33)
-------------------

screen -S loop-eland-autochr22

/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--replicates 21-33 \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/yoruba1-%REPLICATE%.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label eland-2000bp-autochr22-%REPLICATE% \
--maxjobs 1000 \
--walltime 24 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/%REPLICATE% \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/%REPLICATE%/eland-2000bp-autochr22-%REPLICATE%.out 


    Run time: 13:26:02
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl
    6:23AM, 3 October 2010
    ****************************************







NOTES
-----


ERROR:

cd  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/chr22
cat samToSnp-chr22-stdout.txt 
    ...
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    ...



FOR FAILED RUNS 2 AND 3, RERAN sort, gzip AND samToSnp SHELL SCRIPTS MANUALLY:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/chr22
./sortSam-chr22.sh



WHICH RUNS:

sort -t "       " -k 3,3 -k 4,4n /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/chr22/hit.sam -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/chr22/hit.sam.temp;  mv /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/chr22/hit.sam.temp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/chr22/hit.sam


NOW CHECK IS SORTED:

cd  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/2/chr22
sort -c -k 3,3 -k 4,4n hit.sam

    OK!!!!! STRANGE.


SAME ERROR WITH SEQUENCE 3, WHICH IS ***NOT*** SORTED:


samToSnp SHELL SCRIPT:

/nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa -t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/3/chr22/hit.sam.gz

ERROR OUTPUT:

    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)
    [bam_pileup_core] the input is not sorted (reads out of order)


SAM FILE IS NOT SORTED:

sort -c -k 3,3 -k 4,4n hit.sam
    
    sort: hit.sam:3: disorder: SRR002271.1244:1:1:439:703   97      chr22   23071527        13      36M  23071717 226     TTGTTATGCAGAAAATGATTTCAATCTCAGTTAAAA    +++++++++++++)+++(+++++%+++++&+++#++    MD:Z:36       SM:i:13








</entry>



<entry [Fri Oct  1 02:39:57 EDT 2010] CLEAN UP NA18507 SEQUENCES TO FREE SPACE ON SCRATCH FOR ELAND.pl RUNS OF ALL SAMPLES (1-33)>




1. REMOVE AUTOGENOME

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1


2. REMOVE ALL DIRECTORIES CONTAINING FASTQ FILES CREATED BY printSubfiles.pl

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth


DIRS="*"
for DIR in $DIRS;
do
    if [ -d `pwd`/$DIR ]; then    
        rm -fr `pwd`/$DIR/*fastq
    fi;
done;



3. LEFT THESE DIRECTORIES INTACT BECAUSE THEY CONTAIN THE PRIMARY INPUT FILES:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader





</entry>



<entry [Mon Sep 27 23:59:23 EDT 2010] RUN BOWTIE.pl USING 2000 BP 100M READS AGAINST chr22>




INPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader
ls -al *sequence.txt

    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_2.sequence.txt


(FOR PREPARATION OF INPUT FILES, SEE:
Sat Sep 25 20:14:35 EDT 2010
RUN READ SAMPLING WITH 2,000 BP INSERT READS)

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1

screen -S bowtie-autochr22-1


/nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1 \
--params "-k 40" \
--distance 2000 \
--species human \
--label bowtie-autochr22-1 \
--maxjobs 1000 \
--queue large \
--keep \
--cluster LSF \
--cpus 4 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/bowtie-autochr22-1.out 


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/chr22
ll
        
    -rwxrwxrwx  1 syoung root 2.9K Sep 30 01:08 BOWTIE-chr22.sh
    -rwxrwxrwx  1 syoung root 2.9K Sep 28 22:02 chr22.sh
    -rwxrwxrwx  1 syoung root  888 Sep 30 01:27 gzipFile.sh
    -rw-rw-rw-  1 syoung root 1.7K Sep 30 01:28 gzipFile-stdout.txt
    -rw-rw-rw-  1 syoung root  13M Sep 30 01:28 hit.filter
    -rwxrwxrwx  1 syoung root 1.1K Sep 30 00:42 hitIdFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Sep 30 00:42 hitIdFiles-chr22-stdout.txt
    -rw-rw-rw-  1 syoung root  27M Sep 30 01:28 hit.raw
    -rw-rw-r--  1 syoung root 533M Oct  1 01:19 hit.sam
    -rw-rw-r--  1 syoung root 123M Oct  1 01:18 hit.sam.bkp.gz
    -rw-rw-rw-  1 syoung root 123M Sep 30 01:27 hit.sam.gz
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 01:27 hit.sam.head
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 01:27 hit.sam.tail
    -rw-rw-rw-  1 syoung root 9.4M Sep 30 01:28 hit.snp
    -rwxrwxrwx  1 syoung root  18K Sep 30 01:13 mergeSam-chr22.sh
    -rw-rw-rw-  1 syoung root 7.5K Sep 30 01:13 mergeSam-chr22-stdout.txt
    -rw-rw-r--  1 syoung root  14M Sep 30 00:42 out.hitid.bkp
    -rwxrwxrwx  1 syoung root 1.6K Sep 30 01:28 samToSnp-chr22.sh
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 01:28 samToSnp-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.0K Sep 30 00:42 sortHitFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.8K Sep 30 00:42 sortHitFiles-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.3K Sep 30 01:14 sortSam-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Sep 30 01:27 sortSam-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.3K Sep 30 01:11 subdirSamHits-chr22.sh
    
head hit.snp
    
    chr22   16051998        c       T       45      45      60      6       TTttTT  (II)II
    chr22   16052111        c       G       36      36      60      3       g$gg    III
    chr22   16060517        t       Y       1       37      60      4       .CCC    IHHH
    chr22   16061232        G       R       4       37      60      3       .aa     III
    chr22   16064498        t       Y       4       37      60      3       Cc,     III
    chr22   16065219        a       R       105     105     60      40      .GG.....G.GG....GG.G,..,,G.........T,.^~G^~.    IIII9IIII@IIIIIDIIII&?IIIIIIIIIIIIIIHII8
    chr22   16065273        t       Y       118     118     60      26      .$,CC,cCc.,..,,,,.c,,.cc.^~,^~, II2C3IIII.IIEI(III%II)II,*
    chr22   16065281        a       R       58      58      60      24      g,.,Gg..,g,,.,,,.,,.,,,C        II>III2IIIIIII&II0II6.%I
    chr22   16065288        t       Y       40      68      60      19      ,AC,,,,Ca,c.a,.,,c.     IA7IIIIII/II,II15>I
    chr22   16065336        t       Y       52      52      60      21      .c,,..,.,,,c.,,,cc,,^~c 2II2II9DI4BEI-I+II%48



NOTES
-----


PROBLEM

emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/bowtie-autochr22-1.out
    
    Cluster::sortHitFiles    command: sort /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/chr22/out.hitid -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/chr22/out.hitid; 
    Doing runJobs, no. jobs: 1
    Cluster::runJobs    Running 1 jobs
    Cluster::runJobs    scriptfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/chr22/sortHitFiles-chr22.sh


em sortHitFiles-chr22-stdout.txt

    sort: open failed: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/bowtie/1/chr22/out.hitid: No such file or directory


SOLUTION

NOT A REAL PROBLEM. UNCOMMENTED UPSTREAM CODE TO GENERATE out.hit




BOWTIE ARGUMENTS

/nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie

    Reporting:
      -k <int>           report up to <int> good alignments per read (default: 1)
      -a/--all           report all alignments per read (much slower than low -k)
      -m <int>           suppress all alignments if > <int> exist (def: no limit)
      -M <int>           like -m, but reports 1 random hit (MAPQ=0); requires --best
      --best             hits guaranteed best stratum; ties broken by quality
      --strata           hits in sub-optimal strata aren't reported (requires --best)




</entry>



<entry [Mon Sep 27 23:59:23 EDT 2010] RUN MAQ.pl USING 2000 BP 100M READS AGAINST chr22>



INPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader
ls -al *sequence.txt

    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_2.sequence.txt


(FOR PREPARATION OF INPUT FILES, SEE:
Sat Sep 25 20:14:35 EDT 2010
RUN READ SAMPLING WITH 2,000 BP INSERT READS)


FILE 1
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/1

screen -S maq-autochr22-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/1 \
--reads 1000000 \
--cluster LSF \
--queue large \
--maxjobs 5000 \
--label maq-autochr22-1 \
--species human \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/1/maq-autochr22-1.out 

    MAQ.pl    Run time: 02:08:57
    MAQ.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl
    MAQ.pl    10-10-01 04:11:18
    MAQ.pl    ****************************************



SUCCESSFUL RUN:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/1/chr22
ll

    -rwxrwxrwx  1 syoung root  879 Oct  1 04:05 gzipFile.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  1 04:11 gzipFile-stdout.txt
    -rw-rw-rw-  1 syoung root 1.2M Oct  1 04:18 hit.filter
    -rwxrwxrwx  1 syoung root 1.1K Oct  1 03:46 hitIdFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  1 03:49 hitIdFiles-chr22-stdout.txt
    -rw-rw-rw-  1 syoung root 1.3G Oct  1 04:18 hit.raw
    -rw-rw-rw-  1 syoung root 936M Oct  1 03:46 hit.sam.gz
    -rw-rw-rw-  1 syoung root 1.8K Oct  1 04:05 hit.sam.head
    -rw-rw-rw-  1 syoung root 1.7K Oct  1 04:05 hit.sam.tail
    -rw-rw-rw-  1 syoung root 1.1M Oct  1 04:18 hit.snp
    -rwxrwxrwx  1 syoung root 2.5K Oct  1 02:02 maq-chr22.sh
    -rwxrwxrwx  1 syoung root  17K Oct  1 02:24 mergeSam-chr22.sh
    -rw-rw-rw-  1 syoung root 7.3K Oct  1 02:26 mergeSam-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.6K Oct  1 04:11 samToSnp-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  1 04:18 samToSnp-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1012 Oct  1 03:49 sortHitFiles-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  1 03:55 sortHitFiles-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.2K Oct  1 02:24 sortSam-chr22.sh
    -rw-rw-rw-  1 syoung root 1.7K Oct  1 03:46 sortSam-chr22-stdout.txt
    -rwxrwxrwx  1 syoung root 1.1K Oct  1 02:23 subdirMapToSam-chr22.sh
    -rwxrwxrwx  1 syoung root 1.3K Oct  1 02:24 subdirSamHits-chr22.sh


head hit.snp

    chr22   16050473        a       C       36      36      60      3       cc^~C   III
    chr22   16050474        g       C       36      36      60      3       ccC     III
    chr22   16054881        C       G       36      36      37      3       G$GG    I1I
    chr22   16056369        *       +GAT/+GAT       279     3177    10      86      +GAT    *       1  85       0       0       0
    chr22   16059984        a       C       28      33      41      3       G$c^~C  %II
    chr22   16061227        T       C       36      36      60      3       CC^{C   I=I
    chr22   16061228        C       T       36      36      60      3       T$TT    ;II
    chr22   16062909        C       T       48      48      25      7       t$t$t$Tttt      III+II2
    chr22   16062910        A       G       39      39      33      4       G$g$gg  $II*
    chr22   16064008        T       A       36      36      60      3       A$a^zA  =CI




FILE 2
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2

screen -S maq-autochr22-2

/nethome/bioinfo/apps/agua/0.5/bin/apps/aligners/MAQ.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-2.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-2.reads_2.sequence.txt \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2 \
--reads 1000000 \
--cluster LSF \
--queue large \
--maxjobs 5000 \
--label maq-autochr22-1 \
--species human \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/maq-autochr22-1.out 


FAILED WITH ERROR:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/1

emacs maq-chr22-outerr.txt

    maq: match.cc:557: int ma_match(int, char**): Assertion `fp_bfq_l' failed.


emacs maq-chr22-stdout.txt

    Creating outputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/1
    Moving to outputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/1
    Running MAQ: time /nethome/bioinfo/apps/maq/0.7.1/maq match /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/1/out.map /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22/chr22.bfa /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/1/maq-autochr22-1_1.1.bfq /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/1/maq-autochr22-1_2.1.bfq  &> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/1/maq-chr22-outerr.txt
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/maq-chr22.sh: line 30: 25334 Aborted                 (core dumped) /nethome/bioinfo/apps/maq/0.7.1/maq match /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/$LSB_JOBINDEX/out.map /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chr22/chr22.bfa /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/$LSB_JOBINDEX/maq-autochr22-1_1.$LSB_JOBINDEX.bfq /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/$LSB_JOBINDEX/maq-autochr22-1_2.$LSB_JOBINDEX.bfq >&/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/maq/2/chr22/$LSB_JOBINDEX/maq-chr22-outerr.txt


</entry>



<entry [Mon Sep 27 23:59:23 EDT 2010] RUN ELAND.pl USING 2000 BP 100M READS AGAINST chr22>




INPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader
ls -al *sequence.txt

    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_2.sequence.txt


(FOR PREPARATION OF INPUT FILES, SEE:
Sat Sep 25 20:14:35 EDT 2010
RUN READ SAMPLING WITH 2,000 BP INSERT READS)


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1

screen -S eland-autochr22-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label srx001539-autochr22-1 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1 \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/eland.srx001539-autochr22-1.out 


    #Run time: 00:33:39
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl
    #1:50AM, 30 September 2010
    #****************************************

    Run time: 00:40:17
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl
    0:33AM, 1 October 2010
    ****************************************






/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22/chr22 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1_1.1.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1_2.1.txt





NOTES
-----


PROBLEM 

samToSnp FAILS WITH ERROR: reference 'chr22.fa' is recognized as '*'.


tail samToSnp-chr22-stdout.txt

    [sam_read1] reference 'chr22.fa' is recognized as '*'.



DIAGNOSIS

HITS CONTAIN chr22.fa INSTEAD OF chr22. THE NEWLY SQUASHED GENOME FILES ARE MISNAMED - THEY HAVE AN EXTRA '.fa' IN THEM WHICH ELAND PICKS UP AND USES AS PART OF THE REFERENCE NAME FOR EACH READ HIT IN THE *export.txt AND *extended.txt FILES


cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22/
/nethome/syoung/base/apps/GAPipeline/1.6.0/bin/squashGenome ./ chr22



head hit.sam

SRR005734.12612956:4:39:1116:140        153     chr22.fa        14430009        81      36M     *       0       0       AAGTCCCAGGACTTCAGAAGAGCTCTGTGACCTTGG    )+!"++++++++++++++++++++++++++++++++    MD:Z:8T2C24     SM:i:81


RENAME chr22.fa.2bpb AND chr22.fa.vld AND RERUN ELAND_standalone.pl

USE HEAD 1000 AGAINST chr22
---------------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/temp2

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1000-1_1.1.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1000-1_2.1.txt


head reanalysis_2_export.txt
    SRR005718.20            1       1       371     125     0       2       TTTATTTTATCTTATTTTATTTTATTTTGAGACAAG    IIIIIIIIIIIIIIIIIIIIIIIIIIII+A.C7I7I      chr22           41747817        F       10T23G1 10      0                       0       N       Y



USE HEAD 1000 AGAINST chr21
---------------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/temp3

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr21 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1000-1_1.1.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1000-1_2.1.txt



USE HEAD 1000 AGAINST chr20
---------------------------

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/temp4
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/temp4

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr20 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1000-1_1.1.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/1/srx001539-autochr22-1000-1_2.1.txt


emacs reanalysis_2_export.txt
    ...
    SRR005718.31            1       1       837     222     0       2       GCCTGAGCAGTATATAACTCCAGGAAGGGGGCAGCC    IIIIIIII9IIIIIIIIIIIIFII39IIHII<7I,7       chr20           51506569        F       36      87      0                       -1927   R       Y
    ...
    

SOLUTION

1. RELABEL SQUASHED GENOME FILE AND RERUN ANALYSIS

2. CREATE SUBDIRS INSIDE THE SUBDIRS SO THAT WHEN AN INDIVIDUAL CHROMOSOME SUBDIR IS SPECIFIED, ELAND.pm WILL LOOK INSIDE THE SUBDIR FOR OTHER SUBDIRS, JUST LIKE WHEN IT IS LOOKING THROUGH THE MAIN DIRECTORY FOR SUBDIRS FOR EACH CHROMOSOME.

E.G.:

mv chr22.fa.2bpb chr22.2bpb
mv chr22.fa.vld chr22.vld

3. GENERATE ANEW SQUASHED GENOME FILES

mkdir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland
cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland

#### COPY FASTA FILES
cp ../../fasta/*  

#### RENAME FASTA FILES
FILES="*"
for FILE in $FILES;
do
    CHROM=${FILE/.fa/};
    echo "mv $FILE $CHROM";
    mv $FILE $CHROM;
done;


#### SQUASH GENOMES
cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland

FILES="*"
for FILE in $FILES;
do
    echo "time /nethome/syoung/base/apps/GAPipeline/1.6.0/bin/squashGenome . $FILE";
    time /nethome/syoung/base/apps/GAPipeline/1.6.0/bin/squashGenome . $FILE;
done;


#### REMOVE FASTA FILES
cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland
FILES="*";
for FILE in $FILES;
do

    CHROM=$(echo $FILE | egrep "^chr[0-9XYM]+.2bpb");
    if [ "$CHROM" != "" ]; then
        CHROM=${CHROM/.2bpb/};
        echo REMOVING CHROM: $CHROM;
        rm -fr $CHROM
    fi;

done;


#### CREATE A SUBDIR FOR EACH SQUASHED CHROMOSOME AND LINK SQUASHED FILES
cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland
FILES="*";
for FILE in $FILES;
do

    CHROM=$(echo $FILE | egrep "^chr[0-9XYM]+.2bpb");
    if [ "$CHROM" != "" ]; then
        CHROM=${CHROM/.2bpb/};
        echo MAKING DIR: $CHROM;
        mkdir $CHROM
        ln -s `pwd`/$CHROM.2bpb `pwd`/$CHROM/$CHROM.2bpb
        ln -s `pwd`/$CHROM.vld `pwd`/$CHROM/$CHROM.vld
    fi;

done;



#### CREATE A SUB-SUBDIR FOR EACH SQUASHED CHROMOSOME AND LINK SQUASHED FILES
cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland
FILES="*";
for FILE in $FILES;
do

    CHROM=$(echo $FILE | egrep "^chr[0-9XYM]+.2bpb");
    if [ "$CHROM" != "" ]; then
        CHROM=${CHROM/.2bpb/};
        echo MAKING DIR: $CHROM;
        mkdir $CHROM/$CHROM
        ln -s `pwd`/$CHROM.2bpb `pwd`/$CHROM/$CHROM/$CHROM.2bpb
        ln -s `pwd`/$CHROM.vld `pwd`/$CHROM/$CHROM/$CHROM.vld
    fi;

done;






OLD: FIX ELAND INDEX FILES SUBDIRS


DIRS="*"
for DIR in $DIRS;
do

    if [ -d `pwd`/$DIR ]; then
    
        echo "LOOKING FOR FILE: " `pwd`/$DIR/$DIR.fa.2bpb
        
        if [ -f `pwd`/$FILE/$DIR/$DIR.fa.2bpb ]; then
            echo FILE FOUND: `pwd`/$DIR/$DIR.fa.2bpb;
            mv `pwd`/$FILE/$DIR/$DIR.fa.2bpb `pwd`/$FILE/$DIR/$DIR.2bpb
        fi;

        if [ -f `pwd`/$FILE/$DIR/$DIR.fa.vld ]; then
            echo FILE FOUND: `pwd`/$DIR/$DIR.fa.vld;
            mv `pwd`/$FILE/$DIR/$DIR.fa.vld `pwd`/$FILE/$DIR/$DIR.vld
        fi;
    fi;
done;



1. INSIDE THE SUB-DIRECTORIES, CONVERT ALL chr*.fa.2bpb FILES TO chr*.2bpb FILES AND SIMILARLY FOR chr*.fa.vld TO chr*.vld

DIRS="*"
for DIR in $DIRS;
do

    if [ -d `pwd`/$DIR ]; then
    
        echo "LOOKING FOR FILE: " `pwd`/$DIR/$DIR.fa.2bpb
        
        if [ -f `pwd`/$FILE/$DIR/$DIR.fa.2bpb ]; then
            echo FILE FOUND: `pwd`/$DIR/$DIR.fa.2bpb;
            mv `pwd`/$FILE/$DIR/$DIR.fa.2bpb `pwd`/$FILE/$DIR/$DIR.2bpb
        fi;

        if [ -f `pwd`/$FILE/$DIR/$DIR.fa.vld ]; then
            echo FILE FOUND: `pwd`/$DIR/$DIR.fa.vld;
            mv `pwd`/$FILE/$DIR/$DIR.fa.vld `pwd`/$FILE/$DIR/$DIR.vld
        fi;
    fi;
done;


2. \INSIDE THE SUB-DIRECTORIES, CONVERT ALL chr*.fa.2bpb FILES TO chr*.2bpb FILES AND SIMILARLY FOR chr*.fa.vld TO chr*.vld


cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/
DIRS="*"
for DIR in $DIRS;
do

    if [ -d `pwd`/$DIR ]; then    
        echo "Making dir: " `pwd`/$DIR/$DIR
        mkdir `pwd`/$DIR/$DIR;
        echo "LINKING FILE: " `pwd`/$DIR/$DIR/$DIR.2bpb ;
        ln -s `pwd`/$FILE/$DIR/$DIR.2bpb `pwd`/$FILE/$DIR/$DIR/$DIR.2bpb
        echo "LINKING FILE: " `pwd`/$DIR/$DIR/$DIR.vld ;
        ln -s `pwd`/$FILE/$DIR/$DIR.vld `pwd`/$FILE/$DIR/$DIR/$DIR.vld
    fi;
done;



NOW DO INSIDE THE MAIN DIRECTORY


cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/

DIRS="*"
for DIR in $DIRS;
do

    if [ -d `pwd`/$DIR ]; then
            
        if [ -f `pwd`/$DIR.fa.2bpb ]; then
            echo FILE FOUND: `pwd`/$DIR.fa.2bpb;
            mv `pwd`/$DIR.fa.2bpb `pwd`/$DIR.2bpb
        fi;

        if [ -f `pwd`/$DIR.fa.vld ]; then
            echo FILE FOUND: `pwd`/$DIR.fa.vld;
            mv `pwd`/$DIR.fa.vld `pwd`/$DIR.vld
        fi;
    fi;
done;






/nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label srx001539-autochr22/eland-1 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1 \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--cluster LSF \
--cpus 1 \
--reads 1000000



/nethome/bioinfo/apps/samtools/0.1.6/samtools pileup \
-vcf \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa \
-t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/chr22/hit.sam.gz 


/nethome/bioinfo/apps/samtools/0.1.6/samtools pileup -vcf /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa -t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/chr22/hit.sam.gz | tee /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/chr22/hit.raw | /nethome/bioinfo/apps/samtools/0.1.6/samtools.pl varFilter -D100 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/chr22/hit.filter


awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/chr22/hit.filter > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autochr22/eland/1/chr22/hit.snp




</entry>



<entry [Mon Sep 27 23:59:23 EDT 2010] RUN ELAND.pl USING 2000 BP 100M READ SAMPLE AGAINST ALL CHROMOSOMES >



INPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M

    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:39 yoruba1-1.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:38 yoruba1-1.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:39 yoruba1-2.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:38 yoruba1-2.reads_2.fastq

(FOR PREPARATION OF INPUT FILES, SEE:
Sat Sep 25 20:14:35 EDT 2010
RUN READ SAMPLING WITH 2,000 BP INSERT READS)


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1

screen -S eland-autogenome-1

/nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/yoruba1-1.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label srx001539-autogenome-1 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1 \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--cluster LSF \
--cpus 1 \
--reads 1000000 \
--clean \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/autogenome/1/eland.srx001539-autogenome-1.out 

    RUNNING
    Tue Sep 28 00:07:05 EDT 2010

    Run time: 00:23:17
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl
    0:28AM, 28 September 2010
    ****************************************




####CALCULATE HITS IN *export.txt FILES
####
####/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
####--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
####--replicates chr1,chr2,chr3,chr4,chr5,chr6,chr7,chr8,chr9,chr10,chr11,chr12,chr13,chr14,chr15,chr16,chr17,chr18,chr19,chr20,chr21,chr22,chrX,chrY \
####--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/1/srx001539_1.1.txt \
####--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/%REPLICATE%/1/reanalysis_1_export.txt \
####--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/elandHits.%REPLICATE%.1.out
####
####
####FOR HIT RESULTS SEE ABOVE:
####
####Fri Sep 24 14:32:39 EDT 2010
####COMPARISON OF MANUAL AND AUTOMATED RUNS OF ELAND STANDALONE ON SRX001539 10M READ FILES
####
####
####
####/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
####--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
####--replicates 1-5 \
####--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/%REPLICATE%/srx001539_1.%REPLICATE%.txt \
####--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/chr1/%REPLICATE%/reanalysis_1_export.txt \
####--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/elandHits.%REPLICATE%.out
####
####    
####    Run time: 00:18:32
####    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl
####    2:40PM, 24 September 2010
####    ****************************************
####
####WHICH RUNS
####
####/nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
####--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/1/srx001539_1.1.txt \
####--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/chr1/1/reanalysis_1_export.txt
####
####--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/elandHits.1.out



</entry>



<entry [Mon Sep 27 23:43:16 EDT 2010] PEGASUS QUEUE WALL TIMES>



Summary of CCS/HPC Pegasus Cluster Job Queues
Partition	Queue/Class	Max CPU's	Job Time Limit	Default Job Time	Job Priority
General	debug	8	0.5 hrs	0.5 hrs	200
General	small	64	168 hrs	24 hrs	100
General	medium	128	48 hrs	6 hrs	90
Dedicated	amd	160	168 hrs	168 hrs	100
General	large	256	24 hrs	4 hrs	80
Dedicated	xlarge	512	24 hrs	3 hrs	70


</entry>



<entry [Mon Sep 27 16:26:49 EDT 2010] FIX BOWTIE HIT COUNT UNIQUES>




CONTINUATION OF 'RUN BOWTIE.pl AGAINST ALL CHROMOSOMES' IN PREVIOUS LOG:

Fri Sep 24 00:00:39 EDT 2010
RUN ELAND AND BOWTIE AGAINST SRX001539 USING BOTH GENOME (BOWTIE) AND CHROMOSOMES (ELAND, BOWTIE)


NB: GOT VERY LOW NUMBER OF HITS BECAUSE DID NOT USE '-rf' OPTION FOR BOWTIE

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo/chr1
lines hit.sam
    hit.sam: 205047

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/
lines srx001539-1.reads_1.sequence.txt
    srx001539-1.reads_1.sequence.txt: 19999996

% HITS = 205047/4999999 = 0.0410094082018816


mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo

###screen -S bowtie-autochromo

/nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
--distance 2000 \
--species human \
--label srx001539 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo \
--keep \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--cluster LSF \
--cpus 4 \
--reads 1000000



\
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo/bowtie.out    
    
    BOWTIE.pl    Run time: 00:12:34
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    12:36AM, 24 September 2010
    BOWTIE.pl    ****************************************






/nethome/bioinfo/apps/samtools/0.1.6/samtools pileup \
-vcf \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fa \
-t /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools/chr22.fai \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo/chr22/hit.sam.gz 




</entry>



<entry [Thu Sep 23 23:06:17 EDT 2010] TEST ELAND_standalone.pl ALIGNMENT ORDER>



TWO QUESTIONS:

- GIVEN IDENTICAL CHROMOSOMES, WHERE DOES ELAND PLACE THE ALIGNMENT?

- GIVEN IDENTICAL SEQUENCES ON THE SAME CHROMOSOME, WHERE DOES ELAND PLACE THE ALIGNMENT?


ANSWERS:

- EXTENDED FILE CONTAINS ALL MATCHES. MULTIPLE CHROMOSOME MATCHES CAUSED HIT TO BE REJECTED 6:0:0

- EXTENDED FILE CONTAINS ALL MATCHES. MULTIPLE LOCATION PERFECT MATCHES CAUSED HIT TO BE REJECTED 2:0:0



mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order


READS

emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_1.txt
@TESTREAD:1:1:1:1#0/1
AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG
+TESTREAD:1:1:1:1#0/1
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_2.txt
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_2.txt
@TESTREAD:1:1:1:1#0/2
CCCCTTTTCCCCTTTTTCCCCCTTTTCCCCCCTTT
+TESTREAD:1:1:1:1#0/2
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII


REFERENCE SEQUENCES

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference/chr1.fa
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference/chr1.fa
>chr1
CCCCCCCCCAAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGGTTTTAAATTTTAAAATTTTATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCATGCCCCCCCCCAAAGGGGGGAAAAGGTGGAAAAAGGGGAAAAGGGGCCCCCCCCC

COMPARE WITH READ (1 BASE DIFFERENCE):
                                                                AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference/chr2.fa
cd emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference/chr2.fa
>chr2
AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGGCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCAAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference/chr3.fa
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference/chr3.fa
>chr3
AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGGCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCAAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference
/nethome/syoung/base/apps/GAPipeline/1.6.0/bin/squashGenome ./ chr1.fa
/nethome/syoung/base/apps/GAPipeline/1.6.0/bin/squashGenome ./ chr2.fa
/nethome/syoung/base/apps/GAPipeline/1.6.0/bin/squashGenome ./ chr3.fa


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference
/nethome/bioinfo/apps/samtools/0.1.6/samtools faidx chr1.fa
/nethome/bioinfo/apps/samtools/0.1.6/samtools faidx chr2.fa
/nethome/bioinfo/apps/samtools/0.1.6/samtools faidx chr3.fa

cat chr1.fa.fai
    chr1    194     6       194     195


READ 1
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_1

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--multi \
--eland-genome /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_1.txt

    ...    
    Obtained total genome size of 756 bp
    Obtained rest-of-genome correction of 1.28071381624851e-18
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: pickBestAlignment succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/buildExport.pl --symbolic ./reanalysis_calsaf.txt ./reanalysis_qseq.txt > ./reanalysis_export.txt
    
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: buildExport succeded

EXPORT FILE:

[syoung@u01 read_1]$ cat *expo*
TESTREAD                1       1       1       1       0       1       AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG       IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII     chr1.fa         10      F       35      1Y

EXTENDED FILE:

[syoung@u01 read_1]$ cat *ext*
>TESTREAD_0001:1:1:1:1#0/1      AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG     1:1:0   chr1.fa:10F35,160F15T19


NOTE: NO ALIGNMENT WHEN USING ALL 3 TEST CHROMOSOMES:

cat *export.txt
    TESTREAD                1       1       1       1       0       1       AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG       IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII     6:0:0 

6:0:0 MEANS THAT THE NUMBER OF ALIGNMENTS EXCEEDS THE THRESHOLD (6 EXACT ALIGNMENTS)




READ 2
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_2
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_2

CD  \
--input-type fastq \
--eland-genome /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_2.txt

    ...
    Obtained total genome size of 756 bp
    Obtained rest-of-genome correction of 1.28071381624851e-18
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: pickBestAlignment succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/buildExport.pl --symbolic ./reanalysis_calsaf.txt ./reanalysis_qseq.txt > ./reanalysis_export.txt
    
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: buildExport succeded

USING ALL THREE GENOMES, NO HIT IN EXPORT FILE BUT ALL HITS IN EXTENDED FILE:

cat *export.txt
    TESTREAD                1       1       1       1       0       2       AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG       IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII     6:0:0  

cat *extended.txt

    >TESTREAD_0001:1:1:1:1#0/2      AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG     6:0:0   chr1.fa:1F35,218F35,chr2.fa:1F35,218F35,chr3.fa:1F35,218F35

PAIRED
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/paired
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/paired

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/reference \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_1.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/order/read_2.txt


/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: buildExport succeded
[syoung@u01 paired]$ cat *exp*
TESTREAD                1       1       1       1       0       1       AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG       IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII     chr1.fa         10      F       35      1Y
TESTREAD                1       1       1       1       0       2       CCCCTTTTCCCCTTTTTCCCCCTTTTCCCCCCTTT       IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII     chr1.fa         10      R       35      1Y

[syoung@u01 paired]$ cat *ext*
>TESTREAD_0001:1:1:1:1#0/1      AAAGGGGGGAAAAGGGGGAAAAAGGGGAAAAGGGG     1:1:0   chr1.fa:10F35,160F15T19
>TESTREAD_0001:1:1:1:1#0/2      CCCCTTTTCCCCTTTTTCCCCCTTTTCCCCCCTTT     1:1:0   chr1.fa:10R35,160R19A15


NOTES
-----

6:0:0 MEANS THAT THE NUMBER OF ALIGNMENTS EXCEEDS THE THRESHOLD (6 EXACT ALIGNMENTS)

http://rulai.cshl.edu/xuan/Doc/GApipeline-0.3/New%20analysis%20modes%20for%20GERALD%20in%20Pipeline%20Version%200.3.html

NM: no match found
QC: no alignment done - too many "N"s
RM: read was repeat masked - only seen if repeat masking feature of ELAND is switched on
x:y:z - number of alignments exceeds threshold, no alignment information stored. x, y and z are the number of exact, single-error and double-error matches respectively


NB: The eland_extended.txt file has the corrected alignment positions and the full alignment descriptions for >32 base reads so is a better choice for use in your own analysis than the s_N_eland_multi.txt file, especially if one is interested in multiple hits per read. However one should be aware that this file is not purity filtered. If a single alignment per read is fine the s_N_export.txt file is the preferred choice.



When aligning >32 base reads, because only at most 32 bases are used for the alignment, the start positions of alignments to the reverse strand must be corrected by subtracting (read length - 32) from the start position of the alignment. This is corrected for at a later stage but the alignment positions in this file have not been corrected - so you must be aware of this if you are using this file directly.




EXPORT FILE FORMAT
http://rulai.cshl.edu/xuan/Doc/GApipeline-0.3/New%20analysis%20modes%20for%20GERALD%20in%20Pipeline%20Version%200.3.html

Format of export.txt file
Democracy is necessarily despotism, 
as it establishes an executive power contrary to the general will; 
all being able to decide against one whose opinion may differ, 
the will of all is therefore not that of all: 
which is contradictory and opposite to liberty. 
- Immanuel Kant

The number of fields per line remains a constant 22, any not relevant to a particular read are left blank (the empty string ""). In particular, for a single-read analysis the Read Number, Paired Read Alignment Score and Partner Chromosome/Contig/Offset/Strand fields will all be blank

1. Machine (as parsed from run folder name.
2. Run Number (as parsed from run folder name).
3. Lane.
4. Tile.
5. X Coordinate of cluster.
6. Y Coordinate of cluster.
7. Index String (blank for a non-indexed run).
8. Read Number ("1" or "2" for paired read, blank for a single read).
9. Read.
10. Quality String - in symbolic ASCII format (ASCII chracter code = quality value + 64) by default, set QUALITY_FORMAT --numeric in the GERALD config file to get numeric values instead.
11. Match Chromosome - name of chromosome match was to OR code indicating why no match was done.
12. Match Contig (blank if no match found) - gives contig name if there is a match and the match chromosome is split into contigs.
13. Match Position (always with respect to forward strand, numbering starts at 1).
14. Match Strand ("F" for forward or "R" for reverse, blank if no match).
15. Match Descriptor - concise description of alignment. A numeral denotes a run of matching bases, a letter denotes substituation of a nucleotide, so e.g. for a 35 base read, "35" denotes an exact match and "32C2" denotes substitution of a "C" at the 33rd position.
16. Single Read Alignment Score - alignment score of single read match (if a paired read, gives alignment score of read if it were to be treated as a single read).
17. Paired Read Alignment Score - alignment score of read pair (alignment score of a paired read and its partner, taken as a pair. Blank for a single read run).
18. Partner Chromosome - not blank only if read is paired and its partner aligns to another chromosome, in which case it gives the name of the chromosome.
19. Partner Contig - not blank only if read is paired and its partner aligns to another chromosome and that partner is split into contigs.
20. Partner Offset - if a paired read's partner hits to the same chromosome (as it will in the vast majority of cases) and contig (if the chromosome is split into contigs) then this number added to Match Position gives the alignment position of the read's partner.
21. Partner Strand - which strand did the paired read's partner hit to("F" for forward or "R" for reverse, blank if no match).
22. Filtering. Did the read pass quality filtering? "Y" for yes, "N" for no.






/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl
Usage: /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl options
--input-file|if 
  must specify at least one file, specify two for paired analysis
--input-type|it 
  type of input file: fastq, fasta, export or qseq
--read-length|rl
  will work it out from input file(s) if not specified
--seed-length|sl
  length of read used for ELAND alignment 
  - default is to min of read-length and 32
--eland-genome|eg
  full path of a squashed genome directory
--output-prefix|op
  will produce a set of output files whose names prefixed by this
  - defaults to 'reanalysis'  
--pipeline-dir|pd
  path of pipeline installation to call 
  - by default, looks in same dir as executable is found)
--base-quality|bq
  in fasta mode assume all bases have this quality
  - default is set to 30
--pair-params|pp
  paired read analysis parameters to pass to pickBestPair
  - multiple arguments must go in quotes
  - defaults to '--circular' - treats all chromosomes as circular
  NB: for a paired read analysis, both reads must share same
  input-type, read-length and seed-length
[syoung@u01 paired]$


</entry>



<entry [Thu Sep 23 23:06:17 EDT 2010] COUNT HITS FOR ELAND_standalone.pl AS SINGLES AND PAIRED END FOR ALL 10M SAMPLES OF SRR001539 AGAINST chr22 ONLY>




READS WERE ALIGNED CORRECTLY DESPITE THE SAME pickBestPair.pl ERROR MESSAGE:

read 1
% HITS = (4999999 - 4027583 - 3771)/4999999 = 968645/4999999 = 0.193729038745808

read 2
% HITS = (4999999 - 4031222 - 18563)/4999999 = 950214/4999999 = 0.190042838008568

paired read 1
% HITS = (4999999 - 4027583 - 3771)/4999999 = 968645/4999999 = 0.193729038745808

paired read 2
% HITS = (4999999 - 4031222 - 18563)/4999999 = 950214/4999999 = 0.190042838008568


pickBestPair.pl ERROR MESSAGE:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired

emacs  srx001539-1.reads_1+2.ELAND.err

    ...
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: setting circular to Y
    Obtained total genome size of 49591432 bp
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Found 55227 initial pairs from     4999999 clusters
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: only 1.10454 percent of clusters with unique alignment of each read, need 10 percent to do paired alignment
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Nominal orientation of this sample appears to be Rm
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: warning - data will be treated as two sets of unpaired reads
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 26 for read 1
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 26 for read 2
    ...



1. INPUT FILES

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.simpleHeader.txt
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.simpleHeader.txt



2. CREATE DIRECTORY

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome



3. RUN ELAND.pl

READ 1
------

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1/srx001539-1.reads_1.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1/srx001539-1.reads_1.ELAND.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.simpleHeader.txt



RUN JOB

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1/srx001539-1.reads_1.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1/srx001539-1.reads_1.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1/srx001539-1.reads_1.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1/srx001539-1.reads_1.ELAND.sh ; date ; bjobs
    



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_1
lines reanalysis_export.txt
cut -f 11 < reanalysis_export.txt | grep -c NM
cut -f 11 < reanalysis_export.txt | grep -c QC


lines reanalysis_export.txt
    reanalysis_export.txt:     4999999
[syoung@u01 read_1]$ cut -f 11 < reanalysis_export.txt | grep -c NM
    4027583
[syoung@u01 read_1]$ cut -f 11 < reanalysis_export.txt | grep -c QC
    3771


% HITS = (4999999 - 4027583 - 3771)/4999999 = 968645/4999999 = 0.193729038745808



READ 2
------

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2/srx001539-1.reads_2.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2/srx001539-1.reads_2.ELAND.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.simpleHeader.txt



RUN JOB

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2/srx001539-1.reads_2.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2/srx001539-1.reads_2.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2/srx001539-1.reads_2.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2/srx001539-1.reads_2.ELAND.sh ; date; bjobs
    
        



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/read_2
lines reanalysis_export.txt
cut -f 11 < reanalysis_export.txt | grep -c NM
cut -f 11 < reanalysis_export.txt | grep -c QC


reanalysis_export.txt: 4999999
[syoung@u01 read_2]$ cut -f 11 < reanalysis_export.txt | grep -c NM
4031222
[syoung@u01 read_2]$ cut -f 11 < reanalysis_export.txt | grep -c QC
18563

% HITS = (4999999 - 4031222 - 18563)/4999999 = 950214/4999999 = 0.190042838008568



PAIRED
------

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired/srx001539-1.reads_1+2.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired/srx001539-1.reads_1+2.ELAND.sh
#!/bin/sh

#BSUB -W 24:00
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.simpleHeader.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.simpleHeader.txt



RUN JOB


chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired/srx001539-1.reads_1+2.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired/srx001539-1.reads_1+2.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired/srx001539-1.reads_1+2.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired/srx001539-1.reads_1+2.ELAND.sh ; date; bjobs




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired
ll

        
    ###-rw-rw-r-- 1 syoung root 157M Sep 23 12:51 reanalysis_1_calsaf.txt
    ###-rw-rw-r-- 1 syoung root 309M Sep 23 12:36 reanalysis_1_eland_extended.txt
    ###-rw-rw-r-- 1 syoung root 268M Sep 23 12:32 reanalysis_1_eland_query.txt
    ###-rw-rw-r-- 1 syoung root 435M Sep 23 12:54 reanalysis_1_export.txt
    ###-rw-rw-r-- 1 syoung root 385M Sep 23 12:30 reanalysis_1_qseq.txt
    ###-rw-rw-r-- 1 syoung root 157M Sep 23 12:51 reanalysis_2_calsaf.txt
    ###-rw-rw-r-- 1 syoung root 309M Sep 23 12:43 reanalysis_2_eland_extended.txt
    ###-rw-rw-r-- 1 syoung root 268M Sep 23 12:39 reanalysis_2_eland_query.txt
    ###-rw-rw-r-- 1 syoung root 434M Sep 23 12:56 reanalysis_2_export.txt
    ###-rw-rw-r-- 1 syoung root 385M Sep 23 12:37 reanalysis_2_qseq.txt
    ###-rw-rw-r-- 1 syoung root 706M Sep 23 12:51 reanalysis_anomaly.txt
    ###-rw-rw-r-- 1 syoung root   61 Sep 23 12:43 reanalysis_genomesize.xml
    ###-rw-rw-r-- 1 syoung root 6.3K Sep 23 12:51 reanalysis_pair.xml
    ###-rw-rw-r-- 1 syoung root  50K Sep 23 12:56 SRR029338_1+2.ELAND.err
    ###-rw-rw-r-- 1 syoung root 8.7K Sep 23 12:56 SRR029338_1+2.ELAND.out
    ###-rwxr-xr-x 1 syoung root  543 Sep 23 12:17 SRR029338_1+2.ELAND.sh
    ###-rw-rw-r-- 1 syoung root 502M Sep 23 12:08 SRR029338_1.simpleHeader.txt
    ###-rw-rw-r-- 1 syoung root 502M Sep 23 12:23 SRR029338_2.simpleHeader.txt
    

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired
lines SRR029338_1.simpleHeader.txt
lines SRR029338_2.simpleHeader.txt

lines SRR029338_1.simpleHeader.txt
lines SRR029338_2.simpleHeader.txt
    SRR029338_1.simpleHeader.txt: 14411076

[syoung@u04 paired]$ lines SRR029338_2.simpleHeader.txt
    SRR029338_2.simpleHeader.txt: 14411076

= 3602769 RECORDS
    OK


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired
cut -f 11 < reanalysis_1_export.txt | grep -c NM
cut -f 11 < reanalysis_1_export.txt | grep -c QC



cut -f 11 < reanalysis_1_export.txt | grep -c NM
cut -f 11 < reanalysis_1_export.txt | grep -c QC
4027583
[syoung@u01 paired]$ cut -f 11 < reanalysis_1_export.txt | grep -c QC
3771

% HITS = (4999999 - 4027583 - 3771)/4999999 = 968645/4999999 = 0.193729038745808


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manualgenome/paired
cut -f 11 < reanalysis_2_export.txt | grep -c NM
cut -f 11 < reanalysis_2_export.txt | grep -c QC


[syoung@u01 paired]$ cut -f 11 < reanalysis_2_export.txt | grep -c NM
cut -f 11 < reanalysis_2_export.txt | grep -c QC
4031222
[syoung@u01 paired]$ cut -f 11 < reanalysis_2_export.txt | grep -c QC
18563

% HITS = (4999999 - 4031222 - 18563)/4999999 = 950214/4999999 = 0.190042838008568






++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++`
Mon Sep 27 00:47:37 EDT 2010
RUN BOWTIE 'mini' TO DETERMINE CORRECT PARAMETERS FOR PAIRED END ALIGNMENT

MUST USE '--rf' OPTION:

  --fr/--rf/--ff     -1, -2 mates align fw/rev, rev/fw, fw/fw (default: --fr)


READ 1
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MINI.reads_1.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/bowtie.sh \
; date; bjobs
    

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1
cat bowtie.err
    
    # reads processed: 1000000
    # reads with at least one reported alignment: 918421 (91.84%)
    # reads that failed to align: 81579 (8.16%)
    Reported 918421 alignments to 1 output stream(s)
    
    real    1m59.921s
    user    1m30.965s
    sys     0m5.906s

    #### reads processed: 4999999
    #### reads with at least one reported alignment: 4553656 (91.07%)
    #### reads that failed to align: 446343 (8.93%)
    ###Reported 4553656 alignments to 1 output stream(s)
    ###
    ###real    2m32.212s
    ###user    7m44.038s
    ###sys     0m7.379s


GET HITS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1

/nethome/bioinfo/apps/agua/0.5/bin/apps/samHits.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/out.sam \
 | cut -f 1 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/hit.sam

lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome1/hit.sam

    ###4553655



READ 2
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MINI.reads_2.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/bowtie.sh \
; date; bjobs


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2
cat bowtie.err

    # reads processed: 1000000
    # reads with at least one reported alignment: 896110 (89.61%)
    # reads that failed to align: 103890 (10.39%)
    Reported 896110 alignments to 1 output stream(s)
    
    real    1m22.679s
    user    2m4.524s
    sys     0m5.124s

    #### reads processed: 4999999
    #### reads with at least one reported alignment: 4478992 (89.58%)
    #### reads that failed to align: 521007 (10.42%)
    ###Reported 4478992 alignments to 1 output stream(s)
    ###
    ###real    3m21.957s
    ###user    8m25.193s
    ###sys     0m12.388s


GET HITS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2

/nethome/bioinfo/apps/agua/0.5/bin/apps/samHits.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/out.sam \
 | cut -f 1 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/hit.sam


lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome2/hit.sam 




PAIRED
------


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MINI.reads_2.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MINI.reads_1.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/bowtie.sh \
; date; bjobs


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome
cat bowtie.err



    ## reads processed: 4999999
    ## reads with at least one reported alignment: 269377 (5.39%)
    ## reads that failed to align: 4730622 (94.61%)
    #Reported 269377 paired-end alignments to 1 output stream(s)
    #
    #real    61m6.135s
    #user    147m29.188s
    #sys     1m38.596s





GET HITS:

/nethome/bioinfo/apps/agua/0.5/bin/apps/samHits.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/out.sam \
 | cut -f 1 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/hit.sam
 
lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/mini/manualgenome/hit.sam



'MICRO'
-------


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_2.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_1.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/out.sam

SRR005718.28:1:1:611:106#0/1    163     chr7    52700525        255     26M     =       52700601        102     GAAGAAAATAGAGGAAATATTTTCTG IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.28:1:1:611:106#0/2    83      chr7    52700601        255     26M     =       52700525        -102    GAGAAGGAAACAAGAGTCTTCTCAGG IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0

# reads processed: 25
# reads with at least one reported alignment: 2 (8.00%)
# reads that failed to align: 23 (92.00%)
Reported 2 paired-end alignments to 1 output stream(s)

real    0m6.939s
user    0m2.002s
sys     0m5.724s


time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--maxins 3000 \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_2.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_1.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/out.sam

SRR005718.28:1:1:611:106#0/1    163     chr7    52700525        255     26M     =       52700601        102     GAAGAAAATAGAGGAAATATTTTCTG IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.28:1:1:611:106#0/2    83      chr7    52700601        255     26M     =       52700525        -102    GAGAAGGAAACAAGAGTCTTCTCAGG IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.103:1:1:786:235#0/2   99      chr8    71419469        255     26M     =       71420068        625     ACAGTCTTGCTCCGTTGCCCAGGCTG IIIIIIIIIIIIIIIIIIIIDIIIII      XA:i:2  MD:Z:1G10T13    NM:i:2
SRR005718.103:1:1:786:235#0/1   147     chr8    71420068        255     26M     =       71419469        -625    GCTTCATCCATGTCCCTATGAAGGAC IIIIIIAIIIIIIIIIIIIIIIIIII      XA:i:1  MD:Z:19A6       NM:i:1

# reads processed: 25
# reads with at least one reported alignment: 6 (24.00%)
# reads that failed to align: 19 (76.00%)
Reported 6 paired-end alignments to 1 output stream(s)

real    0m29.723s
user    0m0.648s
sys     0m7.209s



time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 1 \
--maxins 3000 \
--rf \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_2.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.MICRO.reads_1.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/micro/manualgenome/out.sam

    !! ALL HITS !!

    SRR005718.5:1:1:235:344#0/2     77      *       0       0       *       *       0       0       AAACTTTTTTTCTTGTCACTATTTCC      IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
    SRR005718.5:1:1:235:344#0/1     141     *       0       0       *       *       0       0       GATTGATCTTGATTCTAATTCCCTGA      IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
    SRR005718.15:1:1:967:222#0/2    83      chr2    237979846       255     26M     =       237981892      2072     TATTAATCTGCTAAGTTTTGGGATTG      IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.15:1:1:967:222#0/1    163     chr2    237981892       255     26M     =       237979846      -2072    GAGATGCTCCAAGCTTTGAAATCAAT      IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.28:1:1:611:106#0/2    77      *       0       0       *       *       0       0       CCTGAGAAGACTCTTGTTTCCTTCTC      IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
    SRR005718.28:1:1:611:106#0/1    141     *       0       0       *       *       0       0       GAAGAAAATAGAGGAAATATTTTCTG      IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
    SRR005718.32:1:1:685:889#0/1    147     chr12   22361259        255     26M     =       22363515       2282     GTTATAATTACCTATCTAGAATATAC      IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.32:1:1:685:889#0/2    99      chr12   22363515        255     26M     =       22361259       -2282    TAGACATCAGTTGCAAGTCTGGGCCT      IIIIIIIIIIIIIIEAIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.42:1:1:367:489#0/2    77      *       0       0       *       *       0       0       TGGTGTGTTCTATGTACCTGGATTAA      IIIIIIIIIIIIIIIIIIIIIIIIHB      XM:i:0
    SRR005718.42:1:1:367:489#0/1    141     *       0       0       *       *       0       0       GACATTATTTGAGATTACAGCTGTGC      IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
    SRR005718.59:1:1:782:432#0/2    83      chr1    214761505       255     26M     =       214763765      2286     TCAAGGTGGACGGGATCCAATGCAAT      3IIIFIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.59:1:1:782:432#0/1    163     chr1    214763765       255     26M     =       214761505      -2286    GTGACTAGGAAAGTGATCATGCAAGG      IIIIIIIIIIIIIIIIIIIIIIIHII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.66:1:1:625:674#0/1    147     chr11   18636042        255     26M     =       18637906       1890     TAATATAAAAACTCTTTCCAATTTCC      IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.66:1:1:625:674#0/2    99      chr11   18637906        255     26M     =       18636042       -1890    TAAGAGAACATTAGTATCCACTTAGT      IIIIII=IIIII;IIIIII-III3I?      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.80:1:1:956:123#0/2    83      chr4    49292667        255     26M     =       49294207       1566     TGAGACAGAATGAGGAGTGACTAATG      IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.80:1:1:956:123#0/1    163     chr4    49294207        255     26M     =       49292667       -1566    GAGAGTAATTGAGTGAAATTGGTGAG      IIIIIIIIIIIIIIIIIIIIII8III      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.85:1:1:418:201#0/2    77      *       0       0       *       *       0       0       TATGTTTAACTTTATTTTATTTTATT      IIIIIIIIIFIIIIIIIIIIIIIGII      XM:i:0
    SRR005718.85:1:1:418:201#0/1    141     *       0       0       *       *       0       0       GAAGGAGAAGGAAAAAAGCCAGAGAG      IIIIIIIIIIIIIIIIIIGIIIIIEI      XM:i:0
    SRR005718.97:1:1:751:599#0/1    147     chr1    172070716       255     26M     =       172072597      1907     ACATTAGCTCATTAATTCCTCTCAAC      IIIIII@IIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
    SRR005718.97:1:1:751:599#0/2    99      chr1    172072597       255     26M     =       172070716      -1907    ACAAAACTTCTTTGTGGCATAATATT      IIIIIIIIIIIIIIIIIH;II5I:II      XA:i:0  MD:Z:26 NM:i:0


    # reads processed: 25
    # reads with at least one reported alignment: 15 (60.00%)
    # reads that failed to align: 10 (40.00%)
    Reported 15 paired-end alignments to 1 output stream(s)
    
    real    0m5.238s
    user    0m0.274s
    sys     0m4.939s





NO EFFECT
-q \
--minins 50 \
--tryhard \
--maqerr 1000 \
--phred33-quals \
--phred64-quals \ 
    Saw ASCII character 51 but expected 64-based Phred qual.
    Try not specifying --solexa1.3-quals/--phred64-quals.
--solexa-quals \

--ff \
    (NO MATCHES IN FIRST 10)

    # reads processed: 25
    # reads with at least one reported alignment: 2 (8.00%)
    # reads that failed to align: 23 (92.00%)
    Reported 2 paired-end alignments to 1 output stream(s)
    
    real    0m5.708s
    user    0m0.319s
    sys     0m5.361s


                        	sense	chromo	position	sense	chromo	position	DISTANCE
SRR005718.15:1:1:967:222#0/1	0	chr2	237981892	16	chr2	237979846	2046
SRR005718.28:1:1:611:106#0/1	0	chr7	52700525	16	chr7	52700601	-76
SRR005718.32:1:1:685:889#0/1	16	chr12	22361259	0	chr12	22363515	-2256
SRR005718.59:1:1:782:432#0/1	0	chr1	214763765	16	chr1	214761505	2260
SRR005718.66:1:1:625:674#0/1	16	chr11	18636042	0	chr11	18637906	-1864
SRR005718.85:1:1:418:201#0/1	16	chr5	162925636	0	chr5	162927635	-1999
SRR005718.97:1:1:751:599#0/1	16	chr1	172070716	0	chr1	172072597	-1881



NOTES
-----


/nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie

Usage: 
  bowtie [options]* <ebwt> {-1 <m1> -2 <m2> | --12 <r> | <s>} [<hit>]

  <m1>    Comma-separated list of files containing upstream mates (or the
          sequences themselves, if -c is set) paired with mates in <m2>
  <m2>    Comma-separated list of files containing downstream mates (or the
          sequences themselves if -c is set) paired with mates in <m1>
  <r>     Comma-separated list of files containing Crossbow-style reads.  Can be
          a mixture of paired and unpaired.  Specify "-" for stdin.
  <s>     Comma-separated list of files containing unpaired reads, or the
          sequences themselves, if -c is set.  Specify "-" for stdin.
  <hit>   File to write hits to (default: stdout)

Input:
  -q                 query input files are FASTQ .fq/.fastq (default)
  -f                 query input files are (multi-)FASTA .fa/.mfa
  -r                 query input files are raw one-sequence-per-line
  -c                 query sequences given on cmd line (as <mates>, <singles>)
  -C                 reads and index are in colorspace
  -s/--skip <int>    skip the first <int> reads/pairs in the input
  -u/--qupto <int>   stop after first <int> reads/pairs (excl. skipped reads)
  -5/--trim5 <int>   trim <int> bases from 5' (left) end of reads
  -3/--trim3 <int>   trim <int> bases from 3' (right) end of reads
  --phred33-quals    input quals are Phred+33 (default)
  --phred64-quals    input quals are Phred+64 (same as --solexa1.3-quals)
  --solexa-quals     input quals are from GA Pipeline ver. < 1.3
  --solexa1.3-quals  input quals are from GA Pipeline ver. >= 1.3
  --integer-quals    qualities are given as space-separated integers (not ASCII)

Alignment:
  -v <int>           report end-to-end hits w/ <=v mismatches; ignore qualities
    or
  -n/--seedmms <int> max mismatches in seed (can be 0-3, default: -n 2)
  -e/--maqerr <int>  max sum of mismatch quals across alignment for -n (def: 70)
  -l/--seedlen <int> seed length for -n (default: 28)
  --nomaqround       disable Maq-like quality rounding for -n (nearest 10 <= 30)
  -I/--minins <int>  minimum insert size for paired-end alignment (default: 0)
  -X/--maxins <int>  maximum insert size for paired-end alignment (default: 250)
  --fr/--rf/--ff     -1, -2 mates align fw/rev, rev/fw, fw/fw (default: --fr)
  --nofw/--norc      do not align to forward/reverse-complement reference strand
  --maxbts <int>     max # backtracks for -n 2/3 (default: 125, 800 for --best)
  --pairtries <int>  max # attempts to find mate for anchor hit (default: 100)
  -y/--tryhard       try hard to find valid alignments, at the expense of speed
  --chunkmbs <int>   max megabytes of RAM for best-first search frames (def: 64)

Reporting:
  -k <int>           report up to <int> good alignments per read (default: 1)
  -a/--all           report all alignments per read (much slower than low -k)
  -m <int>           suppress all alignments if > <int> exist (def: no limit)
  -M <int>           like -m, but reports 1 random hit (MAPQ=0); requires --best
  --best             hits guaranteed best stratum; ties broken by quality
  --strata           hits in sub-optimal strata aren't reported (requires --best)

Output:
  -t/--time          print wall-clock time taken by search phases
  -B/--offbase <int> leftmost ref offset = <int> in bowtie output (default: 0)
  --quiet            print nothing but the alignments
  --refout           write alignments to files refXXXXX.map, 1 map per reference
  --refidx           refer to ref. seqs by 0-based index rather than name
  --al <fname>       write aligned reads/pairs to file(s) <fname>
  --un <fname>       write unaligned reads/pairs to file(s) <fname>
  --max <fname>      write reads/pairs over -m limit to file(s) <fname>
  --suppress <cols>  suppresses given columns (comma-delim'ed) in default output
  --fullref          write entire ref name (default: only up to 1st space)
Colorspace:
  --snpphred <int>   Phred penalty for SNP when decoding colorspace (def: 30)
     or
  --snpfrac <dec>    approx. fraction of SNP bases (e.g. 0.001); sets --snpphred
  --col-cseq         print aligned colorspace seqs as colors, not decoded bases
  --col-cqual        print original colorspace quals, not decoded quals
  --col-keepends     keep nucleotides at extreme ends of decoded alignment
SAM:
  -S/--sam           write hits in SAM format
  --mapq <int>       default mapping quality (MAPQ) to print for SAM alignments
  --sam-nohead       supppress header lines (starting with @) for SAM output
  --sam-nosq         supppress @SQ header lines for SAM output
  --sam-RG <text>    add <text> (usually "lab=value") to @RG line of SAM header
Performance:
  -o/--offrate <int> override offrate of index; must be >= index's offrate
  -p/--threads <int> number of alignment threads to launch (default: 1)
  --mm               use memory-mapped I/O for index; many 'bowtie's can share
  --shmem            use shared mem for index; many 'bowtie's can share
Other:
  --seed <int>       seed for random number generator
  --verbose          verbose output (for debugging)
  --version          print version information and quit
  -h/--help          print this usage message




READS IN BOTH SINGLE ALIGNMENTS THAT ARE MISSING FROM THE PAIRED ALIGNMENT

@SRR005718.15:1:1:967:222#0/1
@SRR005718.32:1:1:685:889#0/1
@SRR005718.59:1:1:782:432#0/1
@SRR005718.80:1:1:956:123#0/1
@SRR005718.66:1:1:625:674#0/1


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/
grep -n "@SRR005718.97:1:1:751:599#0" srx001539-1.MINI.reads_*.sequence.txt

    
    srx001539-1.MINI.reads_1.sequence.txt:37:@SRR005718.97:1:1:751:599#0/1
    srx001539-1.MINI.reads_2.sequence.txt:37:@SRR005718.97:1:1:751:599#0/2

I.E., LINE 37 CONTAINS READ @SRR005718.97:1:1:751:599#0/1

SO CREATE 'micro' CHOPFILE WITH 100 READS EACH

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/
chopfile srx001539-1.MINI.reads_1.sequence.txt srx001539-1.MICRO.reads_1.sequence.txt 100
chopfile srx001539-1.MINI.reads_2.sequence.txt srx001539-1.MICRO.reads_2.sequence.txt 100

CREATED FILES:

-rw-rw-r-- 1 syoung root 2.9K Sep 27 01:22 srx001539-1.MICRO.reads_1.sequence.txt
-rw-rw-r-- 1 syoung root 2.9K Sep 27 01:22 srx001539-1.MICRO.reads_2.sequence.txt


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539
head -n 30 manualgenome1/aligned*

@SRR005718.28:1:1:611:106#0/1
GAAGAAAATAGAGGAAATATTTTCTG
+SRR005718.28:1:1:611:106#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.15:1:1:967:222#0/1
GAGATGCTCCAAGCTTTGAAATCAAT
+SRR005718.15:1:1:967:222#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.32:1:1:685:889#0/1
GTATATTCTAGATAGGTAATTATAAC
+SRR005718.32:1:1:685:889#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.59:1:1:782:432#0/1
GTGACTAGGAAAGTGATCATGCAAGG
+SRR005718.59:1:1:782:432#0/1
IIIIIIIIIIIIIIIIIIIIIIIHII
@SRR005718.80:1:1:956:123#0/1
GAGAGTAATTGAGTGAAATTGGTGAG
+SRR005718.80:1:1:956:123#0/1
IIIIIIIIIIIIIIIIIIIIII8III
@SRR005718.66:1:1:625:674#0/1
GGAAATTGGAAAGAGTTTTTATATTA
+SRR005718.66:1:1:625:674#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.97:1:1:751:599#0/1
GTTGAGAGGAATTAATGAGCTAATGT
+SRR005718.97:1:1:751:599#0/1
IIIIIIIIIIIIIIIIIII@IIIIII
@SRR005718.85:1:1:418:201#0/1
GAAGGAGAAGGAAAAAAGCCAGAGAG

[syoung@u03 SRX001539]$ head -n 30 manualgenome2/aligned*
@SRR005718.32:1:1:685:889#0/2
TAGACATCAGTTGCAAGTCTGGGCCT
+SRR005718.32:1:1:685:889#0/2
IIIIIIIIIIIIIIEAIIIIIIIIII
@SRR005718.28:1:1:611:106#0/2
CCTGAGAAGACTCTTGTTTCCTTCTC
+SRR005718.28:1:1:611:106#0/2
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.15:1:1:967:222#0/2
CAATCCCAAAACTTAGCAGATTAATA
+SRR005718.15:1:1:967:222#0/2
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.59:1:1:782:432#0/2
ATTGCATTGGATCCCGTCCACCTTGA
+SRR005718.59:1:1:782:432#0/2
IIIIIIIIIIIIIIIIIIIIIFIII3
@SRR005718.66:1:1:625:674#0/2
TAAGAGAACATTAGTATCCACTTAGT
+SRR005718.66:1:1:625:674#0/2
IIIIII=IIIII;IIIIII-III3I?
@SRR005718.80:1:1:956:123#0/2
CATTAGTCACTCCTCATTCTGTCTCA
+SRR005718.80:1:1:956:123#0/2
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.42:1:1:367:489#0/2
TGGTGTGTTCTATGTACCTGGATTAA
+SRR005718.42:1:1:367:489#0/2
IIIIIIIIIIIIIIIIIIIIIIIIHB
@SRR005718.85:1:1:418:201#0/2
TATGTTTAACTTTATTTTATTTTATT

head -n 30 manualgenome/aligned*

==> manualgenome/aligned_1.txt <==
@SRR005718.28:1:1:611:106#0/1
GAAGAAAATAGAGGAAATATTTTCTG
+SRR005718.28:1:1:611:106#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.145:1:1:681:588#0/1
GAATGGAATGCAATAGTATGGAATGG
+SRR005718.145:1:1:681:588#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.291:1:1:786:596#0/1
GCATGGAATCATCATCAAATGGAATC
+SRR005718.291:1:1:786:596#0/1
IIIIIIIIIIIIIIIIII:IIIH@II
@SRR005718.337:1:1:633:165#0/1
GATCTGCAGGAACTGATGATGGTTTC
+SRR005718.337:1:1:633:165#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.415:1:1:641:123#0/1
GAAAGTTTGCAGAAGGTGACCAAGGA
+SRR005718.415:1:1:641:123#0/1
IIIIIIIIIIIIIIIIAIII5IIIID
@SRR005718.429:1:1:633:81#0/1
GAGATGGGGTTTCACCATATTGGCCA
+SRR005718.429:1:1:633:81#0/1
IIIIIIIIIIIIIIIIIIIIIII9@I
@SRR005718.552:1:1:884:314#0/1
GAGAGAGAGACAGAGAGACACAGAAA
+SRR005718.552:1:1:884:314#0/1
IIIIIIIIIIIIIIIIIIFI5DI23/
@SRR005718.653:1:1:426:178#0/1
GAAGCCCCGTCTCTACTAAAAATACA

==> manualgenome/aligned_2.txt <==
@SRR005718.28:1:1:611:106#0/2
CCTGAGAAGACTCTTGTTTCCTTCTC
+SRR005718.28:1:1:611:106#0/2
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.145:1:1:681:588#0/2
TCAATTCCATTCCTTTCGTTTCCATT
+SRR005718.145:1:1:681:588#0/2
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.291:1:1:786:596#0/2
TTCGAGTCCATTCGATGATTCTATTC
+SRR005718.291:1:1:786:596#0/2
IIIIDIIIIIIIII4II4IIIIFIE:
@SRR005718.337:1:1:633:165#0/2
TAGCTAAGTTCAGAGGGTTTTTCACT
+SRR005718.337:1:1:633:165#0/2
IIIIIIIIIIIIIIIIIIIIII?III
@SRR005718.415:1:1:641:123#0/2
CCTCACATCCCAGAGCAGGGCGATTC
+SRR005718.415:1:1:641:123#0/2
IIIIIIII1IIIIIIIIIIIIIIII<
@SRR005718.429:1:1:633:81#0/2
CACGCCTGTAATCCCAGAACTTTAGG
+SRR005718.429:1:1:633:81#0/2
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005718.552:1:1:884:314#0/2
TCTCTGTCTCTCCCTCCCTTTCTGCT
+SRR005718.552:1:1:884:314#0/2
IIIIIEIII>GI>DIC:4:?I2C&3<
@SRR005718.653:1:1:426:178#0/2
AACCAGACGGAGTCTTGCTCTGTCGC


CHECK THEIR ALIGNED POSITIONS:


                                    READ			            MATE			
                        
                        
                        
                        	sense	chromo	position	sense	chromo	position	DISTANCE
SRR005718.15:1:1:967:222#0/1	0	chr2	237981892	16	chr2	237979846	2046
SRR005718.28:1:1:611:106#0/1	0	chr7	52700525	16	chr7	52700601	-76
SRR005718.32:1:1:685:889#0/1	16	chr12	22361259	0	chr12	22363515	-2256
SRR005718.59:1:1:782:432#0/1	0	chr1	214763765	16	chr1	214761505	2260
SRR005718.66:1:1:625:674#0/1	16	chr11	18636042	0	chr11	18637906	-1864
SRR005718.85:1:1:418:201#0/1	16	chr5	162925636	0	chr5	162927635	-1999
SRR005718.97:1:1:751:599#0/1	16	chr1	172070716	0	chr1	172072597	-1881


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539
head -n 40 manualgenome1/out.sam

SRR005718.28:1:1:611:106#0/1    0       chr7    52700525        255     26M     *       0   GAAGAAAATAGAGGAAATATTTTCTG       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.15:1:1:967:222#0/1    0       chr2    237981892       255     26M     *       0   GAGATGCTCCAAGCTTTGAAATCAAT       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.32:1:1:685:889#0/1    16      chr12   22361259        255     26M     *       0   GTTATAATTACCTATCTAGAATATAC       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.59:1:1:782:432#0/1    0       chr1    214763765       255     26M     *       0   GTGACTAGGAAAGTGATCATGCAAGG       IIIIIIIIIIIIIIIIIIIIIIIHII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.80:1:1:956:123#0/1    0       chr1    143279947       255     26M     *       0   GAGAGTAATTGAGTGAAATTGGTGAG       IIIIIIIIIIIIIIIIIIIIII8III      XA:i:0  MD:Z:26 NM:i:0
SRR005718.66:1:1:625:674#0/1    16      chr11   18636042        255     26M     *       0   TAATATAAAAACTCTTTCCAATTTCC       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.97:1:1:751:599#0/1    16      chr1    172070716       255     26M     *       0   ACATTAGCTCATTAATTCCTCTCAAC       IIIIII@IIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.85:1:1:418:201#0/1    16      chr5    162925636       255     26M     *       0   CTCTCTGGCTTTTTTCCTTCTCCTTC       IEIIIIIGIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.103:1:1:786:235#0/1   0       chr7    14989417        255     26M     *       0   GTCCTTCATAGGGACATGGATGAAGC       IIIIIIIIIIIIIIIIIIIAIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.115:1:1:958:82#0/1    0       chr7    28839568        255     26M     *       0   GTTTAATTCATTCATTCCTTCATTCA       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539
head -n 40 manualgenome2/out.sam

SRR005718.32:1:1:685:889#0/2    0       chr12   22363515        255     26M     *       0   TAGACATCAGTTGCAAGTCTGGGCCT       IIIIIIIIIIIIIIEAIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.15:1:1:967:222#0/2    16      chr2    237979846       255     26M     *       0   TATTAATCTGCTAAGTTTTGGGATTG       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.28:1:1:611:106#0/2    16      chr7    52700601        255     26M     *       0   GAGAAGGAAACAAGAGTCTTCTCAGG       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.5:1:1:235:344#0/2     0       chr11   113485507       255     26M     *       0   AAACTTTTTTTCTTGTCACTATTTCC       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.59:1:1:782:432#0/2    16      chr1    214761505       255     26M     *       0   TCAAGGTGGACGGGATCCAATGCAAT       3IIIFIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.66:1:1:625:674#0/2    0       chr11   18637906        255     26M     *       0   TAAGAGAACATTAGTATCCACTTAGT       IIIIII=IIIII;IIIIII-III3I?      XA:i:0  MD:Z:26 NM:i:0
SRR005718.80:1:1:956:123#0/2    0       chr21   9700873 255     26M     *       0       0   CATTAGTCACTCCTCATTCTGTCTCA       IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.42:1:1:367:489#0/2    16      chrX    8964921 255     26M     *       0       0   TTAATCCAGGTACATAGAACACACCA       BHIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.85:1:1:418:201#0/2    0       chr5    162927635       255     26M     *       0   TATGTTTAACTTTATTTTATTTTATT       IIIIIIIIIFIIIIIIIIIIIIIGII      XA:i:0  MD:Z:26 NM:i:0
SRR005718.97:1:1:751:599#0/2    0       chr1    172072597       255     26M     *       0   ACAAAACTTCTTTGTGGCATAATATT       IIIIIIIIIIIIIIIIIH;II5I:II      XA:i:0  MD:Z:26 NM:i:0
SRR005718.103:1:1:786:235#0/2   0       chr8    12279199        255     26M     *       0   ACAGTCTTGCTCCGTTGCCCAGGCTG       IIIIIIIIIIIIIIIIIIIIDIIIII      XA:i:0  MD:Z:26 NM:i:0


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539
head -n 40 manualgenome/out.sam

SRR005718.28:1:1:611:106#0      99      chr7    52700525        255     26M     =       52700601     102     GAAGAAAATAGAGGAAATATTTTCTG      IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26      NM:i:0
SRR005718.28:1:1:611:106#0      147     chr7    52700601        255     26M     =       52700525     -102    GAGAAGGAAACAAGAGTCTTCTCAGG      IIIIIIIIIIIIIIIIIIIIIIIIII      XA:i:0  MD:Z:26      NM:i:0
SRR005718.15:1:1:967:222#0      77      *       0       0       *       *       0       0   GAGATGCTCCAAGCTTTGAAATCAAT       IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
SRR005718.15:1:1:967:222#0      141     *       0       0       *       *       0       0   CAATCCCAAAACTTAGCAGATTAATA       IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
SRR005718.5:1:1:235:344#0       77      *       0       0       *       *       0       0   GATTGATCTTGATTCTAATTCCCTGA       IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
SRR005718.5:1:1:235:344#0       141     *       0       0       *       *       0       0   AAACTTTTTTTCTTGTCACTATTTCC       IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
SRR005718.59:1:1:782:432#0      77      *       0       0       *       *       0       0   GTGACTAGGAAAGTGATCATGCAAGG       IIIIIIIIIIIIIIIIIIIIIIIHII      XM:i:0
SRR005718.59:1:1:782:432#0      141     *       0       0       *       *       0       0   ATTGCATTGGATCCCGTCCACCTTGA       IIIIIIIIIIIIIIIIIIIIIFIII3      XM:i:0
SRR005718.66:1:1:625:674#0      77      *       0       0       *       *       0       0   GGAAATTGGAAAGAGTTTTTATATTA       IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
SRR005718.66:1:1:625:674#0      141     *       0       0       *       *       0       0   TAAGAGAACATTAGTATCCACTTAGT       IIIIII=IIIII;IIIIII-III3I?      XM:i:0
SRR005718.80:1:1:956:123#0      77      *       0       0       *       *       0       0   GAGAGTAATTGAGTGAAATTGGTGAG       IIIIIIIIIIIIIIIIIIIIII8III      XM:i:0
SRR005718.80:1:1:956:123#0      141     *       0       0       *       *       0       0   CATTAGTCACTCCTCATTCTGTCTCA       IIIIIIIIIIIIIIIIIIIIIIIIII      XM:i:0
SRR005718.85:1:1:418:201#0      77      *       0       0       *       *       0       0   GAAGGAGAAGGAAAAAAGCCAGAGAG       IIIIIIIIIIIIIIIIIIGIIIIIEI      XM:i:0


</entry>



<entry [Sun Sep 26 20:34:10 EDT 2010] CALCULATE INSERT SIZE FROM ELAND PAIRED END ALIGNMENTS>



RESULTS:

SRX000600 HAS AN AVERAGE INSERT SIZE OF ~ 190, MAX OF 300

SRX001539 HAS AN AVERAGE INSERT SIZE OF ~ 1900, MAX OF 3,000




NB: ASSUMES 'F' AND 'R' STRAND MATCHES START AT POSITION AND EXTEND DOWNSTREAM, REGARDLESS OF ORIENTATION

TEST WITH MANUAL ELAND RUN WITH NA18507 SAMPLE FILE AGAINST CHRY ONLY

USE 10,000 LINES

/nethome/bioinfo/apps/agua/0.5/bin/apps/insertSize.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/reanalysis_export.txt \
--matefile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/reanalysis_export.txt \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/insertsize.txt \
--lines 100000

    INSERT SIZE STATISTICS
    ----------------------
    inputfile  : /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/reanalysis_export.txt
    matefile   : /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/reanalysis_export.txt
    
    median: 184
    reads: 100000
    mean: 3302354
    distance        count
    80      0
    90      0
    100     0
    110     1
    120     0
    130     0
    140     2
    150     16
    160     59
    170     89
    180     116
    190     76
    200     37
    210     6
    220     1
    230     1
    240     0
    250     0
    260     1
    270     0
    280     0



TEST WITH MANUAL ELAND RUN WITH SRX001539 10M READ FILES AGAINST THE WHOLE GENOME

/nethome/bioinfo/apps/agua/0.5/bin/apps/insertSize.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/reanalysis_1_export.txt \
--matefile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/reanalysis_2_export.txt \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/insertsize.txt \
--lines 100000


NOTE MEDIAN DOES NOT CHANGE BY INCREASING THE SAMPLE FROM 10,000 TO 100,000:


    INSERT SIZE STATISTICS
    ----------------------
    inputfile  : /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/reanalysis_1_export.txt
    matefile   : /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/reanalysis_2_export.txt
    
    median: 1851
    reads: 10000
    mean: 41005
    distance        count
    800     0
    900     8
    1000    9
    1100    22
    1200    39
    1300    71
    1400    71
    1500    87
    1600    158
    1700    489
    1800    806
    1900    1024
    2000    878
    2100    655
    2200    346
    2300    128
    2400    25
    2500    4
    2600    2
    2700    0
    2800    0
    
    INSERT SIZE STATISTICS
    ----------------------
    inputfile  : /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/reanalysis_1_export.txt
    matefile   : /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/reanalysis_2_export.txt
    
    median: 1851
    reads: 100000
    mean: 37338
    distance        count
    800     0
    900     60
    1000    108
    1100    202
    1200    465
    1300    754
    1400    728
    1500    824
    1600    1723
    1700    4652
    1800    8501
    1900    10164
    2000    9067
    2100    6801
    2200    3360
    2300    1101
    2400    240
    2500    25
    2600    6
    2700    3
    2800    1


NOTES
-----

ELAND OUTPUT FORMATS

http://rulai.cshl.edu/xuan/Doc/Solexa/docs/Whole%20genome%20alignments%20using%20ELAND.html
The command line syntax to run ELAND is

eland_executable queryFile.txt squashedGenomeDir outFile.txt [repeatFile.txt]

1. queryFile.txt is a file of query sequences. This must be either a multi-entry Fasta format file or a one-sequence-per-line ASCII file. The length of each sequence must exceed the read length specified at compilation, else "undefined behaviour" will result. Unspecified bases in the reads must be denoted by an "N." IUPAC ambiguity codes are not handled (yet).

2. squashedGenomeDir is the path to the directory squashed genome files you made above.

3. outFile.txt is the name of the output file. One line of output per sequence, fields are:

    1. Sequence name (derived from file name and line number if format is not Fasta)
    2. Sequence
    3. Type of match:
    NM - no match found.
    QC - no matching done: QC failure (too many Ns basically).
    RM - no matching done: repeat masked (may be seen if repeatFile.txt was specified).
    U0 - Best match found was a unique exact match.
    U1 - Best match found was a unique 1-error match.
    U2 - Best match found was a unique 2-error match.
    R0 - Multiple exact matches found.
    R1 - Multiple 1-error matches found, no exact matches.
    R2 - Multiple 2-error matches found, no exact or 1-error matches.
    4. Number of exact matches found.
    5. Number of 1-error matches found.
    6. Number of 2-error matches found.
    Rest of fields are only seen if a unique best match was found (i.e. the match code in field 3 begins with "U").
    7. Genome file in which match was found.
    8. Position of match (bases in file are numbered starting at 1).
    9. Direction of match (F=forward strand, R=reverse).
    10. How N characters in read were interpreted: ("."=not applicable, "D"=deletion, "I"=insertion).
    Rest of fields are only seen in the case of a unique inexact match (i.e. the match code was U1 or U2).
    11. Position and type of first substitution error (e.g. 12A: base 12 was A, not whatever is was in read).
    12. Position and type of first substitution error, as above.
    For historical reasons a slightly different file format is used if an output name ending in .vmf is specified.

4. repeatFile.txt: Optionally you may want to specify a set of words that you know are highly repetitive in your target files at your read length of interest. You can then tell ELAND to ignore them, which greatly speeds up whole-human-genome alignments. There is no automatic way of generating a repeat file, but with a bit of Perl/shell scripting it is straightforward to extract a list of repeats from the output of a couple of ELAND runs to speed up future runs. You must have one sequence per line in alphabetical order. It does not matter if there are multiple identical sequences or if their length exceeds the read length, it does matter if any of them are shorter than the read length. Also note that you can't just eg stick 200 base ALu sequences in there, it will only read the first 32 of each - you need to split them into overlapping k-mers.

Also in the Eland directory is a basic test harness ELAND_test.pl which can be run to verify correct operation.









</entry>



<entry [Fri Sept 25 20:26:25 EDT 2009] RE-DOWNLOAD NA18507>




1. DOWNLOAD FILES


U01
---

screen -S deep-0600

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600

    Run time: 04:00:35
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    0:26AM, 26 September 2010
    ****************************************

files /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600

    FILES: 442 (/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600)


    #Run time: 09:40:16
    #Completed /nethome/syoung/base/bin/utils/deepvac.pl
    #6:25AM, 12 August 2010
    #****************************************

U02 - DONE
---

screen -S deepvac

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000601 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601

    Run time: 00:05:24
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    8:41PM, 25 September 2010
    ****************************************

    #Run time: 00:46:58
    #Completed /nethome/syoung/base/bin/utils/deepvac.pl
    #9:48PM, 11 August 2010
    #****************************************


U03 - DONE
---

screen -S deepvac

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001540 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540

    Run time: 00:09:24
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    8:42PM, 25 September 2010
    ***************************************

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000602 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602
    
    Run time: 00:21:52
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    9:30PM, 25 September 2010
    ****************************************

    ####Run time: 02:58:31
    ####Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    ####0:01AM, 12 August 2010
    ####****************************************


U04 - DONE
---

screen -S deepvac

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000603 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603
    
    Run time: 00:11:42
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    8:43PM, 25 September 2010
    ****************************************

    
### ALREADY DOWNLOADED
/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001539 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539



2. REMOVE NON-PAIRED FILES 

(WILL CREATE OUTPUT DIRS IF DON'T EXIST)

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/moveFile.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/singles \
--regex "\d\d\.fastq.bz2"







</entry>



<entry [Sat Sep 25 20:14:35 EDT 2010] RUN READ SAMPLING WITH 2,000 BP INSERT READS>




mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp


CHECK IF ANY STRAYS TO BE MOVED (NONE)

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/moveFile.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/singles \
--regex "\d\d\.fastq.bz2"


OUTPUT DIRS:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M

SCRIPT FILE
-----------

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/sampler.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/sampler.sh
#!/bin/sh

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--queue large \
--id 60 \
--length 36 \
--dot 10000000 \
--zipped bz2 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/fixedwidthfastqs.out

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--size 100000000 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/printListFiles.out

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/printSubfiles.out

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--label yoruba1 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/mergeFiles.out

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
--clean \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader/simpleheader.out




RUN SCRIPT
----------

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/sampler.sh

screen -S duoK

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/sampler.sh


    ==> fixedwidthfastqs.out <==
    Run time: 00:10:57
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    10:05PM, 27 September 2010
    ****************************************
    
    ==> printSubfiles.out <==
    Run time: 00:29:10
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    10:35PM, 27 September 2010
    ****************************************
    
    ==> printListFiles.out <==
    Run time: 00:01:12
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    10:06PM, 27 September 2010
    ****************************************
    
    ==> mergeFiles.out <==
    Run time: 00:15:24
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    11:39PM, 27 September 2010
    ****************************************
    
    ==> simpleheader.out <==
    Run time: 00:14:35
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl
    11:25AM, 28 September 2010
    ****************************************


CHECKED OUTPUT FILES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M

    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:39 yoruba1-1.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:38 yoruba1-1.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:39 yoruba1-2.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9.2G Sep 27 23:38 yoruba1-2.reads_2.fastq


head  yoruba1-1.reads_1.fastq

    @SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    GATTATTTGCATAAAGCGCATCAGTGTATCACTTCT
    +SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005718.3 FC20CMYAAXX:1:1:613:234                        
    GCAATGTAAAGCTCCTGGCTCAAGTTTTCTGGCTGT
    +SRR005718.3 FC20CMYAAXX:1:1:613:234                        
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII0IIII
    @SRR005718.6 FC20CMYAAXX:1:1:699:508                        
    GAAACTGATTTGAAAGGCCACAAAGTAGACTTGGAA


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/simpleheader

ls -al *sequence.txt

    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394684056 Sep 28 11:25 yoruba1-1.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7394717798 Sep 28 11:25 yoruba1-2.reads_2.sequence.txt

head yoruba1-1.reads_1.sequence.txt

    @SRR005718.2:1:1:973:236#0/1
    GATTATTTGCATAAAGCGCATCAGTGTATCACTTCT
    +SRR005718.2:1:1:973:236#0/1
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005718.3:1:1:613:234#0/1
    GCAATGTAAAGCTCCTGGCTCAAGTTTTCTGGCTGT
    +SRR005718.3:1:1:613:234#0/1
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII0IIII
    @SRR005718.6:1:1:699:508#0/1
    GAAACTGATTTGAAAGGCCACAAAGTAGACTTGGAA



NOTES
-----


CHECK IF ANY STRAYS TO BE MOVED (NONE)

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/moveFile.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/singles \
--regex "\d\d\.fastq.bz2"


OUTPUT DIRS:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540



1. RUN fixedWidthFasta.pl TO CREATE FIXED-LENGTH FASTQ FILES
    -   GENERATE AN *.info FILE FOR EACH FIXED-LENGTH .fastq FILE

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M

screen -S twoK

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--queue large \
--id 60 \
--length 36 \
--dot 10000000 \
--zipped bz2 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/fixedwidthfastqs.out

    Run time: 00:10:45
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    11:49PM, 25 September 2010
    ****************************************

    #Run time: 00:24:04
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    #2:41PM, 21 September 2010
    #****************************************    



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth
ll ../../SRX001540/fixedwidth/; echo; ll

    -rw-rw-rw- 1 syoung root 4.3G Sep 25 23:49 SRR005720_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:49 SRR005720_1.fastq.info
    -rw-rw-rw- 1 syoung root 4.3G Sep 25 23:45 SRR005720_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:45 SRR005720_2.fastq.info
    -rw-rw-rw- 1 syoung root 2.0G Sep 25 23:43 SRR005721_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:44 SRR005721_1.fastq.info
    -rw-rw-rw- 1 syoung root 2.0G Sep 25 23:42 SRR005721_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:42 SRR005721_2.fastq.info
    -rw-rw-rw- 1 syoung root 4.1G Sep 25 23:45 SRR005734_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:45 SRR005734_1.fastq.info
    -rw-rw-rw- 1 syoung root 4.1G Sep 25 23:45 SRR005734_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:45 SRR005734_2.fastq.info
    -rw-rw-rw- 1 syoung root 5.5G Sep 25 23:49 SRR005735_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:49 SRR005735_1.fastq.info
    -rw-rw-rw- 1 syoung root 5.5G Sep 25 23:49 SRR005735_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:49 SRR005735_2.fastq.info
    
    -rw-rw-rw- 1 syoung root 5.3G Sep 25 23:49 SRR005718_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:49 SRR005718_1.fastq.info
    -rw-rw-rw- 1 syoung root 5.3G Sep 25 23:49 SRR005718_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:49 SRR005718_2.fastq.info
    -rw-rw-rw- 1 syoung root 3.3G Sep 25 23:47 SRR005719_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:47 SRR005719_1.fastq.info
    -rw-rw-rw- 1 syoung root 3.3G Sep 25 23:47 SRR005719_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 25 23:47 SRR005719_2.fastq.info


    #-rw-rw-rw- 1 syoung root 5.3G Sep 21 14:38 SRR005718_1.fastq
    #-rw-rw-rw- 1 syoung root   18 Sep 21 14:39 SRR005718_1.fastq.info
    #-rw-rw-rw- 1 syoung root 5.3G Sep 21 14:39 SRR005718_2.fastq
    #-rw-rw-rw- 1 syoung root   18 Sep 21 14:39 SRR005718_2.fastq.info
    #-rw-rw-rw- 1 syoung root 3.3G Sep 21 14:37 SRR005719_1.fastq
    #-rw-rw-rw- 1 syoung root   18 Sep 21 14:37 SRR005719_1.fastq.info
    #-rw-rw-rw- 1 syoung root 3.3G Sep 21 14:37 SRR005719_2.fastq
    #-rw-rw-rw- 1 syoung root   18 Sep 21 14:38 SRR005719_2.fastq.info


head  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth/SRR005718_1.fastq

    @SRR005718.1 FC20CMYAAXX:1:1:697:785                        
    AAAAAAAAAAAAAAAAAAAAAAAAAA
    +SRR005718.1 FC20CMYAAXX:1:1:697:785                        
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    GATTATTTGCATAAAGCGCATCAGTG
    +SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005718.3 FC20CMYAAXX:1:1:613:234                        
    GCAATGTAAAGCTCCTGGCTCAAGTT

    #@SRR005718.1 FC20CMYAAXX:1:1:697:785                        
    #AAAAAAAAAAAAAAAAAAAAAAAAAA
    #+SRR005718.1 FC20CMYAAXX:1:1:697:785                        
    #IIIIIIIIIIIIIIIIIIIIIIIIII
    #@SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    #GATTATTTGCATAAAGCGCATCAGTG
    #+SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    #IIIIIIIIIIIIIIIIIIIIIIIIII
    #@SRR005718.3 FC20CMYAAXX:1:1:613:234                        
    #GCAATGTAAAGCTCCTGGCTCAAGTT



2. RUN printListFiles.pl TO GENERATE RANDOMIZED LISTS OF READ BYTE POSITIONS IN FASTA FILES
    -   GENERATE SEVERAL *.list FILES FOR EACH *.info FILE
    -   *.list FILES CONTAIN THE SHUFFLED LOCATIONS OF READS IN THE FIXED-WIDTH FASTQ FILE


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--size 100000000 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/printListFiles.out
    
    Run time: 00:01:13
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    11:56PM, 25 September 2010
    ****************************************

    printListFiles.pl    inputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth
    printListFiles.pl    Doing read subfiles for inputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth
    printListFiles.pl    This inputdir contains this fraction of the total reads: 0.351030041785396
    printListFiles.pl    Size (desired no. reads per file): 100000000
    printListFiles.pl    total reads in inputdir: 103925078
    printListFiles.pl    outdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539
    printListFiles.pl    inputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth
    printListFiles.pl    Doing read subfiles for inputdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth
    printListFiles.pl    This inputdir contains this fraction of the total reads: 0.648969958214604
    printListFiles.pl    Size (desired no. reads per file): 100000000
    printListFiles.pl    total reads in inputdir: 192132426
    printListFiles.pl    outdir: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540



3. RUN printSubfiles.pl TO PRINT FASTQ SUBFILES BASED ON LOCATIONS IN *.list FILES


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M

screen -S twoK

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/printSubfiles.out

    Run time: 00:20:42
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    0:19AM, 26 September 2010
    ****************************************

    #Run time: 04:02:18
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    #8:29PM, 22 September 2010
    #****************************************








4. GENERATE READ SAMPLES USING mergeFiles.pl

screen -S twoK

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/SRX001540/fixedwidth \
--label yoruba1 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M \
--mode fastq \
--indices 1-2 \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/2000bp/100M/mergeFiles.out


    Run time: 00:00:49
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    0:58AM, 26 September 2010
    ****************************************


    #Run time: 01:19:33
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    #11:10PM, 22 September 2010
    #****************************************






</entry>



<entry [Sat Sep 25 20:13:35 EDT 2010] RUN READ SAMPLING WITH 200 BP INSERT READS>



NB: REFACTORED mergeFiles.pl TO AUTOMATICALLY FIND INDICES AND ONLY DO FASTQ FILES

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M


SCRIPT FILE
-----------

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/sampler.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/sampler.sh
#!/bin/sh

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--queue large \
--id 60 \
--length 36 \
--dot 10000000 \
--zipped bz2 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/fixedWidthFastqs.out

echo "Completed fixedWidthFastqs"

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--size 100000000 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/printListFiles.out

echo "Completed printListFiles"

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/printSubfiles.out

echo "Completed printSubfiles"

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--label yoruba1 \
--outputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/mergeFiles.out

echo "Completed mergeFiles"


mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
--clean \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader/simpleheader.out

echo "Completed simpleHeaders"



RUN SCRIPT
----------

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/sampler.sh

screen -S two

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/sampler.sh

    
    ==> fixedWidthFastqs.out <==
    Run time: 00:26:51
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    9:22PM, 27 September 2010
    ****************************************
    
    ==> printListFiles.out <==
    Run time: 00:02:54
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    9:25PM, 27 September 2010
    ****************************************
    
    ==> printSubfiles.out <==
    Run time: 03:13:36
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    0:39AM, 28 September 2010
    ****************************************

    ==> mergeFiles.out <==
    Run time: 01:09:38
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    1:48AM, 28 September 2010
    ****************************************

    ==> simpleheader.out <==
    Run time: 01:34:17
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl
    1:33PM, 28 September 2010
    ****************************************

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M
ls -al *fastq

    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-10.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-10.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-11.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-11.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-12.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:16 yoruba1-12.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:15 yoruba1-13.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:16 yoruba1-13.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:15 yoruba1-14.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:16 yoruba1-14.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:15 yoruba1-15.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:15 yoruba1-15.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:12 yoruba1-16.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:12 yoruba1-16.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:12 yoruba1-17.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:13 yoruba1-17.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:47 yoruba1-18.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-18.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:47 yoruba1-19.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-19.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:14 yoruba1-1.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:14 yoruba1-1.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-20.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:47 yoruba1-20.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:47 yoruba1-21.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-21.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-22.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-22.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-23.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-23.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-24.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-24.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-25.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:48 yoruba1-25.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-26.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-26.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-27.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-27.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-28.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-28.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-29.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:21 yoruba1-29.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:14 yoruba1-2.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:14 yoruba1-2.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 00:59 yoruba1-30.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 00:59 yoruba1-30.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 00:59 yoruba1-31.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 00:59 yoruba1-31.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-32.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-32.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-33.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-33.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-34.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-34.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-35.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:09 yoruba1-35.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:03 yoruba1-36.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:03 yoruba1-36.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:03 yoruba1-37.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:03 yoruba1-37.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:16 yoruba1-3.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:16 yoruba1-3.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:16 yoruba1-4.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:16 yoruba1-4.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:13 yoruba1-5.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:13 yoruba1-5.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:13 yoruba1-6.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:13 yoruba1-6.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:01 yoruba1-7.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:01 yoruba1-7.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:01 yoruba1-8.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-8.reads_2.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-9.reads_1.fastq
    -rw-rw-rw- 1 syoung root 9799975304 Sep 28 01:34 yoruba1-9.reads_2.fastq


head yoruba1-9.reads_2.fastq

    @SRR002271.25 FC2012M_R1:1:1:512:329                        
    CAGTAATGGTTGATGACAGATTCCAAATTATAGATA
    +SRR002271.25 FC2012M_R1:1:1:512:329                        
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR002271.53 FC2012M_R1:1:1:809:653                        
    TTTGACTTGTGTTTTAATGGGAAAGCTTGAAGTTTC
    +SRR002271.53 FC2012M_R1:1:1:809:653                        
    IIIIIIIIIIIIIIIIII?IIIIIIIIIIIIIIIIA
    @SRR002271.91 FC2012M_R1:1:1:540:793                        
    CATCTAGTATTAAGTTATGCCTAGATGGACTTCTGT


SIMPLE HEADER FILES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/simpleheader
ls -al *sequence.txt

    -rw-rw-rw- 1 syoung root 7351160696 Sep 28 13:05 yoruba1-10.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160696 Sep 28 12:31 yoruba1-10.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351148208 Sep 28 13:28 yoruba1-11.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351148208 Sep 28 13:32 yoruba1-11.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351166842 Sep 28 12:52 yoruba1-12.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351166842 Sep 28 12:51 yoruba1-12.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351173420 Sep 28 13:05 yoruba1-13.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351173420 Sep 28 13:28 yoruba1-13.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351175418 Sep 28 13:28 yoruba1-14.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351175418 Sep 28 12:52 yoruba1-14.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351174304 Sep 28 13:28 yoruba1-15.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351174304 Sep 28 12:37 yoruba1-15.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160588 Sep 28 12:31 yoruba1-16.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160588 Sep 28 12:48 yoruba1-16.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160164 Sep 28 12:37 yoruba1-17.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160164 Sep 28 12:31 yoruba1-17.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351167382 Sep 28 12:48 yoruba1-18.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351167382 Sep 28 12:52 yoruba1-18.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351169648 Sep 28 12:31 yoruba1-19.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351169648 Sep 28 12:52 yoruba1-19.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160004 Sep 28 12:48 yoruba1-1.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160004 Sep 28 12:52 yoruba1-1.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351168444 Sep 28 12:48 yoruba1-20.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351168444 Sep 28 12:48 yoruba1-20.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351178910 Sep 28 12:31 yoruba1-21.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351178910 Sep 28 12:48 yoruba1-21.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351174932 Sep 28 13:32 yoruba1-22.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351174932 Sep 28 12:52 yoruba1-22.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351172664 Sep 28 12:48 yoruba1-23.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351172664 Sep 28 13:08 yoruba1-23.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351168142 Sep 28 12:48 yoruba1-24.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351168142 Sep 28 13:32 yoruba1-24.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351163946 Sep 28 13:08 yoruba1-25.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351163946 Sep 28 12:37 yoruba1-25.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351167764 Sep 28 13:14 yoruba1-26.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351167764 Sep 28 12:48 yoruba1-26.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351164454 Sep 28 12:35 yoruba1-27.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351164454 Sep 28 13:08 yoruba1-27.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351161644 Sep 28 12:35 yoruba1-28.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351161644 Sep 28 12:52 yoruba1-28.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351169210 Sep 28 12:31 yoruba1-29.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351169210 Sep 28 12:37 yoruba1-29.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351152730 Sep 28 13:28 yoruba1-2.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351152730 Sep 28 12:48 yoruba1-2.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351170340 Sep 28 13:32 yoruba1-30.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351170340 Sep 28 13:14 yoruba1-30.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351171956 Sep 28 12:48 yoruba1-31.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351171956 Sep 28 13:07 yoruba1-31.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160192 Sep 28 12:48 yoruba1-32.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351160192 Sep 28 12:37 yoruba1-32.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351167256 Sep 28 13:28 yoruba1-33.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351167256 Sep 28 13:27 yoruba1-33.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351169096 Sep 28 12:48 yoruba1-34.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351169096 Sep 28 13:08 yoruba1-34.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351182010 Sep 28 13:32 yoruba1-35.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351182010 Sep 28 13:32 yoruba1-35.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351171624 Sep 28 13:05 yoruba1-36.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351171624 Sep 28 13:14 yoruba1-36.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351188786 Sep 28 12:48 yoruba1-37.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351188786 Sep 28 13:28 yoruba1-37.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351163196 Sep 28 12:35 yoruba1-3.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351163196 Sep 28 13:07 yoruba1-3.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351179572 Sep 28 13:32 yoruba1-4.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351179572 Sep 28 12:31 yoruba1-4.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351163834 Sep 28 12:48 yoruba1-5.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351163834 Sep 28 13:14 yoruba1-5.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351153188 Sep 28 13:08 yoruba1-6.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351153188 Sep 28 12:37 yoruba1-6.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351158068 Sep 28 13:05 yoruba1-7.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351158068 Sep 28 13:32 yoruba1-7.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351162416 Sep 28 12:48 yoruba1-8.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351162416 Sep 28 12:31 yoruba1-8.reads_2.sequence.txt
    -rw-rw-rw- 1 syoung root 7351170214 Sep 28 12:35 yoruba1-9.reads_1.sequence.txt
    -rw-rw-rw- 1 syoung root 7351170214 Sep 28 13:08 yoruba1-9.reads_2.sequence.txt

head yoruba1-10.reads_1.sequence.txt
    @SRR002271.5:1:1:831:387#0/1
    GGAAAGGAATGGAATGGAATGGAATGGAATGGAATG
    +SRR002271.5:1:1:831:387#0/1
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII(=2I
    @SRR002271.59:1:1:590:463#0/1
    GAAGAGGGAAGACCAATTTAACCTCCAAAAAACTTT
    +SRR002271.59:1:1:590:463#0/1
    IIIIIIIIIIIIIIIIIIIIIIIIII5830I9+<=I
    @SRR002271.96:1:1:504:428#0/1
    GCATGGTGTTCTTGGAGCTCACTGGATCTATCATTT

tail yoruba1-10.reads_1.sequence.txt
    +SRR003965.8820729:7:99:1114:1943#0/1
    IIIIIIIII6CIIII.CI+=I=@I*IEI0&3485=,
    @SRR003965.8820770:7:99:1660:1046#0/1
    TCAGTACTTCTTCCCACCCAGAAAAGGCTCGGTTTA
    +SRR003965.8820770:7:99:1660:1046#0/1
    IIIIIIIIIIIIIIIIFBI5E*32+,.>>I+I9;>4
    @SRR003965.8820830:7:99:442:1594#0/1
    ATAACACACCCAACCACACCGCTAACAATCAATACT
    +SRR003965.8820830:7:99:442:1594#0/1
    II@III;IIIIII<:I92;6H'1):0.4$52''.'-

tail yoruba1-10.reads_2.sequence.txt
    +SRR003965.8820729:7:99:1114:1943#0/2
    HII2BIG8F8:>*>29C4+9+))&16/&%((0&%'-
    @SRR003965.8820770:7:99:1660:1046#0/2
    TCAATGAGCAGATGCTAACAGGTTATGAAACTATGC
    +SRR003965.8820770:7:99:1660:1046#0/2
    I-G?II7I:8I16I19+3+,9=+5,+9(&%(2)+*&
    @SRR003965.8820830:7:99:442:1594#0/2
    TGGGGTCATTGGTGTTCTTGTAGTTGAAATACAACG
    +SRR003965.8820830:7:99:442:1594#0/2
    1IIII&8.I1H+%>87%<+5+&+#*+(%)%$&()%1

head yoruba1-10.reads_2.sequence.txt
    @SRR002271.5:1:1:831:387#0/2
    ATTCCATTCGACTGCAATCGAGTTGATTCCATTCCA
    +SRR002271.5:1:1:831:387#0/2
    IIIIIIIIIIIIIIIIIIIIGIIIIIIIIIIII<II
    @SRR002271.59:1:1:590:463#0/2
    ACCATGTTGGGTTCAGAAACTTGCCCTGCCTTCCAG
    +SRR002271.59:1:1:590:463#0/2
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII2I
    @SRR002271.96:1:1:504:428#0/2
    CTTTCAGTTACAATATTTTCAACTTAAGATTGGATT


APPROX 50 MILLION READS PER FILE:

lines yoruba1-10.reads_1.sequence.txt
lines yoruba1-11.reads_1.sequence.txt
lines yoruba1-12.reads_1.sequence.txt
    
    yoruba1-10.reads_1.sequence.txt: 199999496
    yoruba1-11.reads_1.sequence.txt: 199999496
    yoruba1-12.reads_1.sequence.txt: 199999496



NOTES
-----

CHECK IF ANY STRAYS TO BE MOVED (NONE)

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/moveFile.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/s
ingles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/singles,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603/singles \
--regex "\d\d\.fastq.bz2"


mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp

OUTPUT DIRS:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603


1. RUN fixedWidthFasta.pl TO CREATE FIXED-LENGTH FASTQ FILES
    -   GENERATE AN *.info FILE FOR EACH FIXED-LENGTH .fastq FILE

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M

screen -S two

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--queue large \
--id 60 \
--length 36 \
--dot 10000000 \
--zipped bz2 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/fixedWidthFastqs.out
        
    Run time: 00:26:16
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    10:49AM, 26 September 2010
    ****************************************    


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth
ls -alh SRR02933*_*.fastq

    -rw-rw-rw- 1 syoung root 575M Sep 26 10:29 SRR029333_1.fastq
    -rw-rw-rw- 1 syoung root 575M Sep 26 10:31 SRR029333_2.fastq
    -rw-rw-rw- 1 syoung root 968M Sep 26 10:40 SRR029334_1.fastq
    -rw-rw-rw- 1 syoung root 968M Sep 26 10:39 SRR029334_2.fastq
    -rw-rw-rw- 1 syoung root 1.3G Sep 26 10:34 SRR029335_1.fastq
    -rw-rw-rw- 1 syoung root 1.3G Sep 26 10:37 SRR029335_2.fastq
    -rw-rw-rw- 1 syoung root 656M Sep 26 10:36 SRR029336_1.fastq
    -rw-rw-rw- 1 syoung root 656M Sep 26 10:26 SRR029336_2.fastq
    -rw-rw-rw- 1 syoung root 3.1G Sep 26 10:36 SRR029337_1.fastq
    -rw-rw-rw- 1 syoung root 3.1G Sep 26 10:43 SRR029337_2.fastq
    -rw-rw-rw- 1 syoung root 605M Sep 26 10:28 SRR029338_1.fastq
    -rw-rw-rw- 1 syoung root 605M Sep 26 10:35 SRR029338_2.fastq

    #...
    #-rw-rw-rw- 1 syoung root  3.1G Sep 26 00:50 SRR029337_1.fastq
    #-rw-rw-rw- 1 syoung root    11 Sep 26 00:50 SRR029337_1.fastq.info
    #-rw-rw-rw- 1 syoung root  3.1G Sep 26 00:51 SRR029337_2.fastq
    #-rw-rw-rw- 1 syoung root    11 Sep 26 00:52 SRR029337_2.fastq.info
    #-rw-rw-rw- 1 syoung root  605M Sep 26 00:43 SRR029338_1.fastq
    #-rw-rw-rw- 1 syoung root    11 Sep 26 00:46 SRR029338_1.fastq.info
    #-rw-rw-rw- 1 syoung root  605M Sep 26 00:49 SRR029338_2.fastq
    #-rw-rw-rw- 1 syoung root    11 Sep 26 00:49 SRR029338_2.fastq.info
    
head /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth/SRR029338_2.fastq

    @SRR029338.1 080115_EAS112_0034:8:1:615:780                 
    AAAGTCAAATTTGAATTGTTGTCAGC
    +SRR029338.1 080115_EAS112_0034:8:1:615:780                 
    IIIIIIIIDIIIIIIIIIIIII.1F2
    @SRR029338.2 080115_EAS112_0034:8:1:799:785                 
    TCTGATAAAATGCTAACTTAGAAATA
    +SRR029338.2 080115_EAS112_0034:8:1:799:785                 
    IIIIIIIII@IIIII8?II1I9C<II
    @SRR029338.3 080115_EAS112_0034:8:1:611:788                 
    CATATCTTCAGTGGATCTGTCTTTAT

    #@SRR029338.1 080115_EAS112_0034:8:1:615:780                 
    #AAAGTCAAATTTGAATTGTTGTCAGC
    #+SRR029338.1 080115_EAS112_0034:8:1:615:780                 
    #IIIIIIIIDIIIIIIIIIIIII.1F2
    #@SRR029338.2 080115_EAS112_0034:8:1:799:785                 
    #TCTGATAAAATGCTAACTTAGAAATA
    #+SRR029338.2 080115_EAS112_0034:8:1:799:785                 
    #IIIIIIIII@IIIII8?II1I9C<II
    #@SRR029338.3 080115_EAS112_0034:8:1:611:788                 
    #CATATCTTCAGTGGATCTGTCTTTAT




2. RUN printListFiles.pl TO GENERATE RANDOMIZED LISTS OF READ BYTE POSITIONS IN FASTA FILES
    -   GENERATE SEVERAL *.list FILES FOR EACH *.info FILE
    -   *.list FILES CONTAIN THE SHUFFLED LOCATIONS OF READS IN THE FIXED-WIDTH FASTQ FILE


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--size 100000000 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/printListFiles.out

    Run time: 00:02:11
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    11:33AM, 26 September 2010
    ****************************************


global_total: 3758610048
directory       total reads
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth  3259788586
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth  294908326
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth  129727086
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth  74186050

directory       fraction
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth  0.867285657296258
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth  0.0784620703488313
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth  0.0345146435366524
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth  0.0197376288182583



    #Run time: 00:02:24
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    #2:47PM, 21 September 2010
    #****************************************
    #
    #global_total: 4033317542
    #directory       total reads
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth        3251795429
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth        74729052
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth        129727086
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX001539/fixedwidth        103925078
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth        281008471
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX001540/fixedwidth        192132426
    #
    #directory       fraction
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth        0.80623342\
    #8223341
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth        0.01852793\
    #66729316
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth        0.03216386\
    #62587603
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX001539/fixedwidth        0.02576664\
    #91462179
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth        0.06967179\
    #45150077
    #/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX001540/fixedwidth        0.04763632\
    #51837413


3. RUN printSubfiles.pl TO PRINT FASTQ SUBFILES BASED ON LOCATIONS IN *.list FILES


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M

screen -S subfiles

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/printSubfiles.out

    Run time: 00:38:33
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    12:27AM, 26 September 2010
    ****************************************
    
    #Run time: 04:02:18
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    #8:29PM, 22 September 2010
    #****************************************



4. GENERATE READ SAMPLES USING mergeFiles.pl


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/SRX000603/fixedwidth \
--label yoruba1 \
--outputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M/mergeFiles.out
    
    Run time: 01:36:15
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    6:52PM, 27 September 2010
    ****************************************
    
    
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/200bp/100M
ll

    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:43 yoruba1-12.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:43 yoruba1-13.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:44 yoruba1-13.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-14.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:43 yoruba1-14.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-15.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-15.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-16.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-16.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-17.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-17.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:02 yoruba1-18.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:48 yoruba1-18.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:47 yoruba1-19.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:48 yoruba1-19.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:40 yoruba1-1.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:40 yoruba1-1.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:48 yoruba1-20.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:48 yoruba1-20.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:48 yoruba1-21.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:47 yoruba1-21.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-22.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:48 yoruba1-22.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-23.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-23.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-24.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-24.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-25.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-25.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:52 yoruba1-26.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-26.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-27.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-27.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-28.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-28.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-29.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-29.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:31 yoruba1-2.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:39 yoruba1-2.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:47 yoruba1-30.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:49 yoruba1-30.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:48 yoruba1-31.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:47 yoruba1-31.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:47 yoruba1-32.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:47 yoruba1-32.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:47 yoruba1-33.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:46 yoruba1-33.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:55 yoruba1-34.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:46 yoruba1-34.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:55 yoruba1-35.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:55 yoruba1-35.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:55 yoruba1-36.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:55 yoruba1-36.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:27 yoruba1-37.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:55 yoruba1-37.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:31 yoruba1-3.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:31 yoruba1-3.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:31 yoruba1-4.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:32 yoruba1-4.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:32 yoruba1-5.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:32 yoruba1-5.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 17:32 yoruba1-6.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:51 yoruba1-6.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:51 yoruba1-7.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:51 yoruba1-7.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:51 yoruba1-8.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:51 yoruba1-8.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:51 yoruba1-9.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8799977824 Sep 27 18:51 yoruba1-9.reads_2.fastq




</entry>



<entry [Fri Sep 24 14:32:39 EDT 2010] COMPARISON OF MANUAL AND AUTOMATED RUNS OF ELAND STANDALONE ON SRX001539 10M READ FILES>



MANUAL RUN
----------
Mon Sep 20 13:31:53 EDT 2010
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader


tail -n 2 elandHits*out

==> elandHits.1.out <==
hits: 4569742
% hits: 0.913948582789717

==> elandHits.2.out <==
hits: 4567671
% hits: 0.913534382706877

==> elandHits.3.out <==
hits: 4568528
% hits: 0.913705782741157

==> elandHits.4.out <==
hits: 4568565
% hits: 0.913713182742637

==> elandHits.5.out <==
hits: 4569016
% hits: 0.913803382760677

==> elandHits.6.out <==
hits: 4567738
% hits: 0.913547782709556

==> elandHits.7.out <==
hits: 4568629
% hits: 0.913725982745197

==> elandHits.8.out <==
hits: 4567789
% hits: 0.913557982711596

==> elandHits.9.out <==
hits: 4567844
% hits: 0.913568982713796

==> elandHits.10.out <==
hits: 4567319
% hits: 0.913463982692796




AUTOMATED RUN
-------------

==> elandHits.chr1.1.out <==
hits: 295241
% hits: 0.295241

==> elandHits.chr2.1.out <==
hits: 293421
% hits: 0.293421

==> elandHits.chr3.1.out <==
hits: 264994
% hits: 0.264994

==> elandHits.chr4.1.out <==
hits: 265504
% hits: 0.265504

==> elandHits.chr5.1.out <==
hits: 255917
% hits: 0.255917

==> elandHits.chr6.1.out <==
hits: 254383
% hits: 0.254383

==> elandHits.chr7.1.out <==
hits: 265596
% hits: 0.265596

==> elandHits.chr8.1.out <==
hits: 249041
% hits: 0.249041

==> elandHits.chr9.1.out <==
hits: 243782
% hits: 0.243782

==> elandHits.chr10.1.out <==
hits: 265591
% hits: 0.265591

==> elandHits.chr11.1.out <==
hits: 245006
% hits: 0.245006

==> elandHits.chr12.1.out <==
hits: 246061
% hits: 0.246061

==> elandHits.chr13.1.out <==
hits: 218640
% hits: 0.21864

==> elandHits.chr14.1.out <==
hits: 225026
% hits: 0.225026

==> elandHits.chr15.1.out <==
hits: 219470
% hits: 0.21947

==> elandHits.chr16.1.out <==
hits: 236048
% hits: 0.236048

==> elandHits.chr17.1.out <==
hits: 224784
% hits: 0.224784

==> elandHits.chr18.1.out <==
hits: 220777
% hits: 0.220777

==> elandHits.chr19.1.out <==
hits: 211308
% hits: 0.211308

==> elandHits.chr20.1.out <==
hits: 218926
% hits: 0.218926

==> elandHits.chr21.1.out <==
hits: 202615
% hits: 0.202615

==> elandHits.chr22.1.out <==
hits: 196283
% hits: 0.196283

==> elandHits.chrX.1.out <==
hits: 234277
% hits: 0.234277

==> elandHits.chrY.1.out <==
hits: 198784
% hits: 0.198784





</entry>



<entry [Fri Sep 24 00:00:39 EDT 2010] RUN ELAND AND BOWTIE AGAINST SRX001539 USING BOTH GENOME (BOWTIE) AND CHROMOSOMES (ELAND, BOWTIE)>




1. INPUT FILES

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader


2. CREATE DIRECTORY

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome



3. RUN ELAND.pl AGAINST ALL CHROMOSOMES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome

screen -S autogenome-srx001539-eland

/nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label srx001539 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--cluster LSF \
--cpus 4 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/eland.srx001539-1.out 



CALCULATE HITS IN *export.txt FILES

/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
--replicates chr1,chr2,chr3,chr4,chr5,chr6,chr7,chr8,chr9,chr10,chr11,chr12,chr13,chr14,chr15,chr16,chr17,chr18,chr19,chr20,chr21,chr22,chrX,chrY \
--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/1/srx001539_1.1.txt \
--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/%REPLICATE%/1/reanalysis_1_export.txt \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/elandHits.%REPLICATE%.1.out


FOR HIT RESULTS SEE ABOVE:

Fri Sep 24 14:32:39 EDT 2010
COMPARISON OF MANUAL AND AUTOMATED RUNS OF ELAND STANDALONE ON SRX001539 10M READ FILES



/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
--replicates 1-5 \
--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/%REPLICATE%/srx001539_1.%REPLICATE%.txt \
--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/chr1/%REPLICATE%/reanalysis_1_export.txt \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/elandHits.%REPLICATE%.out

    
    Run time: 00:18:32
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl
    2:40PM, 24 September 2010
    ****************************************

WHICH RUNS

/nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/1/srx001539_1.1.txt \
--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/chr1/1/reanalysis_1_export.txt

--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/elandHits.1.out





4. RUN bowtie.pl AGAINST THE GENOME

    1. FIXED samHits.pl SO THAT IT SKIPS ALL '@' HEADER LINES
    
    2. PROBLEM WITH SNP CALLING BECAUSE SAMTOOLS IS LOOKING FOR CHROMOSOME INDEX FILE (NOT IN REFERENCE GENOME DIRECTORY)


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome

screen -S srx001539-bowtie

/nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
--distance 2000 \
--species human \
--label srx001539 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome \
--keep \
--reference /nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie \
--cluster LSF \
--cpus 4 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome/bowtie.srx001539-1.out 

    BOWTIE.pl    Run time: 00:11:48
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    0:00AM, 24 September 2010
    BOWTIE.pl    ****************************************


    BOWTIE.pl    Run time: 00:10:36
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    11:27PM, 24 September 2010
    BOWTIE.pl    ****************************************


CHECK OUTPUT:

hg19/hit.sam FILE IS SORTED CORRECTLY

sort -c -k 3,3 -k 4,4n hit.sam.temp
    OK






5. RUN BOWTIE.pl AGAINST ALL CHROMOSOMES

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo

screen -S bowtie-autochromo

/nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
--distance 2000 \
--species human \
--label srx001539 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo \
--keep \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie \
--cluster LSF \
--cpus 4 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autochromo/bowtie.out    
    
    BOWTIE.pl    Run time: 00:12:34
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    12:36AM, 24 September 2010
    BOWTIE.pl    ****************************************







6. RUN BOWTIE MANUALLY AGAINST WHOLE GENOME WITH EACH MATE SEPARATELY

READ 1
------

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/bowtie.sh \
; date; bjobs
    
    Job <1901777> is submitted to queue <large>.
    Sat Sep 25 19:50:31 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1901776   syoung  RUN   large      u01         n0261       *bowtie.sh Sep 25 19:48
    1901777   syoung  PEND  large      u01                     *bowtie.sh Sep 25 19:50


    
[syoung@u01 manualgenome1]$ cat bowtie.err
    # reads processed: 4999999
    # reads with at least one reported alignment: 4553656 (91.07%)
    # reads that failed to align: 446343 (8.93%)
    Reported 4553656 alignments to 1 output stream(s)
    
    real    2m32.212s
    user    7m44.038s
    sys     0m7.379s

GET HITS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1

/nethome/bioinfo/apps/agua/0.5/bin/apps/samHits.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/out.sam \
 | cut -f 1 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/hit.sam


lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome1/hit.sam
    4553655


READ 2
------

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/bowtie.sh \
; date; bjobs


    Job <1901776> is submitted to queue <large>.
    Sat Sep 25 19:48:50 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1901776   syoung  RUN   large      u01         n0261       *bowtie.sh Sep 25 19:48
    
[syoung@u04 manualgenome2]$ cat bowtie.err

    # reads processed: 4999999
    # reads with at least one reported alignment: 4478992 (89.58%)
    # reads that failed to align: 521007 (10.42%)
    Reported 4478992 alignments to 1 output stream(s)
    
    real    3m21.957s
    user    8m25.193s
    sys     0m12.388s


GET HITS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2

/nethome/bioinfo/apps/agua/0.5/bin/apps/samHits.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/out.sam \
 | cut -f 1 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/hit.sam


lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome2/hit.sam 




7. RUN BOWTIE MANUALLY AGAINST WHOLE GENOME

RUN WITHOUT SETTING --maxins MAX INSERT SIZE:

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome

screen -S bowtie-manualgenome

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome/out.sam

# reads processed: 4999999
# reads with at least one reported alignment: 269377 (5.39%)
# reads that failed to align: 4730622 (94.61%)
Reported 269377 paired-end alignments to 1 output stream(s)

real    61m6.135s
user    147m29.188s
sys     1m38.596s





GET HITS:

/nethome/bioinfo/apps/agua/0.5/bin/apps/samHits.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/out.sam \
 | cut -f 1 > /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/hit.sam
lines /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/hit.sam




8. RUN BOWTIE MANUALLY AGAINST WHOLE GENOME

RUN SETTING --maxins MAX INSERT SIZE TO 3000 BP:

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--maxins 3000 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/bowtie.sh \
; date; bjobs

    Job <1902790> is submitted to queue <large>.
    Sat Sep 25 21:24:57 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1902790   syoung  PEND  large      u01                     *bowtie.sh Sep 25 21:24



cat /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins3000/bowtie.err

    # reads processed: 4999999
    # reads with at least one reported alignment: 702054 (14.04%)
    # reads that failed to align: 4297945 (85.96%)
    Reported 702054 paired-end alignments to 1 output stream(s)
    
    real    38m46.491s
    user    152m1.255s
    sys     0m16.189s




9. RUN BOWTIE MANUALLY AGAINST WHOLE GENOME

RUN SETTING --maxins MAX INSERT SIZE TO 10000 BP:

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--maxins 10000 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/bowtie.sh \
; date; bjobs
    
    Job <1902859> is submitted to queue <large>.
    Sun Sep 26 00:25:43 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1902859   syoung  PEND  large      u01                     *bowtie.sh Sep 26 00:25



cat /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000/bowtie.err

    #### reads processed: 4999999
    #### reads with at least one reported alignment: 702054 (14.04%)
    #### reads that failed to align: 4297945 (85.96%)
    ###Reported 702054 paired-end alignments to 1 output stream(s)
    ###
    ###real    38m46.491s
    ###user    152m1.255s
    ###sys     0m16.189s




10. RUN BOWTIE MANUALLY AGAINST WHOLE GENOME

WITH PRE-1.3 SOLEXA QUALS SETTING AND MAX INSERT SIZE 10,000 bp

    --solexa-quals     input quals are from GA Pipeline ver. < 1.3

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/bowtie.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/bowtie.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--maxins 10000 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/unaligned.txt \
/nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie/hg19 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/out.sam


RUN SCRIPT

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/bowtie.sh
bsub -q large \
-e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/bowtie.err \
-o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/bowtie.out \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/bowtie.sh \
; date; bjobs

    Job <1902860> is submitted to queue <large>.
    Sun Sep 26 00:26:52 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1902859   syoung  RUN   large      u01         n0079       *bowtie.sh Sep 26 00:25
    1902860   syoung  PEND  large      u01                     *bowtie.sh Sep 26 00:26


cat /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/manualgenome-maxins10000-pre1.3/bowtie.err

    ##### reads processed: 4999999
    ##### reads with at least one reported alignment: 702054 (14.04%)
    ##### reads that failed to align: 4297945 (85.96%)
    ####Reported 702054 paired-end alignments to 1 output stream(s)
    ####
    ####real    38m46.491s
    ####user    152m1.255s
    ####sys     0m16.189s











NOTES
-----

/nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie

Usage: 
  bowtie [options]* <ebwt> {-1 <m1> -2 <m2> | --12 <r> | <s>} [<hit>]

  <m1>    Comma-separated list of files containing upstream mates (or the
          sequences themselves, if -c is set) paired with mates in <m2>
  <m2>    Comma-separated list of files containing downstream mates (or the
          sequences themselves if -c is set) paired with mates in <m1>
  <r>     Comma-separated list of files containing Crossbow-style reads.  Can be
          a mixture of paired and unpaired.  Specify "-" for stdin.
  <s>     Comma-separated list of files containing unpaired reads, or the
          sequences themselves, if -c is set.  Specify "-" for stdin.
  <hit>   File to write hits to (default: stdout)
Input:
  -q                 query input files are FASTQ .fq/.fastq (default)
  -f                 query input files are (multi-)FASTA .fa/.mfa
  -r                 query input files are raw one-sequence-per-line
  -c                 query sequences given on cmd line (as <mates>, <singles>)
  -C                 reads and index are in colorspace
  -s/--skip <int>    skip the first <int> reads/pairs in the input
  -u/--qupto <int>   stop after first <int> reads/pairs (excl. skipped reads)
  -5/--trim5 <int>   trim <int> bases from 5' (left) end of reads
  -3/--trim3 <int>   trim <int> bases from 3' (right) end of reads
  --phred33-quals    input quals are Phred+33 (default)
  --phred64-quals    input quals are Phred+64 (same as --solexa1.3-quals)
  --solexa-quals     input quals are from GA Pipeline ver. < 1.3
  --solexa1.3-quals  input quals are from GA Pipeline ver. >= 1.3
  --integer-quals    qualities are given as space-separated integers (not ASCII)
Alignment:
  -v <int>           report end-to-end hits w/ <=v mismatches; ignore qualities
    or
  -n/--seedmms <int> max mismatches in seed (can be 0-3, default: -n 2)
  -e/--maqerr <int>  max sum of mismatch quals across alignment for -n (def: 70)
  -l/--seedlen <int> seed length for -n (default: 28)
  --nomaqround       disable Maq-like quality rounding for -n (nearest 10 <= 30)
  -I/--minins <int>  minimum insert size for paired-end alignment (default: 0)
  -X/--maxins <int>  maximum insert size for paired-end alignment (default: 250)
  --fr/--rf/--ff     -1, -2 mates align fw/rev, rev/fw, fw/fw (default: --fr)
  --nofw/--norc      do not align to forward/reverse-complement reference strand
  --maxbts <int>     max # backtracks for -n 2/3 (default: 125, 800 for --best)
  --pairtries <int>  max # attempts to find mate for anchor hit (default: 100)
  -y/--tryhard       try hard to find valid alignments, at the expense of speed
  --chunkmbs <int>   max megabytes of RAM for best-first search frames (def: 64)
Reporting:
  -k <int>           report up to <int> good alignments per read (default: 1)
  -a/--all           report all alignments per read (much slower than low -k)
  -m <int>           suppress all alignments if > <int> exist (def: no limit)
  -M <int>           like -m, but reports 1 random hit (MAPQ=0); requires --best
  --best             hits guaranteed best stratum; ties broken by quality
  --strata           hits in sub-optimal strata aren't reported (requires --best)
Output:
  -t/--time          print wall-clock time taken by search phases
  -B/--offbase <int> leftmost ref offset = <int> in bowtie output (default: 0)
  --quiet            print nothing but the alignments
  --refout           write alignments to files refXXXXX.map, 1 map per reference
  --refidx           refer to ref. seqs by 0-based index rather than name
  --al <fname>       write aligned reads/pairs to file(s) <fname>
  --un <fname>       write unaligned reads/pairs to file(s) <fname>
  --max <fname>      write reads/pairs over -m limit to file(s) <fname>
  --suppress <cols>  suppresses given columns (comma-delim'ed) in default output
  --fullref          write entire ref name (default: only up to 1st space)
Colorspace:
  --snpphred <int>   Phred penalty for SNP when decoding colorspace (def: 30)
     or
  --snpfrac <dec>    approx. fraction of SNP bases (e.g. 0.001); sets --snpphred
  --col-cseq         print aligned colorspace seqs as colors, not decoded bases
  --col-cqual        print original colorspace quals, not decoded quals
  --col-keepends     keep nucleotides at extreme ends of decoded alignment
SAM:
  -S/--sam           write hits in SAM format
  --mapq <int>       default mapping quality (MAPQ) to print for SAM alignments
  --sam-nohead       supppress header lines (starting with @) for SAM output
  --sam-nosq         supppress @SQ header lines for SAM output
  --sam-RG <text>    add <text> (usually "lab=value") to @RG line of SAM header
Performance:
  -o/--offrate <int> override offrate of index; must be >= index's offrate
  -p/--threads <int> number of alignment threads to launch (default: 1)
  --mm               use memory-mapped I/O for index; many 'bowtie's can share
  --shmem            use shared mem for index; many 'bowtie's can share
Other:
  --seed <int>       seed for random number generator
  --verbose          verbose output (for debugging)
  --version          print version information and quit
  -h/--help          print this usage message




</entry>



<entry [Fri Sep 24 11:28:21 EDT 2010] DOWNLOAD UCSC (GOLDEN PATH) hg19 GENOME AND mRNA SEQUENCES>




hg19 mRNA genbank
-----------------
mkdir -p /nethome/bioinfo/data/sequence/mrna/human/hg19/genbank
cd /nethome/bioinfo/data/sequence/mrna/human/hg19/genbank

mrna.fa.gz - Human mRNA from GenBank. This sequence data is updated
    once a week via automatic GenBank updates.

wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/mrna.fa.gz
wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/mrna.fa.gz.md5

gmd5sum -c mrna.fa.gz.md5 
mrna.fa.gz: OK


hg19 mRNA refseq
----------------
mkdir -p /nethome/bioinfo/data/sequence/mrna/human/hg19/refseq
cd /nethome/bioinfo/data/sequence/mrna/human/hg19/refseq

mrna.fa.gz - Human mRNA from refseq. This sequence data is updated
    once a week via automatic refseq updates.

wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/refMrna.fa.gz.md5
wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/refMrna.fa.gz

md5sum -c refMrna.fa.gz.md5 
refMrna.fa.gz: OK



hg19 2bit
---------
mkdir -p /nethome/bioinfo/data/sequence/genomes/human/hg19/2bit
cd /nethome/bioinfo/data/sequence/genomes/human/hg19/2bit
wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/hg19.2bit

OK


hg19 FASTA
----------
mkdir -p /nethome/bioinfo/data/sequence/genomes/human/hg19/fasta
CONVERT FROM 2bit TO FASTA
cd /nethome/bioinfo/data/sequence/genomes/human/hg19/2bit
/nethome/syoung/bin/x86_64/twoBitToFa hg19.2bit hg19.fa
mv hg19.fa ../fasta

OK


hg19 ELAND  **** CANNOT SQUASH WHOLE GENOME. INSTEAD, USE CHROMOSOMES ****
----------
mkdir -p /nethome/bioinfo/data/sequence/genomes/human/hg19/eland
cd /nethome/bioinfo/data/sequence/genomes/human/hg19/eland
SQUASH FROM FASTA
/nethome/syoung/base/apps/GAPipeline/1.6.0/bin/squashGenome ./ ../fasta/hg19.fa

    squash: opened file ../fasta/hg19.fa of size -1095061387 bytes.
    Segmentation fault


hg19 MASKED
-----------
mkdir -p /nethome/bioinfo/data/sequence/genomes/human/hg19/masked
cd /nethome/bioinfo/data/sequence/genomes/human/hg19/masked

chromFaMasked.tar.gz - The assembly sequence in one file per chromosome.
    Repeats are masked by capital Ns; non-repeating sequence is shown in
    upper case.
    
wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromFaMasked.tar.gz

chromOut.tar.gz - RepeatMasker .out files (one file per chromosome).
    RepeatMasker was run with the -s (sensitive) setting.
    Using: Jan 29 2009 (open-3-2-7) version of RepeatMasker and
    RELEASE 20090120 of library RepeatMaskerLib.embl

wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromOut.tar.gz

OK


hg19 REPEATS
------------
mkdir -p /nethome/bioinfo/data/sequence/genomes/human/hg19/repeats
cd /nethome/bioinfo/data/sequence/genomes/human/hg19/repeats

wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromTrf.tar.gz

chromTrf.tar.gz - Tandem Repeats Finder locations, filtered to keep repeats
    with period less than or equal to 12, and translated into UCSC's BED 5+
    format (one file per chromosome).





NOTES
-----


http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64/


twoBitToFa - Convert all or part of .2bit file to fasta
usage:
   twoBitToFa input.2bit output.fa
options:
   -seq=name - restrict this to just one sequence
   -start=X  - start at given position in sequence (zero-based)
   -end=X - end at given position in sequence (non-inclusive)
   -seqList=file - file containing list of the desired sequence names 
                    in the format seqSpec[:start-end], e.g. chr1 or chr1:0-189
                    where coordinates are half-open zero-based, i.e. [start,end)
   -noMask - convert sequence to all upper case
   -bpt=index.bpt - use bpt index instead of built in one
   -bed=input.bed - grab sequences specified by input.bed. Will exclude introns

Sequence and range may also be specified as part of the input
file name using the syntax:
      /path/input.2bit:name
   or
      /path/input.2bit:name
   or
      /path/input.2bit:name:start-end



CONTENTS OF PAGE
http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/


This directory contains the Feb. 2009 assembly of the human genome (hg19,
GRCh37 Genome Reference Consortium Human Reference 37 (GCA_000001405.1)),
as well as repeat annotations and GenBank sequences.

The Feb. 2009 human reference sequence (GRCh37) was produced by the
Genome Reference Consortium:
	http://www.ncbi.nlm.nih.gov/projects/genome/assembly/grc/

Files included in this directory:

chromAgp.tar.gz - Description of how the assembly was generated from
    fragments, unpacking to one file per chromosome.

chromFa.tar.gz - The assembly sequence in one file per chromosome.
    Repeats from RepeatMasker and Tandem Repeats Finder (with period
    of 12 or less) are shown in lower case; non-repeating sequence is
    shown in upper case.

chromFaMasked.tar.gz - The assembly sequence in one file per chromosome.
    Repeats are masked by capital Ns; non-repeating sequence is shown in
    upper case.

chromOut.tar.gz - RepeatMasker .out files (one file per chromosome).
    RepeatMasker was run with the -s (sensitive) setting.
    Using: Jan 29 2009 (open-3-2-7) version of RepeatMasker and
    RELEASE 20090120 of library RepeatMaskerLib.embl

chromTrf.tar.gz - Tandem Repeats Finder locations, filtered to keep repeats
    with period less than or equal to 12, and translated into UCSC's BED 5+
    format (one file per chromosome).

hg19.2bit - contains the complete hg19 Human Genome
    in the 2bit format.  A utility program, twoBitToFa (available
    from our src tree), can be used to extract .fa file(s) from
    this file.  See also:
	http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64/

est.fa.gz - Human ESTs in GenBank. This sequence data is updated once a
    week via automatic GenBank updates.

md5sum.txt - checksums of files in this directory

mrna.fa.gz - Human mRNA from GenBank. This sequence data is updated
    once a week via automatic GenBank updates.

refMrna.fa.gz - RefSeq mRNA from the same species as the genome.
    This sequence data is updated once a week via automatic GenBank
    updates.

upstream1000.fa.gz - Sequences 1000 bases upstream of annotated
    transcription starts of RefSeq genes with annotated 5' UTRs.
    This file is updated weekly so it might be slightly out of sync with
    the RefSeq data which is updated daily for most assemblies.

upstream2000.fa.gz - Same as upstream1000, but 2000 bases.

upstream5000.fa.gz - Same as upstream1000, but 5000 bases.

xenoMrna.fa.gz - GenBank mRNAs from species other than that of 
    the genome. This sequence data is updated once a week via automatic 
    GenBank updates.



------------------------------------------------------------------
If you plan to download a large file or multiple files from this
directory, we recommend that you use ftp rather than downloading the
files via our website. To do so, ftp to hgdownload.cse.ucsc.edu
[username: anonymous, password: your email address], then cd to the
directory goldenPath/hg19/bigZips. To download multiple files, use
the "mget" command:

    mget <filename1> <filename2> ...
    - or -
    mget -a (to download all the files in the directory)

Alternate methods to ftp access.

Using an rsync command to download the entire directory:
    rsync -avzP rsync://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/ .
For a single file, e.g. chromFa.tar.gz
    rsync -avzP 
        rsync://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz .

Or with wget, all files:
    wget --timestamping 
        'ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/*'
With wget, a single file:
    wget --timestamping 
        'ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz' 
        -O chromFa.tar.gz

To unpack the *.tar.gz files:
    tar xvzf <file>.tar.gz
To uncompress the fa.gz files:
    gunzip <file>.fa.gz

All the files in this directory are freely available for public use.
      Name                    Last modified      Size  Description
      Parent Directory                             -   
      chromAgp.tar.gz         20-Mar-2009 09:02  538K  
      chromFa.tar.gz          20-Mar-2009 09:21  905M  
      chromFaMasked.tar.gz    20-Mar-2009 09:30  477M  
      chromOut.tar.gz         20-Mar-2009 09:03  163M  
      chromTrf.tar.gz         20-Mar-2009 09:30  7.6M  
      est.fa.gz               24-Sep-2010 07:05  1.4G  
      est.fa.gz.md5           24-Sep-2010 07:05   44   
      hg19.2bit               08-Mar-2009 15:29  778M  
      md5sum.txt              29-Jul-2009 10:04  457   
      mrna.fa.gz              24-Sep-2010 07:05  179M  
      mrna.fa.gz.md5          24-Sep-2010 07:05   45   
      refMrna.fa.gz           24-Sep-2010 07:05   36M  
      refMrna.fa.gz.md5       24-Sep-2010 07:05   48   
      upstream1000.fa.gz      24-Sep-2010 07:05  7.2M  
      upstream1000.fa.gz.md5  24-Sep-2010 07:05   53   
      upstream2000.fa.gz      24-Sep-2010 07:05   14M  
      upstream2000.fa.gz.md5  24-Sep-2010 07:05   53   
      upstream5000.fa.gz      24-Sep-2010 07:05   33M  
      upstream5000.fa.gz.md5  24-Sep-2010 07:05   53   
      xenoMrna.fa.gz          24-Sep-2010 07:05  888M  
      xenoMrna.fa.gz.md5      24-Sep-2010 07:05   49   





</entry>



<entry [Thu Sep 23 23:06:17 EDT 2010] RAN ELAND.pl AND BOWTIE.pl FOR ALL 10M SAMPLES OF SRR001539 ON chr22 ONLY>




ENCOUNTERED MINIMUM UNIQUE ALIGNMENTS THRESHOLD PROBLEM WITH pickBestPairs.pl, WHICH THEN DEFAULTS TO TREATING THE READS AS SINGLE READS


SOLUTION:

--min-percent-unique-pairs=101


http://rulai.cshl.edu/xuan/Doc/GApipeline-0.3/New%20analysis%20modes%20for%20GERALD%20in%20Pipeline%20Version%200.3.html


--min-percent-unique-pairs: In this context a "unique pair" is defined as a read pair such that its constituent reads can each be aligned to a unique position in the genome without needing to make use of the fact that they are paired - "individually uniquely aligning" is perhaps a more precise but more verbose definition. pickBestPair works in a two-pass fashion. On the first pass it looks for all clusters that both pass the quality filter and are unique by this definition, using this information to determine the nominal insert size distribution and the relative orientation of the two reads. On a second pass this information is used to resolve repeats and other ambigouous cases.


1. INPUT FILES

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader

2. CREATE DIRECTORY

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome

3. RUN ELAND.pl

screen -S srx001539-eland

/nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label srx001539 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--cluster LSF \
--cpus 4 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/eland.srx001539-1.out 


tail -f /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/autogenome/eland.srx001539-1.out 







4. RUN bowtie.pl

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome


screen -S srx001539-bowtie

/nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
--distance 2000 \
--species human \
--label srx001539 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome \
--keep \
--reference /nethome/bioinfo/data/sequence/genomes/human/hg19/bowtie \
--cluster LSF \
--cpus 4 \
--reads 1000000 \
--clean \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome/bowtie.srx001539-1.out 


tail -f /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/bowtie/SRX001539/autogenome/bowtie.srx001539-1.out 









</entry>



<entry [Thu Sep 23 23:06:17 EDT 2010] RAN ELAND.pl FOR ALL 10M SAMPLES OF SRR001539 ON chr22 ONLY>




ENCOUNTERED MINIMUM UNIQUE ALIGNMENTS THRESHOLD PROBLEM WITH pickBestPairs.pl, WHICH THEN DEFAULTS TO TREATING THE READS AS SINGLE READS


SOLUTION:

--min-percent-unique-pairs=101


http://rulai.cshl.edu/xuan/Doc/GApipeline-0.3/New%20analysis%20modes%20for%20GERALD%20in%20Pipeline%20Version%200.3.html


--min-percent-unique-pairs: In this context a "unique pair" is defined as a read pair such that its constituent reads can each be aligned to a unique position in the genome without needing to make use of the fact that they are paired - "individually uniquely aligning" is perhaps a more precise but more verbose definition. pickBestPair works in a two-pass fashion. On the first pass it looks for all clusters that both pass the quality filter and are unique by this definition, using this information to determine the nominal insert size distribution and the relative orientation of the two reads. On a second pass this information is used to resolve repeats and other ambigouous cases.


1. INPUT FILES

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader

2. CREATE DIRECTORY

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/auto
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/auto

3. RUN ELAND.pl

screen -S srx001539-eland

/nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label srx001539 \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/auto \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--cluster LSF \
--cpus 4 \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/auto/eland.srx001539-1.out 



emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/auto/chr22/1/doBatchAlignment-chr22-stdout.txt 

    ...
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: setting circular to Y
    Obtained total genome size of 49591432 bp
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Found 11543 initial pairs from 1000000 clusters
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: only 1.15430 percent of clusters with unique alignment of each read, need 10 percent to do paired alignment
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Nominal orientation of this sample appears to be Rm
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: warning - data will be treated as two sets of unpaired reads
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 26 for read 1
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 26 for read 2
    ...



</entry>



<entry [Thu Sep 23 14:23:55 EDT 2010] RERUN ELAND MANUALLY WITH A SMALL NA18507 SAMPLE FILE ***AGAINST CHRY ONLY***>



1. EXACT ACCORDANCE BETWEEN SINGLE READ AND PAIRED END ALIGNMENTS

2. PERCENTAGE HITS DID NOT FALL BELOW 10% (MIN PERCENTAGE OF UNIQUE HITS REQUIRED BY pickBestPair)

read 1
% HITS = (3602769 - 3104027)/3602769 = 498742/3602769 = 0.138432966421106

read 2
% HITS = (3602769 - 3080542)/3602769 = 522227/3602769 = 0.144951563644519


paired
% HITS = (3602769 - 3104027)/3602769 = 498742/3602769 = 0.138432966421106
% HITS = (3602769 - 3080542)/3602769 = 522227/3602769 = 0.144951563644519


INPUT FILES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600
ll SRR029338_*.simpleHeader.txt

    -rw-rw-rw- 1 syoung root 502M Sep 16 13:58 SRR029338_2.simpleHeader.txt
    -rw-rw-rw- 1 syoung root 502M Sep 16 13:58 SRR029338_1.simpleHeader.txt



MAKE DIRECTORIES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600
mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1
cp SRR029338_1.simpleHeader.txt chrY/read_1
mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2
cp SRR029338_2.simpleHeader.txt chrY/read_2
mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired
cp SRR029338_1.simpleHeader.txt chrY/paired
cp SRR029338_2.simpleHeader.txt chrY/paired



READ 1
------

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/SRR029338_1.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/SRR029338_1.ELAND.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chrY \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/SRR029338_1.simpleHeader.txt



RUN JOB

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/SRR029338_1.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/SRR029338_1.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/SRR029338_1.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1/SRR029338_1.ELAND.sh 
    
    Job <1895966> is submitted to queue <large>.
    Thu Sep 23 12:14:05 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1895966   syoung  RUN   large      u04         n0183       *.ELAND.sh Sep 23 12:14
    1895945   syoung  RUN   small      u04         n0094       *001539[1] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[2] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[3] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[4] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[5] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[6] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[7] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[8] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0184       *001539[9] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0184       *01539[10] Sep 23 10:23



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_1
lines reanalysis_export.txt
cut -f 11 < reanalysis_export.txt | grep -c NM
cut -f 11 < reanalysis_export.txt | grep -c QC


lines reanalysis_export.txt
    reanalysis_export.txt: 3602769
cut -f 11 < reanalysis_export.txt | grep -c NM
    222281
cut -f 11 < reanalysis_export.txt | grep -c QC
    0


reanalysis_export.txt: 3602769
[syoung@u04 read_1]$ cut -f 11 < reanalysis_export.txt | grep -c NM
3104027
[syoung@u04 read_1]$ cut -f 11 < reanalysis_export.txt | grep -c QC
0


% HITS = (3602769 - 3104027)/3602769 = 498742/3602769 = 0.138432966421106



READ 2
------

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/SRR029338_2.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/SRR029338_2.ELAND.sh
#!/bin/sh

#BSUB -W 24:00

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chrY \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/SRR029338_2.simpleHeader.txt



RUN JOB

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/SRR029338_2.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/SRR029338_2.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/SRR029338_2.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2/SRR029338_2.ELAND.sh ; date; bjobs
    
        
    Job <1895968> is submitted to queue <large>.
    Thu Sep 23 12:15:06 EDT 2010



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/read_2
lines reanalysis_export.txt
cut -f 11 < reanalysis_export.txt | grep -c NM
cut -f 11 < reanalysis_export.txt | grep -c QC


lines reanalysis_export.txt
    reanalysis_export.txt: 3602769
[syoung@u04 read_2]$ cut -f 11 < reanalysis_export.txt | grep -c NM
    3080542
[syoung@u04 read_2]$ cut -f 11 < reanalysis_export.txt | grep -c QC
    0


% HITS = (3602769 - 3080542)/3602769 = 522227/3602769 = 0.144951563644519



PAIRED
------

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_1+2.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_1+2.ELAND.sh
#!/bin/sh

#BSUB -W 24:00
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chrY \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_1.simpleHeader.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_2.simpleHeader.txt



RUN JOB


chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_1+2.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_1+2.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_1+2.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired/SRR029338_1+2.ELAND.sh ; date; bjobs

    Job <1895975> is submitted to queue <large>.
    Thu Sep 23 12:29:20 EDT 2010

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired
ll
        
    -rw-rw-r-- 1 syoung root 157M Sep 23 12:51 reanalysis_1_calsaf.txt
    -rw-rw-r-- 1 syoung root 309M Sep 23 12:36 reanalysis_1_eland_extended.txt
    -rw-rw-r-- 1 syoung root 268M Sep 23 12:32 reanalysis_1_eland_query.txt
    -rw-rw-r-- 1 syoung root 435M Sep 23 12:54 reanalysis_1_export.txt
    -rw-rw-r-- 1 syoung root 385M Sep 23 12:30 reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root 157M Sep 23 12:51 reanalysis_2_calsaf.txt
    -rw-rw-r-- 1 syoung root 309M Sep 23 12:43 reanalysis_2_eland_extended.txt
    -rw-rw-r-- 1 syoung root 268M Sep 23 12:39 reanalysis_2_eland_query.txt
    -rw-rw-r-- 1 syoung root 434M Sep 23 12:56 reanalysis_2_export.txt
    -rw-rw-r-- 1 syoung root 385M Sep 23 12:37 reanalysis_2_qseq.txt
    -rw-rw-r-- 1 syoung root 706M Sep 23 12:51 reanalysis_anomaly.txt
    -rw-rw-r-- 1 syoung root   61 Sep 23 12:43 reanalysis_genomesize.xml
    -rw-rw-r-- 1 syoung root 6.3K Sep 23 12:51 reanalysis_pair.xml
    -rw-rw-r-- 1 syoung root  50K Sep 23 12:56 SRR029338_1+2.ELAND.err
    -rw-rw-r-- 1 syoung root 8.7K Sep 23 12:56 SRR029338_1+2.ELAND.out
    -rwxr-xr-x 1 syoung root  543 Sep 23 12:17 SRR029338_1+2.ELAND.sh
    -rw-rw-r-- 1 syoung root 502M Sep 23 12:08 SRR029338_1.simpleHeader.txt
    -rw-rw-r-- 1 syoung root 502M Sep 23 12:23 SRR029338_2.simpleHeader.txt
    

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired
lines SRR029338_1.simpleHeader.txt
lines SRR029338_2.simpleHeader.txt

lines SRR029338_1.simpleHeader.txt
lines SRR029338_2.simpleHeader.txt
    SRR029338_1.simpleHeader.txt: 14411076
[syoung@u04 paired]$ lines SRR029338_2.simpleHeader.txt
    SRR029338_2.simpleHeader.txt: 14411076

= 3602769 RECORDS
    OK


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired
cut -f 11 < reanalysis_1_export.txt | grep -c NM
cut -f 11 < reanalysis_1_export.txt | grep -c QC


cut -f 11 < reanalysis_1_export.txt | grep -c NM
    3104027
cut -f 11 < reanalysis_1_export.txt | grep -c QC
    0

% HITS = (3602769 - 3104027)/3602769 = 498742/3602769 = 0.138432966421106
SAME AS SINGLE READ RUN


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/chrY/paired
cut -f 11 < reanalysis_2_export.txt | grep -c NM
cut -f 11 < reanalysis_2_export.txt | grep -c QC


[syoung@u04 paired]$ cut -f 11 < reanalysis_2_export.txt | grep -c NM
3080542
[syoung@u04 paired]$ cut -f 11 < reanalysis_2_export.txt | grep -c QC
0


% HITS = (3602769 - 3080542)/3602769 = 522227/3602769 = 0.144951563644519




</entry>



<entry [Mon Sep 20 13:31:53 EDT 2010] RAN ELAND STANDALONE MANUALLY ON SRX001539 10M READ FILES>



OUTPUT DIRECTORY
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader


1. INPUT FILES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M
ll *fastq

    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-10.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-10.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-1.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-1.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-2.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-2.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-3.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-3.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-4.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-4.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-5.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-5.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-6.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-6.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-7.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-7.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-8.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-8.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-9.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-9.reads_2.fastq



2. CONVERT TO SIMPLE HEADER

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader

screen -S simpleheader

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
--clean \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/simpleheader.out


    Run time: 00:03:19
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl
    10:52PM, 22 September 2010
    ****************************************



3. CREATE DIRECTORY

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual



4. CREATE SCRIPT 

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/eland_standalone.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/eland_standalone.sh

#!/bin/sh

#BSUB -W 24:00

echo "Making output directory: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/$LSB_JOBINDEX"
mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/$LSB_JOBINDEX

echo "Changing to output directory"
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/$LSB_JOBINDEX

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-$LSB_JOBINDEX.reads_1.sequence.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-$LSB_JOBINDEX.reads_2.sequence.txt



5. SUBMIT JOB

chmod 755 eland_standalone.sh

bsub -J "srx001539[1-10]" -o "/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/%I/eland_standalone.out" -e "/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/%I/eland_standalone.err" /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/eland_standalone.sh

RUNNING
Thu Sep 23 10:24:12 EDT 2010


ll */reanal*

    -rw-rw-r-- 1 syoung root 128M Sep 23 10:24 10/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root  48M Sep 23 10:24 1/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root 100M Sep 23 10:24 2/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root  56M Sep 23 10:24 3/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root 102M Sep 23 10:24 4/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root  98M Sep 23 10:24 5/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root 126M Sep 23 10:24 6/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root  96M Sep 23 10:24 7/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root  57M Sep 23 10:24 8/reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung root 127M Sep 23 10:24 9/reanalysis_1_qseq.txt




6. CALCULATE HITS IN *export.txt FILES


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual

/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
--replicates 1-10 \
--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-%REPLICATE%.reads_1.sequence.txt \
--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/%REPLICATE%/reanalysis_1_export.txt \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/elandHits.%REPLICATE%.out

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/elandHits.1-10.out

    
    Run time: 00:18:21
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl
    2:27PM, 24 September 2010
    ****************************************


WHICH RUNS

/nethome/bioinfo/apps/agua/0.5/bin/apps/elandHits.pl \
--readsfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/simpleheader/srx001539-1.reads_1.sequence.txt \
--exportfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/1/reanalysis_1_export.txt
 tail -n 2 elandHits*out


==> elandHits.1.out <==
hits: 4569742
% hits: 0.913948582789717

==> elandHits.2.out <==
hits: 4567671
% hits: 0.913534382706877

==> elandHits.3.out <==
hits: 4568528
% hits: 0.913705782741157

==> elandHits.4.out <==
hits: 4568565
% hits: 0.913713182742637

==> elandHits.5.out <==
hits: 4569016
% hits: 0.913803382760677

==> elandHits.6.out <==
hits: 4567738
% hits: 0.913547782709556

==> elandHits.7.out <==
hits: 4568629
% hits: 0.913725982745197

==> elandHits.8.out <==
hits: 4567789
% hits: 0.913557982711596

==> elandHits.9.out <==
hits: 4567844
% hits: 0.913568982713796

==> elandHits.10.out <==
hits: 4567319
% hits: 0.913463982692796






NOTES
-----


HOW TO SUBMIT LSF ARRAY JOBS

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual
rm -fr testarray.sh
emacs testarray.sh
#!/bin/sh                                                                                       

#BSUB -J test1                                                                                  
#BSUB -o %J.out                                                                                 
#BSUB -e %J.err                                                                                 
#BSUB -W 1:00                                                                                   
#BSUB -q priority                                                                               
#BSUB -n 1                                                                                      
#BSUB -B                                                                                        
#BSUB -N                                                                                        
#                                                                                               
echo "Running serial executable on 1 cpu of one node"
# Run serial executable on 1 cpu of one node                                                    
cd /nethome/syoung/base/pipeline/lsf/test
/usr/bin/perl /nethome/syoung/base/pipeline/lsf/array/test.x a b c > /nethome/syoung/base/pipeline/lsf/test/out.txt
exit;



SUBMIT JOB

bsub -J "myArray[1-10]" -o "output.%J.%I" /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/manual/testarray.sh


RESULTS

cat /nethome/syoung/base/pipeline/lsf/test/out.txt
    A: a
    B: b
    C: c
    Sleeping 10 seconds
    Completed /nethome/syoung/base/pipeline/lsf/array/test.x






</entry>



<entry [Wed Sep 22 16:35:26 EDT 2010] REMOVED NUMBERED DIRECTORIES>




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M


DIRS="*"
for DIR in $DIRS;
do
    SPLITDIR=$(echo $DIR | egrep "^[0-9]+" ); 
    if [ "$SPLITDIR" != "" ]; then
        echo REMOVING DIR: `pwd`/$SPLITDIR;
		rm -fr `pwd`/$SPLITDIR
    fi;
done;





</entry>



<entry [Fri Aug 27 12:58:00 EDT 2010] RE-RUN READ SAMPLING WITH NO LENGTH/QUALITY TRIMMING>




OUTPUT DIRS:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540


1. RUN fixedWidthFasta.pl TO CREATE FIXED-LENGTH FASTQ FILES
    -   GENERATE AN *.info FILE FOR EACH FIXED-LENGTH .fastq FILE

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M

screen -S fixedwidth

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--queue large \
--id 60 \
--length 26 \
--dot 10000000 \
--zipped gzip \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M/fixedWidthFastqs.out

    Run time: 00:24:04
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    2:41PM, 21 September 2010
    ****************************************    


ll /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth 
    -rw-rw-rw- 1 syoung root 5.3G Sep 21 14:38 SRR005718_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 21 14:39 SRR005718_1.fastq.info
    -rw-rw-rw- 1 syoung root 5.3G Sep 21 14:39 SRR005718_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 21 14:39 SRR005718_2.fastq.info
    -rw-rw-rw- 1 syoung root 3.3G Sep 21 14:37 SRR005719_1.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 21 14:37 SRR005719_1.fastq.info
    -rw-rw-rw- 1 syoung root 3.3G Sep 21 14:37 SRR005719_2.fastq
    -rw-rw-rw- 1 syoung root   18 Sep 21 14:38 SRR005719_2.fastq.info

head  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR005718_1.fastq
    @SRR005718.1 FC20CMYAAXX:1:1:697:785                        
    AAAAAAAAAAAAAAAAAAAAAAAAAA
    +SRR005718.1 FC20CMYAAXX:1:1:697:785                        
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    GATTATTTGCATAAAGCGCATCAGTG
    +SRR005718.2 FC20CMYAAXX:1:1:973:236                        
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005718.3 FC20CMYAAXX:1:1:613:234                        
    GCAATGTAAAGCTCCTGGCTCAAGTT



2. RUN printListFiles.pl TO GENERATE RANDOMIZED LISTS OF READ BYTE POSITIONS IN FASTA FILES
    -   GENERATE SEVERAL *.list FILES FOR EACH *.info FILE
    -   *.list FILES CONTAIN THE SHUFFLED LOCATIONS OF READS IN THE FIXED-WIDTH FASTQ FILE


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth \
--size 100000000 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M/printListFiles.out
    
    Run time: 00:02:24
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    2:47PM, 21 September 2010
    ****************************************

    global_total: 4033317542
    directory       total reads
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth        3251795429
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth        74729052
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth        129727086
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth        103925078
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth        281008471
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth        192132426
    
    directory       fraction
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth        0.80623342\
    8223341
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth        0.01852793\
    66729316
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth        0.03216386\
    62587603
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth        0.02576664\
    91462179
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth        0.06967179\
    45150077
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth        0.04763632\
    51837413


3. RUN printSubfiles.pl TO PRINT FASTQ SUBFILES BASED ON LOCATIONS IN *.list FILES


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M

screen -S subfiles

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M/printSubfiles.out
    
    Run time: 04:02:18
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    8:29PM, 22 September 2010
    ****************************************



4. GENERATE READ SAMPLES USING mergeFiles.pl


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth \
--label yoruba1 \
--outputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M \
--mode fastq \
--indices 1-40 \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M/mergeFiles.out

    Run time: 01:19:33
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    11:10PM, 22 September 2010
    ****************************************



BUT SOME MERGES FAILED:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M
ll *fastq
    
    ...
    -rw-rw-rw- 1 syoung root 8.2G Sep 22 22:34 yoruba1-5.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.1G Sep 22 22:26 yoruba1-5.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep 22 22:34 yoruba1-6.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.0G Sep 22 22:34 yoruba1-6.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.1G Sep 22 22:34 yoruba1-7.reads_1.fastq
    -rw-rw-rw- 1 syoung root 7.9G Sep 22 22:34 yoruba1-7.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.1G Sep 22 22:47 yoruba1-8.reads_1.fastq
    -rw-rw-rw- 1 syoung root 7.9G Sep 22 22:47 yoruba1-8.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.1G Sep 22 22:47 yoruba1-9.reads_1.fastq
    -rw-rw-rw- 1 syoung root 7.9G Sep 22 22:46 yoruba1-9.reads_2.fastq


CHECK STDOUT FILES FOR 'No such file' ERROR MESSAGES:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M

grep -n "No such" mergeFiles-*-stdout.txt
mergeFiles-11-yoruba1-6.reads_2-stdout.txt:43:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573/SRR005735_2.fastq.6-40.reads-fastq: No such file or directory
mergeFiles-12-yoruba1-7.reads_2-stdout.txt:43:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_2.fastq.7-40.reads-fastq: No such file or directory
mergeFiles-12-yoruba1-7.reads_2-stdout.txt:44:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573/SRR005735_2.fastq.7-40.reads-fastq: No such file or directory
mergeFiles-13-yoruba1-7.reads_1-stdout.txt:43:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_1.fastq.7-40.reads-fastq: No such file or directory
mergeFiles-14-yoruba1-8.reads_2-stdout.txt:43:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_2.fastq.8-40.reads-fastq: No such file or directory
mergeFiles-14-yoruba1-8.reads_2-stdout.txt:44:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573/SRR005735_2.fastq.8-40.reads-fastq: No such file or directory
mergeFiles-15-yoruba1-8.reads_1-stdout.txt:43:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_1.fastq.8-40.reads-fastq: No such file or directory
mergeFiles-16-yoruba1-9.reads_2-stdout.txt:43:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_2.fastq.9-40.reads-fastq: No such file or directory
mergeFiles-16-yoruba1-9.reads_2-stdout.txt:44:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573/SRR005735_2.fastq.9-40.reads-fastq: No such file or directory
mergeFiles-17-yoruba1-9.reads_1-stdout.txt:43:cat: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_1.fastq.9-40.reads-fastq: No such file or directory




MISSING FILES ARE FROM THESE THREE INPUT FILES:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573/SRR005735_2.fastq.6-40.reads-fastq
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_1.fastq.7-40.reads-fastq
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_2.fastq.8-40.reads-fastq


CHECK 5th READS-FASTA IN SRX001540/fixedwidth FOR FILE SRR005735_2.fastq
------------------------------------------------------------------------

FILENAME

    SRR00573/SRR005735_2.fastq.5-40.reads-fastq

THE 5th READS-FASTA SUBFILE OF THE 2nd MATE IS SMALLER THAN THE OTHER SUBFILES:

ll /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573

-rw-rw-rw- 1 syoung root 138M Sep 22 20:29 SRR005735_2.fastq.4-40.reads-fastq
-rw-rw-rw- 1 syoung root 536K Sep 22 20:29 SRR005735_2.fastq.5-40.reads-fastq

THE PROBLEM IS A FAILURE IN printSubfiles.pl RATHER THAN AN ERROR IN THE *.list FILE BECAUSE THE 1st MATE IS FINE:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573
ll SRR005735_*.fastq.5-40.reads-fastq

    -rw-rw-rw- 1 syoung root 138M Sep 22 17:33 SRR005735_1.fastq.5-40.reads-fastq
    -rw-rw-rw- 1 syoung root 536K Sep 22 20:29 SRR005735_2.fastq.5-40.reads-fastq


AND THE LIST FILES ARE ALL PRESENT:


ll *.list

    -rw-rw-rw- 1 syoung root 8.5M Sep 21 14:47 SRR005735_1.fastq.4.list
    -rw-rw-rw- 1 syoung root 8.5M Sep 21 14:47 SRR005735_1.fastq.5.list
    -rw-rw-rw- 1 syoung root 8.5M Sep 21 14:47 SRR005735_1.fastq.6.list
    -rw-rw-rw- 1 syoung root 8.5M Sep 21 14:47 SRR005735_1.fastq.7.list
    -rw-rw-rw- 1 syoung root 8.5M Sep 21 14:47 SRR005735_1.fastq.8.list
    -rw-rw-rw- 1 syoung root 8.5M Sep 21 14:47 SRR005735_1.fastq.9.list



THE 2nd MATE IS CLEARLY TRUNCATED:

tail -n 4 SRR005735_*.fastq.5-40.reads-fastq
==> SRR005735_1.fastq.5-40.reads-fastq <==
    @SRR005735.32688100 FC301L3AAXX:7:93:569:1060               
    CGAGATCTCACCACTGTACTCCAGCC
    +SRR005735.32688100 FC301L3AAXX:7:93:569:1060               
    IIIIIIIIIIIIIIIIIIIIII>*II

==> SRR005735_2.fastq.5-40.reads-fastq <==
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005735.124728 FC301L3AAXX:1:3:1596:1921                 
    AAATTCTATTTTAAGGTCAATTTCCT



AND THE OTHER SUBFILES ARE MISSING:


ll SRR005735_2.fastq.4-40.reads-fastq
	-rw-rw-rw- 1 syoung root 138M Sep 22 20:29 SRR005735_2.fastq.4-40.reads-fastq
ll SRR005735_2.fastq.5-40.reads-fastq
	-rw-rw-rw- 1 syoung root 536K Sep 22 20:29 SRR005735_2.fastq.5-40.reads-fastq
ll SRR005735_2.fastq.6-40.reads-fastq
	ls: SRR005735_2.fastq.6-40.reads-fastq: No such file or directory
ll SRR005735_2.fastq.7-40.reads-fastq
	ls: SRR005735_2.fastq.7-40.reads-fastq: No such file or directory
ll SRR005735_2.fastq.8-40.reads-fastq
	ls: SRR005735_2.fastq.8-40.reads-fastq: No such file or directory
ll SRR005735_2.fastq.9-40.reads-fastq
	ls: SRR005735_2.fastq.9-40.reads-fastq: No such file or directory
ll SRR005735_2.fastq.10-40.reads-fastq
	-rw-rw-rw- 1 syoung root 138M Sep 22 17:02 SRR005735_2.fastq.10-40.reads-fastq


SO THE MERGE JOB FAILED AFTER NOT FINDING THE 6th SUBFILE




CHECK SUBFILES FOR SRX001539 FILES SRR005718_1.fastq AND SRR005718_2.fastq
--------------------------------------------------------------------------

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_1.fastq.7-40.reads-fastq
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571/SRR005718_2.fastq.8-40.reads-fastq

CHECK FOR SUBFILE

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571
ll SRR005718_1.fastq.*-40.reads-fastq

-rw-rw-rw- 1 syoung root 134M Sep 22 20:25 SRR005718_1.fastq.4-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 22 20:27 SRR005718_1.fastq.5-40.reads-fastq
-rw-rw-rw- 1 syoung root  98M Sep 22 20:29 SRR005718_1.fastq.6-40.reads-fastq

SAME AS ABOVE, THE PROBLEM IS A FAILURE IN printSubfiles.pl RATHER THAN AN ERROR IN THE *.list FILE:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571
ll *.list
    
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.3.list
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.40.list
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.4.list
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.5.list
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.6.list
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.7.list
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.8.list
    -rw-rw-rw- 1 syoung root 8.3M Sep 21 14:47 SRR005718_1.fastq.9.list





SOLUTION
--------

RERAN FILE GENERATION FROM EARLIER STAGES

PRINT SUBFILES:

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR005718_1.fastq \
--mode fastq \
--width 176 \
--dot 1000000

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR005718_2.fastq \
--mode fastq \
--width 176 \
--dot 1000000


CREATE FIXED WIDTH FASTQ:

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastq.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/SRR005735_2.fastq.gz \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR005735_2.fastq \
--id 60  \
--length 26  \
--dot 1000000

    Run time: 00:04:24
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastq.pl
    1:21PM, 23 September 2010
    ****************************************

OUTPUT OKAY:

ls -al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR005735_*.fastq
-rw-rw-rw- 1 syoung root 5801036208 Sep 21 14:41 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR005735_1.fastq
-rw-rw-rw- 1 syoung root 5801036208 Sep 23 13:21 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR005735_2.fastq



/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR005735_2.fastq \
--mode fastq \
--width 176 \
--dot 1000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/printsubfile-SRR005735_2.out



CHECKED SUBFILES ARE OKAY (yes):

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573
ll *5735*

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR00571
ll *5718*


[syoung@u04 SRR00571]$ ll *5718_1*fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:00 SRR005718_1.fastq.10-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:10 SRR005718_1.fastq.11-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:19 SRR005718_1.fastq.12-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:29 SRR005718_1.fastq.13-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:33 SRR005718_1.fastq.1-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:44 SRR005718_1.fastq.14-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:03 SRR005718_1.fastq.15-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:10 SRR005718_1.fastq.16-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:16 SRR005718_1.fastq.17-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:22 SRR005718_1.fastq.18-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:29 SRR005718_1.fastq.19-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:37 SRR005718_1.fastq.20-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:41 SRR005718_1.fastq.21-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:43 SRR005718_1.fastq.22-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:44 SRR005718_1.fastq.23-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:58 SRR005718_1.fastq.2-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:46 SRR005718_1.fastq.24-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:48 SRR005718_1.fastq.25-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:50 SRR005718_1.fastq.26-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:52 SRR005718_1.fastq.27-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:54 SRR005718_1.fastq.28-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 15:56 SRR005718_1.fastq.29-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:01 SRR005718_1.fastq.30-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:03 SRR005718_1.fastq.31-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:04 SRR005718_1.fastq.32-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:06 SRR005718_1.fastq.33-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:18 SRR005718_1.fastq.3-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:08 SRR005718_1.fastq.34-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:10 SRR005718_1.fastq.35-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:11 SRR005718_1.fastq.36-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:13 SRR005718_1.fastq.37-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:15 SRR005718_1.fastq.38-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:17 SRR005718_1.fastq.39-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:20 SRR005718_1.fastq.40-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:22 SRR005718_1.fastq.4-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:23 SRR005718_1.fastq.5-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:24 SRR005718_1.fastq.6-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:24 SRR005718_1.fastq.7-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:24 SRR005718_1.fastq.8-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 16:24 SRR005718_1.fastq.9-40.reads-fastq
[syoung@u04 SRR00571]$ ll *5718_2*fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:01 SRR005718_2.fastq.10-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:03 SRR005718_2.fastq.11-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:05 SRR005718_2.fastq.12-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:05 SRR005718_2.fastq.13-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.1-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:06 SRR005718_2.fastq.14-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:06 SRR005718_2.fastq.15-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:06 SRR005718_2.fastq.16-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:06 SRR005718_2.fastq.17-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.18-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.19-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.20-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.21-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.22-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.23-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:08 SRR005718_2.fastq.2-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:07 SRR005718_2.fastq.24-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:08 SRR005718_2.fastq.25-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:08 SRR005718_2.fastq.26-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:08 SRR005718_2.fastq.27-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:08 SRR005718_2.fastq.28-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:08 SRR005718_2.fastq.29-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:09 SRR005718_2.fastq.30-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:09 SRR005718_2.fastq.31-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:09 SRR005718_2.fastq.32-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:09 SRR005718_2.fastq.33-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:23 SRR005718_2.fastq.3-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:09 SRR005718_2.fastq.34-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:09 SRR005718_2.fastq.35-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:10 SRR005718_2.fastq.36-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:10 SRR005718_2.fastq.37-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:10 SRR005718_2.fastq.38-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:10 SRR005718_2.fastq.39-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:29 SRR005718_2.fastq.40-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:38 SRR005718_2.fastq.4-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 13:46 SRR005718_2.fastq.5-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:02 SRR005718_2.fastq.6-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:12 SRR005718_2.fastq.7-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:21 SRR005718_2.fastq.8-40.reads-fastq
-rw-rw-rw- 1 syoung root 134M Sep 23 14:33 SRR005718_2.fastq.9-40.reads-fastq


... AND RERAN MERGE:

screen -S merge

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth \
--label yoruba1 \
--outputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M \
--mode fastq \
--indices 1-40 \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M/mergeFiles.out
    
    Run time: 00:57:32
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    6:03PM, 23 September 2010
    ****************************************



BUT PROBLEMS WITH THE FASTQ QUALITY HEADER


tail yoruba1-9.reads_*.fastq

    ==> yoruba1-9.reads_1.fastq <==
    +SRR005735.32688038 FC301L3AAXX:7:93:829:276                
    IIIIIIIIIIII9I)I*I<).*&$6+
    @SRR005735.32688078 FC301L3AAXX:7:93:1758:1533              
    TATATATATATATGTATAAAAAACAT
    +SRR005735.32688078 FC301L3AAXX:7:93:1758:1533              
    IIIIIIIIIIIIIIIIIIIIIII7II
    @SRR005735.32688101 FC301L3AAXX:7:93:1153:151               
    CCGACCTCAATTCCACCGGCTCCAGT
    +SRR005735.32688101 FC301L3AAXX:7:93:1153:151               
    IIIIIIIIIIIIIIIIII9IIII(+@
    
    ==> yoruba1-9.reads_2.fastq <==
    +                                                           
    IIIIIIIIIIIIIGI(I.HI%0I;5I
    @SRR005735.32688078 FC301L3AAXX:7:93:1758:1533              
    AAAACAAAATCACAATAGTAACTTAT
    +                                                           
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005735.32688101 FC301L3AAXX:7:93:1153:151               
    TGCTATTTAAAAATATCCTGAATGTG
    +                                                           
    IIIIIIIIIIIIIIIIIIIII*IIII



DIAGNOSIS:

SRA HAVE SWITCHED READ FORMAT AND NOW DON'T PRINT QUALITY HEADER (PRESUMABLY BECAUSE IT'S THE SAME AS THE SEQUENCE HEADER SO REDUNDANT, ALTHOUGH NECESSARY FOR SOME ALIGNERS...)


SOLUTION:

ADD QUALITY HEADERS TO FASTQ FILE

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fastqQualityHeader.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/SRR005735_2.noQualityHeader.fastq.gz \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/SRR005735_2.fastq

    Run time: 00:02:29
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fastqQualityHeader.pl
    10:36PM, 23 September 2010
    ****************************************


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastq.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/SRR005735_2.fastq.gz \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR005735_2.fastq \
--id 60  \
--length 26  \
--dot 1000000

    Run time: 00:04:09
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastq.pl
    11:04PM, 23 September 2010
    ****************************************


OUTPUT OKAY:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/
ls -al SRR005735_*.fastq

    -rw-rw-rw- 1 syoung root 5801036208 Sep 21 14:41 SRR005735_1.fastq
    -rw-rw-rw- 1 syoung root 5801036208 Sep 23 23:04 SRR005735_2.fastq


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR005735_2.fastq \
--mode fastq \
--width 176 \
--dot 1000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/printsubfile-SRR005735_2.out

    Run time: 00:09:23
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    11:23PM, 23 September 2010
    ****************************************

    #Run time: 02:57:33
    #Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    #4:23PM, 23 September 2010
    #****************************************


CHECKED SUBFILES ARE OKAY (yes):

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth/SRR00573
ll *5735*

    OK!
    
    
    
DO MERGE:

screen -S merge

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth \
--label yoruba1 \
--outputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M \
--mode fastq \
--indices 1-40 \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/100M/mergeFiles.out











NOTES
-----

RE-DOWNLOADED FILES:

mkdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540
cd  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540

wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001540/SRR005735_2.fastq.bz2

mkdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539
cd  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539

wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001539/SRR005718_1.fastq.bz2
wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001539/SRR005718_2.fastq.bz2



SRX001539, SRR005718_1.fastq
SRX001539, SRR005718_2.fastq
----------------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth

cat  fixedWidthFastqs-503-SRR005718_1.sh

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastq.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/SRR005718_1.fastq.gz \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001539/fixedwidth/SRR005718_1.fastq \
--id 60  \
--length 26  \
--dot 1000000



bsub -q large fixedWidthFastqs-503-SRR005718_1.sh
pwd    Job <1895948> is submitted to queue <large>.

bsub -q large fixedWidthFastqs-503-SRR005718_2.sh
    Job <1895949> is submitted to queue <large>.

bjobs
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1895945   syoung  RUN   small      u04         n0094       *001539[1] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[2] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[3] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[4] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[5] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[6] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[7] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0094       *001539[8] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0184       *001539[9] Sep 23 10:23
    1895945   syoung  RUN   small      u04         n0184       *01539[10] Sep 23 10:23
    1895948   syoung  PEND  large      u04                     *5718_1.sh Sep 23 11:35
    1895949   syoung  PEND  large      u04                     *5718_2.sh Sep 23 11:35




SRX001540, SRR005735_2.fastq
----------------------------

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/sampled/SRX001540/fixedwidth


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/printSubfiles.nocompress.out


bsub -q large fixedWidthFastqs-510-SRR005735_2.sh
    Job <1895950> is submitted to queue <large>.







</entry>



<entry [Fri Sep 17 16:37:54 EDT 2010] RAN WHOLE GENOME WORKFLOW ON SMALLEST DIRECTORY OF NA185O7 SAMPLES: SRX001539>


(2000 BP INSERT PAIRED END EXPERIMENT OF 4 RUNS)


0. MAKE DIRECTORY AND COPY FILES

DATA SOURCE

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539
ll *fastq.gz
-rw-rw-rw- 1 syoung root 1.1G Aug 11 22:50 SRR005718_1.fastq.gz
-rw-rw-rw- 1 syoung root 1.3G Aug 11 23:06 SRR005718_2.fastq.gz
-rw-rw-rw- 1 syoung root 819M Aug 11 23:17 SRR005719_1.fastq.gz
-rw-rw-rw- 1 syoung root 842M Aug 11 23:29 SRR005719_2.fastq.gz


mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/*fastq.gz /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539



1. RUN fixedWidthFasta.pl TO CREATE FIXED-LENGTH FASTA, QUAL AND info FILES

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth

screen -S fixed

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl \
--inputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--queue large \
--id 60 \
--length 26 \
--dot 10000000 \
--zipped gzip \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth/fixedWidthFastqs.nocompress.out
    
    Run time: 00:10:53
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    3:18PM, 20 September 2010
    ****************************************
    


2. RUN printListFiles.pl TO GENERATE RANDOMIZED LISTS OF READ BYTE POSITIONS IN FASTA FILES

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M

screen -S printlist

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth \
--size 10000000 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/printListFiles.out

    Run time: 00:01:17
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    5:16PM, 20 September 2010
    ****************************************    

ll /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth/SRR00571

    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.10.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.1.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.2.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.3.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.4.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.5.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.6.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.7.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.8.list
    -rw-rw-rw- 1 syoung root 32M Sep 20 17:16 SRR005718_1.fastq.9.list

    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.10.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.1.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.2.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.3.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.4.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.5.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.6.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.7.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.8.list
    -rw-rw-rw- 1 syoung root 20M Sep 20 17:15 SRR005719_1.fastq.9.list



3. RUN printSubfiles.pl TO PRINT FASTQ SUBFILES BASED ON LOCATIONS IN *.list FILES

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/printSubfiles.nocompress.out
    
    
    Run time: 00:53:14
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl
    6:11PM, 20 September 2010
    ****************************************



4. GENERATE READ SAMPLES USING mergeFiles.pl

screen -S merge

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/fixedwidth \
--label srx001539 \
--outputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M \
--mode fastq \
--paired \
--indices 1-10 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M/mergeFiles.out

    Run time: 00:02:50
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    11:56PM, 20 September 2010
    ****************************************


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX001539/10M
ll *fastq

    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-10.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-10.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-1.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-1.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-2.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-2.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-3.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-3.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-4.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-4.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-5.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-5.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:54 srx001539-6.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-6.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-7.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-7.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-8.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-8.reads_2.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:56 srx001539-9.reads_1.fastq
    -rw-rw-rw- 1 syoung root 879999824 Sep 20 23:55 srx001539-9.reads_2.fastq


head srx001539-10.reads_1.fastq

    @SRR005718.10 FC20CMYAAXX:1:1:491:125                       
    GTAGTTTTTTAGTGGATTTCTTATTA
    +SRR005718.10 FC20CMYAAXX:1:1:491:125                       
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005718.16 FC20CMYAAXX:1:1:564:487                       
    GCACAAATCAATACATGCTGTCTTAG
    +SRR005718.16 FC20CMYAAXX:1:1:564:487                       
    IIIIIIIIIIIIIIIIIIIIIIIIFI
    @SRR005718.26 FC20CMYAAXX:1:1:353:115                       
    GAAAAGGTAAAAGCAAAATGTAATTC

lines srx001539-10.reads_1.fastq

    srx001539-10.reads_1.fastq: 19999996

    OK!

    

</entry>



<entry [Fri Sep 17 16:37:54 EDT 2010] TESTED ELAND PAIR WITH 1,000,000 READS FROM SRR002271>




FRACTION HITS (AGAINST ONE CHROMOSOME) = 0.17653


cd /nethome/syoung/base/pipeline/SRA/NA18507/eland/SRR002271
ll
    
    -rw-rw-r-- 1 syoung bioinfo  45M Sep  5 23:26 reanalysis_1_calsaf.txt
    -rw-rw-r-- 1 syoung bioinfo  79M Sep  5 23:20 reanalysis_1_eland_extended.txt
    -rw-rw-r-- 1 syoung bioinfo  66M Sep  5 23:17 reanalysis_1_eland_query.txt
    -rw-rw-r-- 1 syoung bioinfo 103M Sep  5 23:28 reanalysis_1_export.txt
    -rw-rw-r-- 1 syoung bioinfo  89M Sep  5 23:16 reanalysis_1_qseq.txt
    -rw-rw-r-- 1 syoung bioinfo  45M Sep  5 23:27 reanalysis_2_calsaf.txt
    -rw-rw-r-- 1 syoung bioinfo  79M Sep  5 23:23 reanalysis_2_eland_extended.txt
    -rw-rw-r-- 1 syoung bioinfo  66M Sep  5 23:21 reanalysis_2_eland_query.txt
    -rw-rw-r-- 1 syoung bioinfo 103M Sep  5 23:29 reanalysis_2_export.txt
    -rw-rw-r-- 1 syoung bioinfo  89M Sep  5 23:20 reanalysis_2_qseq.txt
    -rw-rw-r-- 1 syoung bioinfo 162M Sep  5 23:27 reanalysis_anomaly.txt
    -rw-rw-r-- 1 syoung bioinfo   63 Sep  5 23:23 reanalysis_genomesize.xml
    -rw-rw-r-- 1 syoung bioinfo 2.9K Sep  5 23:27 reanalysis_pair.xml
    -rw-rw-r-- 1 syoung bioinfo    0 Jun 13 20:36 reanalysis_qseq.txt

lines *1_export.txt
    reanalysis_1_export.txt: 1000000
lines *2_export.txt
    reanalysis_2_export.txt: 1000000

screen -S srr002271

cut -f 11 < *1_export.txt | grep -c NM
cut -f 11 < *1_export.txt | grep -c QC
cut -f 11 < *2_export.txt | grep -c NM
cut -f 11 < *2_export.txt | grep -c QC


822408
bash-3.2$ cut -f 11 < *1_export.txt | grep -c QC
1062
bash-3.2$ cut -f 11 < *2_export.txt | grep -c NM


% HITS = (1000000 - 822408 - 1062)/1000000 = 176530/1000000 = 0.17653





</entry>



<entry [Thu Sep 16 12:43:12 EDT 2010] NA18507 RERUN ONE SAMPLE FROM EACH EXPERIMENT>




1. AS EXPECTED, THE SINGLE RUNS SHOW COMPLETE AGREEMENT WITH THE PAIRED END RUNS:

READ 1 % HITS = 0.93830273325878

READ 2 % HITS = 0.944440512283746


2. UNEXPECTEDLY, THE QUALITY VALUES START LOW ~8 AND GET LOWER ~ 0.5 AT THE END 





mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/eland/SRX000600
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR029338_1.fastq.gz ../../rerun/eland/SRX000600
cp /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR029338_2.fastq.gz ../../rerun/eland/SRX000600

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600
gunzip SRR029338_1.fastq.gz
gunzip SRR029338_2.fastq.gz

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600
ll
    -rw-rw-r-- 1 syoung root 674M Sep 16 07:41 SRR029338_1.fastq
    -rw-rw-r-- 1 syoung root 674M Sep 16 07:38 SRR029338_2.fastq


head *

    ==> SRR029338_1.fastq <==
    @SRR029338.1 080115_EAS112_0034:8:1:615:780 length=36
    GGTTGAGTAAAGTGTCTAAAGGCATAGCCTGATTAT
    +SRR029338.1 080115_EAS112_0034:8:1:615:780 length=36
    IIIIIIIIIIIIIIIIIIIAIIA<I8I+7I9+II2I
    @SRR029338.2 080115_EAS112_0034:8:1:799:785 length=36
    GATTTTGAGAGCCAAGTTGTGGTTATATTGTATATT
    +SRR029338.2 080115_EAS112_0034:8:1:799:785 length=36
    IIIIIIIIIIIIII@IIIIIIIII,>):&+&+$%.H
    @SRR029338.3 080115_EAS112_0034:8:1:611:788 length=36
    GAAATAAGATTAGAGAATAAGATCAGTCTTTTTTTC
    
    ==> SRR029338_2.fastq <==
    @SRR029338.1 080115_EAS112_0034:8:1:615:780 length=36
    AAAGTCAAATTTGAATTGTTGTCAGCTTGTCAAAAT
    +SRR029338.1 080115_EAS112_0034:8:1:615:780 length=36
    IIIIIIIIDIIIIIIIIIIIII.1F2II=8*2+//I
    @SRR029338.2 080115_EAS112_0034:8:1:799:785 length=36
    TCTGATAAAATGCTAACTTAGAAATAATCACAAAGT
    +SRR029338.2 080115_EAS112_0034:8:1:799:785 length=36
    IIIIIIIII@IIIII8?II1I9C<II8I7;/,,1I>
    @SRR029338.3 080115_EAS112_0034:8:1:611:788 length=36
    CATATCTTCAGTGGATCTGTCTTTATTGCATTGATG




CREATE SIMPLE HEADER WITH CORRECT MATE NUMBERS

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_1.fastq \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_1.simpleHeader.txt \
--rejectfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_1.simpleHeader.rejects.txt \
--barcode 0 \
--matenumber 1
        
    Run time: 00:00:47
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl
    1:58PM, 16 September 2010
    ****************************************

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_2.fastq \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_2.simpleHeader.txt \
--rejectfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_2.simpleHeader.rejects.txt \
--barcode 0 \
--matenumber 2




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600
ll SRR029338_*.simpleHeader.txt

    -rw-rw-rw- 1 syoung root 502M Sep 16 13:58 SRR029338_2.simpleHeader.txt
    -rw-rw-rw- 1 syoung root 502M Sep 16 13:58 SRR029338_1.simpleHeader.txt



DO ELAND ALIGNMENT






READ 1
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1
cp ../SRR029338_1.simpleHeader.txt ./

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1/SRR029338_1.ELAND.sh

emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1/SRR029338_1.ELAND.sh
#!/bin/sh                                                                                                                                                                 

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1/SRR029338_1.simpleHeader.txt


RUN JOB

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1/SRR029338_1.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1/SRR029338_1.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1/SRR029338_1.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1/SRR029338_1.ELAND.sh 
    
    Job <1861695> is submitted to queue <large>.
    [syoung@u04 read_1]$ date;bjobs
    Thu Sep 16 15:27:51 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1861695   syoung  RUN   large      u04         n0185       *.ELAND.sh Sep 16 15:27



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_1
lines reanalysis_export.txt
cut -f 11 < reanalysis_export.txt | grep -c NM
cut -f 11 < reanalysis_export.txt | grep -c QC


lines reanalysis_export.txt
    reanalysis_export.txt: 3602769
cut -f 11 < reanalysis_export.txt | grep -c NM
    222281
cut -f 11 < reanalysis_export.txt | grep -c QC
    0


% HITS = (3602769 - 222281)/3602769 = 3380488/3602769 = 0.93830273325878



READ 2
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2
cp ../SRR029338_2.simpleHeader.txt ./


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2/SRR029338_2.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2/SRR029338_2.ELAND.sh
#!/bin/sh                                                                                                                                                                 

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2/SRR029338_2.simpleHeader.txt


RUN JOB

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2/SRR029338_2.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2/SRR029338_2.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2/SRR029338_2.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2/SRR029338_2.ELAND.sh ; date; bjobs
    
    
    Job <1861698> is submitted to queue <large>.
    Thu Sep 16 15:31:38 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1861697   syoung  RUN   large      u04         n0187       *.ELAND.sh Sep 16 15:30
    1861695   syoung  RUN   large      u04         n0185       *.ELAND.sh Sep 16 15:27
    1861698   syoung  RUN   large      u04         n0185       *.ELAND.sh Sep 16 15:31




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/read_2
lines reanalysis_export.txt
cut -f 11 < reanalysis_export.txt | grep -c NM
cut -f 11 < reanalysis_export.txt | grep -c QC


reanalysis_export.txt: 3602769
[syoung@u04 read_2]$ cut -f 11 < reanalysis_export.txt | grep -c NM
    200168
[syoung@u04 read_2]$ cut -f 11 < reanalysis_export.txt | grep -c QC
    0


% HITS = (3602769 - 200168)/3602769 = 3402601/3602769 = 0.944440512283746



PAIRED
------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired
cp ../SRR029338_1.simpleHeader.txt ./

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired
cp ../SRR029338_2.simpleHeader.txt ./


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1+2.ELAND.sh
emacs /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1+2.ELAND.sh
#!/bin/sh

#BSUB -W 24:00
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1.simpleHeader.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_2.simpleHeader.txt



RUN JOB

chmod 755 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1+2.ELAND.sh

bsub -e /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1+2.ELAND.err -o /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1+2.ELAND.out -q large /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1+2.ELAND.sh ; date; bjobs


Job <1862922> is submitted to queue <large>.
Fri Sep 17 16:06:49 EDT 2010



RESULTS IN THIS FOLDER:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired-ok
ll
    
    -rw-rw-r-- 1 syoung root 498M Sep 17 16:11 reanalysis_1_export.txt
    -rw-rw-r-- 1 syoung root 497M Sep 17 16:11 reanalysis_2_export.txt
    -rw-rw-r-- 1 syoung root 615K Sep 17 16:11 SRR029338_1+2.ELAND.err
    -rw-rw-r-- 1 syoung root 3.2K Sep 17 16:11 SRR029338_1+2.ELAND.out
    -rw-rw-r-- 1 syoung root 502M Sep 17 16:13 SRR029338_1.simpleHeader.txt
    -rw-rw-r-- 1 syoung root 502M Sep 17 16:13 SRR029338_2.simpleHeader.txt
    
lines SRR029338_1.simpleHeader.txt

    SRR029338_1.simpleHeader.txt: 14411076      = 3602769 RECORDS

lines SRR029338_2.simpleHeader.txt

    SRR029338_2.simpleHeader.txt: 14411076




cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired-ok
cut -f 11 < reanalysis_1_export.txt | grep -c NM
cut -f 11 < reanalysis_1_export.txt | grep -c QC

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired-ok
cut -f 11 < reanalysis_2_export.txt | grep -c NM
cut -f 11 < reanalysis_2_export.txt | grep -c QC



cut -f 11 < reanalysis_1_export.txt | grep -c QC
    222281
cut -f 11 < reanalysis_1_export.txt | grep -c QC
    0

% HITS = (3602769 - 222281)/3602769 = 3380488/3602769 = 0.93830273325878



cut -f 11 < reanalysis_2_export.txt | grep -c QC
    200168
cut -f 11 < reanalysis_2_export.txt | grep -c QC
    0


% HITS = (3602769 - 200168)/3602769 = 3402601/3602769 = 0.944440512283746

DO AVERAGE QUALITY:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_1.simpleHeader.txt \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_1.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa

    total reads     3602769
    0       8.87066781134178
    1       8.85734000708899
    2       8.86709056284208
    3       8.79031739198378
    4       8.61546271770408
    5       8.47995999743531
    6       8.26109001159941
    7       8.31155508443644
    8       7.89697535423448
    9       7.8615614822932
    10      7.77815702311195
    11      7.66682210266603
    12      7.01728503825807
    13      6.51833992132163
    14      5.88285510394921
    15      5.83077682749019
    16      5.27582423408217
    17      4.54585986500939
    18      4.0403947630281
    19      3.61495421993472
    20      3.55254444567498
    21      3.19869883414674
    22      2.77717500067309
    23      2.6902443648205
    24      2.27952083522424
    25      2.16368187913241
    26      1.88995797399167
    27      1.77791137872009
    28      1.68198849273989
    29      1.48423365472502
    30      1.21288597742459
    31      1.14899567527088
    32      0.951459835476546
    33      0.937082838228041
    34      0.779585091356121
    35      0.988856904231162
    averageQuality.pl::average_qualities    outputfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_1.avqual
    
    averageQuality.pl::average_qualities    basequalfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_1.basequal



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_2.simpleHeader.txt \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_2.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa


    total reads     3602769
    0       7.97028313499977
    1       7.88916302988063
    2       7.91565737353685
    3       7.47151649189832
    4       7.41717245818425
    5       7.21240745659797
    6       6.73892997302908
    7       6.37773307142367
    8       6.37144651794217
    9       5.69984253778136
    10      5.45888065540699
    11      5.27660196920757
    12      4.76550869622782
    13      4.29102115622733
    14      4.07434115259679
    15      3.78663827739164
    16      3.30372194276125
    17      2.87086571467668
    18      2.67970968996347
    19      2.45346038005767
    20      2.10140200495785
    21      1.90323942500893
    22      1.7147499603777
    23      1.46794451712003
    24      1.23848517626304
    25      1.0484691080666
    26      0.899142576168497
    27      0.808965548443433
    28      0.685165215976933
    29      0.626116745203481
    30      0.511676990670232
    31      0.485682540290538
    32      0.446454379950532
    33      0.370215797904334
    34      0.307080748168978
    35      0.439327916943884
    averageQuality.pl::average_qualities    outputfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_2.avqual
    
    averageQuality.pl::average_qualities    basequalfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/SRR029338_2.basequal





NOTES
-----


PROBLEM


RUN STOPS WITH THIS MESSAGE FROM ELAND STANDALONE

    User defined signal 2

AND THIS IN THE LSF OUTPUT

    TERM_RUNLIMIT: job killed after reaching LSF run time limit.
    Exited with exit code 140.




DIAGNOSIS

SUBMITTED WITHOUT WALLTIME AND TIMED OUT


SOLUTION

USE #BSUB -W 24:00 IN SHELL SCRIPT


    Job <1861697> is submitted to queue <large>.
    Thu Sep 16 15:30:25 EDT 2010
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1861695   syoung  RUN   large      u04         n0185       *.ELAND.sh Sep 16 15:27
    1861696   syoung  RUN   large      u04         n0185       *.ELAND.sh Sep 16 15:28
    1861697   syoung  PEND  large      u04                     *.ELAND.sh Sep 16 15:30
    [syoung@u04 paired]$ 


OUTPUT FILE:

tail /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/rerun/eland/SRX000600/paired/SRR029338_1+2.ELAND.out

    Your job looked like:
    
    ------------------------------------------------------------
    # LSBATCH: User input
    /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh
    ------------------------------------------------------------
    
    Exited with exit code 126.
    
    Resource usage summary:
    
        CPU time   :      0.01 sec.
        Max Memory :         2 MB
        Max Swap   :        23 MB
    
        Max Processes  :         1
        Max Threads    :         1
    
    The output (if any) follows:


    PS:
    
    Read file </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.err> for stderr output of this \
    job.
    
    Sender: LSF System <lsfadmin@n0093.pegasus.edu>
    Subject: Job 1861419: </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh> Exited
    
    Job </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh> was submitted from host <u01> by \
    user <syoung> in cluster <lsfcluster>.
    Job was executed on host(s) <n0093.pegasus.edu>, in queue <large>, as user <syoung> in cluster <lsfcluster>.
    </nethome/syoung> was used as the home directory.
    </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired> was used as the working directory.
    Started at Thu Sep 16 00:32:57 2010        
    Results reported at Thu Sep 16 04:33:13 2010
    Your job looked like:
    
    ------------------------------------------------------------
    # LSBATCH: User input
    /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh
    ------------------------------------------------------------
    
    TERM_RUNLIMIT: job killed after reaching LSF run time limit.
    Exited with exit code 140.
    
    Resource usage summary:
    
        CPU time   :  14235.00 sec.
        Max Memory :      1477 MB
        Max Swap   :      1705 MB
    
        Max Processes  :         6
        Max Threads    :         7
    
    The output (if any) follows:    
    
    
    PS:
    
    Read file </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.err> for stderr output of this \
    job.
    
    Sender: LSF System <lsfadmin@n0093.pegasus.edu>
    Subject: Job 1861419: </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh> Exited
    
    Job </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh> was submitted from host <u01> by \
    user <syoung> in cluster <lsfcluster>.
    Job was executed on host(s) <n0093.pegasus.edu>, in queue <large>, as user <syoung> in cluster <lsfcluster>.
    </nethome/syoung> was used as the home directory.
    </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired> was used as the working directory.
    Started at Thu Sep 16 00:32:57 2010


OUTPUT ERROR

    ...
    finished making FileReader
    No contig index found for /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland//chrY.fa
    FileReader: unmapping 14443240 bytes of memory
    FileReader: unmapping 126 bytes of memory
    alignment done for the moment User: 0.862869s System: 0s Actual: 0.862918s Efficiency: 99.9943%
    ... done User: 352.365s System: 15.9896s Actual: 381.335s Efficiency: 96.5962%
    Run complete! Time now: Thu Sep 16 04:14:25 2010
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: eland succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/squashGenome /nethome/bioinfo\
    /data/sequence/chromosomes/human/hg19/eland > ./reanalysis_genomesize.xml
    
    User: 0s System: 0s Actual: 2e-06s Efficiency: 0%
    Trying to open directory /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland ...
     ... success, will output file sizes to XML
    User: 0s System: 0.003999s Actual: 0.003858s Efficiency: 103.655%
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: squashGenome succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl --circular 32\
     32 ./reanalysis_1_eland_extended.txt  ./reanalysis_2_eland_extended.txt ./reanalysis_1_qseq.txt ./reanalysis_2_qseq.txt ./reanalysis_1_calsaf.txt ./reanaly\
    sis_2_calsaf.txt ./reanalysis_anomaly.txt ./reanalysis_genomesize.xml > ./reanalysis_pair.xml
    
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: setting circular to Y
    Obtained total genome size of 3079768480 bp
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Found 4958886 initial pairs from 12206342 clusters
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Nominal orientation of this sample appears to be Rp
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 37 for read 1
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 37 for read 2
    Obtained rest-of-genome correction of 3.26083171559413e-13
    Obtained rest-of-genome correction of 3.26083171559413e-13
    Obtained rest-of-genome correction of 1.7262699366e-35
    User defined signal 2




</entry>



<entry [Thu Sep 16 00:41:07 EDT 2010] DOWNLOAD NA18507 500 BP PAIRED END LIBRARY>



FROM HERE

ftp://ftp.ncbi.nlm.nih.gov/sra/static/SRX016/SRX016231

DOWNLOAD WITH deepvac.pl

mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX016231
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX016231

/nethome/bioinfo/apps/agua/0.5/bin/apps/utils/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/static/SRX016/SRX016231 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX016231 \
--type text \
--regex "_(1|2)\.fastq"



    Run time: 03:32:47
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/utils/deepvac.pl
    2:38AM, 16 September 2010
    ****************************************



</entry>



<entry [Thu Sep 16 00:40:07 EDT 2010] NA18507 AT THE SRA>




http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?study=SRP000239


SRP000239  Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer

Study Type:  Whole Genome Sequencing
Submission:  SRA000271 by ILLUMINA on 2008-11-05 22:22:00
Abstract:  We have generated paired-end sequence data covering the genome of an African male individual to a sequence depth of more than 40-fold using the Illumina Genome Analyzer. This individual is a member of the population samples described in the PhaseI and PhaseII HapMap Projects and is from the Yoruba in Ibadan, Nigeria (abbreviation: YRI). The DNA identifier for this individual is NA18507

Description:  We obtained the DNA sample NA18507 from The Coriell Institute for Medical Research. We generated two sequencing libraries. The first had a median insert size of 200 bp and was produced following random fragmentation and gel fractionation of the genomic DNA. This library was used for generating most of the data (38x coverage).

The second library provided longer range paired-read information. For this library fragments of 2 kb were produced by random fragmentation and gel fractionation. These fragments were circularised and fragmented and the junction fragments were recovered.

Paired-end sequencing of the two libraries was carried out using the Illumina Genome Analyzer. We carried out purity-filtering (PF) to remove mixed reads, where two or more different template molecules are close enough on the surface of the flow-cell to form a mixed or overlapping cluster. No other filtering of the data has been carried out prior to submission. The data contain 3.77 billion PF reads from the short-insert library and 296 million PF reads from the long-insert library

Project:  Homo sapiens [ILLUMINA]
Center Project:  NA18507 human genome sequencing project
NCBI Link:  Accurate whole human genome sequencing using reversible terminator chemistry.
External Link:  NA18507



200 BP INSERT
-------------

http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR002271

Experiment: SRX000600
Paired-end sequencing of human library with approximately 200 bp inserts
Run:
Accession:     
Alias: 200x36x36-071113_EAS56_0053_FC2012M_R1
Instrument model:
Date of run: 2007-11-13 00:00:01
Run center: ILLUMINA
Statistics:
Number of spots: 22251361
Number of reads: 44502722
Other:
Study: Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
Design: Paired-end sequencing of human library with approximately 200 bp inserts
Platform: ILLUMINA
Sample: SRS000101
Library Name: CT1194
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'Forward, 5'-3'Reverse, NOMINAL_LENGTH=200, NOMINAL_SDEV=0.0E0)
Library Construction Protocol: Standard Illumina paired-end library construction protocol. Genomic DNA was randomly fragmented using nebulisation and an approximately 200 bp fraction was obtained by gel electrophoresis.




http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR002315

Experiment: SRX000601
Paired-end sequencing of human library with approximately 200 bp inserts
Run:
Accession:     
Alias: 200x36x37-071207_EAS51_0064_FC20476AAXX_R1
Instrument model:
Date of run:
Run center: ILLUMINA
Statistics:
Number of spots: 5104625
Number of reads: 10209250
Other:
Study: Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
Design: Paired-end sequencing of human library with approximately 200 bp inserts
Platform: ILLUMINA
Sample: SRS000101
Library Name: CT1194
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'Forward, 5'-3'Reverse, NOMINAL_LENGTH=200, NOMINAL_SDEV=0.0E0)
Library Construction Protocol: Standard Illumina paired-end library construction protocol. Genomic DNA was randomly fragmented using nebulisation and an approximately 200 bp fraction was obtained by gel electrophoresis.




http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR002316

Experiment: SRX000602
Paired-end sequencing of human library with approximately 200 bp inserts
Run:
Accession:     
Alias: 200x37x37-071122_SLXA-B7_0591_FC20472AAXX_R1
Instrument model:
Date of run:
Run center: ILLUMINA
Statistics:
Number of spots: 14042425
Number of reads: 28084850
Other:
Study: Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
Design: Paired-end sequencing of human library with approximately 200 bp inserts
Platform: ILLUMINA
Sample: SRS000101
Library Name: CT1194
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'Forward, 5'-3'Reverse, NOMINAL_LENGTH=200, NOMINAL_SDEV=0.0E0)
Library Construction Protocol: Standard Illumina paired-end library construction protocol. Genomic DNA was randomly fragmented using nebulisation and an approximately 200 bp fraction was obtained by gel electrophoresis.




http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR002319

Experiment: SRX000603
Paired-end sequencing of human library with approximately 200 bp inserts
Run:
Accession:     
Alias: 200x41x41-080215_EAS139_0019_FC3003UAAXX_R1
Instrument model:
Date of run:
Run center: ILLUMINA
Statistics:
Number of spots: 9264806
Number of reads: 18529612
Other:
Study: Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
Design: Paired-end sequencing of human library with approximately 200 bp inserts
Platform: ILLUMINA
Sample: SRS000101
Library Name: CT1194
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'Forward, 5'-3'Reverse, NOMINAL_LENGTH=200, NOMINAL_SDEV=0.0E0)
Library Construction Protocol: Standard Illumina paired-end library construction protocol. Genomic DNA was randomly fragmented using nebulisation and an approximately 200 bp fraction was obtained by gel electrophoresis.



2,000 BP INSERT
---------------

http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR005718

Experiment: SRX001539
Paired-end sequencing of human library produced from random 2 kb fragments
Run:
Accession:     
Alias: 2000x36x36-080314_EAS192_0023_FC20CMYAAXX_R1
Instrument model:
Date of run:
Run center: ILLUMINA
Statistics:
Number of spots: 32160546
Number of reads: 64321092
Other:
Study: Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
Design: Paired-end sequencing of human library produced from random 2 kb fragments
Platform: ILLUMINA
Sample: SRS000101
Library Name: CT1373
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'Reverse 5'-3'Forward, NOMINAL_LENGTH=1840, NOMINAL_SDEV=200)
Library Construction Protocol: Genomic DNA was randomly fragmented using nebulisation and a ~2000 bp fraction was obtained by gel electrophoresis. Fragments were end-labelled with biotin and circularised. Circles were fragmented and junction fragments were recovered for library making using standard Illumina protocol.



http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR005720

Experiment: SRX001540
Paired-end sequencing of human library produced from random 2 kb fragments
Run:
Accession:     
Alias: 2000x36x36-080404_EAS254_0001_FC20DRLAAXX_R1
Instrument model:
Date of run:
Run center: ILLUMINA
Statistics:
Number of spots: 26158566
Number of reads: 52317132
Other:
Study: Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
Design: Paired-end sequencing of human library produced from random 2 kb fragments
Platform: ILLUMINA
Sample: SRS000101
Library Name: CT1373
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'Reverse 5'-3'Forward, NOMINAL_LENGTH=1840, NOMINAL_SDEV=200)
Library Construction Protocol: Genomic DNA was randomly fragmented using nebulisation and a ~2000 bp fraction was obtained by gel electrophoresis. Fragments were end-labelled with biotin and circularised. Circles were fragmented and junction fragments were recovered for library making using standard Illumina protocol.




500 BP INSERT
-------------

http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=viewer&m=data&s=viewer&run=SRR034939

Experiment: SRX016231
Paired-end sequencing (2x100 base) of human library with ~500 bp inserts
Run:
Accession:     
Alias: 500x100x100-090406_HWI-EAS68_9096_FC400PR_PE-1
Instrument model: Illumina Genome Analyzer II
Date of run: 2009-12-10 00:00:00
Run center: ILLUMINA
Statistics:
Number of spots: 18100821
Number of reads: 36201642
Other:
Study: Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
Design: Paired-end sequencing (2x100 base) of human library with ~500 bp inserts
Platform: ILLUMINA
Sample: SRS000101
Library Name: CT2704
Library Strategy: WGS
Library Source: GENOMIC
Library Selection: RANDOM
Library Layout: PAIRED (ORIENTATION=5'-3'-5'-3')
Library Construction Protocol: Standard Illumina paired-end library construction protocol. Genomic DNA was randomly fragmented using nebulisation and an ~500 bp fraction was obtained by gel electrophoresis.





</entry>



<entry [Wed Sep 15 08:25:33 EDT 2010] QUALITY ANALYSIS OF SOLEXA RUNS>




CURRENT LIST OF ALL RUNS

ll /q/solexa

drwxrwx---+  3 jcabrera1   mihg                     16K Jul  7 12:45 080509_HWI-EAS185_0001_201UPAAXX_Aphid_JH
drwxrwx---+  6 root        mihg-data-drive-full     16K Jun 14 09:05 080801_HWI-EAS185_0001_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_JH
drwxrwx---+  6 root        mihg-data-drive-full     16K Jun 14 09:31 080805_HWI-EAS185_0006_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH
drwxrwx---+  8 jhahn       mihg-data-drive-full     16K Mar 23  2009 090123_HWI-EAS185_0013_20F1GAAXX_Pearl2_Jia_ENJH
drwxrwxr-x+  3 root        mihg-data-drive-full     16K Jun 14 08:52 090130_HWI-EAS185_0014_20DNUAAXX_mito1-4_DH_Jia_Uz_ENJH
drwxrwx---+  8 jhahn       mihg-data-drive-full     16K Feb 19  2010 090224_HWI-EAS185_0001_20EBNAAXX_Pearl_11-15_Jia_ENJH
drwxrwxr-x+  3 root        mihg-data-drive-full     16K Jun 14 09:47 090319_HWI-EAS185_0002_20G75AAXX_PowerOutage_JHEN
drwxrwxr-x+ 10 jhahn       mihg                     16K Apr 20 13:49 090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3
drwxrwx---+  3 jhahn       mihg-data-q-nextgen-full 16K Mar 16  2010 090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3-DATA
drwxrwx---+  7 root        mihg-data-drive-full     16K Apr 20 14:16 090522_HWI-EAS185_0006_42BBFAAXX-RESTORE
drwxrwxr-x+  9 mihg        mihg                     16K Mar 26 11:14 090528_HWI-EAS185_0007_42C1TAAXX_Flemington_Duan
drwxrwxr-x+  8 mihg        mihg                     16K Mar 26 11:14 090605_HWI-EAS185_0008_42DHLAAXX_EF7_Tony_Jia4
drwxrwx---+  4 mihglabtech users                    16K Aug 26  2009 090724_HWI-EAS185_42LKBAAXX_TonyMP
drwxrwx---+  6 mihglabtech users                    16K Apr 20 12:24 091002_HWI-EAS185_0004_Jia6_Holly1
drwxrwx---+  5 mihglabtech users                    16K Feb 15  2010 091029_HWI-EAS185_0005_42BNYAAXX
drwxrwx---+  6 mihglabtech users                    16K Feb  3  2010 091104_HWI-EAS185_0006_4312NAAXX
drwxrwx---+  7 jcabrera1   users                    16K Jan 26  2010 091120_HWI-EAS185_0001_42WNPAAXX
drwxrwx--x+  2 root        mihg-data-q-nextgen-full 16K Aug 27 10:39 09121
drwxrwx---+  7         508 users                    16K Jan 26  2010 091219_HWI-EAS185_0004_4311VAAXX
drwxrwx---+  6 mihglabtech users                    16K Feb 17  2010 100106_HWI-EAS185_0005_611F3AAXX
drwxrwx---+  6 jhahn       mihg-data-q-nextgen-full 16K Jan 16  2010 100113_HWI-EAS185_0006_616ANAAXX_gwang
drwxrwx---+  6 mihglabtech users                    16K Apr 20 16:53 100121_HWUSI-EAS1687R_0003_616GJAAXX
drwxrwx---+  6 mihglabtech users                    16K Apr 20 12:18 100126_HWI-EAS185_0007_61F1BAAXX
drwxrwx---+  7 mihglabtech users                    16K Apr 20 12:19 100128_HWUSI-EAS1687R_0004_4310GAAXX
drwxrwx---+  8 mihglabtech users                    16K Apr 20 12:20 100203_HWI-EAS185_0008_61EWKAAXX
drwxrwx---+  7 mihglabtech users                    16K Apr 20 17:30 100205_HWUSI-EAS1687R_0005_61F40AAXX
drwxrwx---+  8 mihglabtech users                    16K Apr 20 12:25 100212_HWI-EAS185_0009_61EAWAAXX
drwxrwxr-x+  8 mihglabtech users                    16K Apr 20 18:58 100226_HWI-EAS185_0010_61GN2AAXX
drwxrwxr-x+  8 mihglabtech users                    16K Mar 25 18:28 100312_HWUSI-EAS1687R_0008_616ALAAXX
drwxrwxr-x+  8 mihglabtech users                    16K Apr  2 11:32 100325_HWI-EAS185_0001_617K7AAXX
drwxrwxr-x+  8 mihglabtech users                    16K Apr 19 16:06 100331_HWUSI-EAS1687R_0011_61NBAAAXX
drwxrwxr-x+  8 mihglabtech users                    16K Aug 26 16:32 100402_HWI-EAS185_0002_61NV9AAXX
drwxrwxr-x+  6 mihglabtech users                    16K Apr 14 18:20 100402_HWI-EAS185_0002_61NV9AAXX-partial
drwxrwx---+  7 jhahn       mihg-data-q-nextgen-full 16K Aug 12 16:54 100412_HWI-EAS185_0001_61NPVAAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:53 100412_HWUSI-EAS1687R_0001_61NU8AAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:52 100423_HWI-EAS185_0002_61NN7AAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:51 100427_HWUSI-EAS1784_0002_616CFAAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:50 100505_HWI-EAS185_0003_61NN6AAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:47 100512_HWUSI-EAS1687R_0002_61NPBAAXX
drwxrwx---+  9 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:45 100514_HWUSI-EAS1784_0003_61NKMAAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:44 100518_HWUSI-EAS1784_0004_61NKNAAXX
drwxrwx---+  6 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:42 100528_HWI-EAS185_0004_616BKAAXX
drwxrwx---+  6 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:39 100528_HWUSI-EAS1687R_0003_61PKUAAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:35 100610_HWUSI-EAS1687R_0004_61NRFAAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:27 100615_HWI-EAS185_0012_437P3AAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 12 16:25 100629_HWUSI-EAS1784_0005_61NN0AAXX
drwxrwx---+  6 whulme      mihg-data-q-nextgen-full 16K Jul 14 12:56 100702_HWI-EAS185_0005_625K7AAXX
drwxrwx---+  6 whulme      mihg-data-q-nextgen-full 16K Jul 14 12:56 100708_HWI-EAS185_0006_7070TAAXX
drwxrws---+  6 root        mihg-data-drive-full     16K Aug  2 13:38 100727_HWI-EAS185_0007_629JKAAXX
drwxrwx---+  6 whulme      mihg-data-q-nextgen-full 16K Aug  9 17:01 100730_HWUSI-EAS1784_0006_629P5AAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Aug 18 11:13 100802_HWI-EAS185_0009_62CWPAAXX
drwxrwx---+  6 whulme      mihg-data-q-nextgen-full 16K Aug 18 11:18 100813_HWUSI-EAS1784_0007_629WFAAXX
drwxrwxr-x+  9 mihglabtech users                    16K Aug 31 03:29 100823_SN158_0337_B2045NABXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Sep  7 16:59 100825_HWI-EAS185_0010_62CWRAAXX
drwxrwx---+  7 whulme      mihg-data-q-nextgen-full 16K Sep  8 17:30 100827_HWUSI-EAS1784_0008_6288BAAXX
drwxrwx---+  7 whulme      users                    16K Sep 13 15:58 100903_HWUSI-EAS1687R_0006_6289RAAXX
drwxr-x---+  3 jcabrera1   mihg                     16K Jul  7 13:57 2023BAAXX_W002_080522_HWI-EAS185_0002_AN_JH
drwxrwxr-x+  8 mihglabtech users                    16K Apr 20 19:30 617JRAAX_20100308_HWI-EAS185_0011
-rwxrwx--x+  1 gbeecham    mihg                     797 Aug 12 16:18 CLEAN_GERALD.sh
-rwxrwx---+  1 gbeecham    mihg                     793 Aug 12 16:32 CLEAN_TEST_GERALD.sh
-rwxrwx---+  1 rhenson     mihg-data-q-nextgen-full 25K Aug  3 15:35 Flemington Data to put on hard drives.doc
drwxrwxrwx+  2 anaj        mihganlst                16K May 18 23:47 for_Stephan
drwxrwx---+  5 jhahn       mihg-data-q-nextgen-full 16K Aug  5 16:35 HiSeq2000Training
drwxrwx---+  3 jcabrera1   mihg                     16K Feb 16  2010 Instruments
drwxrwx---+  4 rhenson     mihg-data-q-nextgen-full 16K Sep  2 14:13 Multiplexed Sample Sheets
-rwxrwx---+  1 gbeecham    mihg-data-q-nextgen-full 12K Aug 12 17:15 q_contents_20100812.xlsx



ll /q/solexa/HiSeq2000Training

    drwxrwx---+  9 jhahn       mihg-data-q-nextgen-full 16K Aug  5 16:35 100722_SN158_0335_A206LJABXX
    drwxrwx---+  9 jhahn       mihg-data-q-nextgen-full 16K Aug  5 16:35 100722_SN158_0336_B206K0ABXX
    -rwxrwx---+  1 jhahn       mihg-data-q-nextgen-full 657 Aug  5 16:34 NGSMoveDirectoryComparison.txt
    drwxrwx---+  2 jhahn       mihg-data-q-nextgen-full 16K Aug  5 16:35 Summary Table Screenshot






2008
----


run 2 human
human, paired end
http://gouda.ccs.miami.edu:8090/display/NextGen/091219_4311VAAXX
-----------------

MAKE OUTPUT FOLDER

mkdir -p /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX

INPUTFILE

/q/solexa/080805_HWI-EAS185_0006_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH/Data/C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_6_1_sequence.txt

COPY INPUT FILE

cd /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX

cp /q/solexa/080805_HWI-EAS185_0006_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH/Data/C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_6_1_sequence.txt ./

-rwxrwx--- 1 syoung bioinfo 761M Sep 15 20:04 s_6_1_sequence.txt

head /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.txt
    
    @HWI-EAS185_6_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH:6:1:589:870/1
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    +HWI-EAS185_6_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH:6:1:589:870/1
    ZZZZZYYTYZTYTYYYZZYZYZZYRZTTZRZZUUZ
    @HWI-EAS185_6_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH:6:1:318:968/1
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    +HWI-EAS185_6_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH:6:1:318:968/1
    ZZZZZZZZZZZZZYZYZZZZZZZZYZZZZZZZZZZ
    @HWI-EAS185_6_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH:6:1:655:696/1
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    
    
CREATE SIMPLE HEADER VERSION

cd /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.simpleHeader.txt \
--rejectfile /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.simpleHeader.rejects.txt \
--barcode 0 \
--matenumber 1
    


DO ELAND ALIGNMENT

cd /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX

emacs s_6_1_sequence.ELAND.sh

#!/bin/sh                                                                                                                                                                 
/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.simpleHeader.txt



RUN JOB

ll
cd /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX

chmod 755 s_6_1_sequence.ELAND.sh

bsub -e /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.ELAND.sh 


    Job <1861406> is submitted to queue <large>.
    [syoung@u01 080805_HWI-EAS185_0006_20GVYAAXX]$ date
    Wed Sep 15 20:08:48 EDT 2010


[syoung@u01 080805_HWI-EAS185_0006_20GVYAAXX]$ bpeek

    << output from stdout >>
    
    << output from stderr >>
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: deduced read length of 35 for data in /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.simpleHeader.txt


COMPLETED

    ...    
    Comment: >chr22
    finished making FileReader
    No contig index found for /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland//chr22.fa
    FileReader: unmapping 12422860 bytes of memory
    FileReader: unmapping 223 bytes of memory
    alignment done for the moment User: 0.308953s System: 0s Actual: 0.308893s Efficiency: 100.019%
    ... done User: 76.8103s System: 6.13107s Actual: 84.462s Efficiency: 98.1997%
    Run complete! Time now: Wed Sep 15 22:04:56 2010
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: eland succeded
    ELAND_standalone.pl    DOING makeExportSingle(...)
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/a\
    pps/casava/1.6.0/bin/../bin/squashGenome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/elan\
    d > ./reanalysis_genomesize.xml
    
    User: 0s System: 0s Actual: 2e-06s Efficiency: 0%
    Trying to open directory /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland ...
     ... success, will output file sizes to XML
    User: 0s System: 0s Actual: 0.004125s Efficiency: 0%
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: squashGenome succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/a\
    pps/casava/1.6.0/bin/../bin/pickBestAlignment.pl 35 32 ./reanalysis_genomesize.xml ./reanalysis_ela\
    nd_extended.txt ./reanalysis_qseq.txt > ./reanalysis_calsaf.txt
    
    Obtained total genome size of 3079768480 bp
    Obtained rest-of-genome correction of 5.21733074495061e-12
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: pickBestAlignment succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/a\
    pps/casava/1.6.0/bin/../bin/buildExport.pl --symbolic ./reanalysis_calsaf.txt ./reanalysis_qseq.txt\
     > ./reanalysis_export.txt
    
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: buildExport succeded





cd /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX

lines *export.txt

    reanalysis_export.txt: 3339151
    
    OK!
    REM:     total reads     3339151


cut -f 11 < *export.txt | grep -c NM
cut -f 11 < *export.txt | grep -c QC

cut -f 11 < *export.txt | grep -c QC
180579
cut -f 11 < *export.txt | grep -c QC
1520

HITS =  3339151
    -    180579
    -      1520
    ------------
        3157052


3339151 - 180579 - 1520

3157052/3339151

% HITS = 10496334/12206342 = 0.9455




DO AVERAGES


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa

    Run time: 00:02:52
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    8:13PM, 15 September 2010
    ****************************************

    
cat /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.qualstats

    total reads     3339151
    total avg quality       24.8451091396824
    bins    -50 -40 -30 -20 -10 0 1 2 3 4 5 6 7 8 9 10 15 20 30 40 50 60 70 80 90 100 200 300
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       0
    1       0
    2       0
    3       0
    4       0
    5       0
    6       0
    7       0
    8       0
    9       8
    10      53
    15      3000
    20      55094
    30      3280996
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0


cat /nethome/syoung/base/pipeline/avqual/2008/080805_HWI-EAS185_0006_20GVYAAXX/s_6_1_sequence.basequal

    total reads     3339151
    0       25.8866708932899
    1       25.8846428328638
    2       25.8716880428588
    3       25.871025599022
    4       25.865012393869
    5       25.8537355753004
    6       25.8197377117716
    7       25.8106066482169
    8       25.7707734690644
    9       25.7506189447557
    10      25.7204801460012
    11      25.5522775100617
    12      25.6059471404558
    13      25.5633408012995
    14      25.5217302242396
    15      25.4658196050433
    16      25.3935407533232
    17      25.3326642011697
    18      25.2813571473707
    19      25.1556257863151
    20      24.9675812803913
    21      24.9258329437633
    22      24.8778755438134
    23      24.7811976756966
    24      24.6744705465551
    25      24.4946188417355
    26      24.353855515968
    27      24.190726924299
    28      23.992413340996
    29      23.8155641958091
    30      23.0210116284049
    31      22.7335376567277
    32      22.5270264806833
    33      22.3402903911803
    34      20.9055214933377




SAMPLES
FlowCell ID: 20GVYAAXX 
Run Folder:

1) 080801_HWI-EAS185_0001_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_JH
2) 080805_HWI-EAS185_0006_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH

Lane	 Sample	 Sample Comments 
1	 Jia_Human normalized cDNA #8*	 
2	 Jia_Human normalized cDNA #8*	 
3	 Jia_Human normalized cDNA #8*	 
4	 Jia_Human normalized cDNA #8*	 
5	 PhiX control	 
6	 Total mtDNA	 Mouse mtDNA provided by Sion Williams, total DNA, testing 
7	 Small mtDNA	 Mouse mtDNA provided by Sion Williams, small-sized portion, testing
8	 Medium mtDNA	 Mouse mtDNA provided by Sion Williams, medium-sized portion, testing
Paired-end run
Same human subject as in 'human run 1'


ll /q/solexa/080801_HWI-EAS185_0001_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_JH


cd /q/solexa/080805_HWI-EAS185_0006_20GVYAAXX_Jia_cDNA2_mtDNA_Total_Small_Medium_read2_JH/Data
ll C1-72_Firecrest*/Bustard1.9*/GERALD_*/*sequence.txt

-rwxrwx---+ 1 root mihg-data-drive-full 2.4M Jun  7 23:23 C1-72_Firecrest1.9.2_27-08-2008_syoung.2/Bustard1.9.2_27-08-2008_syoung/GERALD_27-08-2008_syoung/s_6_1_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 2.4M Jun  7 23:23 C1-72_Firecrest1.9.2_27-08-2008_syoung.2/Bustard1.9.2_27-08-2008_syoung/GERALD_27-08-2008_syoung/s_6_2_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 761M Jun  8 00:24 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_6_1_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 761M Jun  8 00:25 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_6_2_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 646M Jun  8 00:26 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_7_1_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 646M Jun  8 00:27 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_7_2_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 1.1G Jun  8 00:20 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_8_1_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 1.1G Jun  8 00:22 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_07-09-2008_syoung/s_8_2_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 704M Jun  8 00:57 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_28-08-2008_syoung/s_6_1_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 704M Jun  8 00:55 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_28-08-2008_syoung/s_6_2_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 597M Jun  8 00:49 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_28-08-2008_syoung/s_7_1_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 597M Jun  8 00:48 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_28-08-2008_syoung/s_7_2_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 968M Jun  8 00:53 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_28-08-2008_syoung/s_8_1_sequence.txt
-rwxrwx---+ 1 root mihg-data-drive-full 968M Jun  8 00:52 C1-72_Firecrest1.9.2_28-08-2008_syoung/Bustard1.9.2_28-08-2008_syoung/GERALD_28-08-2008_syoung/s_8_2_sequence.txt


[syoung@u04 solexa]$ ll C1-36_Firecrest*/Bustard1.9*/GERALD_*/*sequence.txt
    
    -rwxrwx---+ 1 root mihg-data-drive-full 9.5M Jun  7 23:23 C1-36_Firecrest1.9.2_10-10-2008_syoung.7/Bustard1.9.2_10-10-2008_syoung/GERALD_10-10-2008_syoung/s_5_sequence.txt






2009
----


090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3
human, paired end
-----------------

Run: Duan_Emmet_Fly
viewfile: The viewfile macro only supports pdf, doc, xls, and ppt file types
FlowCell ID: 3031UAAXX

DATA LOCATION

LANES 1 thru 5 with pipeline1.3:
/q/solexa/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/Data/IPAR_1.3/Bustard1.3.2_18-05-2009_jhoffman/GERALD_18-05-2009_jhoffman

LANE 6:  /q/solexa/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/Data/C1-104_Firecrest1.5.1_31-08-2010_jcabrera1.3/Bustard1.5.1_31-08-2010_jcabrera1/GERALD_31-08-2010_jcabrera1
LANE 7:  /q/solexa/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/Data/C1-104_Firecrest1.5.1_31-08-2010_jcabrera1/Bustard1.5.1_31-08-2010_jcabrera1/GERALD_31-08-2010_jcabrera1
LANE 8:  /q/solexa/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/Data/C1-104_Firecrest1.5.1_31-08-2010_jcabrera1.2/Bustard1.5.1_31-08-2010_jcabrera1/GERALD_31-08-2010_jcabrera1


INPUT FILES:

ll /q/solexa/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/Data/IPAR_1.3/Bustard1.3.2_18-05-2009_jhoffman/GERALD_18-05-2009_jhoffman/s_2_*_sequence.txt

    -rw-rwx---+ 1 mihg mihg 1656752144 May 18  2009 s_2_1_sequence.txt
    -rw-rwx---+ 1 mihg mihg 1974117036 May 18  2009 s_2_2_sequence.txt


MAKE OUTPUT DIR:

mkdir -p /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3


COPY INPUT FILE

cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3
cp /q/solexa/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/Data/IPAR_1.3/Bustard1.3.2_18-05-2009_jhoffman/GERALD_18-05-2009_jhoffman/s_2_*_sequence.txt ./

ls -al

    -rw-rwx--- 1 syoung bioinfo 1656752144 Sep 15 17:03 s_2_1_sequence.txt
    -rw-rwx--- 1 syoung bioinfo 1974117036 Sep 15 17:04 s_2_2_sequence.txt

bash-3.2$ head s_2_2_sequence.txt

    @HWI-EAS185:2:1:16:1056#0/2
    NANNNNNNNNNNNAACACATANNNNNNNNNNNNNNNGTACTANNNNNNNN
    +HWI-EAS185:2:1:16:1056#0/2
    BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
    @HWI-EAS185:2:1:16:1932#0/2
    NGNNNNNNNNNNNAGAGGAGANNNNNNNcd rNNNNNNNNTATTTTNNNNNNNN
    +HWI-EAS185:2:1:16:1932#0/2
    BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
    @HWI-EAS185:2:1:16:1583#0/2
    AANNNNNNNNNNNACAGGGGGNNNNNNNNNNNNNNNGGAAGTNNNNNNNN

bash-3.2$ head s_2_1_sequence.txt

    @HWI-EAS185:2:1:16:1056#0/1
    AGAATAGTAANGAGGATGTAAGCCCGNGNNNGNTTAT
    +HWI-EAS185:2:1:16:1056#0/1
    __X_`aa``[DY_`__]U[X_BBBBBBBBBBBBBBBB
    @HWI-EAS185:2:1:16:1932#0/1
    TTGATTTTGGGTACCATGTATATTTTNCNNNTNGACT
    +HWI-EAS185:2:1:16:1932#0/1
    b`\[^`b_X_`U]\[_[_S\\\\aBBBBBBBBBBBBB
    @HWI-EAS185:2:1:16:1583#0/1
    TATCATATAGTAAAACCCAGCCCATGNCNNNTNACAG



!! SKIP CREATE SIMPLE HEADER AS HEADERS ARE OKAY !!



DO ELAND ALIGNMENT


cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3


READ 1
------

mkdir -p /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1
cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1
cp ../s_2_1_sequence.txt ./


emacs /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1/s_2_1_sequence.ELAND.sh
#!/bin/sh                                                                                                                                                                 
/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1/s_2_1_sequence.txt


RUN JOB

chmod 755 /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1/s_2_1_sequence.ELAND.sh

bsub -e /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1/s_2_1_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1/s_2_1_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1/s_2_1_sequence.ELAND.sh 
    
    Job <1861416> is submitted to queue <large>.
    Wed Sep 15 23:49:41 EDT 2010
    bash-3.2$ bjobs
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1861416   syoung  RUN   large      u01         n0093       *.ELAND.sh Sep 15 23:49
    bash-3.2$ bpeek
    << output from stdout >>
    
    << output from stderr >>
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: deduced read length of 37 for data in /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1/s_2_1_sequence.txt



CHECK ALIGNMENT

cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1

lines reanalysis_export.txt

    reanalysis_export.txt: 12206342

    OK!
    REM: total reads     12206342
    

head reanalysis_export.txt

    HWI-EAS185              2       1       16      1056    0       1       AGAATAGTAANGAGGATGTAAGCCCGNGNNNGNTTAT   __X_`aa``[DY_`__]U[X_BBBBBBBBBBBBBBBB   QC  Y
    HWI-EAS185              2       1       16      1932    0       1       TTGATTTTGGGTACCATGTATATTTTNCNNNTNGACT   b`\[^`b_X_`U]\[_[_S\\\\aBBBBBBBBBBBBB   QC  Y
    HWI-EAS185              2       1       16      1583    0       1       TATCATATAGTAAAACCCAGCCCATGNCNNNTNACAG   a_aaabaa_]^``\`__`][[\`_BBBBBBBBBBBBB   QC  Y
    HWI-EAS185              2       1       16      76      0       1       TGGAGGAAATGAGGGACGAGAGGCTGAGNCCCCTCAT   ``bYbaZba]ab`_a\VBBBBBBBBBBBBBBBBBBBB   chr14.fa             22964400        R       28C1G1A4        30                                              Y
    HWI-EAS185              2       1       16      1762    0       1       AGAAATTGAAACCTGGCGCAATAGAAATNGTACCCCC   ^a`ab`a\`ba^`WU\Y_`^BBBBBBBBBBBBBBBBB   NM  Y
    HWI-EAS185              2       1       16      919     0       1       ATTAAAGTCCTGTTTGAAGTTGTCAGAANAAGAAAAG   a^Z_[\]N\a`RI[\YT_BBBBBBBBBBBBBBBBBBB   chr2.fa              242260693       F       27CAC3C1T1      29                                              Y
    HWI-EAS185              2       1       16      89      0       1       AAGAATATAAACTTCAGGGTGAACGAAANATTAGAAT   a``\`Va``a\WX]N[_a[K[TBBBBBBBBBBBBBBB   NM  Y
    HWI-EAS185              2       1       17      1737    0       1       AGGGAGCCTACTAGGGTGTAGAATAGGANGTATGTGC   ^`b`W_bba_U_[]_[F[R__V_TX^BBBBBBBBBBB   chr5.fa              134291153       F       28A6A1  70                                              Y
    HWI-EAS185              2       1       17      1078    0       1       AAGAACACCTCTGATTACTCCTGCCATCNTGACCCTT   aa`]a\a]a_[`\\Y]]X[]_XUZ]BBBBBBBBBBBB   chr12.fa             40043735        R       28A8    70                                              Y
    HWI-EAS185              2       1       17      575     0       1       GACTGACCTGTTACGCAGCTGAGAGCCTNACTGTGAA   bbabbaaa\\]`__\_]]``a[_]]``XDX\]]YBBB   chr13.fa             75325496        R       1C2C23G8        25    


cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_1
cut -f 11 < *export.txt | grep -c NM
cut -f 11 < *export.txt | grep -c QC


cut -f 11 < *export.txt | grep -c QC
    1708509

cut -f 11 < *export.txt | grep -c QC
    1499


HITS = 12206342
    -   1708509
    -      1499
    ------------
       10496334
       
% HITS = 10496334/12206342 = 0.8599




READ 2
------

mkdir -p /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2
cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2
cp ../s_2_2_sequence.txt ./


cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2
emacs /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2/s_2_2_sequence.ELAND.sh
#!/bin/sh                                                                                                                                                                 
/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2/s_2_2_sequence.txt


RUN JOB

chmod 755 /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2/s_2_2_sequence.ELAND.sh

bsub -e /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2/s_2_2_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2/s_2_2_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2/s_2_2_sequence.ELAND.sh 

    Job <1861417> is submitted to queue <large>.
    bash-3.2$ date
    Wed Sep 15 23:51:36 EDT 2010
    bash-3.2$ bjobs
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1861417   syoung  RUN   large      u01         n0085       *.ELAND.sh Sep 15 23:51
    1861416   syoung  RUN   large      u01         n0093       *.ELAND.sh Sep 15 23:49
    bash-3.2$ bpeek 1861417
    << output from stdout >>
    
    << output from stderr >>
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: deduced read length of 50 for data in /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2/s_2_2_sequence.txt






CHECK ALIGNMENT

cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2

lines reanalysis_export.txt

    reanalysis_export.txt: 12206342

    OK!
    REM: total reads     12206342
    

head reanalysis_export.txt
    
    HWI-EAS185              2       1       16      1056    0       2       NANNNNNNNNNNNAACACATANNNNNNNNNNNNNNNGTACTANNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       16      1932    0       2       NGNNNNNNNNNNNAGAGGAGANNNNNNNNNNNNNNNTATTTTNNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       16      1583    0       2       AANNNNNNNNNNNACAGGGGGNNNNNNNNNNNNNNNGGAAGTNNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       16      76      0       2       TCNNNNNNNNNNCCTCTCCCCNNNNNNNNNNNNNNNGGAATTNNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       16      1762    0       2       CTNNNNNNNNNNCTTGGGGGGNNNNNNNNNNNNNNGGGGGGGNNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       16      919     0       2       CTNNNNNNNNNNCGCCGGGGANNNNNNNNNNNNNNCGGGGGGNNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       16      89      0       2       CANNNNNNNNNNCCCCTCTTCGNNNNNNNNNNNNNAAACACANNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       17      1737    0       2       GGNNNNNNNNNNCCACTTATCCNNNNNNNNNNNNNCAAGAAANNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       17      1078    0       2       GANNNNNNNNNNGGTGAGGGTGNNNNNNNNNNNNNTGTTTGTNNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC               HWI-EAS185              2       1       17      575     0       2       TCTNNNNNNNNNCAAGACTTTANNNNNNNNNNNNNTCACCTGNNNNNNNN      BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   QC 

cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/read_2
cut -f 11 < *export.txt | grep -c NM
cut -f 11 < *export.txt | grep -c QC




cut -f 11 < *export.txt | grep -c QC
    1708509

cut -f 11 < *export.txt | grep -c QC
    1499


HITS = 12206342
    -   1986287
    -     69208
    ------------
       10150847

% HITS = 10150847/12206342 = 0.8316





PAIRED
------

####mkdir -p /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired
####cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired
####cp ../s_2_1_sequence.txt ./
####cp ../s_2_2_sequence.txt ./
####
####
####
####TRIM SECOND READ TO LENGTH OF FIRST READ, I.E. 37 BP
####
####/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/trimRead.pl \
####--inputfile /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_2_2_sequence.txt \
####--outputfile /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_2_2_sequence.fastq \
####--type solexa \
####--format fastq \
####--length 37
####
####
####
####cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired
####ll
####
####    -rw-rwx--- 1 syoung bioinfo 1.6G Sep 15 23:54 s_2_1_sequence.txt
####    -rw-rw-rw- 1 syoung bioinfo 1.6G Sep 16 00:06 s_2_2_sequence.fastq
####    -rw-rwx--- 1 syoung bioinfo 1.9G Sep 15 23:53 s_2_2_sequence.txt
####
####CHANGE NAME OF FIRST READ TO .fastq
####
####mv s_2_1_sequence.txt s_2_1_sequence.fastq
####ll
####    
####    -rw-rwx--- 1 syoung bioinfo 1.6G Sep 15 23:54 s_2_1_sequence.fastq
####    -rw-rw-rw- 1 syoung bioinfo 1.6G Sep 16 00:06 s_2_2_sequence.fastq
####    -rw-rwx--- 1 syoung bioinfo 1.9G Sep 15 23:53 s_2_2_sequence.txt
####
####
####
####emacs /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh
#####!/bin/sh
####
####cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired
####/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
####--input-type fastq \
####--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
####--input-file /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_2_1_sequence.fastq \
####--input-file /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_2_2_sequence.fastq
####
####
####RUN JOB
####
####chmod 755 /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh
####
####bsub -e /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh 
####
####    
####    Job <1861419> is submitted to queue <large>.
####    [syoung@u01 paired]$ date
####    Thu Sep 16 00:32:57 EDT 2010
####    [syoung@u01 paired]$ bjobs
####    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
####    1861417   syoung  RUN   large      u01         n0085       *.ELAND.sh Sep 15 23:51
####    1861416   syoung  RUN   large      u01         n0093       *.ELAND.sh Sep 15 23:49
####    1861419   syoung  RUN   large      u01         n0093       *.ELAND.sh Sep 16 00:32
####
####CHECK ALIGNMENT
####
####cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired
####
####THESE FILES NOT PRESENT:
####
####    reanalysis_1_export.txt
####    reanalysis_2_export.txt
####
####ll
####
####    -rw-rw-r-- 1 syoung bioinfo 187M Sep 16 04:33 reanalysis_1_calsaf.txt
####    -rw-rw-r-- 1 syoung bioinfo 1.3G Sep 16 02:25 reanalysis_1_eland_extended.txt
####    -rw-rw-r-- 1 syoung bioinfo 849M Sep 16 00:44 reanalysis_1_eland_query.txt
####    -rw-rw-r-- 1 syoung bioinfo 1.3G Sep 16 00:37 reanalysis_1_qseq.txt
####    -rw-rw-r-- 1 syoung bioinfo 186M Sep 16 04:33 reanalysis_2_calsaf.txt
####    -rw-rw-r-- 1 syoung bioinfo 1.3G Sep 16 04:14 reanalysis_2_eland_extended.txt
####    -rw-rw-r-- 1 syoung bioinfo 849M Sep 16 02:37 reanalysis_2_eland_query.txt
####    -rw-rw-r-- 1 syoung bioinfo 1.3G Sep 16 02:30 reanalysis_2_qseq.txt
####    -rw-rw-r-- 1 syoung bioinfo 329M Sep 16 04:33 reanalysis_anomaly.txt
####    -rw-rw-r-- 1 syoung bioinfo  747 Sep 16 04:14 reanalysis_genomesize.xml
####    -rw-rw-r-- 1 syoung bioinfo    0 Sep 16 04:14 reanalysis_pair.xml
####    -rw-rw-r-- 1 syoung bioinfo 1.7M Sep 16 04:33 s_1+2_sequence.ELAND.err
####    -rw-rw-r-- 1 syoung bioinfo 4.7K Sep 16 04:33 s_1+2_sequence.ELAND.out
####    -rwxr-xr-x 1 syoung bioinfo  528 Sep 16 00:31 s_1+2_sequence.ELAND.sh
####    -rw-rw-r-- 1 syoung bioinfo  513 Sep 16 00:30 s_1+2_sequence.ELAND.sh~
####    -rw-rwx--- 1 syoung bioinfo 1.6G Sep 15 23:54 s_2_1_sequence.fastq
####    -rw-rw-rw- 1 syoung bioinfo 1.6G Sep 16 00:06 s_2_2_sequence.fastq
####    -rw-rwx--- 1 syoung bioinfo 1.9G Sep 15 23:53 s_2_2_sequence.txt
####
####
####INSTEAD, ERROR FILE READS:
####    
####tail -n 100  s_1+2_sequence.ELAND.err
####
####    ...
####    finished making FileReader
####    No contig index found for /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland//chr8.fa
####    FileReader: unmapping 36568708 bytes of memory
####    FileReader: unmapping 94 bytes of memory
####    FileReader: opened file /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland//chrY.fa.2bpb of size 14443240 bytes.
####    squash: opened file /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland//chrY.fa.vld of size 126 bytes.
####    Comment: >chrY
####    finished making FileReader
####    No contig index found for /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland//chrY.fa
####    FileReader: unmapping 14443240 bytes of memory
####    FileReader: unmapping 126 bytes of memory
####    alignment done for the moment User: 0.862869s System: 0s Actual: 0.862918s Efficiency: 99.9943%
####    ... done User: 352.365s System: 15.9896s Actual: 381.335s Efficiency: 96.5962%
####    Run complete! Time now: Thu Sep 16 04:14:25 2010
####    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: eland succeded
####    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/squashGenome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland > ./reanalysis_genomesize.xml
####    
####    User: 0s System: 0s Actual: 2e-06s Efficiency: 0%
####    Trying to open directory /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland ...
####     ... success, will output file sizes to XML
####    User: 0s System: 0.003999s Actual: 0.003858s Efficiency: 103.655%
####    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: squashGenome succeded
####    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl --circular 32 32 ./reanalysis_1_eland_extended.txt  ./reanalysis_2_eland_extended.txt ./reanalysis_1_qseq.txt ./reanalysis_2_qseq.txt ./reanalysis_1_calsaf.txt ./reanalysis_2_calsaf.txt ./reanalysis_anomaly.txt ./reanalysis_genomesize.xml > ./reanalysis_pair.xml
####    
####    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: setting circular to Y
####    Obtained total genome size of 3079768480 bp
####    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Found 4958886 initial pairs from 12206342 clusters
####    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Nominal orientation of this sample appears to be Rp
####    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 37 for read 1
####    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 37 for read 2
####    Obtained rest-of-genome correction of 3.26083171559413e-13
####    Obtained rest-of-genome correction of 3.26083171559413e-13
####    Obtained rest-of-genome correction of 1.7262699366e-35
####    User defined signal 2
####
####
####
####AND THE OUTPUT FILE READS:
####
####
####cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired
####tail -n 100 *out
####
####
####    Job </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh> was submitted from host <u01> by user <syoung> in cluster <lsfcluster>.
####    Job was executed on host(s) <n0093.pegasus.edu>, in queue <large>, as user <syoung> in cluster <lsfcluster>.
####    </nethome/syoung> was used as the home directory.
####    </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired> was used as the working directory.
####    Started at Thu Sep 16 00:32:57 2010
####    Results reported at Thu Sep 16 04:33:13 2010
####    
####    Your job looked like:
####    
####    ------------------------------------------------------------
####    # LSBATCH: User input
####    /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.sh
####    ------------------------------------------------------------
####    
####    TERM_RUNLIMIT: job killed after reaching LSF run time limit.
####    Exited with exit code 140.
####    
####    Resource usage summary:
####    
####        CPU time   :  14235.00 sec.
####        Max Memory :      1477 MB
####        Max Swap   :      1705 MB
####    
####        Max Processes  :         6
####        Max Threads    :         7
####    
####    The output (if any) follows:
####    
####    ELAND_standalone.pl    options:
####    $VAR1 = {
####              'read-length' => [
####                                 -1
####                               ],
####              'pair-params' => '--circular',
####              'pipeline-dir' => '/nethome/syoung/base/apps/casava/1.6.0/bin/..',
####              'input-file' => [
####                                '/nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_2_1_sequence.fastq',
####                                '/nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_2_2_sequence.fastq'
####                              ],
####              'seed-length' => [
####                                 -1
####                               ],
####              'output-prefix' => './reanalysis',
####              'base-quality' => 30,
####              'eland-genome' => '/nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland',
####              'input-type' => 'fastq'
####            };
####    
####    
####    ************************************************************
####    ELAND: Efficient Local Alignment of Nucleotide Data
####    Copyright (c) 2003-2006 Solexa Limited. All rights reserved.
####    Author: Anthony J. Cox
####    
####    Publications incorporating data generated by the use of
####    this software or modified versions thereof should cite:
####    Anthony J. Cox.
####    Ultra high throughput alignment of short sequence tags.
####    In preparation.
####    
####    ************************************************************
####    
####    
####    ************************************************************
####    ELAND: Efficient Local Alignment of Nucleotide Data
####    Copyright (c) 2003-2006 Solexa Limited. All rights reserved.
####    Author: Anthony J. Cox
####    
####    Publications incorporating data generated by the use of
####    this software or modified versions thereof should cite:
####    Anthony J. Cox.
####    Ultra high throughput alignment of short sequence tags.
####    In preparation.
####    
####    ************************************************************
####    
####    
####    
####    PS:
####    
####    Read file </nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired/s_1+2_sequence.ELAND.err> for stderr output of this job.
####
####
####
####
####




MAKE DIR


mkdir -p /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2


COPY FILES

cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2
cp ../paired/s_2_1_sequence.fastq ./
cp ../paired/s_2_2_sequence.fastq ./
ll
    
    -rw-rwx--- 1 syoung bioinfo 1.6G Sep 16 15:19 s_2_1_sequence.fastq
    -rw-rw-r-- 1 syoung bioinfo 1.6G Sep 16 15:20 s_2_2_sequence.fastq



cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2

rm -fr /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2

emacs /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2/s_1+2_sequence.ELAND.sh
#!/bin/sh

cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2

/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2/s_2_1_sequence.fastq \
--input-file /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2/s_2_2_sequence.fastq



RUN JOB

chmod 755 /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2/s_1+2_sequence.ELAND.sh

bsub -e /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2/s_1+2_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2/s_1+2_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/paired2/s_1+2_sequence.ELAND.sh ; date ; bjobs

    Job <1861692> is submitted to queue <large>.
    Thu Sep 16 15:21:20 EDT 2010
    
    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1861692   syoung  PEND  large      u04                     *.ELAND.sh Sep 16 15:21






DO AVERAGE QUALITY:

cd /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/s_2_1_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/s_2_1_sequence.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa




/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/s_2_2_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/s_2_2_sequence.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa




BASE QUALITIES:

cat /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/s_2_1_sequence.basequal

    total reads     12206342
    0       31.8444942801046
    1       31.8604751529983
    2       31.6839238979213
    3       31.5300219344993
    4       31.4569738419586
    5       31.8841843854613
    6       31.8631865304118
    7       31.6705787860114
    8       31.2175601830589
    9       31.4804155085938
    10      31.4406212770378
    11      31.3462660639854
    12      31.1450253482985
    13      30.981875077726
    14      30.8292010825192
    15      30.4909624029869
    16      30.3573759444066
    17      30.2460538136651
    18      30.0223724683447
    19      29.6351641630228
    20      29.4831677663955
    21      29.3079711350051
    22      29.162896222308
    23      28.8978303245968
    24      28.3830861039286
    25      28.0912700954963
    26      27.7741971345715
    27      27.0380169587252
    28      26.29604561301
    29      25.5680239829426
    30      24.7067595680999
    31      23.3580829539267
    32      21.8993555153542
    33      20.4880032035806
    34      19.3285619065892
    35      18.2321669342052
    36      16.2013046988197



cat /nethome/syoung/base/pipeline/avqual/2009/090508_HWI-EAS185_0004_3031UAAXX_Duan4_Jia3/s_2_2_sequence.basequal
    
    
    total reads     12206342
    0       31.1162983144336
    1       30.859465022363
    2       30.4983452864093
    3       30.0475937836249
    4       29.9865266760509
    5       30.3203058705057
    6       30.2405426621669
    7       30.0768753652814
    8       29.6391929703428
    9       29.9081479938871
    10      29.8163220398052
    11      29.8247420889895
    12      29.7987398681767
    13      29.7203109662174
    14      29.5750768739726
    15      29.3821583894667
    16      29.2344839264704
    17      29.1275795811718
    18      28.9218525091301
    19      28.6669452650106
    20      28.3185467030172
    21      27.734360547984
    22      27.5294654205166
    23      27.4060874257005
    24      27.2137724799125
    25      27.0515105999816
    26      26.8517514092264
    27      26.8051112282451
    28      26.6552281592634
    29      26.5425539444987
    30      26.2678047198743
    31      26.0503249048732
    32      25.9696157128811
    33      25.7505201804111
    34      25.5198546788219
    35      25.3324001572297
    36      25.0292110445537
    37      24.8490969694279
    38      24.5688461784866
    39      24.2676320227632
    40      23.9235939808994
    41      23.411890065017
    42      22.7771843521999
    43      22.4453212108918
    44      22.1458965347686
    45      21.8845704142977
    46      21.5277289461495
    47      21.2130263923459
    48      20.9193279198633
    49      20.0995847896118





4311VAAXX_Martin
human, paired end
-----------------

FILES

LANE 2, READ 1

ll /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.6/*sequence.txt

    -rwxrwx---+ 1 jcabrera1 mihg 3.8G Jan 22  2010 s_2_sequence.txt
    -rwxrwx---+ 1 jcabrera1 mihg 3.8G Jan 22  2010 s_5_sequence.txt


head /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.6/s_2_sequence.txt

    @HWI-EAS185_0001:2:1:4:1942#0/1
    CATCCATCCATCTGTCATCCACCCATCNNANNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNTNNCANN
    +HWI-EAS185_0001:2:1:4:1942#0/1
    abbabbbababaaUaaabb`]BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
    @HWI-EAS185_0001:2:1:4:1777#0/1
    CTGCCACCCCTCCTTATCCAATGCCTTNNANNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNTNNATGN
    +HWI-EAS185_0001:2:1:4:1777#0/1
    a``_`a`a`a```aaaa``_^BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
    @HWI-EAS185_0001:2:1:4:158#0/1
    TAAACACAAGGAGCCAGGATTGTGCTGNNANNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNGNNCGAN


LANE 2, READ 2

ll /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1/*sequence.txt

    -rwxrwx---+ 1 jcabrera1 mihg 3.9G Jan 22  2010 s_2_sequence.txt
    -rwxrwx---+ 1 jcabrera1 mihg 3.9G Jan 22  2010 s_5_sequence.txt

head /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1/s_2_sequence.txt

    @HWI-EAS185_0001:2:1:4:1942#0/1
    NNGGATGGTGGATGGATGGGTGGATGGTGAATGATGGGTCGATGGTNGNNNNNNNNNNTATGANNNNNNNNNNNGNG
    +HWI-EAS185_0001:2:1:4:1942#0/1
    BBaW_aab`bbb__S\ba`[T`ZT_XTJT\__Z[b\]SUBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
    @HWI-EAS185_0001:2:1:4:1777#0/1
    NNAGACATCCAGCTGGTCGTGAAATCAGGGGTTGGCATGTGTGAGANGNNNNNNNNNNTTGGTNNNNNNNNNNNGGG
    +HWI-EAS185_0001:2:1:4:1777#0/1
    BBbbba^_bbabbbbb```bbbbbb``aa_[_bb_]aa`aBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
    @HWI-EAS185_0001:2:1:4:158#0/1
    NNTTGGCTGCCAGCACAATCCTGGCTCCTTGTGTTTAAGATCGGAANGNNNNNNNNNNGGGGANNNNNNNNNNNCTC


DATA LOCATION

Run: 4311VAAXX_Martin (3)paid_Stephan (2)paid_Duan(2) Samples(waiting)

Mkohli

LANE 1 READ 1: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.4
LANE 1 READ 2: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.5
LANE 2 READ 1: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.6
LANE 2 READ 2: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1
LANE 3 READ 1: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.2
LANE 3 READ 2: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.2 

SZ

LANE 4: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_14-01-2010_jcabrera1
LANE 6: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_14-01-2010_jcabrera1.2 

DUAN LI

LANE 7, 8 READ 1: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_20-01-2010_jcabrera1.3
LANE 7, 8 READ 2: /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_20-01-2010_jcabrera1.4 
LANE 7, 8 READ 1 (c1-50): /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_26-01-2010_jcabrera1
LANE 7, 8 READ 2 (c51-76): /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_26-01-2010_jcabrera1.2

FlowCell ID: 4311VAAXX

Lane 
Sample  (Investigator)      
Conc.	 Sample comment 
1 AD9 (Martin) 8 pM 
2 CT8 (Martin)	 8 pM	 
3 D4 (Martin)	 8 pM	 
4 Fly (Stephan) 8 pM	 D. Melanogaster whole genomic DNA, wild-type. 
5 PhiX 8 pM 
6 200912188 (Stephan) 8 pM	 CMT, Canadian family, correct sample # is 200901288; Agilent exome capture. 
7 R-F19-4002 (Duan)	 8 pM	 
8 R-R-F12-3005 (Duan) 8 pM

Paired End Run
For this run we performed a v2 paired-end run of 76 cycles. Two v3 36-cycle kits were combined into one for each read of this run.  Pipeline v1.5 SCS v2.5




MAKE OUTPUT DIR:

mkdir -p /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX

COPY FILES

cd /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX
cp /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1.6/s_2_sequence.txt s_2_1_sequence.txt 
cp /q/solexa/091219_HWI-EAS185_0004_4311VAAXX/Data/Intensities/BaseCalls/GERALD_22-01-2010_jcabrera1/s_2_sequence.txt s_2_2_sequence.txt 
ll



CREATE SIMPLE HEADER WITH CORRECT MATE NUMBERS

cd /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.simpleHeader.txt \
--rejectfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.simpleHeader.rejects.txt \
--barcode 0 \
--matenumber 1
    
cd /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.simpleHeader.txt \
--rejectfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.simpleHeader.rejects.txt \
--barcode 0 \
--matenumber 2



DO ELAND ALIGNMENT

READ 1
------

mkdir -p /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/read_1
cp s_2_1_sequence.simpleHeader.txt read_1
cd read_1

emacs s_2_1_sequence.ELAND.sh

#!/bin/sh                                                                                                                                                                 
/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/read_1/s_2_1_sequence.simpleHeader.txt


RUN JOB

bsub -e /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.ELAND.sh 



READ 2
------

mkdir -p /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/read_2
cp s_2_2_sequence.simpleHeader.txt read_2
cd read_2

emacs s_2_2_sequence.ELAND.sh

#!/bin/sh                                                                                                                                                                 
/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.simpleHeader.txt


RUN JOB

bsub -e /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.ELAND.sh 




PAIRED
------

mkdir -p /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/paired
cp s_2_2_sequence.simpleHeader.txt paired
cd paired

emacs s_2_2_sequence.ELAND.sh

#!/bin/sh                                                                                                                                                                 
/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.simpleHeader.txt


RUN JOB

bsub -e /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.ELAND.err -o /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.ELAND.out -q large /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.ELAND.sh 














DO AVERAGE QUALITY:

cd /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_1_sequence.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa



/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/2009/091219_HWI-EAS185_0004_4311VAAXX/s_2_2_sequence.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa









2010
----


HISEQ TRAINING
Run: A206LJABXX_HEDGES


MAKE OUTPUT FOLDER

mkdir -p /nethome/syoung/base/pipeline/avqual/hiseq/100722_SN158_0335_A206LJABXX


DO AVERAGES

cd /nethome/syoung/base/pipeline/avqual/hiseq/100722_SN158_0335_A206LJABXX
screen -S hiseq1
/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.3/s_4_1_sequence.txt \
--outputfile /nethome/syoung/base/pipeline/avqual/hiseq/100722_SN158_0335_A206LJABXX/s_4_1_sequence.avqual \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa

    
    averageQuality.pl    outputfile: /nethome/syoung/base/pipeline/averagequal/hiseq/100722_SN158_0335_A206LJABXX/s_4_1_sequence.avqual
    averageQuality.pl    outfile: /nethome/syoung/base/pipeline/averagequal/hiseq/100722_SN158_0335_A206LJABXX/s_4_1_sequence.avqual
    Can't open basequalfile: /nethome/syoung/base/pipeline/averagequal/hiseq/100722_SN158_0335_A206LJABXX/s_4_1_sequence.basequal








Run: A206LJABXX_HEDGES
FLOW CELL ID: 206KOABXX

Data location: Q:\solexa\HiSeq2000Training\100722_SN158_0335_A206LJABXX 

Analysis location:

1: Q:\solexa\HiSeq2000Training\100722_SN158_0335_A206LJABXX\Data\Intensities\BaseCalls\GERALD_26-08-2010_jcabrera1
3: /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.2
4: /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.3
5: /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.4
6: /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_24-08-2010_jcabrera1
7: /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_24-08-2010_jcabrera1.2
8: /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.7

Run Type: 2x100
Generated with: HCS 1.1.37
FlowCell type: HiSeq
Seq Kit type: HiSeq

Lane	Sample	Conc.	Study	Project	Species	Prep Type	Align to	Process with	Comments
1 	 PhiX	 5 pM 	 	 	 	 	 	 	 
2 	201014049	4 pM	CLP	 Hedges	h. sapiens	Agilent--38Mb Kit	Whole genome	No usable data	4pM PhiX spike in 
Lane failure on cBot
3 	 201014050	 5 pM	 CLP	 Hedges	 h. sapiens	 Agilent--38Mb Kit	 Whole genome	 CASAVA	 5pM PhiX spike in
4 	 201014051	 6 pM	 CLP	 Hedges	 h. sapiens	 Agilent--38Mb Kit	 Whole genome	 CASAVA	 6pM PhiX spike in
5 	 201014052	 7 pM	 CLP	 Hedges	 h. sapiens	 Agilent--38Mb Kit	 Whole genome	 CASAVA	 7pM PhiX spike in
6 	 201014046	 5 pM	 CLP	 Hedges	 h. sapiens	 Nimblegen Eval.Exome	 Whole genome	 CASAVA	 5pM PhiX spike in
7 	 201014047	 5 pM	 CLP	 Hedges	 h. sapiens	 Nimblegen Eval.Exome	 Whole genome	 CASAVA	 5pM PhiX spike in
8 	 201014048	 5 pM	 CLP	 Hedges	 h. sapiens	 Nimblegen Eval.Exome	 Whole genome	 CASAVA	 5pM PhiX spike in




ll /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.3/*sequence.txt


-rw-rw----+ 1 jcabrera1 mihg 31G Aug 17 20:34 /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.3/s_4_1_sequence.txt
-rw-rw----+ 1 jcabrera1 mihg 31G Aug 17 21:09 /q/solexa/HiSeq2000Training/100722_SN158_0335_A206LJABXX/Data/Intensities/BaseCalls/GERALD_13-08-2010_jcabrera1.3/s_4_2_sequence.txt






++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

INSTALL BIOCONDUCTOR ON PEGASUS



1. INSTALL BASIC PACKAGES

Use the biocLite.R installation script, which has arguments:

    pkgs
        Character vector of BioConductor packages to install.
    destdir
        File system directory for downloaded packages.
    lib
        R library where packages are installed.


AT THE R PROMPT:


source("http://bioconductor.org/biocLite.R")
biocLite()

    ...    
    Welcome to Bioconductor
    
      Vignettes contain introductory material. To view, type
      'openVignette()'. To cite Bioconductor, see
      'citation("Biobase")' and for packages 'citation(pkgname)'.
    
    Warning in library(pkg, character.only = TRUE, logical.return = TRUE, lib.loc = lib.loc) :
      there is no package called 'simpleaffy'
    Error : package 'simpleaffy' could not be loaded
    ERROR: lazy loading failed for package affyQCReport
    * Removing /nethome/syoung/base/apps/R/2.9.0/lib64/R/library/affyQCReport
    
    The downloaded packages are in
            /tmp/RtmpLWx8Kp/downloaded_packages
    Updating HTML index of packages in '.Library'
    There were 13 warnings (use warnings() to see them)
    > warnings()
    Warning messages:
    1: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'XML' had non-zero exit status
    2: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'AnnotationDbi' had non-zero exit status
    3: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'RCurl' had non-zero exit status
    4: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'GO.db' had non-zero exit status
    5: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'KEGG.db' had non-zero exit status
    6: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'annotate' had non-zero exit status
    7: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'biomaRt' had non-zero exit status
    8: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'hgu95av2.db' had non-zero exit status
    9: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'annaffy' had non-zero exit status
    10: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'genefilter' had non-zero exit status
    11: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'geneplotter' had non-zero exit status
    12: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'simpleaffy' had non-zero exit status
    13: In install.packages(pkgs = pkgs, repos = repos, dependencies = dependencies,  ... :
      installation of package 'affyQCReport' had non-zero exit status
      


This installs the following packages: affy, affydata, affyPLM, affyQCReport, annaffy, annotate, Biobase, biomaRt, Biostrings, DynDoc, gcrma, genefilter, geneplotter, GenomicRanges, hgu95av2.db, limma, marray, multtest, vsn, and xtable. After downloading and installing these packages, the script prints "Installation complete" and TRUE.


2. INSTALL MORE BIOCONDUCTOR PACKAGES


Bioconductor packages for HTS

 Biostrings
 BSGenome
 ShortRead
 TileQC
 GenomeGraphs
 HilbertVis
 ChipSeq
 edgeR


Biostrings
----------

source("http://bioconductor.org/biocLite.R")
biocLite("Biostrings")



TileQC
------
http://peterdolanconsulting.com/tileqc/

source("http://science.oregonstate.edu/~dolanp/tileqc/tileQC.R")
biocLite("tileQC")

    ...    
    Loading tileQC...
        Loading RMySQL...
    RMySQL is not installed on this version of R.
    Error in eval.with.vis(expr, envir, enclos) : Aborting...
    > biocLite("tileQC")
    Using R version 2.9.0, biocinstall version 2.4.13.
    Installing Bioconductor version 2.4 packages:
    [1] "tileQC"
    Please wait...
    
    Warning message:
    In getDependencies(pkgs, dependencies, available, lib) :
      package tileQC is not available



BSGenome
--------
http://www.bioconductor.org/packages/2.6/bioc/html/BSgenome.html

source("http://bioconductor.org/biocLite.R")
biocLite("BSgenome")    

    OK!
    
    Warning messages:
    1: In safeSource() : Redefining biocinstall
    2: In safeSource() : Redefining biocinstallPkgGroups
    3: In safeSource() : Redefining biocinstallRepos
    > biocLite("BSgenome")    
    Using R version 2.9.0, biocinstall version 2.4.13.
    Installing Bioconductor version 2.4 packages:
    [1] "BSgenome"
    Please wait...
    
    trying URL 'http://bioconductor.org/packages/2.4/bioc/src/contrib/BSgenome_1.12.5.tar.gz'
    Content type 'application/x-gzip' length 353545 bytes (345 Kb)
    opened URL
    ==================================================
    downloaded 345 Kb
    
    * Installing *source* package BSgenome ...
    ** R
    ** inst
    ** preparing package for lazy loading
    
    Attaching package: 'IRanges'
    
    
            The following object(s) are masked from package:base :
    
             cbind,
             duplicated,
             order,
             pmax,
             pmax.int,
             pmin,
             pmin.int,
             rank,
             rbind,
             rep.int,
             sapply,
             sort,
             table,
             unique 
    
    ** help
    *** installing help indices
     >>> Building/Updating help pages for package 'BSgenome'
         Formats: text html latex example 
      BSParams-class                    text    html    latex
      BSgenome-class                    text    html    latex   example
      BSgenomeForge                     text    html    latex   example
      GenomeData-class                  text    html    latex   example
      GenomeDataList-class              text    html    latex   example
      GenomeDescription-class           text    html    latex   example
      available.genomes                 text    html    latex   example
      bsapply                           text    html    latex   example
      gdapply                           text    html    latex
      getSeq                            text    html    latex   example
      injectSNPs                        text    html    latex   example
      strand                            text    html    latex   example
    ** building package indices ...
    * DONE (BSgenome)
    
    The downloaded packages are in
            /tmp/RtmpLWx8Kp/downloaded_packages
    Updating HTML index of packages in '.Library'
    






source("http://bioconductor.org/biocLite.R")
biocLite("EBImage")




Install Additional Bioconductor Packages


There are many Bioconductor and R packages in addition to those in the default installation of biocLite. A catalog of the Bioconductor packages is available at BiocViews. To install a new package, e.g., EBImage, use

source("http://bioconductor.org/biocLite.R")
biocLite("EBImage")


Install "pkg1" and "pkg2" with

biocLite(c("pkg1", "pkg2"))


Update Installed Bioconductor Packages

Bioconductor packages, especially those in the development branch, are updated fairly regularly.

To identify packages requiring update, start a new session of R and enter

source("http://bioconductor.org/biocLite.R")
old.packages(repos=biocinstallRepos())

To update all installed packages that are out of date, start a new session of R and enter

source("http://bioconductor.org/biocLite.R")
update.packages(repos=biocinstallRepos(), ask=FALSE)


Read the help page for update.packages for additional details. Recompiling installed Bioconductor packages

Rarely, underlying changes in the operating system require ALL installed packages to be recompiled for source (C or Fortran) compatibility. One way to address this might be to start a new R session and enter

source("http://bioconductor.org/biocLite.R")
pkgs <- rownames(installed.packages())
biocLite(pkgs)


As this will reinstall all currently installed packages, it likely involves a significant amount of network bandwidth and compilation time. All packages are implicitly updated, and the cumulative effect might introduce wrinkles that disrupt your workflow.




NOTES
-----

Install Base Bioconductor Packages
http://www.bioconductor.org/install/


Install BioConductor packages using the biocLite.R installation script. In an R command window, type the following:

source("http://bioconductor.org/biocLite.R")
biocLite()



This installs the following packages: affy, affydata, affyPLM, affyQCReport, annaffy, annotate, Biobase, biomaRt, Biostrings, DynDoc, gcrma, genefilter, geneplotter, GenomicRanges, hgu95av2.db, limma, marray, multtest, vsn, and xtable. After downloading and installing these packages, the script prints "Installation complete" and TRUE.

The biocLite.R script has arguments that change the default behavior:
pkgs
    Character vector of BioConductor packages to install.
destdir
    File system directory for downloaded packages.
lib
    R library where packages are installed.
[ Back to top ]
Install Additional Bioconductor Packages

There are many Bioconductor and R packages in addition to those in the default installation of biocLite. A catalog of the Bioconductor packages is available at BiocViews. To install a new package, e.g., EBImage, use

source("http://bioconductor.org/biocLite.R")
biocLite("EBImage")


Install "pkg1" and "pkg2" with

biocLite(c("pkg1", "pkg2"))


Update Installed Bioconductor Packages

Bioconductor packages, especially those in the development branch, are updated fairly regularly.

To identify packages requiring update, start a new session of R and enter

source("http://bioconductor.org/biocLite.R")
old.packages(repos=biocinstallRepos())

To update all installed packages that are out of date, start a new session of R and enter

source("http://bioconductor.org/biocLite.R")
update.packages(repos=biocinstallRepos(), ask=FALSE)


Read the help page for update.packages for additional details. Recompiling installed Bioconductor packages

Rarely, underlying changes in the operating system require ALL installed packages to be recompiled for source (C or Fortran) compatibility. One way to address this might be to start a new R session and enter

source("http://bioconductor.org/biocLite.R")
pkgs <- rownames(installed.packages())
biocLite(pkgs)


As this will reinstall all currently installed packages, it likely involves a significant amount of network bandwidth and compilation time. All packages are implicitly updated, and the cumulative effect might introduce wrinkles that disrupt your workflow.




    

</entry>



<entry [Fri Sep 10 14:51:00 EDT 2010] TEST QUALITY WITH PIQA>




1. INSTALLED R DEPENDENCIES libpng AND jpeg 
-------------------------------------------
http://cran.r-project.org/doc/manuals/R-admin.html#Installing-R-under-Unix_002dalikes

TO AVOID THIS ERROR:

PIQA_rpt(type_of_data,in_d,out_d,lane)

    do_fastq --> Loading data...
    do_fastq --> Writing data into a file...
    do_fastq --> qtyRpt.csv created in /nethome/syoung/base/apps/R/2.9.0/
    Error in X11(paste("png::", filename, sep = ""), width, height, pointsize,  : 
      unable to start device PNG
    In addition: Warning message:
    In png(graph) : no png support in this version of R



http://cran.r-project.org/doc/manuals/R-admin.html#Installing-R-under-Unix_002dalikes



NB: REQUIRED VERSIONS OF libpng AND jpeg

You will need files

libpng-1.2.18.tar.gz
jpegsrc.v6b.tar.gz
tiff-3.8.0.tar.gz

or later.




DOWNLOADED libpng FROM http://www.libpng.org/ AND UNZIPPED HERE
(NB: ALSO HERE http://sourceforge.net/projects/libpng/files/)


/nethome/syoung/base/apps/R/libpng/libpng-1.4.3 
cd /nethome/syoung/base/apps/R/libpng/libpng-1.4.3

mkdir /nethome/syoung/base/apps/R/libpng/1.4.3
./configure --prefix=/nethome/syoung/base/apps/R/libpng/1.4.3
make check
make install

    OK!

NB: libpng ALREADY INSTALLED ON PEGASUS:

locate libpng

    /usr/lib/libpng.so.3
    /usr/lib/libpng.so.3.10.0
    /usr/lib/libpng12.so.0
    /usr/lib/libpng12.so.0.10.0
    /usr/lib64/libpng.so.3
    /usr/lib64/libpng.so.3.10.0
    /usr/lib64/libpng12.so.0
    /usr/lib64/libpng12.so.0.10.0
    /usr/share/doc/libpng-1.2.10
    /usr/share/doc/libpng-1.2.10/CHANGES
    /usr/share/doc/libpng-1.2.10/LICENSE
    /usr/share/doc/libpng-1.2.10/README
    /usr/share/doc/libpng-1.2.10/TODO
    /usr/share/doc/libpng-1.2.10/example.c
    /usr/share/doc/libpng-1.2.10/libpng.txt




DOWNLOADED JPEG FROM http://www.ijg.org

mkdir /nethome/syoung/base/apps/R/jpeg
cd /nethome/syoung/base/apps/R/jpeg
wget http://www.ijg.org/files/jpegsrc.v8b.tar.gz
tar xfvz *gz
cd /nethome/syoung/base/apps/R/jpeg/jpeg-8b
mkdir /nethome/syoung/base/apps/R/jpeg/8b
./configure --prefix=/nethome/syoung/base/apps/R/jpeg/8b
make
make test
make install

    /bin/sh /nethome/syoung/base/apps/R/jpeg/jpeg-8b/install-sh -d /nethome/syoung/base/apps/R/jpeg/8b/include
    /usr/bin/install -c -m 644 jconfig.h /nethome/syoung/base/apps/R/jpeg/8b/include/jconfig.h
    test -z "/nethome/syoung/base/apps/R/jpeg/8b/include" || /bin/mkdir -p "/nethome/syoung/base/apps/R/jpeg/8b/include"
     /usr/bin/install -c -m 644 jerror.h jmorecfg.h jpeglib.h '/nethome/syoung/base/apps/R/jpeg/8b/include'
    test -z "/nethome/syoung/base/apps/R/jpeg/8b/share/man/man1" || /bin/mkdir -p "/nethome/syoung/base/apps/R/jpeg/8b/share/man/man1"
     /usr/bin/install -c -m 644 cjpeg.1 djpeg.1 jpegtran.1 rdjpgcom.1 wrjpgcom.1 '/nethome/syoung/base/apps/R/jpeg/8b/share/man/man1'
    make[1]: Leaving directory `/nethome/syoung/base/apps/R/jpeg/jpeg-8b'

    OK!


AND INSTALLED TIFF LIBRARY JUST IN CASE FOR LATER:

DOWNLOADED tiff FROM http://www.libtiff.org
AT THIS PAGE ftp://ftp.remotesensing.org/pub/libtiff

mkdir /nethome/syoung/base/apps/R/tiff
cd /nethome/syoung/base/apps/R/tiff
wget ftp://ftp.remotesensing.org/pub/libtiff/tiff-3.9.4.tar.gz
tar xfvz *gz
cd /nethome/syoung/base/apps/R/tiff/tiff-3.9.4
mkdir /nethome/syoung/base/apps/R/tiff/3.9.4
./configure --prefix=/nethome/syoung/base/apps/R/tiff/3.9.4
make
make install
    
    ...
    make[2]: Nothing to be done for `install-exec-am'.
    test -z "/nethome/syoung/base/apps/R/tiff/3.9.4/share/doc/tiff-3.9.4" || /bin/mkdir -p "/nethome/syoung/base/apps/R/tiff/3.9.4/share/doc/tiff-3.9.4"
     /usr/bin/install -c -m 644 COPYRIGHT ChangeLog README README.vms RELEASE-DATE TODO VERSION '/nethome/syoung/base/apps/R/tiff/3.9.4/share/doc/tiff-3.9.4'
    make[2]: Leaving directory `/nethome/syoung/base/apps/R/tiff/tiff-3.9.4'
    make[1]: Leaving directory `/nethome/syoung/base/apps/R/tiff/tiff-3.9.4'

    OK!
    
    
2. INSTALLED R
--------------

DOWNLOADED FROM HERE:

wget http://cran.ms.unimelb.edu.au/src/base/R-2/R-2.9.0.tar.gz


MAKE INSTALL DIRECTORY

mkdir /nethome/syoung/base/apps/R/2.9.0


RUN INSTALL

cd /nethome/syoung/base/apps/R/R-2.9.0

./configure --with-libpng=yes --with-jpeglib=yes --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LIBS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LDFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' FFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' CPPFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'

make

    ...
      unused-classes                    text    html    latex   example
      xtabs                             text    html    latex   example
    ** building package indices ...
    Loading required package: Matrix
    
    Attaching package: 'Matrix'
    
    
            The following object(s) are masked from package:stats :
    
             xtabs 
    
    
            The following object(s) are masked from package:base :
    
             rcond 
    
    * DONE (Matrix)
    make[2]: Leaving directory `/nethome/syoung/base/apps/R/R-2.9.0/src/library/Recommended'
    make[1]: Leaving directory `/nethome/syoung/base/apps/R/R-2.9.0/src/library/Recommended

    OK!






NB: USED ALL FLAGS IN THE END (NOT IF ALL WERE NECESSARY) BECAUSE USING CPPFLAGS ONLY RESULTS IN THIS ERROR:

####./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CPPFLAGS='-I/nethome/syoung/base/apps/R/jpeg/8b/include -L /nethome/syoung/base/apps/R/jpeg/8b/lib -I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'


make

    ...
    rbitmap.c: In function my_png_error:
    rbitmap.c:73: warning: jmpbuf is deprecated (declared at /nethome/syoung/base/apps/R/libpng/1.4.3/include/png.h:1096)
    rbitmap.c: In function R_SaveAsPng:
    rbitmap.c:127: warning: jmpbuf is deprecated (declared at /nethome/syoung/base/apps/R/libpng/1.4.3/include/png.h:1096)
    gcc -std=gnu99 -shared -L/usr/local/lib64 -o R_X11.so dataentry.o devX11.o rotated.o rbitmap.o -lSM -lICE  -L/usr/lib64 -lX11 -lXt -lXmu  -ljpeg -lpng -lz  -L../../../lib -lR -lm 
    /usr/bin/ld: cannot find -ljpeg
    collect2: ld returned 1 exit status


GET MORE INFO FROM ld:

ld -verbose -l jpeg

    ...
    attempt to open /usr/x86_64-redhat-linux/lib64/libjpeg.so failed
    attempt to open /usr/x86_64-redhat-linux/lib64/libjpeg.a failed
    attempt to open /usr/local/lib64/libjpeg.so failed
    attempt to open /usr/local/lib64/libjpeg.a failed
    attempt to open /lib64/libjpeg.so failed
    attempt to open /lib64/libjpeg.a failed
    attempt to open /usr/lib64/libjpeg.so failed
    attempt to open /usr/lib64/libjpeg.a failed
    attempt to open /usr/x86_64-redhat-linux/lib/libjpeg.so failed
    attempt to open /usr/x86_64-redhat-linux/lib/libjpeg.a failed
    attempt to open /usr/lib64/libjpeg.so failed
    attempt to open /usr/lib64/libjpeg.a failed
    attempt to open /usr/local/lib/libjpeg.so failed
    attempt to open /usr/local/lib/libjpeg.a failed
    attempt to open /lib/libjpeg.so failed
    attempt to open /lib/libjpeg.a failed
    attempt to open /usr/lib/libjpeg.so failed
    attempt to open /usr/lib/libjpeg.a failed
    ld: cannot find -ljpeg
    


DISPLAY PNG SUPPORT:

/nethome/syoung/base/apps/R/2.9.0/bin/R

capabilities(what=NULL)

    jpeg      png     tiff    tcltk      X11     aqua http/ftp  sockets 
   FALSE    FALSE    FALSE    FALSE    FALSE    FALSE     TRUE     TRUE 
  libxml     fifo   cledit    iconv      NLS  profmem    cairo 
    TRUE     TRUE     TRUE     TRUE     TRUE    FALSE    FALSE 



SO PNG SUPPORT STILL NOT THERE!!!



NEED X11 FOR PNG AND JPEG SUPPORT:


Re: [R-SIG-Mac] Building R with png and jpeg support
http://www.mail-archive.com/r-sig-mac@stat.math.ethz.ch/msg00131.html

both dll rely on  X11, so to enable capabilities you need to first  
run the X11 window server on your mac and the launch R.
stefano

On 29/set/05, at 04:27, Craig Amundsen wrote:


> Hi -
>
> I recently built R 2.1.1 on a machine running 10.3.9. After
> configuring (based on the suggested line in the R on Mac FAQ I get the
> following summary
>
>   Source directory:          .
>   Installation directory:    /Library/Frameworks
>
>   C compiler:                gcc  -g -O2
>   C++ compiler:              g++  -g -O2
>   Fortran compiler:          g77  -g -O2
>
>   Interfaces supported:      X11, aqua
>   External libraries:        readline, BLAS(generic)
>   Additional capabilities:   PNG, JPEG, iconv, MBCS, NLS
>   Options enabled:           framework, R profiling
>
>   Recommended packages:      yes
>
> Which seems to indicate that I am going to get PNG and JPEG
> capabilities. But after making and installing, when I run capabilities
> I get this result:
>
> amundsen$ echo "capabilities()" | R --slave
>     jpeg      png    tcltk      X11 http/ftp  sockets   libxml      
> fifo
>    FALSE    FALSE    FALSE     TRUE     TRUE     TRUE     TRUE      
> TRUE
>   cledit  IEEE754    iconv
>    FALSE     TRUE     TRUE
>
> It seems that I don't have PNG and jpeg capabilities. I have libpng
> 1.2.8 and jpeg 6b installed in /usr/local/lib and what appear to the
> proper headers in /usr/local/include. Is there some step I'm missing
> in the build process?
>
> TIA for any wisdom anyone can provide
> - Craig





AND LIBPNG IS AVAILABLE HERE:

ll /usr/lib  | grep png

    lrwxrwxrwx   1 root root   18 Mar  5  2010 libpng12.so.0 -> libpng12.so.0.10.0
    -rwxr-xr-x   1 root root 151K Mar 24  2009 libpng12.so.0.10.0
    lrwxrwxrwx   1 root root   16 Mar  5  2010 libpng.so.3 -> libpng.so.3.10.0
    -rwxr-xr-x   1 root root 159K Mar 24  2009 libpng.so.3.10.0

AND png.h IS HERE:

locate png.h

    /usr/lib/syslinux/com32/include/png.h





TRY INSTALLING LIBPNG-DEVEL LIBRARY









NOTES
-----

TESTING DIFFERENT FLAGS

RESULT: ONLY CPPFLAGS NEEDED TO FIND png.h

  CFLAGS      C compiler flags
  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
              nonstandard directory <lib dir>
  LIBS        libraries to pass to the linker, e.g. -l<library>
  CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
              you have headers in a nonstandard directory <include dir>



CFLAGS='-I ...'
---------------

cd /nethome/syoung/base/apps/R/R-2.9.0

####configure with-png=DIR CFLAGS=-IDIR/include

cd /nethome/syoung/base/apps/R/R-2.9.0
###export CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include'


#./configure --with-lib --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' 



LDFLAGS
-------

cd /nethome/syoung/base/apps/R/R-2.9.0

#./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LDFLAGS='-L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'
grep png.h config.log 


cd /nethome/syoung/base/apps/R/R-2.9.0

./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LIBS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'


./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LIBS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LDFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' FFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' CPPFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'
grep png.h config.log 

checking if libpng version >= 1.0.5... [syoung@u03 R-2.9.0]$ grep png.h config.log 
r_cv_header_png_h=yes

    OK!



./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LIBS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LDFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' FFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' 
grep png.h config.log 

    no
    



./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LIBS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LDFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' CPPFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'
grep png.h config.log 
    
    YES
    


./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' LIBS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' CPPFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'
grep png.h config.log 

    YES
    
./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib' CPPFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'
grep png.h config.log 

    YES
    
./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CPPFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'
grep png.h config.log 


*********** SO ONLY CPPFLAGS NEEDED TO FIND png.h *********** 


TRY IT WITH CPPFLAGS FOR jpeglib.h

./configure --with-libpng --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0 CPPFLAGS='-I/nethome/syoung/base/apps/R/jpeg/8b/include -L /nethome/syoung/base/apps/R/jpeg/8b/lib -I/nethome/syoung/base/apps/R/libpng/1.4.3/include  -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib'
grep png.h config.log 
grep jpeglib.h config.log 
    
    checking if libpng version >= 1.0.5... [syoung@u03 R-2.9.0]$ grep png.h config.log 
    r_cv_header_png_h=yes
    [syoung@u03 R-2.9.0]$ grep jpeglib.h config.log 
    r_cv_header_jpeglib_h=yes

    OK!
    



NB: THIS IS THE ACTUAL TEST FOR png.h IN CONFIGURE AS IT IS PRINTED TO THE FILE conftest.c

    
    LIBS=$ac_check_lib_save_LIBS
    fi
    { echo "$as_me:$LINENO: result: $ac_cv_lib_z_main" >&5
    echo "${ECHO_T}$ac_cv_lib_z_main" >&6; }
    if test $ac_cv_lib_z_main = yes; then
      have_png=yes
    else
      have_png=no
    fi
    
      if test "${have_png}" = yes; then
        { echo "$as_me:$LINENO: checking if libpng version >= 1.0.5" >&5
    echo $ECHO_N "checking if libpng version >= 1.0.5... $ECHO_C" >&6; }
    if test "${r_cv_header_png_h+set}" = set; then
      echo $ECHO_N "(cached) $ECHO_C" >&6
    else
      cat >conftest.$ac_ext <<_ACEOF                                                                                                   
    /* confdefs.h.  */                                                                                                                 
    _ACEOF                                                                                                                             
    cat confdefs.h >>conftest.$ac_ext
    cat >>conftest.$ac_ext <<_ACEOF                                                                                                    
    /* end confdefs.h.  */                                                                                                             
    #include <png.h>                                                                                                                   
    #if (PNG_LIBPNG_VER >= 10005)                                                                                                      
      yes                                                                                                                              
    #endif
    
    _ACEOF 


WHICH IS PRETTY MUCH THE SAME AS:

emacs R.m4

    ...
    ## _R_HEADER_PNG
    ## -------------
    ## Set shell variable r_cv_header_png_h to 'yes' if a recent enough
    ## 'png.h' is found, and to 'no' otherwise.
    AC_DEFUN([_R_HEADER_PNG],
    [AC_CACHE_CHECK([if libpng version >= 1.0.5],
                    [r_cv_header_png_h],
    AC_EGREP_CPP([yes],
    [#include <png.h>
    #if (PNG_LIBPNG_VER >= 10005)
      yes
    #endif
    ],
                 [r_cv_header_png_h=yes],
                 [r_cv_header_png_h=no]))
    ])# _R_HEADER_PNG
    ...



AND RESULTS IN THIS ERROR:

configure:43935: checking if libpng version >= 1.0.5
conftest.c:202:17: error: png.h: No such file or directory

    
AND THE OUTPUT IS:

    ...
    config.status: executing libtool commands
    config.status: executing po-directories commands
    config.status: creating po/POTFILES
    config.status: creating po/Makefile
    config.status: executing stamp-h commands
    
    R is now configured for x86_64-unknown-linux-gnu
    
      Source directory:          .
      Installation directory:    /nethome/syoung/base/apps/R/2.9.0
    
      C compiler:                gcc -std=gnu99  -I/nethome/syoung/base/apps/R/libpng/1.4.3/include
      Fortran 77 compiler:       gfortran  -g -O
    
      C++ compiler:              g++  -g -O2
      Fortran 90/95 compiler:    gfortran -g -O
      Obj-C compiler:             
    
      Interfaces supported:      X11
      External libraries:        readline
      Additional capabilities:   iconv, MBCS, NLS
      Options enabled:           shared R library, shared BLAS, R profiling, Java
    
      Recommended packages:      yes
    
    configure: WARNING: you cannot build DVI versions of the R manuals
    configure: WARNING: you cannot build DVI versions of all the help pages
    configure: WARNING: you cannot build info or HTML versions of the R manuals
    configure: WARNING: you cannot build PDF versions of the R manuals
    configure: WARNING: you cannot build PDF versions of all the help pages


AND THE RELEVANT ENTRY IN config.log IS AS FOLLOWS:

    ...
    configure:43926: result: yes
    configure:43935: checking if libpng version >= 1.0.5
    conftest.c:202:17: error: png.h: No such file or directory
    configure:43961: result: no
    configure:44066: checking rpc/types.h usability
    configure:44083: gcc -std=gnu99 -c -I/nethome/syoung/base/apps/R/libpng/1.4.3/include -fpic  -I/usr/\
    local/include  conftest.c >&5
    configure:44089: $? = 0
    configure:44103: result: yes
    ...



DISPLAY PNG SUPPORT:

/nethome/syoung/base/apps/R/2.9.0/bin/R

capabilities(what=NULL)

    NOPE
    
    
    
USE export LDFLAGS='-L...'

you really don't use LDFLAGS with ./configure
./configure determines LDFLAGS by examining various config files for libraries and writes those flags to the Makefile 
it May be possible to set some LDFLAGS by using
export LDFLAGS='-L/some/path'
then in the same shell 
./configure
i'm not sure
you certainly can controll
CFLAGS that way

sometimes it's easy to just change the Makefile after configure has made it 
if it's not working



cd /nethome/syoung/base/apps/R/R-2.9.0

export LDFLAGS='-L/nethome/syoung/base/apps/R/libpng/1.4.3/include -L/nethome/syoung/base/apps/R/libpng/1.4.3/lib -L/nethome/syoung/base/apps/R/libpng/1.4.3'
export CFLAGS='-I/nethome/syoung/base/apps/R/libpng/1.4.3/include -I/nethome/syoung/base/apps/R/libpng/1.4.3/lib -I/nethome/syoung/base/apps/R/libpng/1.4.3'

./configure --with-lib --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0


##./configure --with-lib --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0





GIVES ERROR WITH GCC EXECUTION

checking for gcc... gcc
checking for C compiler default output file name... 
configure: error: C compiler cannot create executables
See `config.log' for more details.
[syoung@u01 R-2.9.0]$ 

INCLUDE PRE-INSTALLED png.h

export LDFLAGS=/nethome/syoung/base/apps/R/libpng/1.4.3:/nethome/syoung/base/apps/R/jpeg/8b 

export LIBS=/nethome/syoung/base/apps/R/libpng/1.4.3:/nethome/syoung/base/apps/R/jpeg/8b 
./configure --with-lib --with-jpeglib --enable-R-shlib --prefix=/nethome/syoung/base/apps/R/2.9.0

echo; grep jpeg config.log; echo ; grep png config.log



make clean
make

    ...
    unpack                            text    html    latex   example
    unused-classes                    text    html    latex   example
    xtabs                             text    html    latex   example
    ** building package indices ...
    Loading required package: Matrix
    
    Attaching package: 'Matrix'
    
    
          The following object(s) are masked from package:stats :
    
           xtabs 
    
    
          The following object(s) are masked from package:base :
    
           rcond 
    
    * DONE (Matrix)
    make[2]: Leaving directory `/nethome/syoung/base/apps/R/R-2.9.0/src/library/Recommended'
    make[1]: Leaving directory `/nethome/syoung/base/apps/R/R-2.9.0/src/library/Recommended'

    OK!



THE INSTALLED R BINARY IS HERE:

/nethome/syoung/base/apps/R/2.9.0/bin/R





CHECK CONFIG LOG TO SHOW THAT PNG AND JPEG HEADERS NOT FOUND:

em config.log

    configure:43748: checking if jpeglib version >= 6b
    conftest.c:203:21: error: jpeglib.h: No such file or directory
    configure:43774: result: no
    configure:43865: checking for main in -lz
    configure:43902: gcc -std=gnu99 -o conftest -g -O2 -fpic  -I/usr/local/include  -L/usr/local/lib64 c\
    onftest.c -lz  -ldl -lm  >&5
    configure:43908: $? = 0
    configure:43926: result: yes
    configure:43935: checking if libpng version >= 1.0.5
    conftest.c:203:17: error: png.h: No such file or directory
    configure:43961: result: no


DISPLAY PNG SUPPORT:

capabilities(what=NULL)

    jpeg      png     tiff    tcltk      X11     aqua http/ftp  sockets 
   FALSE    FALSE    FALSE    FALSE    FALSE    FALSE     TRUE     TRUE 

  libxml     fifo   cledit    iconv      NLS  profmem    cairo 
    TRUE     TRUE     TRUE     TRUE     TRUE    FALSE    FALSE 


TEST PNG SUPPORT:

x <- c(1,2,3) 
y <- c(2,4,6) 
plot(x,y) 
png(file="myplot.png", bg="transparent") 


    Error in X11(paste("png::", filename, sep = ""), width, height, pointsize,  : 
      unable to start device PNG
    In addition: Warning message:
    In png(file = "myplot.png", bg = "transparent") :
      no png support in this version of R
  



3. INSTALLED R2HTML
-------------------

TO AVOID THIS ERROR:

library("PIQA")

    Loading required package: R2HTML
    Error: package 'R2HTML' could not be loaded
    In addition: Warning message:
    In library(pkg, character.only = TRUE, logical.return = TRUE, lib.loc = lib.loc) :
      there is no package called 'R2HTML'

    
FILE IS HERE:
wget https://r-forge.r-project.org/src/contrib/R2HTML_1.60-1.tar.gz

GET R PROMPT:
/nethome/syoung/base/apps/R/2.9.0/bin/R

AT R PROMPT:
install.packages("R2HTML", repos="http://R-Forge.R-project.org")

    ** building package indices ...
    * DONE (R2HTML)
    
    The downloaded packages are in
            /tmp/RtmpjMG3LI/downloaded_packages
    Updating HTML index of packages in '.Library'

    OK!





2. INSTALLED PIQA v1.0
----------------------

mkdir /nethome/syoung/base/apps/piqa
cd /nethome/syoung/base/apps/piqa
wget http://bioinfo.uh.edu/PIQA/PIQA_1.0_R_x86_64-redhat-linux-gnu.tar.gz


ON COMMAND LINE:

/nethome/syoung/base/apps/R/2.9.0/bin/R CMD INSTALL /nethome/syoung/base/apps/piqa/PIQA_1.0_R_x86_64-redhat-linux-gnu.tar.gz

* Installing to library /nethome/syoung/base/apps/R/2.9.0/library
* Installing *binary* package PIQA ...
* DONE (PIQA)

CHECK INSTALLED

/nethome/syoung/base/apps/R/2.9.0/bin/R

library("PIQA")
type_of_data="fastq"; in_d="s_1_sequence.txt"; out_d=getwd() ;lane=1;


3. COPIED PIQA EXAMPLE DATA TO R'S WORKING DIR
----------------------------------------------

GET R'S WORKING DIR:

> getwd()
[1] "/nethome/syoung/base/apps/R/2.9.0"

COPY FILE:

cd /nethome/syoung/base/apps/R/2.9.0
cp /scratch/syoung/base/pipeline/piqa/s_1_sequence.txt ./



4. RAN PIQA WITH EXAMPLE FASTQ FILE
-----------------------------------
http://bioinfo.uh.edu/PIQA/


GET R PROMPT:

/nethome/syoung/base/apps/R/2.9.0/bin/R

AT R PROMPT:

library("PIQA")
type_of_data="fastq"; in_d="s_1_sequence.txt"; out_d=getwd() ;lane=1;
PIQA_rpt(type_of_data,in_d,out_d,lane)

    do_fastq --> Loading data...
    do_fastq --> Writing data into a file...
    do_fastq --> qtyRpt.csv created in /nethome/syoung/base/apps/R/2.9.0/
    Error in X11(paste("png::", filename, sep = ""), width, height, pointsize,  : 
      unable to start device PNG
    In addition: Warning message:
    In png(graph) : no png support in this version of R


> type_of_data="fastq"; in_d="s_1_sequence.txt"; out_d=getwd() ;lane=1;
> PIQA_rpt(type_of_data,in_d,out_d,lane)
do_fastq --> Loading data...
do_fastq --> Writing data into a file...
do_fastq --> qtyRpt.csv created in /nethome/syoung/base/apps/R/2.9.0/
mkdir: cannot create directory `/nethome/syoung/base/apps/R/2.9.0/PIQA_report_files': File exists
mkdir: cannot create directory `/nethome/syoung/base/apps/R/2.9.0/prpRpt_files': File exists
mkdir: cannot create directory `/nethome/syoung/base/apps/R/2.9.0/qtyRpt_files': File exists
Error in X11(paste("png::", filename, sep = ""), width, height, pointsize,  : 
  unable to start device PNG
In addition: Warning message:
In png(graph) : print "print "\n";\n";



Although the R implementation allows the user direct interaction with all the functions defined in the package, our intention was to provide the user with a "push-button" application. In this way all the user has to do is to type at R's prompt:

PIQA_rpt(data_format, in_d, out_d, lane)










NOTES
-----


1. INSTALLED R VERSION 2.11.1 BUT FOUND WAS INCOMPATIBLE WITH PIQA
http://cran.r-project.org/doc/manuals/R-admin.html#Installing-R-under-Unix_002dalikes


INSTALL VERSION 2.9 TO AVOID THIS ERROR:

> library("PIQA")
Error: package 'PIQA' was built before R 2.10.0: please re-install it





2. TRIED TO INSTALL pdf MAKER BUT GO THIS ERROR


make pdf
    
    ...
    make[4]: Leaving directory `/nethome/syoung/base/apps/R/2.9.0/src/library'
    make[3]: Leaving directory `/nethome/syoung/base/apps/R/2.9.0/src/library'
    ERROR: 'pdflatex' needed but missing on your system.
    make[2]: *** [refman.pdf] Error 1
    make[2]: Leaving directory `/nethome/syoung/base/apps/R/2.9.0/doc/manual'
    make[1]: *** [pdf] Error 2
    make[1]: Leaving directory `/nethome/syoung/base/apps/R/2.9.0/doc'
    make: [pdf] Error 2 (ignored)



3. 


PIQA.so INSTALL PROBLEM

ERROR

Loading required package: brew
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared library '/nethome/syoung/base/apps/R/2.9.0/library/PIQA/libs/PIQA.so':
  libR.so: cannot open shared object file: No such file or directory
Error: package/namespace load failed for 'PIQA'


SOLUTION 

REINSTALLED R WITH ./configure --enable-R-shlib 

The key to the error message 
> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
> unable to load shared library "/usr/lib/R/library/acepack/libs/acepack.so": 
> libR.so: cannot open shared object file: No such file or directory 
> Error in library(acepack) : .First.lib failed 
is the libR.so. That means that at some stage you compiled R with the 
--enable-R-shlib flag and built libR.so. Then, when you installed a 
new version of R, you did not use the --enable-R-shlib flag. So 
libR.so was not built. But when a package is installed and libR.so 
exists, that package is linked against the libR.so. So when that 
previously compiled package is loaded into the new R that has no 
libR.so, you get the error message you are seeing. 
To get around this problem, either re-install the packages from source 
as you mention or rebuild R with the --enable-R-shlib flag passed to 
configure. I agree this is annoying. It is a natural issue when we 
have component based software; both a blessing and a curse.


./configure --enable-R-shlib 
make clean
make

    OK!



R VERSION 2.11.1 INSTALLATION
-----------------------------

NB: CAN BUILD IN ANOTHER DIRECTORY
http://cran.r-project.org/doc/manuals/R-admin.html#Installing-R-under-Unix_002dalikes
To build in BUILDDIR, run
    cd BUILDDIR
    TOP_SRCDIR/configure
    make


mkdir /nethome/syoung/base/apps/R
cd /nethome/syoung/base/apps/R
wget http://cran.ms.unimelb.edu.au/src/base/R-2/R-2.11.1.tar.gz

./configure

    config.status: creating po/POTFILES
    config.status: creating po/Makefile
    config.status: executing stamp-h commands
    
    R is now configured for x86_64-unknown-linux-gnu
    
      Source directory:          .
      Installation directory:    /usr/local
    
      C compiler:                gcc -std=gnu99  -g -O2
      Fortran 77 compiler:       gfortran  -g -O
    
      C++ compiler:              g++  -g -O2
      Fortran 90/95 compiler:    gfortran -g -O
      Obj-C compiler:             
    
      Interfaces supported:      X11
      External libraries:        readline
      Additional capabilities:   NLS
      Options enabled:           shared BLAS, R profiling, Java
    
      Recommended packages:      yes
    
    configure: WARNING: you cannot build DVI versions of the R manuals
    configure: WARNING: you cannot build DVI versions of all the help pages
    configure: WARNING: you cannot build info or HTML versions of the R manuals
    configure: WARNING: you cannot build PDF versions of the R manuals
    configure: WARNING: you cannot build PDF versions of all the help pages

make

    <10 MINUTES>
    ...
    installing to /nethome/syoung/base/apps/R/R-2.11.1/library/mgcv/libs
    ** R
    ** inst
    ** preparing package for lazy loading
    ** help
    *** installing help indices
    ** building package indices ...
    ** testing if installed package can be loaded
    
    * DONE (mgcv)
    make[2]: Leaving directory `/nethome/syoung/base/apps/R/R-2.11.1/src/library/Recommended'
    make[1]: Leaving directory `/nethome/syoung/base/apps/R/R-2.11.1/src/library/Recommended'
    

THE INSTALLED R BINARY IS HERE:

/nethome/syoung/base/apps/R/R-2.11.1/bin/R



R README
--------

                        INSTALLING R UNDER UNIX


This document concerns building and installing R from sources.  Pre-made
binaries are made available for some systems with varying regularity and
can be obtained from CRAN (see the RESOURCES file).

The main source of information on installation is the `R Installation
and Administration Manual', an HTML copy of which is available as file
`doc/html/R-admin.html'.  Please read that before installing R.  But
if you are impatient, read on but please refer to the manual to
resolve any problems.  (If you obtained R using Subversion, the manual
is at doc/manual/R-admin.texi.)


SIMPLE COMPILATION

As you are reading this file, you have unpacked the R sources and are
presumably in the top directory.  Issue the following commands:

        ./configure
        make

(If your make is not called `make', set the environment variable MAKE to
its name, and use that name throughout these instructions.)
This will take a while, giving you time to read `R-admin.html'.

Then check the built system worked correctly, by

        make check

and make the manuals by (as many options as preferred from)

        make dvi        to create DVI versions
        make pdf        to create PDF versions
        make info       to create info files

However, please read the notes in `R-admin.html' about making the
reference manual.


INSTALLATION

You do not need to install R to run it: you can run R by the script
`bin/R' which you can link or copy to any convenient place in your path.

For a site-wide installation, use

        make install
        make install-dvi
        make install-info
        make install-pdf

choosing to install the manuals that you made.

This installs to the default location (typically `/usr/local') for your
platform: see the Installation and Administration Manual for other options.




4. SPECIFYING LOCATION OF LIBPNG AND JPEG WHEN USING configure

USE THESE OPTIONS

  --with-lib           use libpng library (if available) [yes]
  --with-jpeglib          use jpeglib library (if available) [yes]

E.G.:

./configure --with-lib=/nethome/syoung/base/apps/R/libpng/1.4.3 --prefix=/PATH/TO/INSTALL


./configure --help


`configure' configures R 2.9.0 to adapt to many kinds of systems.

Usage: ./configure [OPTION]... [VAR=VALUE]...

To assign environment variables (e.g., CC, CFLAGS...), specify them as
VAR=VALUE.  See below for descriptions of some of the useful variables.

Defaults for the options are specified in brackets.

Configuration:
  -h, --help              display this help and exit
      --help=short        display options specific to this package
      --help=recursive    display the short help of all the included packages
  -V, --version           display version information and exit
  -q, --quiet, --silent   do not print `checking...' messages
      --cache-file=FILE   cache test results in FILE [disabled]
  -C, --config-cache      alias for `--cache-file=config.cache'
  -n, --no-create         do not create output files
      --srcdir=DIR        find the sources in DIR [configure dir or `..']

Installation directories:
  --prefix=PREFIX         install architecture-independent files in PREFIX
                          [/usr/local]
  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
                          [PREFIX]

By default, `make install' will install all the files in
`/usr/local/bin', `/usr/local/lib' etc.  You can specify
an installation prefix other than `/usr/local' using `--prefix',
for instance `--prefix=$HOME'.

For better control, use the options below.

Fine tuning of the installation directories:
  --bindir=DIR           user executables [EPREFIX/bin]
  --sbindir=DIR          system admin executables [EPREFIX/sbin]
  --libexecdir=DIR       program executables [EPREFIX/libexec]
  --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
  --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
  --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
  --libdir=DIR           object code libraries [EPREFIX/lib]
  --includedir=DIR       C header files [PREFIX/include]
  --oldincludedir=DIR    C header files for non-gcc [/usr/include]
  --datarootdir=DIR      read-only arch.-independent data root [PREFIX/share]
  --datadir=DIR          read-only architecture-independent data [DATAROOTDIR]
  --infodir=DIR          info documentation [DATAROOTDIR/info]
  --localedir=DIR        locale-dependent data [DATAROOTDIR/locale]
  --mandir=DIR           man documentation [DATAROOTDIR/man]
  --docdir=DIR           documentation root [DATAROOTDIR/doc/R]
  --htmldir=DIR          html documentation [DOCDIR]
  --dvidir=DIR           dvi documentation [DOCDIR]
  --pdfdir=DIR           pdf documentation [DOCDIR]
  --psdir=DIR            ps documentation [DOCDIR]

R installation directories:
  --libdir=DIR        R files to R_HOME=DIR/R [EPREFIX/$LIBnn]
    rdocdir=DIR       R doc files to DIR      [R_HOME/doc]
    rincludedir=DIR   R include files to DIR  [R_HOME/include]
    rsharedir=DIR     R share files to DIR    [R_HOME/share]

X features:
  --x-includes=DIR    X include files are in DIR
  --x-libraries=DIR   X library files are in DIR

System types:
  --build=BUILD     configure for building on BUILD [guessed]
  --host=HOST       cross-compile to build programs to run on HOST [BUILD]

Optional Features:
  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
  --enable-R-profiling    attempt to compile support for Rprof() [yes]
  --enable-memory-profiling
                          attempt to compile support for Rmemprof(),
                          tracemem() [no]
  --enable-R-framework[=DIR]
                          MacOS X only: build R framework (if possible), and
                          specify its installation prefix [yes,
                          /Library/Frameworks]
  --enable-R-shlib        build the shared/dynamic library 'libR' [no]
  --enable-R-static-lib   build the static library 'libR.a' [no]
  --enable-BLAS-shlib     build BLAS into a shared library [perhaps]
  --enable-maintainer-mode
                          enable make rules and dependencies not useful (and
                          maybe confusing) to the casual installer [no]
  --enable-strict-barrier provoke compile error on write barrier violation
                          [no]
  --enable-mbcs           enable support for UTF-8 and other MBCS locales
                          [yes]
  --enable-static[=PKGS]  build static libraries [default=no]
  --enable-shared[=PKGS]  build shared libraries [default=yes]
  --enable-fast-install[=PKGS]
                          optimize for fast installation [default=yes]
  --disable-libtool-lock  avoid locking (might break parallel builds)
  --disable-largefile     omit support for large files
  --disable-nls           do not use Native Language Support
  --enable-threads={posix|solaris|pth|win32}
                          specify multithreading API
  --disable-threads       build without multithread safety
  --disable-rpath         do not hardcode runtime library paths

Optional Packages:
  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
  --with-blas             use system BLAS library (if available), or specify
                          it [no]
  --with-lapack           use system LAPACK library (if available), or specify
                          it [no]
  --with-readline         use readline library [yes]
  --with-aqua             MacOS X only: use Aqua (if available) [yes]
  --with-tcltk            use Tcl/Tk (if available), or specify its library
                          dir [yes]
  --with-tcl-config=TCL_CONFIG
                          specify location of tclConfig.sh []
  --with-tk-config=TK_CONFIG
                          specify location of tkConfig.sh []
  --with-cairo            use cairo (and pango) if available [yes]
  --with-lib           use libpng library (if available) [yes]
  --with-jpeglib          use jpeglib library (if available) [yes]
  --with-system-zlib      use system zlib library (if available) [no]
  --with-system-bzlib     use system bzlib library (if available) [no]
  --with-system-pcre      use system PCRE library (if available) [no]
  --with-valgrind-instrumentation
                          Level of additional instrumentation for Valgrind
                          (0/1/2) [0]
  --with-recommended-packages
                          use/install recommended R packages [yes]
  --with-iconv            use iconv library [yes]
  --with-ICU              use ICU library [yes]
  --with-pic              try to use only PIC/non-PIC objects [default=use
                          both]
  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
  --with-x                use the X Window System
  --with-gnu-ld           assume the C compiler uses GNU ld default=no
  --with-libpth-prefix[=DIR]  search for libpth in DIR/include and DIR/lib
  --without-libpth-prefix     don't search for libpth in includedir and libdir
  --with-included-gettext use the GNU gettext library included here
  --with-libintl-prefix[=DIR]  search for libintl in DIR/include and DIR/lib
  --without-libintl-prefix     don't search for libintl in includedir and libdir

Some influential environment variables:
  R_PRINTCMD  command used to spool PostScript files to the printer
  R_PAPERSIZE paper size for the local (PostScript) printer
  R_BATCHSAVE set default behavior of R when ending a session
  MAIN_CFLAGS additional CFLAGS used when compiling the main binary
  SHLIB_CFLAGS
              additional CFLAGS used when building shared libraries
  MAIN_FFLAGS additional FFLAGS used when compiling the main binary
  SHLIB_FFLAGS
              additional FFLAGS used when building shared libraries
  MAIN_LD     command used to link the main binary
  MAIN_LDFLAGS
              flags which are necessary for loading a main program which will
              load shared library modules (DLLs) at runtime
  CPICFLAGS   special flags for compiling C code to be turned into a shared
              library.
  FPICFLAGS   special flags for compiling Fortran code to be turned into a
              shared library.
  FCPICFLAGS  special flags for compiling Fortran 95 code to be turned into a
              shared library.
  SHLIB_LD    command for linking shared libraries which contain object files
              from a C or Fortran compiler only
  SHLIB_LDFLAGS
              special flags used by SHLIB_LD
  DYLIB_LD    command for linking dynamic libraries which contain object files
              from a C or Fortran compiler only
  DYLIB_LDFLAGS
              special flags used for make a dynamic library
  CXXPICFLAGS special flags for compiling C++ code to be turned into a shared
              library
  SHLIB_CXXLD command for linking shared libraries which contain object files
              from a C++ compiler
  SHLIB_CXXLDFLAGS
              special flags used by SHLIB_CXXLD
  SHLIB_FCD   command for linking shared libraries which contain object files
              from the Fortran 95 compiler
  SHLIB_FCLDFLAGS
              special flags used by SHLIB_FCLD
  TCLTK_LIBS  flags needed for linking against the Tcl and Tk libraries
  TCLTK_CPPFLAGS
              flags needed for finding the tcl.h and tk.h headers
  MAKE        Make command
  R_BROWSER   default browser
  BLAS_LIBS   flags needed for linking against external BLAS libraries
  LAPACK_LIBS flags needed for linking against external LAPACK libraries
  LIBnn       'lib' or 'lib64' for dynamic libraries
  SAFE_FFLAGS Safe Fortran 77 compiler flags for e.g. dlamc.f
  r_arch      Use architecture-dependent subdirs with this name
  DEFS        C defines for use when compiling R
  JAVA_HOME   Path to the root of the Java environment
  R_SHELL     shell to be used for shell scripts, including 'R'
  YACC        The `Yet Another C Compiler' implementation to use. Defaults to
              the first program found out of: `bison -y', `byacc', `yacc'.
  YFLAGS      The list of arguments that will be passed by default to $YACC.
              This script will default YFLAGS to the empty string to avoid a
              default value of `-d' given by some make applications.
  CC          C compiler command
  CFLAGS      C compiler flags
  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
              nonstandard directory <lib dir>
  LIBS        libraries to pass to the linker, e.g. -l<library>
  CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
              you have headers in a nonstandard directory <include dir>
  CPP         C preprocessor
  F77         Fortran 77 compiler command
  FFLAGS      Fortran 77 compiler flags
  CXX         C++ compiler command
  CXXFLAGS    C++ compiler flags
  CXXCPP      C++ preprocessor
  OBJC        Objective C compiler command
  OBJCFLAGS   Objective C compiler flags
  XMKMF       Path to xmkmf, Makefile generator for X Window System
  FC          Fortran compiler command
  FCFLAGS     Fortran compiler flags


Use these variables to override the choices made by `configure' or to help
it to find libraries and programs with nonstandard names/locations.








</entry>



<entry [Fri Sep  9 10:51:00 EDT 2010] GET AVERAGE QUALITY DISTRIBUTIONS OF 'PERFECT' BOWTIE PAPER DATA SET>



/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.fastq \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa
    

    averageQuality.pl    outputfile: /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.avqual
    averageQuality.pl    outfile: /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.avqual
    averageQuality.pl    Doing bins: -50 -40 -30 -20 -10 0 1 2 3 4 5 6 7 8 9 10 15 20 30 40 50 60 70 80 90 100 200 300
    0
    
    1000000
    2000000
    3000000
    4000000
    5000000
    6000000
    7000000
    8000000
    9000000
    averageQuality.pl    total: 34190669.1276228
    averageQuality.pl    Printing statsfile
    data bins: 0 0 0 0 0 141583 696692 1247887 1713997 1702575 1472041 1192722 812072 345880 72512 0 0 0 0 0 0 0 0 0 0 0 0 0
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       141583
    1       696692
    2       1247887
    3       1713997
    4       1702575
    5       1472041
    6       1192722
    7       812072
    8       345880
    9       72512
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0
    averageQuality.pl::average_qualities    statsfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.qualstats
    
    
    Run time: 00:04:06
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    1:42PM, 9 September 2010
    ****************************************
    
    



DOWNLOADED TEST DATA SET FROM 'PIQA'
------------------------------------

mkdir /scratch/syoung/base/pipeline/piqa
cd /scratch/syoung/base/pipeline/piqa
wget http://bioinfo.uh.edu/PIQA/fastq_example.zip
unzip fastq_example.zip
    
    inflating: s_1_sequence.txt

ll

    -rw-rw-r-- 1 syoung root 110M Feb 17  2009 fastq_example.zip
    -rwxr-xr-x 1 syoung root 524M Nov  7  2008 s_1_sequence.txt

head *txt
    @HWI-EAS236_3_FC203BMAAXX:1:1:337:395
    TCACTGATGCTGCTTCTGGCGTGGTTGATAT
    +HWI-EAS236_3_FC203BMAAXX:1:1:337:395
    [SS[[S[SS[SSSSSWSOIOO[S[[[S[SWY
    @HWI-EAS236_3_FC203BMAAXX:1:1:572:181
    TGTGGCTAAATACGTTAACCAAAAGTCAGAT
    +HWI-EAS236_3_FC203BMAAXX:1:1:572:181
    Y]]]]]]Y]Y]]]]X]S]]I]YYA]]]Y]P]
    @HWI-EAS236_3_FC203BMAAXX:1:1:470:116
    GATTTTCTGACGAGTAACAAAGTTTGGATTG

tail *txt
    +HWI-EAS236_3_FC203BMAAXX:1:300:1001:194
    TVVERQVRKQTQCIVE?C?????????????
    @HWI-EAS236_3_FC203BMAAXX:1:300:503:830
    CGGTGGCATTCAAGGCGATGTGCTTGCTACC
    +HWI-EAS236_3_FC203BMAAXX:1:300:503:830
    Y]]]]]]]]]]]P]]S]U]]]X]]]X]]]]A
    @HWI-EAS236_3_FC203BMAAXX:1:300:554:348
    CCGCCGCGTGAAATTTCTATGAAGGATGTTT
    +HWI-EAS236_3_FC203BMAAXX:1:300:554:348
    VTSV[[TTOSTQQITCIKQDKIKEIDDQKKD

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/piqa/s_1_sequence.txt \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type solexa



[syoung@u02 piqa]$ /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
> --inputfile /scratch/syoung/base/pipeline/piqa/s_1_sequence.txt \
> --bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
> --type solexa
averageQuality.pl    outputfile: /scratch/syoung/base/pipeline/piqa/s_1_sequence.txt.avqual
averageQuality.pl    outfile: /scratch/syoung/base/pipeline/piqa/s_1_sequence.txt.avqual
total reads     3835812
0       28.1239805287642
1       28.0674389151502
2       27.8827927437528
3       28.0264668862812
4       27.9488429047096
5       27.9047101369932
6       27.89501258143
7       27.7897373489629
8       27.6307290346868
9       27.5071228725495
10      27.4264202729435
11      27.3888715088226
12      27.0114153144106
13      26.9085088111722
14      26.90991972495
15      26.6042553701798
16      26.5755905138208
17      26.4067602896075
18      26.1356476803347
19      25.9521809202328
20      25.5758694638841
21      25.5196930923622
22      25.3208684367221
23      24.9602316276189
24      25.0475922699027
25      24.6350410291224
26      24.5660644995114
27      24.2804365803121
28      24.2656694332256
29      23.8656936262778
30      21.3300959483937
averageQuality.pl::average_qualities    outputfile printed:

/scratch/syoung/base/pipeline/piqa/s_1_sequence.txt.avqual

averageQuality.pl::average_qualities    basequalfile printed:

/scratch/syoung/base/pipeline/piqa/s_1_sequence.txt.basequal

averageQuality.pl    Doing bins: -50 -40 -30 -20 -10 0 1 2 3 4 5 6 7 8 9 10 15 20 30 40 50 60 70 80 90 100 200 300
0
1000000
2000000
3000000
averageQuality.pl    total: 100902106.258038
averageQuality.pl    Printing statsfile
data bins: 0 0 0 0 0 0 0 0 0 0 1 3 42 160 441 808 16655 172921 3644724 57 0 0 0 0 0 0 0 0
-50     0
-40     0
-30     0
-20     0
-10     0
0       0
1       0
2       0
3       0
4       0
5       1
6       3
7       42
8       160
9       441
10      808
15      16655
20      172921
30      3644724
40      57
50      0
60      0
70      0
80      0
90      0
100     0
200     0
300     0
averageQuality.pl::average_qualities    statsfile printed:

/scratch/syoung/base/pipeline/piqa/s_1_sequence.txt.qualstats


    Run time: 00:13:30
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    3:09PM, 10 September 2010
    ****************************************




    
TEST WITH ELAND_standalone.pl




head /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.fastq

    @SRR001115.1 2044KAAXX:7:1:120:526 length=47
    TTACTGGCATTGAGATGGTGTGTGCTATGGCTCTTTGAAATCTTTTA
    +SRR001115.1 2044KAAXX:7:1:120:526 length=47
    II=I->II0%+I6II@IIII+4IIIB*&*0%'*<II>I:II(I&II$
    @SRR001115.2 2044KAAXX:7:1:116:171 length=47
    TGGGGGTATCATCAGTGTAAAGATAGGATCTGAAGCCATGATAATTT
    +SRR001115.2 2044KAAXX:7:1:116:171 length=47
    IIIIIIIIIIIII@IIIIIIII0IIIIIIIIIII&IIHII1.%-III
    @SRR001115.3 2044KAAXX:7:1:101:763 length=47
    TTTGAGATGCCATGAGGAATCTTGTTAGTATTGCTTATTATTTTTTT


mkdir /scratch/syoung/base/pipeline/SRA/NA12878/eland
cd /scratch/syoung/base/pipeline/SRA/NA12878/eland


/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.fastq



Could not identify pair information of the following line: SRR001115.1 2044KAAXX:7:1:120:526 length=47 
Please check your files.



mkdir /scratch/syoung/base/pipeline/SRA/NA12878/simpleheader
cd /scratch/syoung/base/pipeline/SRA/NA12878/simpleheader





/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.fastq \
--outputfile /scratch/syoung/base/pipeline/SRA/NA12878/simpleheader/SRR001115.simpleHeader.fastq \
--rejectfile /scratch/syoung/base/pipeline/SRA/NA12878/simpleheader/SRR001115.simpleHeader.rejects.fastq


</entry>



<entry [Thu Sep  2 23:06:17 EDT 2010] RUN BOWTIE.pl FOR ALL 100M SAMPLES AGAINST chr22>




RE-RUN LOOP WITH CORRECT simpleHeaders

/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--replicates 1-33 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/%REPLICATE%/bowtie \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-%REPLICATE%.reads_2.sequence.txt \
--distance 200 \
--queue large \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species human \
--label sample%REPLICATE%-bowtie \
--reads 1000000 \
--clean \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/%REPLICATE%/bowtie/chr22/samples.%REPLICATE%-33.bowtie.out 


WHICH RUNS:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie

/nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-1.reads_2.sequence.txt \
--distance 200 \
--queue large \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species human \
--label sample1-bowtie \
--reads 1000000 \
--clean \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/samples.1-33.bowtie.out



</entry>



<entry [Thu Sep  2 23:05:17 EDT 2010] RUN ELAND.pl FOR ALL SAMPLES 1-33 AGAINST chr22>




1. MAKE ALIGNMENT OUTPUT DIRECTORIES FOR INPUT SEQUENCE min3length26-1.reads_1.sequence.txt AND ITS MATE PAIR

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/eland/chr22
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/eland
#### FOLLOWING NOT NECESSARY ARE WERE DONE EARLIER
####cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M
####cp min3length26-1.reads_1.fastq 1/min3length26-1.reads_1.sequence.txt
####cp min3length26-1.reads_2.fastq 1/min3length26-1.reads_2.sequence.txt 


2. RUN ELAND.pl

TEST SAMPLE 3 AGAINST CHROMO 22

DISCOVERED pickBestPair HAS MINIMUM 10% THRESHOLD (UNIQUE ALIGNMENTS) FOR PAIRED ALIGNMENT

    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: only 4.36730 percent of clusters with unique alignment of each read, need 10 percent to do paired alignment


chr22
-----


/nethome/bioinfo/apps/agua/0.5/bin/apps/ELAND.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-3.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-3.reads_2.sequence.txt \
--inputtype fastq \
--species human \
--label sample3-eland \
--maxjobs 1000 \
--queue large \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/eland \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22 \
--cluster LSF \
--cpus 4 \
--reads 1000000


--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/eland/chr22/samples.3-33.eland.out 





TEST RUN TO DETERMINE WHY SO FEW READS ARE BEING MATCHED:


/nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chr22/chr22 \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/eland/1/sample3-eland_1.1.txt \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/eland/1/sample3-eland_2.1.txt \


IT APPEARS THAT ELAND_standalone.pl ABANDONS THE PAIRED ALIGNMENT BECAUSE TOO FEW PAIRED READS AMONG THE INPUT READS MATCH chr22 (A PROBLEM CAUSED BY SPLITTING UP THE GENOME INTO MULTIPLE REFERENCE FILES):

    ...
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: setting circular to Y
    Obtained total genome size of 49591432 bp

*****

    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Found 43673 initial pairs from 1000000 clusters
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: only 4.36730 percent of clusters with unique alignment of each read, need 10 percent to do paired alignment
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Nominal orientation of this sample appears to be Fp


    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: warning - data will be treated as two sets of unpaired reads


****

    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 26 for read 1
    /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/pickBestPair.pl: Deduced read length of 26 for read 2
    Obtained rest-of-genome correction of 2.20230198522131e-08
    Obtained rest-of-genome correction of 2.20230198522131e-08
    Obtained rest-of-genome correction of 4.89009274234081e-24
    0 read 1s were unique
    Resolved a further 0 read 1s with pairing information
    0 read 2s were unique
    Resolved a further 0 read 2s with pairing information
    An extra 0 possible pairings were found using circularization
    Outputting XML summary
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: pickBestPair succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/buildExport.pl --paired --symbolic ./reanalysis_1_calsaf.txt ./reanalysis_1_qseq.txt > ./reanalysis_1_export.txt
    
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: buildExport succeded
    /nethome/syoung/base/apps/casava/1.6.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/casava/1.6.0/bin/../bin/buildExport.pl --paired --symbolic ./reanalysis_2_calsaf.txt ./reanalysis_2_qseq.txt > ./reanalysis_2_export.txt



SOLUTION:

1. ALIGN FEWER READS AGAINST THE WHOLE GENOME

2. ALIGN ALL READS FIRST AS SINGLE READS WITH FRAGMENTED GENOME AND GATHER ALL READS THAT MATCH EACH PARTICULAR CHROMOSOME AND REALIGN THESE READS AS PAIRED END READS


CHOOSE SOLUTION 1 BECAUSE SOLUTION 2 IS OVERKILL



</entry>



<entry [Sat Sep  4 09:44:47 EDT 2010] USE simpleHeaders.pl TO LOOP simpleHeader.pl OVER ALL READS IN ALL DIRECTORIES>



mkdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheaders

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
--clean \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheaders/simpleHeaders.out
    
    Run time: 01:00:18
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeaders.pl
    11:13AM, 4 September 2010
    ****************************************


ALL GOOD EXCEPT (REM: MUST USE clean):

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader

    -rw-rw-rw-  1 syoung root  527638528 Sep  4 10:07 min3length26-6.reads_1.sequence.txt
    -rw-rw-rw-  1 syoung root 6355754558 Sep  4 10:25 min3length26-6.reads_2.sequence.txt


ll /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/min3length26-6.reads_1.fastq \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-6.reads_1.sequence.txt \
--rejectfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/simpleheader/min3length26-6.reads_1.reject.txt \
--matenumber 1


</entry>



<entry [Thu Sep  2 10:28:08 EDT 2010] CREATED simpleHeader.pl TO FORMAT READS AND checkHeader TO DETECT AND EXTRACT MISFORMATTED HEADERS >




simpleHeader.pl FORMATS READS
-----------------------------

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/min3length26-4.reads_1.fastq \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt \
--rejectfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.rejects.txt \
--matenumber 1

    simpleHeader.pl    outputfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt
    
    simpleHeader.pl    rejectfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.rejects.txt
    
    
    Run time: 00:09:44
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl
    8:27AM, 4 September 2010
    ****************************************



TEST:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/tests

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/simpleHeader.pl \
--inputfile test.fastq \
--outputfile test.out \
--rejectfile test.reject \
--matenumber 1


WHERE test.fastq IS:

@SRR002271.28 FC2012M_R1:1:1:881:458#0/1
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28 FC2012M_R1:1:1:881:458#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.28 FC2012M_R1:1:1:881:458
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28 FC2012M_R1:1:1:881:458
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.28 FC2012M_R1:1:1:881:458 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28 FC2012M_R1:1:1:881:458
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
GTATAATTATCTGTAATCCTACAACT
+SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
IIIIIIIIIIIIIIIIIIIIIIIIII


GIVES THIS OUTPUT:

    simpleHeader.pl    Opening normally inputfile: test.fastq
    
    @SRR002271.28:1:1:881:458#7
    GATGATAGTTTCCAATTCACAAAGCT
    +SRR002271.28:1:1:881:458#7
    IIIIIIIIIIIIIIIIIIIIIIIIII
    
    @SRR002271.28:1:1:881:458#7
    GATGATAGTTTCCAATTCACAAAGCT
    +SRR002271.28:1:1:881:458#7
    IIIIIIIIIIIIIIIIIIIIIIIIII
    
    @SRR002271.28:1:1:881:458#7
    GATGATAGTTTCCAATTCACAAAGCT
    +SRR002271.28:1:1:881:458#7
    IIIIIIIIIIIIIIIIIIIIIIIIII
    
    @SRR029336.1000040:4:53:400:163#7
    GTATAATTATCTGTAATCCTACAACT
    +SRR029336.1000040:4:53:400:163#7
    IIIIIIIIIIIIIIIIIIIIIIIIII

    simpleHeader.pl    outputfile printed:
    
    test.out
    
    simpleHeader.pl    rejectfile printed:
    
    test.reject



checkHeader.pl VERIFIES THAT simpleHeader.pl HAS DONE IT'S JOB
--------------------------------------------------------------


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/checkHeader.pl --inputfile test.simpleHeader.fastq --outputfile test.out --rejectfile test.reject

WHERE test.simpleHeader.fastq IS:

@SRR002271.28:1:1:881:458#0/1
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28:1:1:881:458#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.28:1:1:881:458
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28:1:1:881:458
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.28:1:1:881:458 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28:1:1:881:458
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
GTATAATTATCTGTAATCCTACAACT
+SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
IIIIIIIIIIIIIIIIIIIIIIIIII






TO AVOID PROBLEMS LIKE THIS:

head /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/bowtie/chr22/hit.sam
    SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163              141     *       0       0       *       *       0       0       ATGGTGAAGCTGAGATTTGACCTTGG      IIII0A.1CII?64,4B5I2/(/9I*      XM:i:0
    SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163              77      *       0       0       *       *       0       0       ATGGTGAAGCTGAGATTTGACCTTGG      IIII0A.1CII?64,4B5I2/(/9I*      XM:i:0
    SRR029336.1000079 071224_SLXA-B7_0597:4:53:579:556              141     *       0       0       *       *       0       0       TGTGGAAGTTATTATAGGATGTTCTG      IIIIII8IBI9II+$(+D:+<6>$&&      XM:i:0
    SRR029336.1000079 071224_SLXA-B7_0597:4:53:579:556              77      *       0       0       *       *       0       0       TGTGGAAGTTATTATAGGATGTTCTG      IIIIII8IBI9II+$(+D:+<6>$&&      XM:i:0
    SRR029336.1000105 071224_SLXA-B7_0597:4:53:940:306              141     *       0       0       *       *       0       0       TCATCGAATGCAAGCGAATGGAATCT      IIIIIIDIIIII7I;7A<2I56/?(-      XM:i:0
    SRR029336.1000105 071224_SLXA-B7_0597:4:53:940:306              77      *       0       0       *       *       0       0       TCATCGAATGCAAGCGAATGGAATCT      IIIIIIDIIIII7I;7A<2I56/?(-      XM:i:0
    SRR029336.100013 071224_SLXA-B7_0597:4:6:655:954                141     *       0       0       *       *       0       0       TTCAAAAATGAAGGTAAAGTAAGACA      IIIIIIAIII/9I>4I<0I711I5I;      XM:i:0
    SRR029336.100013 071224_SLXA-B7_0597:4:6:655:954                77      *       0       0       *       *       0       0       TTCAAAAATGAAGGTAAAGTAAGACA      IIIIIIAIII/9I>4I<0I711I5I;      XM:i:0
    SRR029336.1000132 071224_SLXA-B7_0597:4:53:220:920              141     *       0       0       *       *       0       0       ATTTTCCTACAAAAAAAAAAAAAACC      IIIIIIIIIIFIIC9I?:I?I7;)HI      XM:i:0
    SRR029336.1000132 071224_SLXA-B7_0597:4:53:220:920              77      *       0       0       *       *       0       0       ATTTTCCTACAAAAAAAAAAAAAACC      IIIIIIIIIIFIIC9I?:I?I7;)HI      XM:i:0


grep -n "071224_SLXA-B7_0597:4:53:400:163" /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt

grep -n "071224_SLXA-B7_0597:4:53:400:163" /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.simpleHeader.txt


chopfile.pl /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt-100 100


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M
grep -n SLX /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt > out

head out

    154948257:@SRR029336.3 071224_SLXA-B7_0597:4:1:458:881                
    154948259:+SRR029336.3 071224_SLXA-B7_0597:4:1:458:881                
    154948261:@SRR029336.50 071224_SLXA-B7_0597:4:1:305:517               
    154948263:+SRR029336.50 071224_SLXA-B7_0597:4:1:305:517               
    154948265:@SRR029336.85 071224_SLXA-B7_0597:4:1:570:344               
    154948267:+SRR029336.85 071224_SLXA-B7_0597:4:1:570:344               
    154948269:@SRR029336.128 071224_SLXA-B7_0597:4:1:461:680 



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M
grep -n SLX min*fastq > grepslx.txt

min3length26-10.reads_1.fastq:154948257:@SRR029336.18 071224_SLXA-B7_0597:4:1:514:570               
min3length26-10.reads_1.fastq:154948259:+SRR029336.18 071224_SLXA-B7_0597:4:1:514:570               
min3length26-10.reads_1.fastq:154948261:@SRR029336.41 071224_SLXA-B7_0597:4:1:391:502               
min3length26-10.reads_1.fastq:154948263:+SRR029336.41 071224_SLXA-B7_0597:4:1:391:502               
min3length26-10.reads_1.fastq:154948265:@SRR029336.76 071224_SLXA-B7_0597:4:1:422:543               
min3length26-10.reads_1.fastq:154948267:+SRR029336.76 071224_SLXA-B7_0597:4:1:422:543               
min3length26-10.reads_1.fastq:154948269:@SRR029336.119 071224_SLXA-B7_0597:4:1:600:800              
min3length26-10.reads_1.fastq:154948271:+SRR029336.119 071224_SLXA-B7_0597:4:1:600:800              
min3length26-10.reads_1.fastq:154948273:@SRR029336.150 071224_SLXA-B7_0597:4:1:503:810





CHECK PROCESSED READ HEADERS WITH sed
-------------------------------------


TEST FILE (GOOD + BAD HEADER):

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/tests
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/tests
emacs test.fastq
@SRR002271.28:1:1:881:458#0/1
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28:1:1:881:458#0/1
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.28:1:1:881:458
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28:1:1:881:458 
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.28:1:1:881:458 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28:1:1:881:458 
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
GTATAATTATCTGTAATCCTACAACT
+SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
IIIIIIIIIIIIIIIIIIIIIIIIII



GETTING RATHER COMPLEX - NEED TO SEPARATE OUT GOOD AND BAD AND PRINT BOTH TO FILE SO SCRAP sed AND USE PERL IN Cluster::simpleHeader WHICH DOES BASICALLY THIS:


#!/usr/bin/perl -w

my $DEBUG = 0;
$DEBUG = 1;

my $file = <ARGV>;
open(FILE, $file) or die "Can't open file: $file\n";
while ( <FILE> )
{
    if ( $_ =~ /^@[A-Z0-9\.]+:[0-9]+:[0-9]+:[0-9]+:[0-9]+#\/[12]/ )
    {
        print "Good read: $_\n" if $DEBUG;
        print STDOUT $_;
        print STDOUT <FILE>;
        print STDOUT <FILE>;
        print STDOUT <FILE>;
    }
    else
    {
        print "Bad read: $_\n" if $DEBUG;
        print STDERR $_;
        print STDERR <FILE>;
        print STDERR <FILE>;
        print STDERR <FILE>;
    }
}
print "Completed $0\n" if $DEBUG;










TEST UNPROCESSED READ HEADERS WITH sed AND egrep
------------------------------------------------


TEST FILE 1 (GOOD HEADER):

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/tests
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/tests
emacs test1.fastq

@SRR002271.28 FC2012M_R1:1:1:881:458 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28 FC2012M_R1:1:1:881:458 
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.40 FC2012M_R1:1:1:764:263 length=26
GTATAATTATCTGTAATCCTACAACT
+SRR002271.40 FC2012M_R1:1:1:764:263
IIIIIIIIIIIIIIIIIIIIIIIIII



USING < THEN | WORKS TO REMOVE THE LENGTH:

sed -e 's/ [A-Za-z0-9\.\_\-]*:\([0-9\:]*[0-9\:]*[0-9\:]*[0-9\:]*\)/:\1#0\/1/' < test1.fastq  | sed -e 's/[ ]*length=[0-9]*[ ]*//' 



TEST FILE 2 (BAD HEADER):

emacs test2.fastq
@SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163
IIIIIIIIIIIIIIIIIIIIIIIIII




CREATE TEST FILE 3 USING egrep TO CHECK FOR MISFORMATTED READ HEADERS (2nd WORD STARTS WITH A NUMBER):


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/tests
emacs test3.fastq
@SRR002271.28 FC2012M_R1:1:1:881:458 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28 FC2012M_R1:1:1:881:458 
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163
IIIIIIIIIIIIIIIIIIIIIIIIII


TEST FOR NON-STANDARD READ HEADERS:

egrep "^@SRR[A-Z0-9\.]+" test3.fastq | egrep "^@SRR[0-9\.]+\s+[0-9]" 



CREATE TEST FILE 4 USING EGREP:


cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/tests
emacs test3.fastq
@SRR002271.28 FC2012M_R1:1:1:881:458 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR002271.28 FC2012M_R1:1:1:881:458 
IIIIIIIIIIIIIIIIIIIIIIIIII
@SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
GATGATAGTTTCCAATTCACAAAGCT
+SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163
IIIIIIIIIIIIIIIIIIIIIIIIII

egrep "^@SRR[A-Z0-9\.]+" test3.fastq | egrep "^@SRR[0-9\.]+\s+[0-9]" 
    @SRR029336.1000040 071224_SLXA-B7_0597:4:53:400:163 length=26
    
    OK!

THIS IS BASED ON THIS ORIGINAL READ FILE:

head /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt-8

    @SRR002271.31 FC2012M_R1:1:1:549:479                        
    GATGTTGAGCATCTTTTCATGTGCTT
    +SRR002271.31 FC2012M_R1:1:1:549:479                        
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR002271.48 FC2012M_R1:1:1:501:745                        
    GGTGTAAACTAGAGGTCTCAAACCAA
    +SRR002271.48 FC2012M_R1:1:1:501:745                        
    IIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR002271.77 FC2012M_R1:1:1:628:699                        
    GTGAGGTATGTGATTTATATTTTCTC

egrep "^@SRR[A-Z0-9\.]+" /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/min3length26-4.reads_1.sequence.txt-8 | egrep "^@SRR[0-9\.]+\s+[0-9]" 
    <NO OUTPUT>
    
    OK!










</entry>



<entry [Thu Sep  2 10:27:08 EDT 2010] LOOP BOWTIE WITH ALL SAMPLES AGAINST chr22>




1. COPY INPUT FILES TO SEPARATE DIRECTORIES

EXAMPLE READ NAME:
min3length26-10.reads_1.fastq



cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M
FILES="min3length26-*fastq"
for FILE in $FILES;
do
    #echo $FILE

    NUMBER=${FILE/min3length26-/};
    NUMBER=${NUMBER/.reads*/};
    echo "number: " $NUMBER

    SEQFILE=${FILE/fastq/};
    SEQFILE=$SEQFILE"sequence.txt" ;
    echo "seqfile: " $SEQFILE

    #if test -d $NUMBER then 
    #   echo "directory $NUMBER does not exist"
    #fi 

    mkdir `pwd`/$NUMBER;
    cp `pwd`/$FILE `pwd`/$NUMBER/$SEQFILE;
    
done;




2. RUN LOOP


/nethome/bioinfo/apps/agua/0.5/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--replicates 2-33 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/%REPLICATE%/bowtie \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/%REPLICATE%/min3length26-%REPLICATE%.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/%REPLICATE%/min3length26-%REPLICATE%.reads_2.sequence.txt \
--distance 200 \
--queue large \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species human \
--label sample%REPLICATE%-bowtie \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/%REPLICATE%/bowtie/chr22/samples.%REPLICATE%-33.bowtie.out 



/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/2/bowtie/chr22/samples.2-33.bowtie.out

    BOWTIE.pl    Run time: 00:57:46
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    11:08AM, 2 September 2010
    BOWTIE.pl    ****************************************

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/bowtie/chr22/samples.3-33.bowtie.out


BOWTIE.pl    Run time: 01:33:49
BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
BOWTIE.pl    12:42AM, 2 September 2010
BOWTIE.pl    ****************************************

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/4/bowtie/chr22/samples.4-33.bowtie.out

    BOWTIE::run    After printUsage       10-09-02 14:11:16
    BOWTIE.pl    Run time: 01:28:32
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    2:11PM, 2 September 2010
    BOWTIE.pl    ****************************************


...

tail /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/9/bowtie/chr22/samples.9-33.bowtie.out

    BOWTIE.pl    Run time: 01:27:31
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    9:51PM, 2 September 2010
    BOWTIE.pl    ****************************************

tail /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/10/bowtie/chr22/samples.10-33.bowtie.out
          'maxmemory' => 0,
          'completed' => 0
        };
BOWTIE::run    After printUsage       10-09-02 14:11:16
BOWTIE.pl    Run time: 01:28:32
BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
BOWTIE.pl    2:11PM, 2 September 2010
BOWTIE.pl    ****************************************








/nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/min3length26-3.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/min3length26-3.reads_2.sequence.txt \
--distance 200 \
--queue large \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species human \
--label sample3-bowtie \
--reads 1000000 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/bowtie/chr22/samples.3-33.bowtie.out 


/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie \

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/3/bowtie/chr22/samples.3-33.bowtie.out

</entry>



<entry [Wed Sep  1 11:36:58 EDT 2010] RAN BOWTIE AGAINST chr22>




1. MAKE ALIGNMENT OUTPUT DIRECTORIES FOR INPUT SEQUENCE min3length26-1.reads_1.sequence.txt AND ITS MATE PAIR

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M
cp min3length26-1.reads_1.fastq 1/min3length26-1.reads_1.sequence.txt
cp min3length26-1.reads_2.fastq 1/min3length26-1.reads_2.sequence.txt 
cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie


2. RUN BOWTIE.pl


chr22
-----

perl /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/min3length26-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/min3length26-1.reads_2.sequence.txt \
--distance 200 \
--queue large \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species human \
--label sample1-bowtie \
--reads 1000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/sample1-bowtie.out 

    BOWTIE.pl    Run time: 00:13:26
    BOWTIE.pl    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl
    BOWTIE.pl    10:17PM, 1 September 2010
    BOWTIE.pl    ****************************************



WHICH RUNS:

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/chr22/1/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/chr22/1/unaligned.txt \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22/chr22 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/1/sample1-bowtie_1.1.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/1/sample1-bowtie_2.1.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/chr22/1/out.sam



RUN JOB '1': 

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/chr22/1/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/chr22/1/unaligned.txt \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22/chr22 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/1/sample1-bowtie_1.1.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/1/sample1-bowtie_2.1.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/chr22/1/out.sam
    
    
    Warning: Exhausted best-first chunk memory for read SRR002271.1563505:1:76:638:250#0/1                  /1 (patid 36338); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002271.4073088:1:191:774:819#0/1                 /1 (patid 100899); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002271.5507047:2:56:807:971#0/1                  /1 (patid 128865); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002271.8204228:2:175:55:695#0/1                  /1 (patid 188150); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002271.8292426:2:179:677:577#0/1                 /1 (patid 189880); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002271.10969217:3:95:841:99#0/1                  /1 (patid 235369); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002271.12118087:3:145:546:224#0/1                /1 (patid 260654); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002272.319157:1:15:143:578#0/1                   /1 (patid 459665); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002272.1277591:1:58:779:502#0/1                  /1 (patid 483565); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002272.2834650:1:129:613:277#0/1                 /1 (patid 526369); skipping read
    Warning: Exhausted best-first chunk memory for read SRR002272.15997169:4:105:401:447#0/1                /1 (patid 835632); skipping read# reads processed: 1000000
    # reads with at least one reported alignment: 6363 (0.64%)
    # reads that failed to align: 993637 (99.36%)
    Reported 6363 paired-end alignments to 1 output stream(s)
    
    real    2m14.152s
    user    8m36.520s
    sys     0m5.312s



NB: BOWTIE MANUAL RECOMMENDS ADJUSTING THE --chunkmbs <int> PARAMETER TO AVOIE MEMORY BEING EXHAUSTED
    http://bowtie-bio.sourceforge.net/manual.shtml
    
    --chunkmbs <int>
    The number of megabytes of memory a given thread is given to store path descriptors in --best mode. Best-first search must keep track of many paths at once to ensure it is always extending the path with the lowest cumulative cost. Bowtie tries to minimize the memory impact of the descriptors, but they can still grow very large in some cases. If you receive an error message saying that chunk memory has been exhausted in --best mode, try adjusting this parameter up to dedicate more memory to the descriptors. Default: 64.





time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie \
--sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/2/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/2/unaligned.txt \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22/chr22 \
-1 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/2/sample1-bowtie_1.2.txt \
-2 /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/2/sample1-bowtie_2.2.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr22/2/out.sam



NOTES
-----

RUN ALL CHROMOSOMES


perl /nethome/bioinfo/apps/agua/0.5/bin/apps/BOWTIE.pl \
--inputfiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/min3length26-1.reads_1.sequence.txt \
--matefiles /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/min3length26-1.reads_2.sequence.txt \
--distance 200 \
--queue large \
--reference /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr22 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species mouse \
--label sample1-bowtie \
--reads 1000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/bowtie.out 



WHICH RUNS:

time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie --sam \
--threads 4 \
--al /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr1/1/aligned.txt \
--un /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr1/1/unaligned.txt \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chr1 \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/1/sample1-bowtie_1.1.txt \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/1/bowtie/chr1/1/out.sam
    
    ...
    # reads processed: 1000000
    # reads with at least one reported alignment: 175733 (17.57%)
    # reads that failed to align: 824267 (82.43%)
    Reported 175733 alignments to 1 output stream(s)
    
    real    0m44.658s
    user    2m45.740s
    sys     0m2.540s







PROBLEM

GET THIS ERROR MESSAGE

Saw ASCII character 36 but expected 64-based Phred qual.
Try not specifying --solexa1.3-quals/--phred64-quals.
terminate called after throwing an instance of 'int'



SOLUTION

DON'T USE --params "--solexa1.3-quals" ARGUMENT



</entry>



<entry [Wed Sep  1 11:36:58 EDT 2010] CREATED CHROMOSOME SUBDIRS FOR BOWTIE COLORSPACE INDEX FILES>




cd /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie
DIRS="chr*.fa"
for DIR in $DIRS;
do

    CHROM=${DIR/.fa/};
    echo CHROM: $CHROM;

    mkdir `pwd`/$CHROM;
    cp `pwd`/$CHROM.* `pwd`/$CHROM/;
done;






</entry>



<entry [Fri Aug 27 12:58:00 EDT 2010] RE-RUN READ SAMPLING WITH MIN 3 LENGTH 26 READS>




USE THESE INPUTDIRS:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540 \


TRIM READS:

    1. USE ONLY BASES 1-26
    
    2. USE ONLY READS WITH AN AVERAGE QUALITY OF AT LEAST 3


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/trimReads.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540 \
--zipped gzip \
--paired \
--format fastq \
--type solexa \
--cluster LSF \
--maxjobs 600 \
--queue large \
--length 26 \
--min 3 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/trimReads.out

    Run time: 00:51:03
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/trimReads.pl
    1:58PM, 31 August 2010
    ****************************************


WHICH RUNS THIS (SMALL TEST FILE):

-rw-rw-rw-  1 syoung root   14080659 Aug 12 04:09 SRR004865_1.fastq.gz


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/trimRead.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004865_1.fastq.gz \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/SRR004865_1.fastq \
--type solexa \
--format fastq \
--length 26 \
--min 3 \
--paired




1. RUN fixedWidthFasta.pl TO CREATE FIXED-LENGTH FASTA, QUAL AND info FILES


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M

screen -S fixedWidthFastqs

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth \
--cluster LSF \
--maxjobs 600 \
--queue large \
--id 60 \
--length 26 \
--dot 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/fixedWidthFastqs.nocompress.out
    
    
    Run time: 00:28:33
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    3:04PM, 31 August 2010
    ****************************************
    

COMPRESSED VERSION TOOK 6.5 MINS LONGER:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/fixedWidthFastqs.out

    ##Run time: 00:28:48
    ##Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastqs.pl
    ##11:39AM, 27 August 2010
    ##****************************************


WHICH RUNS:

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fixedWidthFastq.pl --inputfile \
/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/SRR004850_1.fastq.gz \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fasta/SRR004850_1.fasta \
--dot 100000 \
--id 60 \
--length 26





2. RUN printListFiles.pl TO GENERATE RANDOMIZED LISTS OF READ BYTE POSITIONS IN FASTA FILES


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth \
--size 100000000 \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/printListFiles.out
    
    
    ...
    global_total: 3375475686

    directory       total reads
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth        242992941
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth        70925757
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth        102529242
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth        186987828
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603/fixedwidth        106459248
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fixedwidth        2665580670
    
    directory       fraction
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth        0.0719877622012887
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth        0.021012077584848
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth        0.0303747535274055
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth        0.0553959931560295
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603/fixedwidth        0.0315390356510481
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fixedwidth        0.78969037787938
    ...
    Run time: 00:02:14
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    5:01PM, 31 August 2010
    ****************************************



WHICH RUNS THIS:


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fasta/SRR004211_2.fasta.info \
--compress gzip \
--dot 1000000 \
--size 100000000 \
--fraction 0.808232701234265 \
--total 3251795429 


WHICH GENERATES SEVERAL *.list FILES FOR EACH *.info FILE, CONTAINING THE LOCATIONS OF READS IN THE FIXED-WIDTH INPUT FILE




3. RUN printSubfiles.pl TO PRINT FASTQ SUBFILES BASED ON LOCATIONS IN *.list FILES


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth,ll \
--cluster LSF \
--maxjobs 600 \
--dot 1000000 \
--queue large \
--mode fastq \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/printSubfiles.nocompress.out
    

    ####Run time: 01:10:26
    ####Completed /nethome/bioinfo/apps/agua/0.5/bin/azpps/readprep/printSubfiles.pl
    ####12:48AM, 30 August 2010
    ####****************************************



LINGERING JOBS:


[syoung@u02 ~]$ bjobs

    JOBID     USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME
    1850840   syoung  RUN   large      u01         n0031       *5718_1.sh Aug 30 13:40
    1850844   syoung  RUN   large      u01         n0031       *5720_2.sh Aug 30 13:40
    1850845   syoung  RUN   large      u01         n0031       *5735_2.sh Aug 30 13:40
    1850846   syoung  RUN   large      u01         n0031       *5720_1.sh Aug 30 13:40



bpeek 1850840
outputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth/SRR00571/SRR005718_1.fastq.15-29.r

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth/SRR005718_1.fastq \
--mode fastq \
--width 176 \
--dot 1000000

    Run time: 00:06:52
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    2:58PM, 30 August 2010
    ****************************************


bpeek 1850844
outputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR00572/SRR005720_2.fastq.15-29.reads-fastq

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR005720_2.fastq \
--mode fastq \
--width 176 \
--dot 1000000

    Run time: 00:06:13
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    2:59PM, 30 August 2010
    ****************************************



bpeek 1850845
outputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR00573/SRR005735_2.fastq.14-29.reads-fastq


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR005735_2.fastq \
--mode fastq \
--width 176 \
--dot 1000000
    
    Run time: 00:41:21
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    3:34PM, 30 August 2010
    ****************************************


bpeek 1850846
outputfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR00572/SRR005720_1.fastq.14-29.reads-fastq


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR005720_1.fastq \
--mode fastq \
--width 176 \
--dot 1000000

    Run time: 00:38:33
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    3:32PM, 30 August 2010
    ****************************************


WHICH RUNS


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fixedwidth/SRR002297_2.fastq \
--mode fastq \
--width 176 \
--dot 1000000

    Run time: 00:08:41
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    1:02AM, 28 August 2010
    ****************************************






/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR005735_2.fastq \
--mode fastq \
--width 176 \
--dot 1000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR00573/printSubfile-SRR005735_2.out

    ...
    outputfile:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR00573/SRR005735_2.fastq.10-29.reads-fastq
    0
    1000000
    
    Run time: 00:00:16
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    5:40PM, 30 August 2010
    ****************************************



/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR005735_1.fastq \
--mode fastq \
--width 176 \
--dot 1000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR00573/printSubfile-SRR005735_1.out

    ...
    outputfile:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth/SRR00573/SRR005735_1.fastq.10-29.reads-fastq
    0
    1000000
    
    Run time: 00:01:49
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printSubfile.pl
    5:42PM, 30 August 2010
    ****************************************


4. GENERATE READ SAMPLES USING mergeFiles.pl


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000600/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000603/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001539/fixedwidth,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX001540/fixedwidth \
--label min3length26 \
--outputdir  /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M \
--mode fastq \
--indices 1-33 \
--paired \
--cluster LSF \
--maxjobs 600 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M/mergeFiles.out

    Run time: 01:12:09
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/mergeFiles.pl
    0:17AM, 1 September 2010
    ****************************************


ll /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/samples/100M

    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:13 min3length26-1.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:13 min3length26-1.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:26 min3length26-2.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:26 min3length26-2.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:47 min3length26-3.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:48 min3length26-3.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:48 min3length26-4.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:48 min3length26-4.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:47 min3length26-5.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:48 min3length26-5.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:47 min3length26-6.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:47 min3length26-6.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:46 min3length26-7.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:42 min3length26-7.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:42 min3length26-8.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:42 min3length26-8.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:29 min3length26-9.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:42 min3length26-9.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:29 min3length26-10.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:29 min3length26-10.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:29 min3length26-11.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:36 min3length26-11.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:36 min3length26-12.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:36 min3length26-12.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:36 min3length26-13.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:28 min3length26-13.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:28 min3length26-14.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:28 min3length26-14.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-15.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:28 min3length26-15.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-16.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-16.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-17.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-17.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-18.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-18.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-19.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:15 min3length26-19.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-20.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-20.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-21.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-21.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-22.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-22.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:38 min3length26-23.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:13 min3length26-23.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:13 min3length26-24.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:13 min3length26-24.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:13 min3length26-25.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:14 min3length26-25.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:12 min3length26-26.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:13 min3length26-26.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-27.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:14 min3length26-27.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-28.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-28.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-29.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-29.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-30.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-30.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:54 min3length26-31.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Sep  1 00:17 min3length26-31.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:54 min3length26-32.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:54 min3length26-32.reads_2.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:54 min3length26-33.reads_1.fastq
    -rw-rw-rw- 1 syoung root 8.2G Aug 31 23:54 min3length26-33.reads_2.fastq



NB: REMOVED THESE SINGLE FILES FROM SRX000601 AND SRX000602:


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth/SRR002315.fastq
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000601/fixedwidth/SRR003966.fastq
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth/SRR003863.fastq
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/min3.length26/SRX000602/fixedwidth/SRR003875.fastq




</entry>



<entry [Wed Aug 25 17:12:33 EDT 2010] RE-DOWNLOADED BOWTIE PAPER DATA SET FROM SRA (SRR001115)>




1. FOUND FTP URL ON SRA

ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000032/SRX000259/SRR001115.fastq.gz	

    1:  SRX000259 1000 genomes - CEPH/UTAH Trio	Links
    Submitter: BI, Genome Sequencing
    Study: 1000Genomes Project Pilot 2(SRP000032)  Summary  Genome Project  All experiments
    Sample: Human HapMap individual NA12878 (SRS000090)
    Instrument: Illumina Genome Analyzer

    Download data for this experiment SRX000259
    Total: 26 runs, 272.8M spots , 12.8G bases
    #	Run	# of Spots	# of Bases
    1.	SRR001115	9,397,961	441.7M 
    2.	SRR001116	8,570,588	402.8M 
    3.	SRR001117	8,544,487	401.6M 
    4.	SRR001118	8,398,304	394.7M 
    5.	SRR001121	8,169,305	384M 
    6.	SRR001140	12,170,288	572M 
    7.	SRR001141	12,124,955	569.9M 
    8.	SRR001142	11,929,308	560.7M 
    9.	SRR001143	12,191,014	573M 
    10.	SRR001144	11,518,234	541.4M 
    11.	SRR001145	11,163,741	524.7M 
    12.	SRR001146	12,144,274	570.8M 
    13.	SRR001147	8,683,614	408.1M 
    14.	SRR001148	8,195,127	385.2M 
    15.	SRR001149	9,135,522	429.4M 
    16.	SRR001150	9,281,389	436.2M 
    17.	SRR001151	9,257,440	435.1M 
    18.	SRR001152	9,537,172	448.2M 
    19.	SRR001153	8,076,187	379.6M 
    20.	SRR001732	11,831,905	556.1M 
    21.	SRR001733	11,780,824	553.7M 
    22.	SRR001734	11,265,750	529.5M 
    23.	SRR001735	11,954,855	561.9M 
    24.	SRR001736	12,745,766	599.1M 
    25.	SRR001737	12,443,958	584.9M 
    26.	SRR001738	12,274,746	576.9M 



2. DOWNLOADED TO PEGASUS

mkdir -p /scratch/syoung/base/pipeline/SRA/NA12878
cd /scratch/syoung/base/pipeline/SRA/NA12878
wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000032/SRX000259/SRR001115.fastq.gz	
gunzip *gz


3. CHECKED DATA - 9,397,961 READS

head SRR001115.fastq 

    @SRR001115.1 2044KAAXX:7:1:120:526 length=47
    TTACTGGCATTGAGATGGTGTGTGCTATGGCTCTTTGAAATCTTTTA
    +SRR001115.1 2044KAAXX:7:1:120:526 length=47
    II=I->II0%+I6II@IIII+4IIIB*&*0%'*<II>I:II(I&II$
    @SRR001115.2 2044KAAXX:7:1:116:171 length=47
    TGGGGGTATCATCAGTGTAAAGATAGGATCTGAAGCCATGATAATTT
    +SRR001115.2 2044KAAXX:7:1:116:171 length=47
    IIIIIIIIIIIII@IIIIIIII0IIIIIIIIIII&IIHII1.%-III
    @SRR001115.3 2044KAAXX:7:1:101:763 length=47
    TTTGAGATGCCATGAGGAATCTTGTTAGTATTGCTTATTATTTTTTT



tail SRR001115.fastq    

    +SRR001115.9397959 2044KAAXX:7:273:978:280 length=47
    ((&)76$$+-(-4'#%('&&#%(&+$$"$$"*'%*$"+""0!%&!'+
    @SRR001115.9397960 2044KAAXX:7:273:0:52 length=47
    NNNTNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
    +SRR001115.9397960 2044KAAXX:7:273:0:52 length=47
    """."""""""""""""""""""""""""""""""""""""""""""
    @SRR001115.9397961 2044KAAXX:7:273:527:304 length=47
    CAGTCATCTCATTCCCCGTGAACTCCTGCTTTGGTCCTCGTATTTTT
    +SRR001115.9397961 2044KAAXX:7:273:527:304 length=47
    %I&#%%$$I+@('$'%#%(.$H8#=&1%#%&/-.,$@%'$I%>'$I*



lines SRR001115.fastq

    SRR001115.fastq: 37591844



4. VERIFY simpleHeader FILE REMOVES 'length=47'


sed -e 's/ [\D]*[A-Z0-9\.\_]*:\([0-9\:]*\)/:\1#0\/1/' <  SRR001115.fastq > SRR001115.simpleHeader.fastq


 head *simple*
@SRR001115.1:7:1:120:526#0/1 length=47
TTACTGGCATTGAGATGGTGTGTGCTATGGCTCTTTGAAATCTTTTA
+SRR001115.1:7:1:120:526#0/1 length=47
II=I->II0%+I6II@IIII+4IIIB*&*0%'*<II>I:II(I&II$
@SRR001115.2:7:1:116:171#0/1 length=47
TGGGGGTATCATCAGTGTAAAGATAGGATCTGAAGCCATGATAATTT
+SRR001115.2:7:1:116:171#0/1 length=47
IIIIIIIIIIIII@IIIIIIII0IIIIIIIIIII&IIHII1.%-III
@SRR001115.3:7:1:101:763#0/1 length=47
TTTGAGATGCCATGAGGAATCTTGTTAGTATTGCTTATTATTTTTTT





5. RAN Bowtie.t AT 47 BP

READ HIT COUNTS DISTRIBUTION

cat out.hitct.bins 
    3409432 1
     127176 2
      60729 3
      40809 4
      30438 5
      24646 6
      20424 7
      16896 8
      14969 9
      13580 10
      12265 11
      11703 12
      11951 13
      11451 14
      11283 15
      11514 16
      12141 17
      12831 18
      13865 19
      15239 20
      18369 21
      22644 22
      38070 23
     376412 24




4,338,837 READS WTIH HITS FROM 9,397,961 READS

[syoung@u04 bowtie-paper]$ lines out.hitct
out.hitct: 4338837

[syoung@u01 bowtie-paper]$ lines out.hitct.sorted
out.hitct.sorted: 4338835

[syoung@u01 bowtie-paper]$ head out.hitid

SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1
SRR001115.1000001:7:30:62:482#0/1


COUNT TOTAL HITS (INCLUDES DUPLICATE READS):

[syoung@u01 bowtie-paper]$ lines out.hitid
out.hitid: 17601412

[syoung@u01 bowtie-paper]$ lines */out.hitid
chr10/out.hitid: 789462
chr11/out.hitid: 772296
chr12/out.hitid: 770781
chr13/out.hitid: 665313
chr14/out.hitid: 681386
chr15/out.hitid: 657667
chr16/out.hitid: 678507
chr17/out.hitid: 648812
chr18/out.hitid: 642803
chr19/out.hitid: 624426
chr1/out.hitid: 947176
chr20/out.hitid: 613321
chr21/out.hitid: 556621
chr22/out.hitid: 533356
chr2/out.hitid: 968194
chr3/out.hitid: 869479
chr4/out.hitid: 858212
chr5/out.hitid: 840622
chr6/out.hitid: 821633
chr7/out.hitid: 828731
chr8/out.hitid: 788302
chr9/out.hitid: 752514
chrX/out.hitid: 801301
chrY/out.hitid: 490497




6. RAN Bowtie.t AT 35 BP

TRIM TO 35 BP

/nethome/bioinfo/apps/agua/0.5/bin/apps/filetools.pl trimRead \
--inputfile /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115.fastq \
--outputfile /scratch/syoung/base/pipeline/SRA/NA12878/SRR001115-35bp.fastq \
--type fastq \
--length 35 




##### BOWTIE PAPER (9.4 M READS) --- 35 BP
my $inputfiles  =   "/scratch/syoung/base/pipeline/SRA/NA12878/SRR001115-35bp.fastq";
my $matefiles   =   undef;
my $outputdir   =   "/scratch/syoung/base/pipeline/SRA/NA18507/bowtie/t/bowtie-35bp";
my $clean       =   undef;
my $maxlines    =   4000000;
my $splitfile   =   undef;
my $referencedir=   "/nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie";














NOTES
-----

BOWTIE PAPER
http://genomebiology.com/2009/10/3/R25#sec6


The performance and sensitivity of Bowtie v0.9.6, SOAP v1.10, and Maq v0.6.6 when aligning 8.84 M reads from the 1,000 Genome project (National Center for Biotechnology Information Short Read Archive: SRR001115) trimmed to 35 base pairs. The 'soap.contig' version of the SOAP binary was used. SOAP could not be run on the PC because SOAP's memory footprint exceeds the PC's physical memory. For the SOAP comparison, Bowtie was invoked with '-v 2' to mimic SOAP's default matching policy (which allows up to two mismatches in the alignment and disregards quality values). For the Maq comparison Bowtie is run with its default policy, which mimics Maq's default policy of allowing up to two mismatches during the first 28 bases and enforcing an overall limit of 70 on the sum of the quality values at all mismatched positions. To make Bowtie's memory footprint more comparable to Maq's, Bowtie is invoked with the '-z' option in all experiments to ensure only the forward or mirror index is resident in memory at one time.



http://genomebiology.com/2009/10/3/R25/table/T1
TABLE 1 SHOWING PERCENT READS MAPPED

Bowtie -v 2
	Server
	15 m 7 s
	15 m 41 s
	33.8
	1,149
	-


8.84 M reads from the 1,000 Genome project (National Center for Biotechnology Information Short Read Archive: SRR001115)

TRIMMED TO 35 BASE PAIRS

BOWTIE -v 1 (MAQ)   71.9
MAQ                 74.7
BOWTIE -v 2 (SOAP)	67.4
SOAP                67.3


The performance and sensitivity of Bowtie v0.9.6, SOAP v1.10, and Maq v0.6.6 when aligning 8.84 M reads from the 1,000 Genome project (National Center for Biotechnology Information Short Read Archive: SRR001115) trimmed to 35 base pairs. The 'soap.contig' version of the SOAP binary was used. SOAP could not be run on the PC because SOAP's memory footprint exceeds the PC's physical memory. For the SOAP comparison, Bowtie was invoked with '-v 2' to mimic SOAP's default matching policy (which allows up to two mismatches in the alignment and disregards quality values). For the Maq comparison Bowtie is run with its default policy, which mimics Maq's default policy of allowing up to two mismatches during the first 28 bases and enforcing an overall limit of 70 on the sum of the quality values at all mismatched positions. To make Bowtie's memory footprint more comparable to Maq's, Bowtie is invoked with the '-z' option in all experiments to ensure only the forward or mirror index is resident in memory at one time. CPU, central processing unit.









</entry>



<entry [Mon Aug 23 16:02:31 EDT 2010] USE averageQuality.pl TO DETERMINE HOW MANY BASES TO SKIP AT START AND TRIM FROM ENDS>



ADDED min, skip AND length OPTIONS TO averageQuality.pl AND averageQualities.pl


screen -S avqualskip

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger \
--cluster LSF \
--maxjobs 200 \
--queue small \
--skip 1 \
--length 35 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/averageQualities.out




/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.fastq.gz \
--compress gzip \
--skip 1 \
--length 35 \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger




TESTED THESE SKIP, LENGTH AND MIN VALUES:


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl --inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/SRR005718_1.fastq.gz --compress gzip --bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 --type sanger


    averageQuality.pl    total: 7.81435425651328
    averageQuality.pl    Printing statsfile
    data bins: 0 0 0 0 0 6425 34974 47962 101066 311217 868310 1916453 3707602 6963793 18202744 0 0 0 0 0 0 0 0 0 0 0 0 0
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       6425
    1       34974
    2       47962
    3       101066
    4       311217
    5       868310
    6       1916453
    7       3707602
    8       6963793
    9       18202744
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0
    
    Run time: 01:11:19
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    12:06AM, 25 August 2010
    ****************************************





/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.qualstats

    total reads     6044862
    total avg quality       4.00707714437616
    bins    -50 -40 -30 -20 -10 0 1 2 3 4 5 6 7 8 9 10 15 20 30 40 50 60 70 80 90 100 200 300
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       31712
    1       252093
    2       562732
    3       990112
    4       1262872
    5       1197119
    6       902593
    7       532081
    8       224290
    9       89258
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0



/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.skip2.length32.qualstats
    
    total reads     6044862
    total avg quality       3.93896522679095
    bins    -50 -40 -30 -20 -10 0 1 2 3 4 5 6 7 8 9 10 15 20 30 40 50 60 70 80 90 100 200 300
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       54125
    1       323693
    2       638184
    3       982985
    4       1181322
    5       1106052
    6       865095
    7       534763
    8       250287
    9       108356
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0


/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.min4.skip2.length32.qualstats

    total reads     2900504
    total avg quality       5.55350366479412
    bins    -50 -40 -30 -20 -10 0 1 2 3 4 5 6 7 8 9 10 15 20 30 40 50 60 70 80 90 100 200 300
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       0
    1       0
    2       0
    3       0
    4       35951
    5       1106052
    6       865095
    7       534763
    8       250287
    9       108356
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0






RUN averageQualities.pl WITH min, skip AND length:

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger \
--cluster LSF \
--maxjobs 200 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/averageQualities.out





WHICH RUNS THIS:


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.fastq.gz \
--compress gzip \
--min 4 \
--skip 2 \
--length 32 \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger





RUN PLAIN VANILLA TO GET THE BASE QUALITIES:


screen -S avqual

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger \
--cluster LSF \
--maxjobs 300 \
--queue large \
--clean \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/averageQualities.out

    
    Run time: 02:03:11
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl
    3:07PM, 26 August 2010
    ****************************************




THIS IS THE FINAL REPORT FOR BINNED AVERAGE QUALITY AND QUALITY PER BASE:


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl --inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 --outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/averageQualities.txt --compress gzip --bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 --type sanger --cluster LSF --maxjobs 300 --queue large

    executable: /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    No. files: 512
    Doing use Monitor::LSF
    total reads     4033317542
    total average quality   3.79628569310948
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       44021536
    1       387411260
    2       597397059
    3       697477399
    4       666395780
    5       519965502
    6       369791230
    7       260639732
    8       201469476
    9       288748568
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0

    averageQualities.pl    basereads        4033317543
    1       7.20937857656797
    2       7.22661531859456
    3       7.27419428205433
    4       7.10626098402388
    5       6.9627019865418
    6       6.69919097391534
    7       6.58001387370555
    8       6.34787166868006
    9       6.11035200309791
    10      5.89083342154298
    11      5.72605788405686
    12      5.47483668607344
    13      4.99756125673341
    14      4.58756366830401
    15      4.32801618069872
    16      4.16304524699309
    17      3.72756642211148
    18      3.40004462227387
    19      3.12488577396397
    20      2.89580695159265
    21      2.77577953425226
    22      2.5351873131701
    23      2.33367937278724
    24      2.22521514269971
    25      2.02092976590611
    26      1.91996806461217
    27      1.76401288694665
    28      1.6850503015304
    29      1.58553049513761
    30      1.45846154766793
    31      1.3428010324651
    32      1.28126099368715
    33      1.19670689861178
    34      1.13009660816582
    35      1.02967913131654
    36      1.09801005395324
    37      0.065286766586729
    38      0.0258695426005043
    39      0.0244665018184014
    40      0.0232214161174961
    41      0.0257807965505879
    
    Run time: 00:00:06
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl
    6:20PM, 26 August 2010
    ****************************************


WHICH RUNS:


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.fastq.gz \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger
    
    averageQuality.pl::average_qualities         0
    averageQuality.pl::average_qualities         1000000
    averageQuality.pl::average_qualities         2000000
    averageQuality.pl::average_qualities         3000000
    averageQuality.pl::average_qualities         4000000
    averageQuality.pl::average_qualities         5000000
    averageQuality.pl::average_qualities         6000000
    averageQuality.pl::average_qualities    basequalfile: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.basequal
    total reads     6044862
    0       8.13336135713272
    1       8.10716158615366
    2       8.1007839384919
    3       7.80326581483581
    4       7.52414397549522
    5       7.12680785764836
    6       6.80795508648502
    7       6.9518604394939
    8       6.37849813610302
    9       6.44323377440213
    10      6.24967203552372
    11      6.06548304990255
    12      5.40677388499522
    13      4.91398050112641
    14      4.44263243726656
    15      4.39664677208512
    16      3.91535753835241
    17      3.48938056815855
    18      3.17028246467827
    19      2.78503760714471
    20      2.81495375742242
    21      2.52248835457286
    22      2.19669745976004
    23      2.21464013570533
    24      1.95702135135591
    25      1.8719573747093
    26      1.66327270994772
    27      1.58098480990964
    28      1.50697220217765
    29      1.35432421782334
    30      1.1846740256436
    31      1.13008502096491
    32      1.05710270970619
    33      1.01991724542264
    34      0.866518210010419
    35      1.10084878695328
    averageQuality.pl::average_qualities    outputfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.avqual
    
    averageQuality.pl::average_qualities    basequalfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.basequal
    
    averageQuality.pl    compress(filename, compress)
    averageQuality.pl    filename: /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.avqual
    averageQuality.pl    compress: gzip
    gzip /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.avqual
    averageQuality.pl    Doing bins
    0
    1000000
    2000000
    3000000
    4000000
    5000000
    6000000
    averageQuality.pl    total: 24222228.3611079
    averageQuality.pl    Printing statsfile
    data bins: 0 0 0 0 0 31712 252093 562732 990112 1262872 1197119 902593 532081 224290 89258 0 0 0 0 0 0 0 0 0 0 0 0 0
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       31712
    1       252093
    2       562732
    3       990112
    4       1262872
    5       1197119
    6       902593
    7       532081
    8       224290
    9       89258
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0
    averageQuality.pl::average_qualities    statsfile printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.qualstats
    
    
    Run time: 00:23:18
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    12:43AM, 26 August 2010
    ****************************************




DECISION:

    1. USE ONLY BASES 1-26
    
    2. USE ONLY READS WITH AN AVERAGE QUALITY OF AT LEAST 3




RERUN averageQualities WITH THESE PARAMETERS TO GET AVERAGE QUALITY DISTRIBUTION AND AVERAGE QUALITY PER BASE:






screen -S avqual

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/averageQualities.min3.length26.txt \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--min 3 \
--length 26 \
--type sanger \
--cluster LSF \
--maxjobs 300 \
--queue large \
--clean \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/averageQualities.min3.length26.out


    ...    
    total reads     2331364627
    total average quality   5.3526664686249
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       0
    1       0
    2       0
    3       24354339
    4       666395780
    5       519965502
    6       369791230
    7       260639732
    8       201469476
    9       288748568
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0

    averageQualities.pl    basereads        2331364628
    1       12.4724003863543
    2       12.5022203695371
    3       12.5845331342138
    4       12.2940044417625
    5       12.0456438824378
    6       11.5897634177368
    7       11.3835841340559
    8       10.9819724699023
    9       10.5710576681187
    10      10.1912851797801
    11      9.90621948991841
    12      9.47160070363733
    13      8.64590259580793
    14      7.93659679004104
    15      7.48757332008385
    16      7.20216959000718
    17      6.44878062506146
    18      5.88215994070577
    19      5.40612843680838
    20      5.00981649919757
    21      4.80216614618723
    22      4.38593574861427
    23      4.03732210781402
    24      3.84967635015521
    25      3.49625767677213
    26      3.32159147650927
    27      3.05178522379126
    28      2.91517802937173
    29      2.74300634237812
    30      2.52317397088003
    31      2.32307846484149
    32      2.21661270010484
    33      2.07033205789892
    34      1.95509463438595
    35      1.78136995565672
    36      1.89958411473334
    37      0.112947695026966
    38      0.0447549382652811
    39      0.0423276435675595
    40      0.0401736150043364
    41      0.0446014054391838

    
    Run time: 01:55:40
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl
    8:31PM, 26 August 2010
    ****************************************






NOTES
-----

    THE SRA TAKES FASTQ DATA IN ILLUMINA FASTQ FORMAT (I.E., OFFSET IS 64):
    
    http://www.ebi.ac.uk/ena/about/page.php?page=sra_data_format#1.5
    
    Illumina Genome Analyzer: FASTQ format

    We support Illumina Genome Analyzer submissions in a well defined FASTQ format described below.
    We accept FASTQ submissions with application reads in separate files, i.e. paired reads can be submitted in two files: one file for the forward and one file for the reverse reads. When this is done we recommend that no technical reads, including barcode reads, are submitted to SRA.
    Each spot in the FASTQ file consists of three components: spot name, base calls and quality scores. The spot names are composed of seven fields:
    @<instrument name>:<lane>:<tile>:<x-coordinate>:<y-coordinate>#<tag or index>/<pair index>
    <instrument name>: the unique instrument name
    <lane>: the flowcell lane
    <tile>: the tile within the flowcell lane
    <x-coordinate>: the x-coordinate of the cluster within the tile
    <y-coordinate>: the y-coordinate of the cluster within the tile
    <tag or index>: the tag or the tag index for multiplexed samples (optional or 0 for no indexing)
    <pair index>: the pair index: 1 or 2 (optional or 0 for single-ended spots)
    Example:
    @HWUSI-EAS100R:6:73:941:1973#0/1
    The quality encoding should use a Phred quality score ranging from 0 to 62 using ASCII characters from 64 to 126.
    A single spot in the FASTQ file should look like this:
    @HWUSI-EAS100R:6:73:941:1973#0/1
    GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT
    +
    !''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65
    The FASTQ files should be individually compressed using gzip prior uploading them to EBI.
    More information about the FASTQ format is available from Wikipedia.
        


</entry>



<entry [Mon Aug 23 16:02:31 EDT 2010] GET READ QUALITY DISTRIBUTION>






screen -S avqual

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger \
--cluster LSF \
--maxjobs 200 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/averageQualities.out


    ...
    executable: /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    No. files: 513
    files:
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR003837_2.fastq.gz
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004850_1.fastq.gz
    ...    
    Run time: 01:54:16
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl
    8:15PM, 23 August 2010
    ****************************************


PLUS AN ADDITIONAL 7.5 MINS TO BIN THE AVERAGE QUALITIES:

    Run time: 00:07:28
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQualities.pl
    12:26AM, 24 August 2010
    ****************************************    


WHICH RUNS

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.fastq.gz \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger

    0
    1000000
    2000000
    3000000
    4000000
    5000000
    6000000
    Output file printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.avqual.tsv
    
    
    Run time: 00:10:28
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    4:38PM, 23 August 2010
    ****************************************



/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/SRR004186_1.fastq.gz \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger



/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/SRR005718_1.fastq.gz \
--compress gzip \
--bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 \
--type sanger




TEST ON LARGE INPUT FILE:


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl --inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/SRR005734_1.fastq.gz --compress gzip --bins -50,-40,-30,-20,-10,0,1,2,3,4,5,6,7,8,9,10,15,20,30,40,50,60,70,80,90,100,200,300 --type sanger

    ...    
    23000000
    24000000
    averageQuality.pl    total: 8.80013178311544
    averageQuality.pl    Printing statsfile
    data bins: 0 0 0 0 0 18903 33231 19582 22389 39128 48101 82818 219728 878535 23628099 0 0 0 0 0 0 0 0 0 0 0 0 0
    -50     0
    -40     0
    -30     0
    -20     0
    -10     0
    0       18903
    1       33231
    2       19582
    3       22389
    4       39128
    5       48101
    6       82818
    7       219728
    8       878535
    9       23628099
    10      0
    15      0
    20      0
    30      0
    40      0
    50      0
    60      0
    70      0
    80      0
    90      0
    100     0
    200     0
    300     0
    
    Run time: 00:56:07
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/averageQuality.pl
    2:49PM, 24 August 2010
    ****************************************





</entry>



<entry [Fri Aug 13 01:54:09 EDT 2009] GENERATE FILES>




NB: CHANGED readsFastqFasta TO fastqToFastas.pl



1. RUN fastqToFastas.pl TO CREATE FIXED-LENGTH FASTA, QUAL AND info FILES


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M

screen -S fastqToFastas

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fastqToFastas.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/fasta \
--compress gzip \
--cluster LSF \
--maxjobs 100 \
--queue large \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/fastqToFastas.out

    Run time: 01:14:55
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fastqToFastas.pl
    1:05PM, 20 August 2010
    ****************************************



ACCIDENTALLY DELETED THIS FILE:


/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR004211_2.fasta.gz




TEST RUN WITH ONE FILE TAKES:

    ...
    7300000
    7400000
    7500000
    INFO file printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR003837_2.fasta.info
    
    gzip /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR003837_2.fasta
    gzip /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR003837_2.fasta.qual
    Output files printed:
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR003837_2.fasta
    
    /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR003837_2.fasta.qual
    Run time: 00:06:41
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/fastqToFasta.pl
    10:26AM, 19 August 2010
    ****************************************



2. REMOVE SINGLE FILES


rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/*/*_2.fasta.*list

mkdir singles
ls | grep -v _ | grep fasta | xargs -L1 -IMYFILES mv MYFILES singles

NB: DELETED COMPLETELY THESE SINGLE FILES IN SRX000602/fasta:

SRR003863.fasta.gz
SRR003863.fasta.qual.gz

SRR003866.fasta.gz
SRR003866.fasta.qual.gz

SRR003875.fasta.gz
SRR003875.fasta.qual.gz




3. RUN listFiles.pl TO GENERATE RANDOMIZED LISTS OF READ BYTE POSITIONS IN FASTA FILES


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/fasta \
--size 100000000 \
--compress gzip \
--paired \
--cluster LSF \
--maxjobs 100 \
--queue large \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/printListFiles.out
    

    Run time: 00:03:36
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFiles.pl
    2:46PM, 20 August 2010
    ****************************************



WHICH RUNS THIS:


/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printListFile.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR004211_2.fasta.info \
--dot 100000 \
--compress gzip \
--dot 1000000 \
--size 100000000 \
--fraction 0.808232701234265 \
--total 3251795429 \
--paired


WHICH GENERATES SEVERAL *.list FILES FOR EACH *.info FILE, CONTAINING THE LOCATIONS OF READS IN THE FIXED-WIDTH INPUT FILE


NB: REMOVE ERRONEOUSLY GENERATED *_2.fasta.*list FILES:

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/*/*_2.fasta.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/fasta/*/*_2.fasta.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/fasta/*/*_2.fasta.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603/fasta/*/*_2.fasta.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/fasta/*/*_2.fasta.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/fasta/*/*_2.fasta.*list

rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/*/*fasta.gz.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/fasta/*/*fasta.gz.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/fasta/*/*fasta.gz.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603/fasta/*/*fasta.gz.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/fasta/*/*fasta.gz.*list
rm -fr /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/fasta/*/*fasta.gz.*list




4. RUN printFiles.pl TO PRINT FASTA, QUAL AND FASTQ SUB FILES BASED ON LOCATIONS IN *.list FILES


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printFiles.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/fasta \
--cluster LSF \
--maxjobs 100 \
--queue large \
--compress gzip \
--mode fasta \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/printFiles.out



WHICH RUNS

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printFile.pl --inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR004211_1.fasta --mode fasta --width 59 --dot 100000 --compress gzip

/nethome/bioinfo/apps/agua/0.5/bin/apps/readprep/printFile.pl --inputfile /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR004211_2.fasta --mode fasta --width 58 --dot 100000 --compress gzip



INPUTFILE:

/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta/SRR004211_2.fasta.gz

    >SRR004211.1          
    ATAGGGCCTTGAGAAACATTTAGGGCTTTCCATGGA
    >SRR004211.2          
    AAACCTAAACTAAAAGTTAAAAAATAAAATTGAGTT
    >SRR004211.3          
    GTGCACAGTCCTCACACTCAGGAAATTTACAGCCTC
    >SRR004211.4          
    ATTTTAGAATAATCACATCTGTATCTACAAAAAAAA
    >SRR004211.5          
    TCAGAGAATTCTCCATGCTTCCTATTCAGGGGGAAA
    >SRR004211.6          
    GTTTCGTATCTTACTAGAAATTGATGCAAGAGCTTC
    >SRR004211.7          
    ATGGCAAGCACTAAATAGTCACTTAAAATATTATAC
    >SRR004211.8          
    TTCCCCATTTCTTGTTTTTGTCAGGTTTGTCCAAGT
    >SRR004211.9          
    AAAAATAAGATAGGGACATTTCACAATTAACAGTAA
    >SRR004211.10         
    AAATTATATTTCTTGAGTGAGAAAGATGTTTAGGGT
    >SRR004211.11         
    CAGGAGACAGTGGTCTAGTTTCATTTTTCTACACAT


#/nethome/syoung/base/bin/comparison/printFiles.pl \
#--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
#--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
#--mode fasta \
#--size 10000
#
#
#
#/nethome/syoung/base/bin/comparison/printFiles.pl \
#--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
#--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
#--mode qual \
#--size 10000 
#
#
#
#/nethome/syoung/base/bin/comparison/printFiles.pl \
#--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
#--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
#--mode fastq \
#--size 10000 




5. GENERATE READ SAMPLES USING sampleReads.pl


/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539/fasta,/scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540/fasta \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M \
--compress gzip \
--mode samples \
--size 10000000 \
&> /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/samples/100M/sampleReads.out












</entry>



<entry [Fri Aug 13 01:44:09 EDT 2009] RE-DOWNLOAD NA18507>




U01
---

screen -S deep-0600

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600

    Run time: 09:40:16
    Completed /nethome/syoung/base/bin/utils/deepvac.pl
    6:25AM, 12 August 2010
    ****************************************

U02
---

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000601 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000601

    Run time: 00:46:58
    Completed /nethome/syoung/base/bin/utils/deepvac.pl
    9:48PM, 11 August 2010
    ****************************************

U03
---

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000602 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000602
    
    Run time: 02:58:31
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    0:01AM, 12 August 2010
    ****************************************

U04
---


/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000603 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000603




/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001539 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001539

/nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001540 --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX001540

    
    Run time: 00:56:43
    Completed /nethome/bioinfo/apps/agua/0.5/bin/apps/deepvac.pl
    0:26AM, 12 August 2010
    ****************************************




DOWNLOADED SNPS AND INDELS FOR NA18507 FROM SANGER:

cd /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239
wget ftp://ftp.sanger.ac.uk/pub/rd/NA18507/NA18507.indel.gz

wget ftp://ftp.sanger.ac.uk/pub/rd/NA18507/NA18507.snp.gz

Sanger README:

wget ftp://ftp.sanger.ac.uk/pub/rd/NA18507/00README.txt

NA18507.snp.gz
==============

Each line consists of chromosome, position, reference base, consensus
base, Phred-like consensus quality, read depth, the average number of
hits of reads covering this position, the highest mapping quality of the
reads covering the position, the minimum consensus quality in the 3bp
flanking regions at each side of the site (6bp in total), the second
best call, log likelihood ratio of the second best and the third best
call, and the third best call.

NA18507.indel.gz
================

Each line consists of chromosome, position, genotype and the score. The
higher the score the more reliable the call.

NB: AT THE BOTTOM OF THE FILE, NT_113898 IS THE CHROMOSOME ENTRY

Contig	 :	 NT_113898		
Homo sapiens chromosome 6 genomic contig, reference assembly.
http://howdy.jst.go.jp/HOWDYCL//HOWDY.pl?Cls=Contig&Key=UKEY&Val=nt_113898






</entry>



<entry [Sun May 24 13:44:09 EDT 2009] NICK - LIST OF DEEPLY SEQUENCED HUMAN GENOMES>




ILLUMINA WHOLE HUMAN GENOMES
http://solexa.co.uk/HumanGenome/


YORUBA (NA18507, NA18506, NA18508)


NA18506 genome sequence data
ftp://ftp.ncbi.nlm.nih.gov/sra/Submissions/SRA009/SRA009225/


NA18508 genome sequence data
ftp://ftp.ncbi.nlm.nih.gov/sra/Submissions/SRA009/SRA009347/


1000GENOMES, PILOT 2 ( >5x mappable data)
NA19240
ftp://ftp.era.ebi.ac.uk/vol1/ERA000/ERA000023/srf/


HAN CHINESE
http://en.wikipedia.org/wiki/Beijing_Genomics_Institute

http://www.nature.com/nature/journal/v456/n7218/full/nature07484.html
Wang, J. et al. (2008) The diploid genome sequence of an Asian individual.
Nature doi:10.1038/nature07484.


Data production and short read alignment
The genomic DNA used in this study came from an anonymous male Han Chinese individual who has no known genetic diseases. The donor gave written consent for public release of the genomic data for use in scientific research (see Supplementary Information for consent forms).

We carried out G-banded karyotyping to check the overall structural suitability of this DNA for use as a genomic standard for other genetic comparison and found no obvious chromosomal abnormalities (Supplementary Fig. 1). We then proceeded with whole-genome sequencing of the individuals DNA (hereafter referred to as YH) using Illumina Genome Analysers (GA; see Methods for details). To minimize the likelihood of systematic biases in genome representation, multiple DNA libraries were prepared and data were generated from eight single-end and two paired-end libraries (Supplementary Table 1). The read lengths averaged 35?base pairs (bp), and the two paired-end libraries had a span size of 135?bp and 440?bp, respectively.

We collected a total of 3.3 billion reads of high-quality data:
117.7 Gb of sequence
72 Gb from single-end reads and 45.7 Gb from paired-end reads

SRA accession number: ERA000005

(See Supplementary Information for details concerning the availability of all data.)

Using the Short Oligonucleotide Alignment Program (SOAP)6, 102.9?Gb of sequence (87.4% of all data) was properly aligned to the NCBI human reference genome (build 36.1; hereafter called NCBI36). This resulted in a 36-fold average coverage of NCBI36 (Table 1). The effective genome coverage of the single- and paired-end sequencing was 22.5-fold and 13.5-fold, respectively. In total, 99.97% of NCBI36 (excluding Ns, which are undetermined sequence of the reference genome) was covered by at least one uniquely or repeatedly aligned read (uniquely aligned reads had only one best hit on NBCI36; repeatedly aligned reads had multiple possible alignments; see Methods for details).





KOREAN GENOME

http://genome.cshlp.org/content/19/9/1622

Sung-Min Ahn et al. (2009) The first Korean genome sequence and analysis: Full genome sequencing for a socio-ethnic group. Genome Res. 2009. 19: 1622-1629
Published in Advance May 26, 2009, doi: 10.1101/gr.092197.109

[Supplemental material is available online at:

http://www.genome.org.

The sequence data from this study are available at
ftp://ftp.kobic.kr/pub/KOBIC-KoreanGenome/

and have been deposited in the NCBI Short Read Archive:
http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi

under accession no. SRA008175



OTHERS
------

14 others sequenced by Complete Genomics
Unknown number sequenced by Knome
6 genomes sequenced at high depth by the 1000 Genomes Project
180 genomes sequenced at low coverage by the 1000 Genomes Project
Two acute myeloid leukemia patients




SHORT READ ARCHIVE
DEEPLY SEQUENCED HUMAN GENOMES


FAMOUS PEOPLE: 
Craig Venter, James Watson, Stephen Quake, George Church, Marjolein Kriek, Hermann Hauser

YORUBA (NA18507, NA18506, NA18508)
Bentley et al. (2008) Accurate whole human genome sequencing using reversible terminator chemistry.Nature 456: 53-59. 

HAN CHINESE (ERA000005)
Wang, J. et al. (2008) The diploid genome sequence of an Asian individual.
Nature 456: 60-65 

KOREAN Seong-Jin Kim (SRA008175)
Sung-Min Ahn et al. (2009) The first Korean genome sequence and analysis: Full genome sequencing for a socio-ethnic group.
Genome Res. 2009. 19: 1622-1629

KOREAN AK1 
Jong-Il Kim et al. (2009) A highly annotated whole-genome sequence of a Korean individual
Nature 460: 1011-1015

1000 Genomes, PILOT 2 ( > 5x coverage, ~10 individuals )
ftp://ftp.era.ebi.ac.uk/vol1/ERA000/ERA000023/srf/












</entry>



<entry [Tue May 25 02:43:53 EDT 2010] GENERATED hg18 BOWTIE INDEX FILES ON PEGASUS AND KRONOS>




perl /nethome/bioinfo/apps/agua/0.4/bin/apps/bowtieIndex.pl \
--inputdir /nethome/bioinfo/data/sequence/chromosomes/human/hg18/bowtie



    #bowtieIndex.pl    arguments: --inputdir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta
    #bowtieIndex.pl    bowtie: /nethome/bioinfo/apps/BOWTIE/0.12.2
    #bowtieIndex.pl    inputdir: /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta
    #command: time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie-build  chr1.fa chr1
    #...
    #bowtieIndex.pl    Run time: 02:40:16
    #bowtieIndex.pl    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/bowtieIndex.pl
    #bowtieIndex.pl    5:09AM, 28 April 2010
    #bowtieIndex.pl    ****************************************




</entry>



<entry [Wed May 12 13:29:08 EDT 2010] CREATED BOWTIE.pl AND BOWTIE.pm>



mkdir -p /nethome/syoung/base/pipeline/bixby/run1/ln/bowtie/analysis1
cd /nethome/syoung/base/pipeline/bixby/run1/ln/bowtie/analysis1


perl /nethome/bioinfo/apps/agua/0.4/bin/apps/BOWTIE.pl \
--inputfiles /nethome/bioinfo/data/sequence/labs/bixby/run1/s_1_sequence.txt,/nethome/bioinfo/data/sequence/labs/bixby/run1/s_2_sequence.txt \
--params "--solexa1.3-quals" \
--distance 200 \
--queue large \
--reference /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/bowtie \
--outputdir /nethome/syoung/base/pipeline/bixby/run1/ln/bowtie/analysis1 \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species mouse \
--label bowtie1+2





</entry>



<entry [Wed May 12 13:29:08 EDT 2010] COUNT LINES IN SAM FILES>




maq1: PAIRED END
----------------

/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1




maq2: SINGLE READ (50 Million reads)
-----------------------------------

/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2

MAQ hits (50 million reads)	
chr1	1,089,007 
chr2	424,211 
chr3	5,005,746 
chr4	967,796 
chr5	276,823 
chr6	1,921,811 
chr7	2,130,308 
chr8	179,315 
chr9	4,841,640 
chr10	473,292 
chr11	2,771,752 
chr12	1,647,231 
chr13	524,578 
chr14	1,959,956 
chr15	2,140,678 
chr16	1,877,465 
chr17	397,776 
chr18	1,912,812 
chr19	5,368,784 
chr20	6,884,635 
chr21	7,133,556 
chr22	5,304,038 
chrX	370,835 
chrY	1,359,652 
Total	56,963,697 


[syoung@u03 maq2]$ ll */out.sam
-rw-rw-rw- 1 syoung root  72M May  1 09:02 chr10/out.sam
-rw-rw-rw- 1 syoung root 419M May  1 03:26 chr11/out.sam
-rw-rw-rw- 1 syoung root 249M May  1 11:51 chr12/out.sam
-rw-rw-rw- 1 syoung root  80M May  1 07:54 chr13/out.sam
-rw-rw-rw- 1 syoung root 296M May  1 02:46 chr14/out.sam
-rw-rw-rw- 1 syoung root 323M May  1 12:09 chr15/out.sam
-rw-rw-rw- 1 syoung root 284M May  1 02:46 chr16/out.sam
-rw-rw-rw- 1 syoung root  61M May  1 10:14 chr17/out.sam
-rw-rw-rw- 1 syoung root 289M May  1 12:16 chr18/out.sam
-rw-rw-rw- 1 syoung root 809M May  1 06:27 chr19/out.sam
-rw-rw-rw- 1 syoung root 164M May  1 12:06 chr1/out.sam
-rw-rw-rw- 1 syoung root 1.1G May  1 17:33 chr20/out.sam
-rw-rw-rw- 1 syoung root 1.1G May  1 07:27 chr21/out.sam
-rw-rw-rw- 1 syoung root 800M May  1 06:38 chr22/out.sam
-rw-rw-rw- 1 syoung root  64M May  1 11:40 chr2/out.sam
-rw-rw-rw- 1 syoung root 752M May  1 03:32 chr3/out.sam
-rw-rw-rw- 1 syoung root 146M May  1 09:55 chr4/out.sam
-rw-rw-rw- 1 syoung root  42M May  1 02:33 chr5/out.sam
-rw-rw-rw- 1 syoung root 289M May  1 03:16 chr6/out.sam
-rw-rw-rw- 1 syoung root 320M May  1 12:33 chr7/out.sam
-rw-rw-rw- 1 syoung root  28M May  1 10:51 chr8/out.sam
-rw-rw-rw- 1 syoung root 726M May  1 03:58 chr9/out.sam
-rw-rw-rw- 1 syoung root  56M May  1 09:28 chrX/out.sam
-rw-rw-rw- 1 syoung root 204M May  1 11:19 chrY/out.sam



[syoung@u03 maq2]$ lines */out.sam
chr10/out.sam: 473292
chr11/out.sam: 2771752
chr12/out.sam: 1647231
chr13/out.sam: 524578
chr14/out.sam: 1959956
chr15/out.sam: 2140678
chr16/out.sam: 1877465
chr17/out.sam: 397776
chr18/out.sam: 1912812
chr19/out.sam: 5368784
chr1/out.sam: 1089007
chr20/out.sam: 6884635
chr21/out.sam: 7133556
chr22/out.sam: 5304038
chr2/out.sam: 424211
chr3/out.sam: 5005746
chr4/out.sam: 967796
chr5/out.sam: 276823
chr6/out.sam: 1921811
chr7/out.sam: 2130308
chr8/out.sam: 179315
chr9/out.sam: 4841640
chrX/out.sam: 370835
chrY/out.sam: 1359652





[syoung@u03 maq2]$ lines */out.sam
chr10	473292
chr11	2771752
chr12	1647231
chr13	524578
chr14	1959956
chr15	2140678
chr16	1877465
chr17	397776
chr18	1912812
chr19	5368784
chr1	1089007
chr20	6884635
chr21	7133556
chr22	5304038
chr2	424211
chr3	5005746
chr4	967796
chr5	276823
chr6	1921811
chr7	2130308
chr8	179315
chr9	4841640
chrX	370835
chrY	1359652





</entry>



<entry [Wed May 12 03:07:21 EDT 2010] TEST ADDED merge FUNCTION TO Cluster.pm>






1. COPIED REFERENCE FILES 

HUMAN
-----

mkdir -p /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/human/hg19

cp /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta/chrY.fa \
/nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/human/hg19
cp /nethome/bioinfo/data/sequence/chromosomes/human/hg19/bowtie/chrY.* \
/nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/human/hg19

ll /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/human/hg19
    
    -rw-rw-r-- 1 syoung bioinfo  11M May 13 03:02 chrY.1.ebwt
    -rw-rw-r-- 1 syoung bioinfo 3.1M May 13 03:02 chrY.2.ebwt
    -rw-rw-r-- 1 syoung bioinfo  170 May 13 03:02 chrY.3.ebwt
    -rw-rw-r-- 1 syoung bioinfo 6.2M May 13 03:02 chrY.4.ebwt
    -rw-r--r-- 1 syoung bioinfo  58M May 13 03:02 chrY.fa
    -rw-rw-r-- 1 syoung bioinfo  11M May 13 03:02 chrY.rev.1.ebwt
    -rw-rw-r-- 1 syoung bioinfo 3.1M May 13 03:02 chrY.rev.2.ebwt
    -rwxrwxr-x 1 syoung bioinfo  926 May 13 03:02 chrY.sh


MOUSE
-----

mkdir -p /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/mouse/mm9

cp /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/fasta/chrY.fa \
/nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/mouse/mm9

cp /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/bowtie/chrY.* \
/nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/mouse/mm9

cp /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/cufflinks/mm9-knownGene.gtf \
/nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/mouse/mm9


ll /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/mouse/mm9
    
    -rw-r--r-- 1 syoung bioinfo 4.8M May 13 03:37 chrY.1.ebwt
    -rw-r--r-- 1 syoung bioinfo 330K May 13 03:37 chrY.2.ebwt
    -rw-r--r-- 1 syoung bioinfo   44 May 13 03:37 chrY.3.ebwt
    -rw-r--r-- 1 syoung bioinfo 660K May 13 03:37 chrY.4.ebwt
    -rw-r--r-- 1 syoung bioinfo  16M May 13 03:37 chrY.fa
    -rw-r--r-- 1 syoung bioinfo 4.8M May 13 03:37 chrY.rev.1.ebwt
    -rw-r--r-- 1 syoung bioinfo 330K May 13 03:37 chrY.rev.2.ebwt
    -rw-r--r-- 1 syoung bioinfo  83M May 13 03:46 mm9-knownGene.gtf



2. COPIED READS FILE


mkdir -p /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/mouse

cp /nethome/bioinfo/data/sequence/labs/bixby/run1/s_1_sequence.txt \
/nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/mouse

ll /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/mouse
head /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/mouse/s_1_sequence.txt

    @HWI-EAS185:1:1:24:584#0/1
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    +HWI-EAS185:1:1:24:584#0/1
    \XXXX\^\\RNNNNMX\XYMN\X`\^JYX]W\\\[XJW[VW\X]BBBBBBBB
    @HWI-EAS185:1:1:24:1197#0/1
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    +HWI-EAS185:1:1:24:1197#0/1
    ][_X\XX^X\\X\Z_X`\\XX`X\M\XXXX\\\\_XXX_X\X\XXV[XZ^Xa
    @HWI-EAS185:1:1:27:1922#0/1
    GAGGAGGAGGAGGAAGAGAGGGAGGAGGGGGAGGAGAAGAGGGGGAGGAGGG



NUMBER LINES:

lines /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/s_1_sequence.txt

    79,409,068


RECORDS:

    19,852,267


FILE SIZE (3.1 GB):

ll /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/mouse/s_1_sequence.txt
    
    -rw-r--r-- 1 syoung bioinfo 3.1G May 13 03:17 /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/mouse/s_1_sequence.txt




3. RUN TOPHAT TEST

mkdir -p /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/tophat
cd /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/tophat

perl /nethome/bioinfo/apps/agua/0.4/bin/apps/TOPHAT.pl \
--inputfiles /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reads/mouse/s_1_sequence.txt \
--params "--solexa1.3-quals" \
--queue "large" \
--gtf /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/mouse/mm9/mm9-knownGene.gtf \
--reference /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/reference/mouse/mm9 \
--outputdir /nethome/bioinfo/apps/agua/0.4/bin/apps/t/Cluster/tophat \
--keep \
--cluster LSF \
--cpus 4 \
--maxjobs 1000 \
--species mouse \
--label test-tophat \
--reads 250000



NB: NEED CHROMOSOME SIZES FOR STATS

perl /nethome/bioinfo/apps/agua/0.4/bin/apps/TOPHATstats.pl \
--inputdirs /scratch/syoung/base/pipeline/bixby/run1/tophat/analysis13 \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/bowtie \
--chromosomes /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/bowtie/chromosome-sizes.txt


/scratch/syoung/base/pipeline/bixby/run1/tophat/analysis1/chrY



4. RUN MAQ


cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--reads 500000 \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2 \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--maxjobs 5000 \
--label maq2 \
--species human










TEST SIMPLE RUN
===============

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/clusterMerge.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/clusterMerge.pl \
--inputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22 \
--pattern "*/out.sam" \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22/out.sam \
--type sam


/nethome/bioinfo/apps/agua/0.4/bin/apps/clusterMerge.pl \
--inputdir "/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22/*" \
--pattern "out.map" \
--outputfile /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22/out.map \
--type map

OK!











++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

RERUN maq1 AND RUN maq3: READ FILES 1 AND 3 (IN SINGLE READ MODE)



MAQ
---


PAIRED END
----------

mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1
cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1

screen -S maq1

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--reads 500000 \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1 \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--matefile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--maxjobs 5000 \
--label maq1 \
--species human 

#### --stdout /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/maq.outerr \

    
    RUNNING:

    Tue May 11 01:19:48 EDT 2010
    :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    QUEUE_NAME      PRIO STATUS          MAX JL/U JL/P JL/H NJOBS  PEND   RUN  SUSP 
    small           100  Open:Active       -    -    -    -     0     0     0     0
    training        100  Open:Active       -    -    -    -     0     0     0     0
    medium           90  Open:Active       -    -    -    -     0     0     0     0
    large            80  Open:Active       -    -    -    -  1963    33  1930     0
    ngs              80  Open:Active       -    -    -    -     0     0     0     0
    mpi              80  Open:Active       -    -    -    -    64     0    64     0
    test             80  Open:Active       -    -    -    -   304     0   304     0
    sagempi          80  Open:Active       -    -    -    -     0     0     0     0
    kirtman          80  Open:Active       -    -    -    -    80     0    80     0
    ashwanth         80  Open:Active       -    -    -    -     0     0     0     0
    
    Tue May 11 01:19:51 EDT 2010
    :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


FAILED:

Tue May 11 16:51:35 EDT 2010


    Job <589230> is submitted to queue <large>.
    Job <589231> is submitted to queue <large>.
    Job <589232> is submitted to queue <large>.
    Host does not have a software license. Job not submitted.


RERAN:

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl --reads 500000 --cluster LSF --queue large --tempdir /tmp --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1 --inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq --matefile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq --referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq --maxjobs 5000 --label maq1 --species human 
    
    MAQ.pl    inputfiles: /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
    MAQ.pl    matefiles: /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq
    MAQ.pl    outputdir: /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1
    MAQ.pl    referencedir: /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq
    MAQ::run    MAQ::run()
    MAQ::run    Doing run on cluster (IN PARALLEL)
    MAQ::runInParallel    MAQ::runInParallel()
    referencefiles: chrY.bfa chrX.bfa chr22.bfa.bfa chr22.bfa chr21.bfa chr20.bfa chr19.bfa chr18.bfa chr17.bfa chr16.bfa chr15.bfa chr14.bfa chr13.bfa chr12.bfa chr11.bfa chr10.bfa chr9.bfa chr8.bfa chr7.bfa chr6.bfa chr5.bfa chr4.bfa chr3.bfa chr2.bfa chr1.bfa
    MAQ::runInParallel    Doing faToBfa()       10-05-11 16:51:41
    -- 0 sequences have been converted.
    0.00user 0.00system 0:00.00elapsed 0%CPU (0avgtext+0avgdata 0maxresident)k
    0inputs+0outputs (0major+288minor)pagefaults 0swaps
    MAQ::runInParallel    After faToBfa()       10-05-11 16:51:41
    MAQ::runInParallel    Doing doSplitfiles()  10-05-11 16:51:41
    MAQ::runInParallel    After doSplitfiles()  10-05-11 16:51:41
    MAQ::::run    length splitfiles: 100
    MAQ::runInParallel    Doing fastqToBfq      10-05-11 16:51:41
    MAQ::    RUNNING 100 jobs...
    Cluster::runJobs    Running 100 jobs
    Job <599857> is submitted to queue <large>.
    Job <599858> is submitted to queue <large>.
    Job <599859> is submitted to queue <large>.
    Job <599860> is submitted to queue <large>.
    Job <599861> is submitted to queue <large>.
    Job <599862> is submitted to queue <large>.
    ...
    
    
STILL RUNNING :

Wed May 12 14:02:09 EDT 2010

BUT GET "LSF is processing your request. Please wait ..."

    ...
    Job <617404> is submitted to queue <large>.
    Job <617405> is submitted to queue <large>.
    Job <617406> is submitted to queue <large>.
    Job <617407> is submitted to queue <large>.
    Job <617408> is submitted to queue <large>.
    Job <617409> is submitted to queue <large>.
    Job <617410> is submitted to queue <large>.
    LSF is processing your request. Please wait ...
    LSF is processing your request. Please wait ...
    LSF is processing your request. Please wait ...
    LSF is processing your request. Please wait ...


CURRENTLY DOING MERGE:

bpeek 622482

    Doing subfile 50 of 199
    -rw-rw-rw- 1 syoung root 853401080 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam
    mv: `/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam' and `/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam.temp' are the same file
    -rw-rw-rw- 1 syoung root 853401080 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam.temp
    Doing subfile 51 of 199
    -rw-rw-rw- 1 syoung root 872230974 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam
    mv: cannot stat `/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam': No such file or directory
    -rw-rw-rw- 1 syoung root 872230974 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam.temp
    Doing subfile 52 of 199
    
    



SINGLE READ, 1 AND 3
--------------------


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3
cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3

screen -S maq3

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl


WITHOUT STDOUT:

cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--reads 500000 \
--cluster LSF \
--queue large \
--tempdir /tmp \    
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3 \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.3.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--maxjobs 5000 \
--label maq3 \
--species human

    
    QUEUE_NAME      PRIO STATUS          MAX JL/U JL/P JL/H NJOBS  PEND   RUN  SUSP 
    small           100  Open:Active       -    -    -    -     0     0     0     0
    training        100  Open:Active       -    -    -    -     0     0     0     0
    medium           90  Open:Active       -    -    -    -     0     0     0     0
    large            80  Open:Active       -    -    -    -   720    24   696     0
    ngs              80  Open:Active       -    -    -    -     0     0     0     0
    mpi              80  Open:Active       -    -    -    -    64     0    64     0
    test             80  Open:Active       -    -    -    -   304     0   304     0
    sagempi          80  Open:Active       -    -    -    -     0     0     0     0
    kirtman          80  Open:Active       -    -    -    -    80     0    80     0
    ashwanth         80  Open:Active       -    -    -    -     0     0     0     0
    
    Tue May 11 01:16:32 EDT 2010
    :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


    RUNNING...

        Job <594400> is submitted to queue <large>.
        Job <594401> is submitted to queue <large>.
        Job <594402> is submitted to queue <large>.
        Job <594403> is submitted to queue <large>.
        Job <594404> is submitted to queue <large>.
        Job <594405> is submitted to queue <large>.
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        lsb_queryjobinfo: Host does not have a software license
        Cluster::runJobs    Completed mergeSam at 10-05-11 15:19:06, duration: 02:07:58
        Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
        Cluster::samtoolSnps    After mergeSam      10-05-11 15:19:06
        Cluster::samtoolSnps    Doing samToBam      10-05-11 15:19:06
        Cluster::runJobs    Running 72 jobs
        Host does not have a software license. Job not submitted.


RESUBMITTED
Tue May 11 16:03:11 EDT 2010


bash-3.2$ /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl --reads 500000 --cluster LSF --queue large --tempdir /tmp --outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3 --inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.3.fastq --referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq --maxjobs 5000 --label maq3 --species human



GOT ERROR LSF is down

Wed May 12 23:31:58 EDT 2010
    
    From: Young, Stuart 
    Sent: Wednesday, May 12, 2010 11:29 PM
    To: CCS HPC (High Performance Computing - RT)
    Cc: Zysman, Joel
    Subject: 
    
    Hi Zongjun,
    
    Im getting the LSF is down error again:
    
    Job <622479> is submitted to queue <large>.
    Job <622480> is submitted to queue <large>.
    Job <622481> is submitted to queue <large>.
    Job <622482> is submitted to queue <large>.
    LSF is processing your request. Please wait ...
    LSF is processing your request. Please wait ...
    LSF is processing your request. Please wait ...
    LSF is down. Please wait ...
    LSF is down. Please wait ...
    
    Did you restart the scheduler last time this happened?
    
    My current jobs seem to be running okay right now but Im wondering what will happen when they finish and the next jobs have to be scheduled.
    
    Cheers,
    
    Stuart.

    
    Doing subfile 72 of 199
    -rw-rw-rw- 1 syoung root 1255612846 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam
    mv: cannot stat `/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam': No such file or directory
    -rw-rw-rw- 1 syoung root 1255612846 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam.temp
    Doing subfile 73 of 199
    -rw-rw-rw- 1 syoung root 1273158389 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam
    mv: cannot stat `/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam': No such file or directory
    -rw-rw-rw- 1 syoung root 1273158389 May 12 2010 /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq3/chr1/out.sam.temp
    Doing subfile 74 of 199






</entry>



<entry [Sun May  3 02:41:10 EDT 2010] ADD NOVOALIGN.pm AND BOWTIE.pm>




SAMTOOLS CONVERTERS TO SAM FORMAT:


ls /nethome/syoung/base/apps/samtools/0.1.6/*2sam*

    blast2sam.pl   export2sam.pl  maq2sam-short  psl2sam.pl   zoom2sam.pl
    bowtie2sam.pl  maq2sam-long   novo2sam.pl    soap2sam.pl




</entry>



<entry [Sun May  3 02:41:10 EDT 2010] CONVERT READ FILE PAIR 3 AND 10 TO CORRECT FORMAT FOR MAQ AND ELAND>




1. CREATE readsPlain FILES WITHOUT MACHINE ID 
=============================================

ACCORDING TO THE ILLUMINA FORMAT:
http://en.wikipedia.org/wiki/FASTQ_format

Illumina sequence identifiers
Sequences from the Illumina software use a systematic identifier:
@HWUSI-EAS100R:6:73:941:1973#0/1
HWUSI-EAS100R	the unique instrument name
6	flowcell lane
73	tile number within the flowcell lane
941	'x'-coordinate of the cluster within the tile
1973	'y'-coordinate of the cluster within the tile
#0	index number for a multiplexed sample (0 for no indexing)
/1	the member of a pair, /1 or /2 (paired-end or mate-pair reads only)
Versions of the Illumina pipeline since 1.4 appear to use #NNNNNN instead of #0 for the multiplex ID, where NNNNNN is the sequence of the multiplex tag from the beginning of the read.


NB: NCBI Short Read Archive

FASTQ files from the NCBI Short Read Archive often include a description, e.g.
@SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=36
GGGTGATGGCCGCTGCCGATGGCGTCAAATCCCACC
+SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=36
IIIIIIIIIIIIIIIIIIIIIIIIIIIIII9IG9IC

In this example there is an NCBI-assigned identifier, and the description holds the original identifier from Solexa/Illumina (as described above) plus the read length.
Also note that the NCBI have converted this FASTQ data from the original Solexa/Illumina encoding to the Sanger standard (see encodings below).


/scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.3.fastq
/scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_2.3.fastq/scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.3.fastq

sed COMMANDS:

3.fastq
-------

sed -e 's/FC[A-Z0-9\.\_]*:\([0-9\:]*\)/\1#\/1/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.3.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.3.fastq 

sed -e 's/FC[A-Z0-9\.\_]*:\([0-9\:]*\)/\1#\/2/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.3.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_2.3.fastq 


10.fastq
-------

sed -e 's/FC[A-Z0-9\.\_]*:\([0-9\:]*\)/\1#\/1/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.10.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.10.fastq 

sed -e 's/FC[A-Z0-9\.\_]*:\([0-9\:]*\)/\1#\/2/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.10.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_2.10.fastq 



running Tue May  4 04:42:47 EDT 2010



2. REPLACE @ WITH A IN QUALITY LINE
===================================


3.fastq
-------

/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.3.fastq \
--dot 100000


/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_2.3.fastq \
--dot 100000

    Run time: 00:06:25
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl
    3:29AM, 10 May 2010
    ****************************************


10.fastq
-------

/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.10.fastq \
--dot 100000


/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_2.10.fastq \
--dot 100000

    
    Run time: 00:06:17
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl
    3:29AM, 10 May 2010
    ****************************************



</entry>



<entry [Sun May  3 02:41:10 EDT 2010] CREATE 'NOSPACE' HUMAN, MOUSE AND RAT CHROMOSOME FASTA FILES (REQUIRED FOR USING getbases.pl)>



HUMAN

/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/nospaces.pl \
--inputfile /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta \
--outputfile /nethome/bioinfo/data/sequence/chromosomes/human/hg19/nospace

    
    Run time: 00:01:56
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/utils/nospaces.pl
    0:41AM, 3 May 2010
    ****************************************

MOUSE

/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/nospaces.pl \
--inputfile /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/fasta \
--outputfile /nethome/bioinfo/data/sequence/chromosomes/mouse/mm9/nospace

    Run time: 00:02:22
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/utils/nospaces.pl
    1:13AM, 3 May 2010
    ****************************************


RAT

/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/nospaces.pl \
--inputfile /nethome/bioinfo/data/sequence/chromosomes/rat/rn4/fasta \
--outputfile /nethome/bioinfo/data/sequence/chromosomes/rat/rn4/nospace

    Run time: 00:02:28
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/utils/nospaces.pl
    1:12AM, 3 May 2010
    ****************************************



</entry>



<entry [Wed Apr 28 02:41:10 EDT 2010] BUILD BOWTIE INDEXES FOR HUMAN CHROMOSOMES>



perl /nethome/bioinfo/apps/agua/0.4/bin/apps/bowtieIndex.pl \
--inputdir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta

    bowtieIndex.pl    arguments: --inputdir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta
    bowtieIndex.pl    bowtie: /nethome/bioinfo/apps/BOWTIE/0.12.2
    bowtieIndex.pl    inputdir: /nethome/bioinfo/data/sequence/chromosomes/human/hg19/fasta
    command: time /nethome/bioinfo/apps/BOWTIE/0.12.2/bowtie-build  chr1.fa chr1
    ...
    bowtieIndex.pl    Run time: 02:40:16
    bowtieIndex.pl    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/bowtieIndex.pl
    bowtieIndex.pl    5:09AM, 28 April 2010
    bowtieIndex.pl    ****************************************
    
    

</entry>



<entry [Wed Apr 14 05:15:56 EDT 2010] RUN ELAND, MAQ, BOWTIE, BWA, NOVOALIGN AND SHRIMP ON NA18507>




1. CONVERT '@' TO 'A' IN FASTQ QUALITY 
======================================

TO AVOID THIS ERROR:

    #### Converting .fastq file to .bfq file...
    time /nethome/bioinfo/apps/maq/0.7.1/maq fastq2bfq /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/100/maq1_1.100.fastq /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/100/maq1_1.100.bfq
    ...
    LSB_JOBFILENAME:  /nethome/syoung/.lsbatch/1271619372.420208
    LD_LIBRARY_PATH:  /share/apps/lsf/7.0/linux2.6-glibc2.3-x86_64/lib:
    [seq_read_fastq] Inconsistent sequence name: HII. Continue anyway.
    [seq_read_fastq] Inconsistent sequence name: @IBAIICI. Continue anyway.
    [seq_read_fastq] Inconsistent sequence name: 0IIIIIIIIII. Continue anyway.


/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--dot 100000

    ...
    Sampler::replaceAtQual    49800000
    Sampler::replaceAtQual    49900000
    Sampler::replaceAtQual    Doing copyback
    Sampler::replaceAtQual    Sampler::
    Sampler::replaceAtQual    output file printed:
    /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq-temp
    Run time: 00:06:34
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl
    9:45PM, 18 April 2010
    ****************************************


/nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--dot 100000
    
    ...
    Sampler::replaceAtQual    49800000
    Sampler::replaceAtQual    49900000
    Sampler::replaceAtQual    Doing copyback
    Sampler::replaceAtQual    Sampler::
    
    Run time: 00:06:44
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/utils/replaceAtQual.pl
    9:47PM, 18 April 2010
    ****************************************	



2. CREATE *.fai FILES FOR CONVERTING SAM TO BAM
===============================================

INDEX FILES WITH SAMTOOLS

screen -S human-faidx

perl /nethome/bioinfo/apps/agua/0.4/bin/apps/bowtieRefList.pl \
--inputdir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/samtools \
--queue large


OK



MAQ
===


SINGLE READ
-----------


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2
cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2

screen -S maq2

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl


WITHOUT STDOUT:

cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--reads 500000 \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2 \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--maxjobs 5000 \
--label maq2 \
--species human

    Job <497324> is submitted to queue <large>.
    Job <497326> is submitted to queue <large>.
    Job <497328> is submitted to queue <large>.
    Cluster::runJobs    Completed mapToSam at 10-04-30 18:17:41, duration: 02:32:35
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    MAQ::runInParallel    After mapToSam        10-04-30 18:17:41
    MAQ::runInParallel    Doing samtoolSnps      10-04-30 18:17:41
    Cluster::samtoolSnps    Cluster::samtoolSnps(splitfiles, referencedir, outputdir)
    Cluster::samtoolSnps    referencedir: /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq
    Cluster::samtoolSnps    outputdir: /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2
    Cluster::listReferenceFiles    Cluster::listReferenceFiles(referencedir, pattern)
    Cluster::listReferenceFiles    referencedir: /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq
    Cluster::listReferenceFiles    pattern: *fa
    Cluster::samtoolSnps    referencefiles: chrY.bfa chrX.bfa chr22.bfa.bfa chr22.bfa chr21.bfa chr20.bfa chr19.bfa chr18.bfa chr17.bfa chr16.bfa chr15.bfa chr14.bfa chr13.bfa chr12.bfa chr11.bfa chr10.bfa chr9.bfa chr8.bfa chr7.bfa chr6.bfa chr5.bfa chr4.bfa chr3.bfa chr2.bfa chr1.bfa


ALIGNMENTS COMPLETED OKAY 

ll -tr /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2/chr1

    ...    
    drwxrwxrwx   2 syoung root       173 Apr 30 17:46 99
    -rw-rw-rw-   1 syoung root      8706 Apr 30 12:12 assemble.log
    -rwxrwxrwx   1 syoung root     56621 Apr 30 04:13 chr1.sh
    -rw-rw-rw-   1 syoung root     28577 Apr 30 12:18 chr1-stdout.txt
    -rw-rw-rw-   1 syoung root 502741104 Apr 30 12:13 cns.fq
    -rw-rw-rw-   1 syoung root  49293159 Apr 30 12:14 cns.snp
    -rw-rw-rw-   1 syoung root 409129708 Apr 30 12:12 consensus.cns
    -rw-rw-rw-   1 syoung root      5424 Apr 30 12:08 mapcheck.txt
    -rw-rw-rw-   1 syoung root         0 Apr 30 12:16 out.indelpe
    -rw-rw-rw-   1 syoung root    147270 Apr 30 12:17 out.indelsoa
    -rw-rw-rw-   1 syoung root      9685 Apr 30 12:17 out.indelsoa.filter
    -rw-rw-rw-   1 syoung root 511277434 Apr 30 12:07 out.map
    -rw-rw-rw-   1 syoung root 511277434 Apr 30 12:16 out.rmdup
    -rw-rw-rw-   1 syoung root   5511370 Apr 30 12:18 out.SNPfilter

WITH STDOUT REDIRECTED:

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--reads 500000 \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2/maq.outerr \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--maxjobs 5000 \
--label maq2 \
--species human 



##\
##--clean








PAIRED END
----------


mkdir -p /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1
cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1

screen -S maq1

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--reads 500000 \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1 \
--stdout /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/maq.outerr \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--matefile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--maxjobs 5000 \
--parallel \
--label maq1 \
--species human 


RETRUN




##\
##--clean



WITHOUT STDOUT:

cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1

/nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--reads 500000 \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1 \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--matefile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq \
--maxjobs 5000 \
--parallel \
--label maq1 \
--species human

    ...
    Job <497456> is submitted to queue <large>.
    Job <497458> is submitted to queue <large>.
    Cluster::runJobs    Completed bamToSnp at 10-04-30 18:11:34, duration: 00:19:02
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After bamToSnp      10-04-30 18:11:34
    MAQ::runInParallel    After samtoolSnps      10-04-30 18:11:34
    MAQ::runInParallel    Doing printUsage       10-04-30 18:11:34
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/maq-USAGE.txt
    MAQ::runInParallel    After printUsage       10-04-30 18:11:35
    MAQ.pl    Run time: 26:31:28
    MAQ.pl    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl
    MAQ.pl    10-04-30 18:11:35
    MAQ.pl    ****************************************






RERUN USING CORRECT FORMAT IN FASTQ HEADER:

    ...
    Job <547706> is submitted to queue <large>.
    Job <547707> is submitted to queue <large>.
    Job <547708> is submitted to queue <large>.
    Job <547709> is submitted to queue <large>.
    Job <547710> is submitted to queue <large>.
    Job <547711> is submitted to queue <large>.
    Cluster::runJobs    Completed bamToSnp at 10-05-02 18:17:56, duration: 00:25:48
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After bamToSnp      10-05-02 18:17:56
    MAQ::runInParallel    After samtoolSnps      10-05-02 18:17:56
    MAQ::runInParallel    Doing printUsage       10-05-02 18:17:56
    Cluster::printUsage    Printing USAGE file: /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq2/maq-USAGE.txt
    MAQ::runInParallel    After printUsage       10-05-02 18:17:56
    MAQ.pl    Run time: 40:50:08
    MAQ.pl    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl
    MAQ.pl    10-05-02 18:17:56
    MAQ.pl    ****************************************




TEST
----

chr22

    Cluster::runJobs    Completed samToBam at 10-04-29 13:25:24, duration: 00:12:27
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    Cluster::samtoolSnps    After samToBam      10-04-29 13:25:24


SAMTOOLS SNP FILE FOR CHROMOSOME 22:

cd /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22
head out.filter

    chr22   14437955        N       A       57      0       49      10      AA-2NNAAaaAAaa  :91::9:X05
    chr22   14437955        *       -NN/-NN 0       0       49      10      -NN     *       1       9      0
    chr22   14442934        N       T       51      0       55      8       Tt-3nnntt-3nnntTTt-3nnn IHX_6451
    chr22   14442934        *       -NNN/-NNN       0       0       55      8       -NNN    *       3      0
    chr22   14443496        N       A       72      0       52      18      A$A$a$aAa*A**aA-1NAaAAaA       I<FCI4:::29::18XI1
    chr22   14443496        *       -N/-N   0       0       52      18      -N      *       1       17     0
    chr22   14443734        N       A       81      0       53      18      a$AaAAAaAAAa-1nA-1NA-1NAa-1naaaFI2I:I3441:831::4I
    chr22   14443734        *       -N/-N   0       0       53      18      -N      *       4       14     0
    chr22   14444980        N       T       78      0       59      17      TTTtttt-1nt-1ntttTttTtt ,I-187W48AA0X:9:5
    chr22   14444980        *       -N/-N   0       0       59      17      -N      *       2       15     0





COMPARISON OF MAQ AND SAMTOOLS SNP COUNTS:


head /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22/chr22-out.SNPfilter

    -- 4417 potential pe-indels pass the filter.
    chr22   14430036        A       C       15      4       1.00    63      38      M       39      A
    chr22   14430612        C       S       8       6       1.00    63      44      G       22      C
    chr22   14430678        C       T       24      7       1.00    63      44      Y       150     C
    chr22   14430967        C       G       17      5       1.00    63      38      S       66      C
    chr22   14431018        A       C       11      7       1.00    42      28      Y       41      T
    chr22   14431107        C       A       10      1       1.00    63      22      N       20      N
    chr22   14431209        A       R       10      9       1.00    63      34      G       32      A
    chr22   14431241        C       T       39      4       1.00    63      38      N       67      N
    chr22   14431255        C       T       28      8       1.00    63      36      Y       58      C


lines /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22/chr22-out.SNPfilter

    57973


head /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22/out.SNPfilter


ll /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chr22

    -rw-rw-rw-   1 syoung root 8.5K Apr 29 23:24 assemble.log
    -rwxrwxrwx   1 syoung root 1.3K Apr 29 15:21 bamToSnp-chr22.sh
    -rw-rw-rw-   1 syoung root 7.1K Apr 29 15:27 bamToSnp-chr22-stdout.txt
    -rw-rw-rw-   1 syoung root 8.5K Apr 28 18:40 chr22-assemble.log
    -rw-rw-rw-   1 syoung root  97M Apr 28 18:40 chr22-cns.fq
    -rw-rw-rw-   1 syoung root  11M Apr 28 18:40 chr22-cns.snp
    -rw-rw-rw-   1 syoung root  94M Apr 28 18:40 chr22-consensus.cns
    -rw-rw-rw-   1 syoung root 5.3K Apr 28 18:38 chr22-mapcheck.txt
    -rw-rw-rw-   1 syoung root  26M Apr 28 18:44 chr22-out.indelpe
    -rw-rw-rw-   1 syoung root 3.0M Apr 28 18:45 chr22-out.indelsoa
    -rw-rw-rw-   1 syoung root 573K Apr 28 18:45 chr22-out.indelsoa.filter
    -rw-rw-rw-   1 syoung root 783M Apr 28 18:37 chr22-out.map
    -rw-rw-rw-   1 syoung root 765M Apr 28 18:43 chr22-out.rmdup
    -rw-rw-rw-   1 syoung root 2.4M Apr 28 18:45 chr22-out.SNPfilter
    -rwxrwxrwx   1 syoung root  56K Apr 29 17:39 chr22.sh
    -rw-rw-r--   1 syoung root  30K Apr 29 02:02 #chr22-stdout.txt#
    -rw-rw-rw-   1 syoung root  58K Apr 29 23:32 chr22-stdout.txt
    -rw-rw-rw-   1 syoung root  97M Apr 29 23:25 cns.fq
    -rw-rw-rw-   1 syoung root  11M Apr 29 23:25 cns.snp
    -rw-rw-rw-   1 syoung root  94M Apr 29 23:24 consensus.cns
    -rwxrwxrwx   1 syoung root  845 Apr 29 14:40 indexBam-chr22.sh
    -rw-rw-rw-   1 syoung root 4.6K Apr 29 14:40 indexBam-chr22-stdout.txt
    -rw-rw-rw-   1 syoung root 5.3K Apr 29 23:22 mapcheck.txt
    -rwxrwxrwx   1 syoung root  54K Apr 29 04:22 mergesam-chr22.sh
    -rwxrwxrwx   1 syoung root  54K Apr 30 03:08 mergeSam-chr22.sh
    -rw-rw-rw-   1 syoung root  61K Apr 29 05:25 mergesam-chr22-stdout.txt
    -rw-r--r--   1 syoung root 701M Apr 29 14:27 out.bam
    -rw-rw-rw-   1 syoung root 102K Apr 29 14:40 out.bam.bai
    -rw-rw-rw-   1 syoung root 1.5M Apr 29 15:27 out.filter
    -rw-rw-r--   1 syoung root 1.5M Apr 29 23:12 out.filter.bkp
    -rw-rw-rw-   1 syoung root  26M Apr 29 23:31 out.indelpe
    -rw-rw-rw-   1 syoung root 3.0M Apr 29 23:32 out.indelsoa
    -rw-rw-rw-   1 syoung root 574K Apr 29 23:32 out.indelsoa.filter
    -rw-rw-rw-   1 syoung root 783M Apr 29 23:18 out.map
    -rw-rw-r--   1 syoung root 1.2G Apr 29 15:27 out.raw
    -rw-rw-rw-   1 syoung root 765M Apr 29 23:29 out.rmdup
    -rw-rw-rw-   1 syoung root 466M Apr 30 04:31 out.sam
    -rw-rw-rw-   1 syoung root 597M Apr 30 04:23 out.sam.temp
    -rw-rw-rw-   1 syoung root 1.3M Apr 29 15:27 out.snp
    -rw-rw-rw-   1 syoung root 2.4M Apr 29 23:32 out.SNPfilter
    -rw-r--r--   1 syoung root 726M Apr 29 13:15 out.unsorted.bam
    -rwxrwxrwx   1 syoung root 1.5K Apr 29 14:40 samToBam-chr22.sh
    -rw-rw-rw-   1 syoung root  26K Apr 29 14:40 samToBam-chr22-stdout.txt
    -rwxrwxrwx   1 syoung root  915 Apr 29 14:19 sortBam-chr22.sh
    -rw-rw-rw-   1 syoung root 3.1K Apr 29 14:27 sortBam-chr22-stdout.txt









ELAND
=====

SINGLE READ
-----------

mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland2

cd /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland2



/nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--reads 500000 \
--inputtype fastq \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland2 \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--maxjobs 600 \
--subdirs \
--label eland2 \
--species human \
--clean
    
    ...
    Job <498105> is submitted to queue <large>.
    Job <498106> is submitted to queue <large>.
    Cluster::runJobs    Completed BATCH 1 at 10-04-30 18:20:52, duration: 01:14:38
    Cluster::runJobs    cleanup not defined. Leaving scriptfiles.
    ELAND::runInParallel    After doAlignment()    10-04-30 18:20:52
    ELAND::::run    length splitfiles: 100


/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland2/1/eland2_1.1.fastq \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland2/1/eland2_2.1.fastq


PAIRED-END
----------



mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland1

cd /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland1

/nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--reads 500000 \
--inputtype fastq \
--cluster LSF \
--queue large \
--tempdir /tmp \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland1 \
--inputfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPairInfo_1.1.fastq \
--matefile /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPairInfo_2.1.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--maxjobs 600 \
--subdirs \
--label eland1 \
--species human






/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland1/1/eland1_1.1.fastq \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland1/1/eland1_2.1.fastq




TROUBLESHOOTING
===============


ELAND_standalone.pl
-------------------

DOING SINGLE READ ANALYSIS WITH READ DATA FORMAT:

SRR002271.28 FC2012M_R1:1:1:881:458#/1


ERROR:

/nethome/syoung/base/apps/GAPipeline/1.5.1/bin/ELAND_standalone.pl: single input-file specified, will do single read analysis
/nethome/syoung/base/apps/GAPipeline/1.5.1/bin/ELAND_standalone.pl: deduced read length of 36 for data in /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland2/1/eland2_1.1.fastq

Could not identify index of the following line: SRR002271.28 FC2012M_R1:1:1:881:458#/1          


DIAGNOSIS:

    THE INCLUSION OF A MACHINE ID IN THE FASTQ HEADER IS NOT ANTICIPATED IN THE REGEX IN
    
    ELAND_standalone.pl LINE 633:
    
    if( !($_[0] =~ /^(\S+):(\d+):(\d+):(\d+):(\d+)/) ) {
 

    SO IT CAN'T PARSE PROPERLY THIS HEADER:
    
    SRR002271.28 FC2012M_R1:1:1:881:458#/1                         



SOLUTION:

    EDIT LINE 626 IN emacs /nethome/syoung/base/apps/GAPipeline/1.5.1/bin/ELAND_standalone.pl:
    
    die "\nCould not identify index of the following line: $_[0] \nPlease check your files.\n"\
;

    CHANGE TO:

#    die "\nCould not identify index of the following line: $_[0] \nPlease check your files.\n"\
;






ERROR:

Could not parse the following line: SRR002271.28 FC2012M_R1:1:1:881:458#/1                          

SOLUTION:

EDIT LINE 638


    # check basic information                                                                                                                                
    if( !($_[0] =~ /^(\w+):(\d+):(\d+):(\d+):(\d+)/) ) {
#       die "\nCould not parse the following line: $_[0] \nPlease check your files.\n";                                                                      
    }


ERROR2:

/nethome/syoung/base/apps/GAPipeline/1.5.1/bin/ELAND_standalone.pl: single input-file specified, will do single read analysis
/nethome/syoung/base/apps/GAPipeline/1.5.1/bin/ELAND_standalone.pl: deduced read length of 36 for data in /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland2/1/eland2_1.1.fastq
/nethome/syoung/base/apps/GAPipeline/1.5.1/bin/ELAND_standalone.pl: Setting seed length for ./reanalysis_eland_extended.txt to 32
/nethome/syoung/base/apps/GAPipeline/1.5.1/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline/1.5.1/bin/../bin/buildSeq.pl --fasta ./reanalysis_qseq.txt > ./reanalysis_eland_query.txt

ERROR: getQseqRead wrong number of fields [3] expected [11] in [GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    1]


=======================================================================
exit code: 2304
buildSeq using ./reanalysis_qseq.txt did not finish properly!

Exiting...
=======================================================================










ERROR:

/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl \
--input-type fastq \
--eland-genome /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chrY \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland1/1/eland1_1.1.fastq \
--input-file /scratch/syoung/base/pipeline/SRA/NA18507/eland/eland1/1/eland1_2.1.fastq \


    User: 0s System: 0s Actual: 6e-06s Efficiency: 0%
    Trying to open directory /nethome/bioinfo/data/sequence/chromosomes/human/hg19/eland/chrY ...
     ... success, will output file sizes to XML
    User: 0s System: 0s Actual: 0.00145s Efficiency: 0%
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: squashGenome succeded
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl --circular 32 32 ./reanalysis_1_eland_extended.txt  ./reanalysis_2_eland_extended.txt ./reanalysis_1_qseq.txt ./reanalysis_2_qseq.txt ./reanalysis_1_calsaf.txt ./reanalysis_2_calsaf.txt ./reanalysis_anomaly.txt ./reanalysis_genomesize.xml > ./reanalysis_pair.xml
    
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: setting circular to Y
    Obtained total genome size of 57772954 bp
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Found 3252 initial pairs from 500000 clusters
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: only 0.65040 percent of clusters with unique alignment of each read, need 10 percent to do paired alignment
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Nominal orientation of this sample appears to be Rp
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: warning - data will be treated as two sets of unpaired reads
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Deduced read length of 36 for read 1
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Deduced read length of 36 for read 2
    Obtained rest-of-genome correction of 2.44677977491035e-14
    Obtained rest-of-genome correction of 2.44677977491035e-14
    Obtained rest-of-genome correction of 5.18125771006137e-36
    Can't take log of -4.01187 at /home/syoung/base/apps/GAPipeline-1.4.0/lib/perl/Gerald/Common.pm line 1601, <READ2> line 500001.
    
    
    =======================================================================
    exit code: 2304
    pickBestPair did not finish properly!
    
    Exiting...
    =======================================================================



DIAGNOSIS:


???


SOLUTION:


???




ERROR: 

WHEN RUNNING ELAND_standalone.pl
    
    Could not identify pair information of the following line: SRR002271.28 FC2012M_R1:1:1:881:458                          
    Please check your files.


DIAGNOSIS:

    THE /1 OR /2 AT END OF LINE IS MISSING 


SOLUTION:

ADD MATE PAIR INFO TO FASTQ IDS IN READ FILES

ADD '#/1' AND '#/2' AT THE END OF EVERY FASTA ID IN INPUT READ FILES:

/scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
/scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq


1. CREATE readsPairInfo FILES WITH MACHINE ID
=============================================

/scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPairInfo_1.1.fastq
/scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPairInfo_2.1.fastq


sed COMMANDS:

sed -e 's/\(SRR[A-Z0-9\s\.]* [A-Z0-9\s\.\:\_]*\)/\1#\/1/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPairInfo_1.1.fastq 

sed -e 's/\(SRR[A-Z0-9\s\.]* [A-Z0-9\s\.\:\_]*\)/\1#\/2/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPairInfo_2.1.fastq 


head  /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq

    @SRR002271.28 FC2012M_R1:1:1:881:458                         
    GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
    +SRR002271.28 FC2012M_R1:1:1:881:458                         
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR002271.69 FC2012M_R1:1:1:565:398                         
    GGGGAGTGGAGATAAAGGTAGAACTACAAAAAATGT
    +SRR002271.69 FC2012M_R1:1:1:565:398                         
    IIIIIIIIIIIIIIIIII6II8I;C>219822B3;7
    @SRR002271.94 FC2012M_R1:1:1:903:411                         
    GAAGACCTAACTCTTCAGGGTTTTAAAATATTTGAT


head /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPairInfo_1.1.fastq 

    @SRR002271.28 FC2012M_R1:1:1:881:458#/1                         
    GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
    +SRR002271.28 FC2012M_R1:1:1:881:458#/1                         
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR002271.69 FC2012M_R1:1:1:565:398#/1                         
    GGGGAGTGGAGATAAAGGTAGAACTACAAAAAATGT
    +SRR002271.69 FC2012M_R1:1:1:565:398#/1                         
    IIIIIIIIIIIIIIIIII6II8I;C>219822B3;7
    @SRR002271.94 FC2012M_R1:1:1:903:411#/1                         
    GAAGACCTAACTCTTCAGGGTTTTAAAATATTTGAT




2. CREATE readsPlain FILES WITHOUT MACHINE ID 
=============================================

/scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.1.fastq
/scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_2.1.fastq

sed COMMANDS:

sed -e 's/FC[A-Z0-9\.\_]*:\([0-9\:]*\)/\1#\/1/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_1.1.fastq 

sed -e 's/FC[A-Z0-9\.\_]*:\([0-9\:]*\)/\2#\/1/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq > /scratch/syoung/base/pipeline/SRA/NA18507/samples/readsPlain_2.1.fastq 






TEST WITH SHORT FILE:
---------------------
sed -e 's/\(chr[A-Z0-9]*\)/\1.fa/' < chr1.fa.fai > TMP; mv -f TMP  chr1.fa.fai

chopfile /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1-4.fastq 4

cp /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1-4.fastq /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1-4.fastq.bkp


readsPairInfo
-------------

sed -e 's/\(SRR[A-Z0-9\s\.]* [A-Z0-9\s\.\:\_]*\)/\1#\/1/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1-4.fastq


INPUT:

@SRR002271.28 FC2012M_R1:1:1:881:458                         
GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
+SRR002271.28 FC2012M_R1:1:1:881:458                         
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII

OUTPUT:

@SRR002271.28 FC2012M_R1:1:1:881:458#/1                         
GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
+SRR002271.28 FC2012M_R1:1:1:881:458#/1                         
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII



readsPlain
----------

sed -e 's/FC[A-Z0-9\.\_]*:\([0-9\:]*\)/\1#\/1/' < /scratch/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1-4.fastq 


INPUT:

    @SRR002271.28 FC2012M_R1:1:1:881:458                         
    GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
    +SRR002271.28 FC2012M_R1:1:1:881:458                         
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII

OUTPUT:

    @SRR002271.28 1:1:881:458#/1                         
    GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
    +SRR002271.28 1:1:881:458#/1                         
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII


ERROR:

    Could not parse the following line: SRR002271.28 FC2012M_R1:1:1:881:458#/1                          
    Please check your files.


DIAGNOSIS:

    THE INCLUSION OF A MACHINE ID IN THE FASTQ HEADER IS NOT ANTICIPATED IN THE REGEX IN
    
    ELAND_standalone.pl LINE 644:
    
    if( !($_[0] =~ /^(\S+):(\d+):(\d+):(\d+):(\d+)/) ) {
 

    SO IT CAN'T PARSE PROPERLY THIS HEADER:
    
    SRR002271.28 FC2012M_R1:1:1:881:458#/1                         



SOLUTION:

    CHANGE LINE 644 TO:
    

    if( !($_[0] =~ /^(\S+)\s*[\w]*:*(\d+):(\d+):(\d+):(\d+)/) ) {


emacs /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl
    


    *** TO DO: MAKE *.patch FILE FOR ELAND_standalone.pl



MAQ
---



ERROR:

read.cc:61: longreads_t* ma_load_reads(void*, int, void*, int): Assertion `strncmp(name



time \
/nethome/bioinfo/apps/maq/0.7.1/maq match \
/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/76/chrY-out.map \
/nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chrY.bfa \
/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/76/maq1_1.76.bfq \
/scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/76/maq1_2.76.bfq
    
    -- maq-0.7.1
    [ma_load_reads] loading reads...
    [ma_load_reads] set length of the first read as 36.
    [ma_load_reads] set length of the second read as 36.
    maq: read.cc:61: longreads_t* ma_load_reads(void*, int, void*, int): Assertion `strncmp(name, lr->name[j], tl-1) == 0' failed.
    Aborted
    
    real    0m0.014s
    user    0m0.002s
    sys     0m0.004s


CHECK READ LENGTH:

head /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/1/maq1_2.1.fastq

@SRR002271.28 FC2012M_R1:1:1:881:458                         
GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
+SRR002271.28 FC2012M_R1:1:1:881:458                         
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
@SRR002271.69 FC2012M_R1:1:1:565:398                         
GGGGAGTGGAGATAAAGGTAGAACTACAAAAAATGT
+SRR002271.69 FC2012M_R1:1:1:565:398                         
IIIIIIIIIIIIIIIIII6II8I;C>219822B3;7
@SRR002271.94 FC2012M_R1:1:1:903:411                         
GAAGACCTAACTCTTCAGGGTTTTAAAATATTTGAT

head /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/1/maq1_2.1.fastq

@SRR002271.28 FC2012M_R1:1:1:881:458                         
TTAGGATTAGAATTAAGCTTTCCTGTACCAGGCTGG
+SRR002271.28 FC2012M_R1:1:1:881:458                         
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIFI9II?
@SRR002271.69 FC2012M_R1:1:1:565:398                         
CATTTCCATTCCATATTAAGGTGGCCTTGTCCAGAT
+SRR002271.69 FC2012M_R1:1:1:565:398                         
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII@I?I    <====== CULPRIT IS '@' IN QUALITY LINE
@SRR002271.94 FC2012M_R1:1:1:903:411                         
TAGTATTCTAATAAGGCTTTTGTGCTTTTTGATGAT


SOLUTION:

REDO SPLITFILES AFTER RUNNING replaceAtQual.pl ON INPUTFILE AND MATEFILE


time /nethome/bioinfo/apps/maq/0.7.1/maq match /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/chrY/1/out.map /nethome/bioinfo/data/sequence/chromosomes/human/hg19/maq/chrY.bfa /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/1/maq1_1.1.bfq /scratch/syoung/base/pipeline/SRA/NA18507/maq/maq1/1/maq1_2.1.bfq

    -- maq-0.7.1
    [ma_load_reads] loading reads...
    [ma_load_reads] set length of the first read as 36.
    [ma_load_reads] set length of the second read as 36.
    [ma_load_reads] 500000*2 reads loaded.
    [ma_longread2read] encoding reads... 1000000 sequences processed.
    [ma_match] set the minimum insert size as 37.
    [match_core] Total length of the reference: 57772954
    [match_core] round 1/3...
    [match_core] making index...
    [match_search]   0% processed in 3.811 sec: 0 / 0 = 0.000
    [match_search]   1% processed in 4.808 sec: 657130 / 655232 = 1.003
    [match_search]   2% processed in 5.888 sec: 803640 / 720770 = 1.115
    [match_search]   3% processed in 7.131 sec: 976158 / 851805 = 1.146
    [match_search]   4% processed in 8.226 sec: 749231 / 720763 = 1.039
    [match_search]   5% processed in 9.261 sec: 570683 / 655228 = 0.871






++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Thu Apr  8 04:54:35 EDT 2010


Sense from sequence reads: methods for alignment and assembly
Flicek and Birney
http://www.nature.com/nmeth/journal/v6/n11s/full/nmeth.1376.html


</entry>



<entry [Thu Apr  8 04:53:35 EDT 2010] ILLUMINA ADAPTOR SEQUENCES>





Entire document and oligonucleotide sequences  2007-2009 Illumina, Inc. All rights reserved. 1/4
Dear Customer,
This communication is provided to you in response to your request for certain
oligonucleotide sequences for use with Illuminas instruments (e.g. Genome
Analyzer, Genome Analyzer II, and Genome Analyzer IIx) and associated equipment,
reagents, kits, and software (Illumina products). Below please find information on
sequences for oligonucleotides that we can make available to you. This
communication is provided solely for your use and may not be reproduced or
distributed outside your institution.
The oligonucleotide sequences described in this communication are protected by
copyrights owned by Illumina. Illumina allows you to reproduce the oligonucleotide
sequences solely for use with Illumina products. Illumina realizes that for certain
applications, customers may need to make modifications to the oligonucleotide
sequences necessary to allow their use with Illumina products. Thus, Illumina allows
you to make such necessary modifications to the oligonucleotide sequences, but only
for use with Illumina products.
If you reproduce these oligonucleotide sequences for viewing within your institution,
the sequences must be accompanied by the following copyright notice:
Oligonucleotide sequences  2007-2009 Illumina, Inc. All rights reserved. Illumina
customers may reproduce and create derivative works of the oligonucleotide
sequences, but limited to use with Illumina instruments and products. All other uses
are strictly prohibited.
If you reproduce these oligonucleotide sequences for viewing outside your institution
(e.g. journal publication), the sequences must be accompanied by the following
copyright notice:
Oligonucleotide sequences  2007-2009 Illumina, Inc. All rights reserved.
Except as provided above, Illumina grants you no other rights to use, reproduce, or
otherwise disclose the oligonucleotide sequences. Illumina does not grant you
permission to alter or modify the oligonucleotide sequences for use with non-Illumina
products.
Genomic DNA oligonucleotide sequences
Adapters1
5' P-GATCGGAAGAGCTCGTATGCCGTCTTCTGCTTG
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT
1 The oligonucleotides are further modified, treated and purified in a proprietary manner. We cannot
guarantee efficient results or performance if the customer does not use oligonucleotides purchased
from Illumina.
Entire document and oligonucleotide sequences  2007-2009 Illumina, Inc. All rights reserved. 2/4
PCR Primers1
5' AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT
5' CAAGCAGAAGACGGCATACGAGCTCTTCCGATCT
Genomic DNA Sequencing Primer
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT
Paired End DNA oligonucleotide sequences
PE Adapters1
5' P-GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT
PE PCR Primer 1.01
5' AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT
PE PCR Primer 2.01
5' CAAGCAGAAGACGGCATACGAGATCGGTCTCGGCATTCCTGCTGAACCGCTCTTCCGATCT
PE Read 1 Sequencing Primer
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT
PE Read 2 Sequencing Primer
5' CGGTCTCGGCATTCCTGCTGAACCGCTCTTCCGATCT
Multiplexing DNA oligonucleotide sequences
Multiplexing Adapters1
5' P-GATCGGAAGAGCACACGTCT
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT
Multiplexing PCR Primer 1.01
5' AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT
Multiplexing PCR Primer 2.01
5' GTGACTGGAGTTCAGACGTGTGCTCTTCCGATCT
Multiplexing Read 1 Sequencing Primer
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT
Multiplexing Index Read Sequencing Primer
5' GATCGGAAGAGCACACGTCTGAACTCCAGTCAC
Multiplexing Read 2 Sequencing Primer
5' GTGACTGGAGTTCAGACGTGTGCTCTTCCGATCT
PCR Primer Index 1
CAAGCAGAAGACGGCATACGAGATCGTGATGTGACTGGAGTTC
PCR Primer Index 2
CAAGCAGAAGACGGCATACGAGATACATCGGTGACTGGAGTTC
PCR Primer Index 3
CAAGCAGAAGACGGCATACGAGATGCCTAAGTGACTGGAGTTC
PCR Primer Index 4
CAAGCAGAAGACGGCATACGAGATTGGTCAGTGACTGGAGTTC
PCR Primer Index 5
CAAGCAGAAGACGGCATACGAGATCACTGTGTGACTGGAGTTC
PCR Primer Index 6
CAAGCAGAAGACGGCATACGAGATATTGGCGTGACTGGAGTTC
PCR Primer Index 7
CAAGCAGAAGACGGCATACGAGATGATCTGGTGACTGGAGTTC
PCR Primer Index 8
CAAGCAGAAGACGGCATACGAGATTCAAGTGTGACTGGAGTTC
Entire document and oligonucleotide sequences  2007-2009 Illumina, Inc. All rights reserved. 3/4
PCR Primer Index 9
CAAGCAGAAGACGGCATACGAGATCTGATCGTGACTGGAGTTC
PCR Primer Index 10
CAAGCAGAAGACGGCATACGAGATAAGCTAGTGACTGGAGTTC
PCR Primer Index 11
CAAGCAGAAGACGGCATACGAGATGTAGCCGTGACTGGAGTTC
PCR Primer Index 12
CAAGCAGAAGACGGCATACGAGATTACAAGGTGACTGGAGTTC
DpnII gene expression oligonucleotide sequences
Gex Adapter 1
5' P-GATCGTCGGACTGTAGAACTCTGAAC
5 ACAGGTTCAGAGTTCTACAGTCCGAC
Gex Adapter 2
5' CAAGCAGAAGACGGCATACGANN
5' P-TCGTATGCCGTCTTCTGCTTG
Gex PCR Primer 1
5' CAAGCAGAAGACGGCATACGA
Gex PCR Primer 2
5' AATGATACGGCGACCACCGACAGGTTCAGAGTTCTACAGTCCGA
Gex Sequencing Primer
5' CGACAGGTTCAGAGTTCTACAGTCCGACGATC
NlaIII gene expression oligonucleotide sequences
Gex Adapter 1
5' P-TCGGACTGTAGAACTCTGAAC
5' ACAGGTTCAGAGTTCTACAGTCCGACATG
Gex Adapter 2
5' CAAGCAGAAGACGGCATACGANN
5' P-TCGTATGCCGTCTTCTGCTTG
Gex PCR Primer 1
5' CAAGCAGAAGACGGCATACGA
Gex PCR Primer 2
5' AATGATACGGCGACCACCGACAGGTTCAGAGTTCTACAGTCCGA
Gex Sequencing Primer
5' CCGACAGGTTCAGAGTTCTACAGTCCGACATG
Small RNA oligonucleotide sequences
RT Primer
5' CAAGCAGAAGACGGCATACGA
5' RNA Adapter
5' GUUCAGAGUUCUACAGUCCGACGAUC
3' RNA Adapter1
5' P-UCGUAUGCCGUCUUCUGCUUGUidT
v1.5 Small RNA 3' Adapter1
5' /5rApp/ATCTCGTATGCCGTCTTCTGCTTG/3ddC/
Small RNA PCR Primer 1
5' CAAGCAGAAGACGGCATACGA
Entire document and oligonucleotide sequences  2007-2009 Illumina, Inc. All rights reserved. 4/4
Small RNA PCR Primer 2
5' AATGATACGGCGACCACCGACAGGTTCAGAGTTCTACAGTCCGA
Small RNA Sequencing Primer
5' CGACAGGTTCAGAGTTCTACAGTCCGACGATC
Please contact us if you have any questions.
Sincerely yours,
Customer Support - Illumina Inc.
858-202-4566






</entry>



<entry [Wed Apr  7 22:10:43 EDT 2010] SAMTOOLS CALLING SNPS & PERFORMANCE OF ALIGNERS WITH SAMTOOLS SNP CALLER>




SNP AND INDEL CALLING
=====================

SUMMARY

samtools pileup -vcf ref.fa aln.bam | tee raw.txt | samtools.pl varFilter -D100 > flt.txt
awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' flt.txt > final.txt

Please always remember to set the maximum depth (-D) in filtering.


DETAILS


1. Get the raw variant calls on the X chromosome. Assume X chromosome is named X in both hsRef.fa and aln.bam.

   samtools view -u aln.bam X | samtools pileup -vcf hsRef.fa - > var-X.raw.txt

   A region is specified with chr, chr:begin or chr:begin-end.
   
   
2. Filter the raw variant calls.

   samtools.pl varFilter -D100 var-X.raw.txt > var-X.flt.txt

   Please remember to set the -D to set a maximum read depth according to the average read depth. In whole genome shotgun (WGS) resequencing, SNPs with excessively high read depth are usually caused by structural variations or alignment artifacts and should not be trusted.
   
   
3. Acquire final variant calls by setting a quality threshold.

   awk '($3=="*"&&$6>=50)||($3!="*"&&$6>=20)' var-X.flt.txt > var-X.final.txt

   Here 50 is the quality threshold for indels and 20 for substitutions.
   
   
4. Get the consensus sequence of chrX

   samtools view -u aln.bam X | samtools pileup -cf hsRef.fa - | samtools.pl pileup2fq -D100 > var-X.fq

   File var-X.fq is in the multi-line FASTQ format. Bases in lowercase are filtered out due to repeats, being close to indels or insufficient/excessive read depth. The consensus file is essential to the estimate of mutation rate.

   The pileup2fq command applies fewer filters than varFilter and may not give identical results. For variant discovery, varFilter is recommended.






The integer FLAG field is not friendly to eyes.

You may get string FLAG by:

samtools view -X aln.bam | less -S

For more information, please check out:

samtools view -?





http://sourceforge.net/apps/mediawiki/samtools/index.php?title=SAM_FAQ#How_are_SNPs_and_indels_called_and_filtered_by_SAMtools.3F


 For Developers
How to make my aligner work best with samtools?

To get the best performance in SNP calling, we recommend the following rules.

    * Try to generate all the mandatory fields, in particular the mate coordinates and insert size. Samtools' rmdup relies on the ISIZE field and Picard MarkDuplicates requires the mate coordinates. One may use the fixmate command afterward, but that is very inefficient.
    * Choose a random position for a repetitive read. If an aligner discards repetitive reads, the read depth will be inaccurate, which may cause problems in filtering SNPs.
    * Write mapping quality. It is recommended to compute mapping quality as samtools SNP caller may take advantage of this information. However, computing mapping quality requires an aligner to look into suboptimal hits and thus slows down alignment. If your aligner cannot do this, write 0 for repetitive reads and 60 for `unique' reads. 

Why mapping quality?

The plot below shows alignment accuracy for 108bp simulated reads under different configurations of BWA. If we only retain `unique' alignment, we get a single spot ungap-se-unqiue which corresponds to ~2300 wrong alignments out of 1.68 million mapped reads. If we look at the mapping quality generated by BWA and set a stringent threshold on that, it is possible to get an accuracy of 400/1.67M (the ungap-se line). That is saying we get >80% fewer false alignments at the cost of 1% loss in sensitivity. Setting a higher threshold further reduces false alignments and helps to reduce noises in identifying structural variations bridging unique regions. The plot may vary with the aligner in use, but it is generally true that an algorithm seeing more suboptimal alignments is more accurate. File:108.png



</entry>



<entry [Thurs Mar 18 11:43:46 EDT 2010] BIXBY AND LERNER-HANER RUNS>




1. USE TWO TISSUE CULTURE (I.E., CLONED) SAMPLES AS GOLD STANDARD FOR SNPS

CHECK: LERNER-HANER IS CLONED CELL LINE, JUST AT DIFFERENT STAGES OF DEVELOPMENT?


2. PUT THROUGH GSA FOR PATHWAYS



3. HOW TO DETERMINE THE DIFFERENCES BETWEEN:

    1. A SNP IN AN INDIVIDUAL WITHIN THE GLOBAL POPULATION
    
    2. A SNP IN AN INDIVIDUAL WITHIN A HETEROGENEOUS POPULATION
    
    3. SETS OF SNPS BY GENE, OR CHROMOSOME




NOTES
=====


SEGMENTAL DUPLICATIONS

http://humanparalogy.gs.washington.edu/build36/build36.htm

This page contains updated data regarding recent segmental duplications in the finishing human genome (build36; March 2006; hg18).   It focuses on genomic duplications >1 kb and >90% identity.






</entry>



<entry [Wed Mar 17 11:43:46 EDT 2010] CONVERT .SAM TO .BAM>




CONVERT ELAND OUTPUT TO SAM/BAM 

export2bam.pl




1. CONVERT MAQ out.map TO SAM/BAM

cd /p/NGS/syoung/base/pipeline/SRA/maq/1
/nethome/syoung/base/apps/samtools/0.1.6/maq2sam-long out.map > out.sam

CONVERTS THIS FILE:

-rw-rw----+ 1 syoung bioinfo 3.4G Sep 15 09:46 out.map


INTO THIS FILE:

-rw-rw----+ 1 syoung bioinfo 17G Oct 30 16:23 out.sam



2. INDEX THE REFERENCE FASTA

time /nethome/syoung/base/apps/samtools/0.1.6/samtools faidx /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa 

real    1m58.570s
user    0m37.815s
sys     0m3.437s

ll /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai

WHICH CREATES THIS FILE:

-rw-rw----+ 1 syoung bioinfo 760 Oct 30 16:34 /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai

head /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai
    chr1    247249719       6       50      51
    chr2    242951149       252194726       50      51
    chr3    199501827       500004904       50      51
    chr4    191273063       703496774       50      51
    chr5    180857866       898595305       50      51
    chr6    170899992       1083070335      50      51
    chr7    158821424       1257388333      50      51
    chr8    146274826       1419386192      50      51
    chr9    140273252       1568586521      50      51
    chr10   135374737       1711665246      50      51



3. CONVERT SAM FILE TO BINARY BAM FORMAT (SAM->BAM)

time /nethome/syoung/base/apps/samtools/0.1.6/samtools import \
/p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai \
/p/NGS/syoung/base/pipeline/SRA/maq/1/out.sam \
/p/NGS/syoung/base/pipeline/SRA/maq/1/out.bam   

WHICH OUTPUTS:

[sam_header_read2] 24 sequences loaded.

real    19m26.333s
user    18m8.493s
sys     0m34.976s

CREATES THIS FILE:

    -rw-r-----+ 1 syoung bioinfo  3447485425 Oct 30 18:06 out.bam


4. # index BAM
ll
cd /p/NGS/syoung/base/pipeline/SRA/maq/1
time /nethome/syoung/base/apps/samtools/0.1.6/samtools index out.bam                

    real    2m9.597s
    user    1m31.412s
    sys     0m3.527s

CREATES THIS FILE:

    -rw-rw----+ 1 syoung bioinfo     7701704 Oct 31 23:53 out.bam.bai


5. EXTRACT MAQ ALIGNMENTS WITH samtools view AND samtools fixmate

NB: 40 BP OFFSET FOR READ LENGTH (I.E., 40 BP SHORTER AT EITHER END THAN REFERENCE)
    
cd /p/NGS/syoung/base/pipeline/SRA/maq/1
time /nethome/syoung/base/apps/samtools/0.1.6/samtools view out.bam 2:2044001-2045500
time /nethome/syoung/base/apps/samtools/0.1.6/samtools view out.bam 20:68001-69500

    
    Usage:   samtools view [options] <in.bam>|<in.sam> [region1 [...]]
    
    Options: -b       output BAM
             -h       print header for the SAM output
             -H       print header only (no alignments)
             -S       input is SAM
             -u       uncompressed BAM output (force -b)
             -x       output FLAG in HEX (samtools-C specific)
             -X       output FLAG in string (samtools-C specific)
             -t FILE  list of reference names and lengths (force -S) [null]
             -T FILE  reference sequence file (force -S) [null]
             -o FILE  output file name [stdout]
             -f INT   required flag, 0 for unset [0]
             -F INT   filtering flag, 0 for unset [0]
             -q INT   minimum mapping quality [0]
             -l STR   only output reads in library STR [null]
             -r STR   only output reads in read group STR [null]
             -?       longer help
    

PROCESS WITH samtools fixmate (to make it self-consistent as a standalone alignment)








5. # view alignment
/nethome/syoung/base/apps/samtools/0.1.6/samtools tview out.bam ex1.fa


6. # pileup and consensus
/nethome/syoung/base/apps/samtools/0.1.6/samtools pileup -cf ex1.fa ex1.bam


7. ANOTHER PILEUP USING -t FLAG

/nethome/syoung/base/apps/samtools/0.1.6/samtools pileup -cf ex1.fa -t ex1.fa.fai ex1.sam.gz



/p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \





</entry>



<entry [Tue Mar 16 11:43:46 EDT 2010] RUN ELAND ALIGNMENTS ON SAMPLE 1 (37 SUBFILES, 250,000 READ CHUNKS)>



head reads_1.1.fasta
>SRR002271.28 FC2012M_R1:1:1:881:458                         
GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
>SRR002271.69 FC2012M_R1:1:1:565:398                         
GGGGAGTGGAGATAAAGGTAGAACTACAAAAAATGT
>SRR002271.94 FC2012M_R1:1:1:903:411                         
GAAGACCTAACTCTTCAGGGTTTTAAAATATTTGAT
>SRR002271.130 FC2012M_R1:1:1:806:408                        
GTGTGAGATGGTATCTCACTGTGGTTGTGGTTTGGT
>SRR002271.168 FC2012M_R1:1:1:903:673                        
GAAGAAATCCCGTTTCCAACGAAGGCCTCAAAGAGG



REPLICATES 1 - 10
=================

screen -S eld-100K-rep1

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 100000 \
--times 1-10 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 3000 \
--parallel


    
    Sampler::splitFiles    Can't open input file: /nethome/syoung/base/pipeline/SRA/
    NA18507/samples/reads_1.9.fastq
    
    
    command: /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl --inputtype fastq --cl
    uster LSF --queue priority --tempdir /tmp --outputdir /nethome/syoung/base/pipel
    ine/SRA/NA18507/eland/eland10-100000 --stdout /nethome/syoung/base/pipeline/SRA/
    NA18507/eland/eland10-100000/eland.outerr --inputfile /nethome/syoung/base/pipel
    ine/SRA/NA18507/samples/reads_1.10.fastq --matefile /nethome/syoung/base/pipelin
    e/SRA/NA18507/samples/reads_2.10.fastq --referencedir /nethome/bioinfo/data/sequ
    ence/chromosomes/human-sq --jobs 3000 --parallel --reads 100000
    
    
    Failed in an LSF library call: LIM is down; try later. Job not submitted.
    
    Run time: 16:27:19
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    4:15AM, 17 March 2010
    ****************************************



REPLICATE 11-20
===============

screen -S eld-100K-rep2

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 100000 \
--times 11-20 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/benchmark/data/duan/run12/s_1_1_sequence.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 3000 \
--parallel


    command: /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl --inputtype fastq --cl
    uster LSF --queue priority --tempdir /tmp --outputdir /nethome/syoung/base/pipel
    ine/SRA/NA18507/eland/eland20-100000 --stdout /nethome/syoung/base/pipeline/SRA/
    NA18507/eland/eland20-100000/eland.outerr --inputfile /nethome/syoung/base/pipel
    ine/benchmark/data/duan/run12/s_1_1_sequence.fastq --referencedir /nethome/bioin
    fo/data/sequence/chromosomes/human-sq --jobs 3000 --parallel --reads 100000
    
    
    
    Run time: 18:07:39
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    5:56AM, 17 March 2010
    ****************************************
    
    
    [syoung@u01 pipeline]$ /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl --executa
    ble /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl --parameter "--reads" --ran
    ge 100000 --times 11-20 --inputtype fastq --cluster LSF --queue priority --tempd
    ir /tmp --outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTE
    R%-%PARAMETER% --stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%CO
    UNTER%-%PARAMETER%/eland.outerr --inputfile /nethome/syoung/base/pipeline/benchm
    ark/data/duan/run12/s_1_1_sequence.fastq --referencedir /nethome/bioinfo/data/se
    quence/chromosomes/human-sq --jobs 3000 --parallel


GOT 'NO SPACE LEFT ON DEVICE' ERROR:

        
    -----Original Message-----
    From: LSF System [mailto:lsfadmin@pegasus.ccs.miami.edu] 
    Sent: Wednesday, March 17, 2010 11:10 AM
    To: syoung@n0033.pegasus.edu
    Subject: Job 123278: </nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/chr9/eld-chr9-1.sh> Done

    
    Job </nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/chr9/eld-chr9-1.sh> was submitted from host <u01> by user <syoung> in cluster <lsfcluster>.
    Job was executed on host(s) <n0033>, in queue <priority>, as user <syoung> in cluster <lsfcluster>.
    </nethome/syoung> was used as the home directory.
    </nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/chr9> was used as the working directory.
    Started at Wed Mar 17 11:23:06 2010
    Results reported at Wed Mar 17 12:09:46 2010
    
    Your job looked like:
    
    ------------------------------------------------------------
    # LSBATCH: User input
    /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/chr9/eld-chr9-1.sh
    ------------------------------------------------------------
    
    Successfully completed.
    
    Resource usage summary:
    
        CPU time   :    533.25 sec.
    
    The output (if any) follows:
    
    LS_JOBID: 
    LS_JOBPID:  11970
    LSB_JOBINDEX:  0
    LSB_JOBNAME:  /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/chr9/eld-chr9-1.sh
    LSB_QUEUE:  priority
    LSFUSER:  syoung
    LSB_JOB_EXECUSER:  syoung
    HOSTNAME:  n0033.pegasus.edu
    LSB_HOSTS:  n0033
    LSB_ERRORFILE: 
    LSB_JOBFILENAME:  /nethome/syoung/.lsbatch/1268839380.123278
    LD_LIBRARY_PATH:  /share/apps/lsf/7.0/linux2.6-glibc2.3-x86_64/lib:
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: single input-file specified, will do single read analysis
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: deduced read length of 37 for data in /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/s_1_1_sequence.1.fastq
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: Setting seed length for ./reanalysis_eland_extended.txt to 32
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/buildSeq.pl --fasta ./reanalysis_qseq.txt > ./reanalysis_eland_query.txt
    
    $VAR1 = {
              'read-length' => [
                                 -1
                               ],
              'pair-params' => '--circular',
              'pipeline-dir' => '/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/..',
              'input-file' => [
                                '/nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/s_1_1_sequence.1.fastq'
                              ],
              'seed-length' => [
                                 -1
                               ],
              'output-prefix' => './reanalysis',
              'base-quality' => 30,
              'eland-genome' => '/nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9',
              'input-type' => 'fastq'
            };
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: buildSeq succeeded
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/eland_32 ./reanalysis_eland_query.txt /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9 ./reanalysis_eland_multi.txt --multi=
    
    ELAND: Efficient Local Alignment of Nucleotide Data Copyright (c) 2003-2006 Solexa Limited. All rights reserved.
    Author: Anthony J. Cox
    
    Publications incorporating data generated by the use of this software or modified versions thereof should cite:
    Anthony J. Cox.
    Ultra high throughput alignment of short sequence tags.
    In preparation.
    
    WARNING: this software is compiled to process oligos of length 32.
    To change this value, edit OLIGO_LENGTH and recompile.
    
    Will use at most 25 bits in hash table
    Can process at most 2147483647 oligos per batch Will find all matches having 2 errors or less
    getOligoSourceFile: detected fasta format oligo file
    WARNING: first sequence of ./reanalysis_eland_query.txt contains 37 bases, but only the first 32 bases will be used in the alignment.
    To change this value, edit OLIGO_LENGTH and recompile.
    
    Starting run! Time now: Wed Mar 17 11:48:48 2010 Will read oligos from file ./reanalysis_eland_query.txt Could not parse max number of matches from string --multi=, proceeding using defaults Built MatchTableMulti: will store at most 10,10,10 0,1,2 error matches per read Trying to open directory /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9 ...
    Sorting chromosome names
    made hash table, pointer table sizes = 0, 0 About to build hash tables for pass 0: User: 0.009999s System: 0s Actual: 0.017127s Efficiency: 58.3815% partition hash table will run in split prefix mode, split is 25/7 Setting partition hash table size to 25 bits partition hash table will run in split prefix mode, split is 25/7 Setting partition hash table size to 25 bits counting oligos Error in OligoSourceFasta: found name but no sequence read 3500000 oligos from source Will hash 3499228 oligos converting count values to pointer arrays will place 6978722 entries in table will place 6978722 entries in table
    6978722 entries reduced to 6978722 entries
    6978722 entries reduced to 6978722 entries successful table build Built hash tables: User: 13.6009s System: 0.944857s Actual: 14.5516s Efficiency: 99.9602% Scanning file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa: User: 0s System: 0s Actual: 9.4e-05s Efficiency: 0% Starting block: 1
    FileReader: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.2bpb of size 35068316 bytes.
    squash: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.vld of size 318 bytes.
    Comment: >chr9
    finished making FileReader
    Finishing block: 10
    ... done User: 56.2504s System: 0.122981s Actual: 56.3945s Efficiency: 99.9626%
    FileReader: unmapping 35068316 bytes of memory
    FileReader: unmapping 318 bytes of memory made hash table, pointer table sizes = 33554434, 33554434 About to build hash tables for pass 1: User: 0.001s System: 0.002s Actual: 0.002244s Efficiency: 133.69% partition hash table will run in split prefix mode, split is 25/7 Setting partition hash table size to 25 bits partition hash table will run in split prefix mode, split is 25/7 Setting partition hash table size to 25 bits counting oligos Error in OligoSourceFasta: found name but no sequence read 3500000 oligos from source Will hash 3450598 oligos converting count values to pointer arrays will place 6872345 entries in table will place 6889317 entries in table
    6872345 entries reduced to 6872345 entries
    6889317 entries reduced to 6889317 entries successful table build Built hash tables: User: 14.0479s System: 0.370943s Actual: 14.4219s Efficiency: 99.9787% Scanning file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa: User: 0s System: 0s Actual: 5.5e-05s Efficiency: 0% Starting block: 1
    FileReader: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.2bpb of size 35068316 bytes.
    squash: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.vld of size 318 bytes.
    Comment: >chr9
    finished making FileReader
    Finishing block: 10
    ... done User: 34.0368s System: 0.025996s Actual: 34.0712s Efficiency: 99.9755%
    FileReader: unmapping 35068316 bytes of memory
    FileReader: unmapping 318 bytes of memory made hash table, pointer table sizes = 33554434, 33554434 About to build hash tables for pass 2: User: 0s System: 0.002s Actual: 0.002245s Efficiency: 89.0869% partition hash table will run in split prefix mode, split is 25/7 Setting partition hash table size to 25 bits partition hash table will run in split prefix mode, split is 25/7 Setting partition hash table size to 25 bits counting oligos Error in OligoSourceFasta: found name but no sequence read 3500000 oligos from source Will hash 3450598 oligos converting count values to pointer arrays will place 6880852 entries in table will place 6880852 entries in table
    6880852 entries reduced to 6880852 entries
    6880852 entries reduced to 6880852 entries successful table build Built hash tables: User: 15.6806s System: 0.32895s Actual: 16.0117s Efficiency: 99.9866% Scanning file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa: User: 0s System: 0s Actual: 5.9e-05s Efficiency: 0% Starting block: 1
    FileReader: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.2bpb of size 35068316 bytes.
    squash: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.vld of size 318 bytes.
    Comment: >chr9
    finished making FileReader
    Finishing block: 10
    ... done User: 38.0752s System: 0.029995s Actual: 38.1123s Efficiency: 99.9815%
    FileReader: unmapping 35068316 bytes of memory
    FileReader: unmapping 318 bytes of memory Will look for index file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.idx
    ... not found, will not index
    Outputting results: User: 0s System: 0.002s Actual: 0.002243s Efficiency: 89.1663%
    Info: 2089385 matches were stored
    Info: 8357540 bytes of temp storage used for oligo numbers
    Info: 8357540 bytes of temp storage used for match positions ... done User: 4.25835s System: 0.684896s Actual: 4.95013s Efficiency: 99.8609% Run complete! Time now: Wed Mar 17 11:51:46 2010
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: eland succeded
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run cat ./reanalysis_eland_multi.txt | /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/unsquashGenome /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9 37 32 --multi --compact > ./reanalysis_frag.txt
    
    Building string index for /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9
    FileReader: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.2bpb of size 35068316 bytes.
    squash: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.vld of size 318 bytes.
    Comment: >chr9
    finished making FileReader
    No contig index found for /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa
    FileReader: unmapping 35068316 bytes of memory
    FileReader: unmapping 318 bytes of memory end of file reached
    FileReader: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.2bpb of size 35068316 bytes.
    squash: opened file /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa.vld of size 318 bytes.
    Comment: >chr9
    finished making FileReader
    No contig index found for /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9/chr9.fa
    FileReader: unmapping 35068316 bytes of memory
    FileReader: unmapping 318 bytes of memory
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: unquash succeded
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run paste ./reanalysis_eland_multi.txt ./reanalysis_frag.txt | /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/buildExtendedAlign.pl 37 32 > ./reanalysis_eland_extended.txt 
    
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: buildExtendedAlign succeded
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/squashGenome /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9 > ./reanalysis_genomesize.xml
    
    User: 0s System: 0s Actual: 3e-06s Efficiency: 0% Trying to open directory /nethome/bioinfo/data/sequence/chromosomes/human-sq/chr9 ...
     ... success, will output file sizes to XML
    User: 0s System: 0s Actual: 7.38133s Efficiency: 0%
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: squashGenome succeded
    /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestAlignment.pl 37 32 ./reanalysis_genomesize.xml ./reanalysis_eland_extended.txt ./reanalysis_qseq.txt > ./reanalysis_calsaf.txt
    
    Obtained total genome size of 140273252 bp Obtained rest-of-genome correction of 1.48520082578132e-14
    
    
    PS:
    
    Fail to open output file /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland19-3500000/1/chr9/eld-chr9-1-stdout.txt: No space left on device.
    Output is stored in this mail.





</entry>



<entry [Tue Mar 16 04:24:31 EDT 2010] RUN ELAND ALIGNMENTS ON SAMPLE 1 (37 SUBFILES, CHUNKS FROM 1M TO 4M READS)>




chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl


REPLICATES 1 - 10
=================

screen -S eld-rep1

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 1000000,1500000,2000000,2500000,3000000,3500000,4000000 \
--times 1-10 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
    --outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    
    
    command: /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl --inputtype fastq --cl
    uster LSF --queue priority --tempdir /tmp --outputdir /nethome/syoung/base/pipel
    ine/SRA/NA18507/eland/eland20-3500000 --stdout /nethome/syoung/base/pipeline/SR/
    NA18507/eland/eland20-3500000/eland.outerr --inputfile /nethome/syoung/base/pipe
    line/benchmark/data/duan/run12/s_1_1_sequence.fastq --referencedir /nethome/bioi
    nfo/data/sequence/chromosomes/human-sq --jobs 600 --parallel --reads 3500000
    
    
    mkdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland20-3500000: No space
    left on device at /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl line 283
    
    
    command: /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl --inputtype fastq --cl
    uster LSF --queue priority --tempdir /tmp --outputdir /nethome/syoung/base/pipel
    ine/SRA/NA18507/eland/eland20-4000000 --stdout /nethome/syoung/base/pipeline/SRA
    /NA18507/eland/eland20-4000000/eland.outerr --inputfile /nethome/syoung/base/pip
    eline/benchmark/data/duan/run12/s_1_1_sequence.fastq --referencedir /nethome/bio
    info/data/sequence/chromosomes/human-sq --jobs 600 --parallel --reads 4000000
    
    
    mkdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland20-4000000: No space
    left on device at /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl line 283
    
    Run time: 31:45:13
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    12:09AM, 17 March 2010
    ****************************************


REPLICATE 11-20
===============

screen -S eld-rep2

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 1000000,1500000,2000000,2500000,3000000,3500000,4000000 \
--times 11-20 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/benchmark/data/duan/run12/s_1_1_sequence.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    ###Run time: 10:32:46
    ###Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    ###2:26PM, 14 March 2010
    ###****************************************


REPLICATE 21-30
================

TRANSFERRING FILES




screen -S eld-rep3

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 1000000,1500000,2000000,2500000,3000000,3500000,4000000 \
--times 21-30 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    
    command: /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl --inputtype fastq --cl
    uster LSF --queue priority --tempdir /tmp --outputdir /nethome/syoung/base/pipel
    ine/SRA/NA18507/eland/eland30-4000000 --stdout /nethome/syoung/base/pipeline/SRA
    /NA18507/eland/eland30-4000000/eland.outerr --inputfile /nethome/syoung/base/pip
    eline/SRA/NA18507/samples/reads_1.30.fastq --matefile /nethome/syoung/base/pipel
    ine/SRA/NA18507/samples/reads_2.30.fastq --referencedir /nethome/bioinfo/data/se
    quence/chromosomes/human-sq --jobs 600 --parallel --reads 4000000
    
    
    Sampler::splitFiles    Can't open input file: /nethome/syoung/base/pipeline/SRA/
    NA18507/samples/reads_1.30.fastq
    
    Run time: 00:00:52
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    4:25AM, 16 March 2010
    ****************************************
    
    
    [syoung@u01 run1]$ /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl --executable
    /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl --parameter "--reads" --range 1
    000000,1500000,2000000,2500000,3000000,3500000,4000000 --times 21-30 --inputtype
     fastq --cluster LSF --queue priority --tempdir /tmp --outputdir /nethome/syoung
    /base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% --stdout /nethome/sy
    oung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr --i
    nputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fas
    tq --matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER
    %.fastq --referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq --job
    s 600 --parallel



REPLICATE 31-37
===============




TRANSFERRING FILES



screen -S eld-rep4

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 1000000,1500000,2000000,2500000,3000000,3500000,4000000 \
--times 31-37 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fasta \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fasta \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    
















</entry>



<entry [Sun Mar 14 03:07:04 EDT 2010] RUN MAQ ON NA18507 DATA>




1. CREATE OUTPUT DIR

mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/maq
cd /nethome/syoung/base/pipeline/SRA/NA18507/maq


2. RUN ALIGNMENTS USING loop.pl


REPLICATES 1 - 10
=================

screen -S mq-rep1

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--parameter "--reads" \
--range 500000 \
--times 1-10 \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER%/maq.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-bfa \
--jobs 600 \
--parallel


    Run time: 00:24:47
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    1:53AM, 15 March 2010
    ****************************************

    ###...
    ###Use of uninitialized value in concatenation (.) or string at /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl line 740.
    ###Use of uninitialized value in concatenation (.) or string at /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl line 740.
    ###
    ###Run time: 01:07:29
    ###Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    ###2:18AM, 15 March 2010
    ###****************************************




REPLICATE 11-20
===============

screen -S mq-rep2

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--parameter "--reads" \
--range 500000 \
--times 11-20 \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER%/maq.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-bfa \
--jobs 600 \
--parallel




REPLICATE 21-30
================

screen -S mq-rep3

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--parameter "--reads" \
--range 500000 \
--times 21-30 \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER%/maq.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-bfa \
--jobs 600 \
--parallel


REPLICATE 31-37
===============


screen -S mq-rep4

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/MAQ.pl \
--parameter "--reads" \
--range 500000 \
--times 31-37 \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/maq/maq%COUNTER%-%PARAMETER%/maq.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-bfa \
--jobs 600 \
--parallel




eld-rep3

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "\
--reads" \
--range 500000 \
--times 21-30 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/benchmark/data/duan/run12/s_1_1_sequence.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    Run time: 00:18:02
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl
    1:53AM, 15 March 2010
    ****************************************



eld-rep4

NB: SHOULD BE fastq NOT fasta

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bi
n/apps/ELAND.pl \
--parameter "\
--reads" \
--range 500000 \
--times 31-37 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fasta \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fasta \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    Sampler::splitFiles    Can't open input file: /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.37.fasta
    
    Run time: 00:02:32
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    0:53AM, 15 March 2010
    ****************************************





</entry>



<entry [Sun Mar 14 03:07:04 EDT 2010] RUN ELAND ON NA18507 DATA>




NB: THERE ARE 50 MILLION READS IN FILE reads_1.1.fastq (I.E., 100 READS MILLION FOR EACH FILE PAIR)

lines /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
    /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq: 199999536


(NNB: THERE ARE ONLY 3,385,184 READS IN LAST FILE, reads_1.37.fastq:

lines /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.37.fastq
    
    /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.37.fastq: 13540736)


1. SUMMARY OF INPUT FILES

NA18507: The data contain 3.77 billion PF reads from the short-insert library and 296 million PF reads from the long-insert library

cd /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/
ll
 
    ...
    -rwxrwx---+  1 syoung bioinfo 4.7G Sep 13 09:14 reads_1.10.fasta
    -rwxrwx---+  1 syoung bioinfo 8.0G Sep 13 11:49 reads_1.10.fasta.qual
    -rwxrwx---+  1 syoung bioinfo 9.3G Sep 13 18:43 reads_1.10.fastq
    -rwxrwx---+  1 syoung bioinfo 4.7G Sep 13 09:19 reads_1.11.fasta
    -rwxrwx---+  1 syoung bioinfo 8.0G Sep 13 11:55 reads_1.11.fasta.qual
    -rwxrwx---+  1 syoung bioinfo 9.3G Sep 13 18:43 reads_1.11.fastq
    -rwxrwx---+  1 syoung bioinfo 4.7G Sep 13 09:20 reads_1.12.fasta
    ...


2. COPY TO pegasus

mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/samples

ON kronos-x:

screen -S copy-samples
cd /p/NGS/syoung/base/pipeline/SRA/NA18507/samples

scp -r * syoung@pegasus.ccs.miami.edu:/nethome/syoung/base/pipeline/SRA/NA18507/samples



3. CREATE OUTPUT DIR

mkdir -p /nethome/syoung/base/pipeline/SRA/NA18507/eland
cd /nethome/syoung/base/pipeline/SRA/NA18507/eland



4. RUN ELAND ALIGNMENTS ON SAMPLE 1 (37 CHUNKS)

REPLICATES 1 - 10
=================

screen -S eld-rep1
chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 500000 \
--times 1-10 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel




REPLICATE 11-20
===============

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 500000 \
--times 11-20 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/benchmark/data/duan/run12/s_1_1_sequence.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    Run time: 10:32:46
    Completed /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl
    2:26PM, 14 March 2010
    ****************************************


REPLICATE 21-30
================

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 500000 \
--times 21-30 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fastq \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fastq \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel


REPLICATE 31-37
===============

chmod 755 /nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl

/nethome/bioinfo/apps/agua/0.4/bin/apps/loop.pl \
--executable /nethome/bioinfo/apps/agua/0.4/bin/apps/ELAND.pl \
--parameter "--reads" \
--range 500000 \
--times 31-37 \
--inputtype fastq \
--cluster LSF \
--queue priority \
--tempdir /tmp \
--outputdir /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER% \
--stdout /nethome/syoung/base/pipeline/SRA/NA18507/eland/eland%COUNTER%-%PARAMETER%/eland.outerr \
--inputfile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_1.%COUNTER%.fasta \
--matefile /nethome/syoung/base/pipeline/SRA/NA18507/samples/reads_2.%COUNTER%.fasta \
--referencedir /nethome/bioinfo/data/sequence/chromosomes/human-sq \
--jobs 600 \
--parallel

    




++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


http://nar.oxfordjournals.org/cgi/content/full/gkp1137v1

Cock 2009 The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants

ABSTRACT
 
FASTQ has emerged as a common file format for sharing sequencing read data combining both the sequence and an associated per base quality score, despite lacking any formal definition to date, and existing in at least three incompatible variants. This article defines the FASTQ format, covering the original Sanger standard, the Solexa/Illumina variants and conversion between them, based on publicly available information such as the MAQ documentation and conventions recently agreed by the Open Bioinformatics Foundation projects Biopython, BioPerl, BioRuby, BioJava and EMBOSS. Being an open access publication, it is hoped that this description, with the example files provided as Supplementary Data, will serve in future as a reference for this important file format.


</entry>



<entry [Fri Jan 15 16:05:06 EST 2010] COMPARISON CONFIGURATIONS FOR BOWTIE, MAQ AND SOAP>



FROM 
Langmead et al., 2009 BOWTIE PAPER

Table 1 presents the performance and sensitivity of Bowtie
v0.9.6, SOAP v1.10, and Maq v0.6.6.

SOAP could not be run
on the PC because SOAP's memory footprint exceeds the PC's
physical memory. The 'soap.contig' version of the SOAP
binary was used.


For comparison with SOAP, Bowtie was
invoked with '-v 2' to mimic SOAP's default matching policy
(which allows up to two mismatches in the alignment and disregards
quality values), and with '--maxns 5' to simulate
SOAP's default policy of filtering out reads with five or more
no-confidence bases.


For the Maq comparison Bowtie is run
with its default policy, which mimics Maq's default policy of
allowing up to two mismatches in the first 28 bases and
enforcing an overall limit of 70 on the sum of the quality values
at all mismatched read positions.


To make Bowtie's memory
footprint more comparable to Maq's, Bowtie is invoked
with the '-z' option in all experiments to ensure that only the
forward or mirror index is resident in memory at one time



</entry>



<entry [Fri Nov 7 16:26:16 EDT 2009] COLD SPRING HARBOUR TALK NOTES>



 GD

COMPLETE GENOMES:

na19240 ceph?
na007022
na18507
venter
watson



omicia mapped genome alleles
~50-70 OMIM alleles (hetero), 20 homo per genome
NB: reference may be deleterious allele

in 10 genomes not a single false positive for homozygous allele

ie., 10,000 snps but only 100 in OMIM

missense, identity of new AA, severity of change... mutDB

ontology OBO compliance, using principles of internal medicine, MeSH

COSMIC - chosen genes for resequencing so ascertainment bias

decipher database - copy number with clinical info through Ensembl



</entry>



<entry [Fri Oct 30 16:26:16 EDT 2009] RUN SAMTOOLS ON NA18507 MAQ OUTPUT DATA>




CONVERT ELAND TO .BAM

SAMTOOLS

export2bam.pl





GATK
-----

CONVERT BUSTARD OUTPUT TO .BAM FILE


/seq/software/picard/current/bin/BustardToSam.jar \
  B=lane5barcode47 \
  L=5 \
  BARCODE_POSITION=1 \
  BARCODE=CAGGTT \
  PAIRED_RUN=True \
  OUTPUT=CAGGTT.bam \
  RUN_BARCODE=CAGGTT \
  SAMPLE_ALIAS=lane5





</entry>



<entry [Fri Oct 30 16:26:16 EDT 2009] RUN SAMTOOLS ON NA18507 MAQ OUTPUT DATA>




1. CONVERT MAQ TO SAM

cd /p/NGS/syoung/base/pipeline/SRA/maq/1
/nethome/syoung/base/apps/samtools/0.1.6/maq2sam-long out.map > out.sam

CONVERTS THIS FILE:

-rw-rw----+ 1 syoung bioinfo 3.4G Sep 15 09:46 out.map


INTO THIS FILE:

-rw-rw----+ 1 syoung bioinfo 17G Oct 30 16:23 out.sam



2. INDEX THE REFERENCE FASTA

time /nethome/syoung/base/apps/samtools/0.1.6/samtools faidx /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa 

real    1m58.570s
user    0m37.815s
sys     0m3.437s

ll /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai

WHICH CREATES THIS FILE:

-rw-rw----+ 1 syoung bioinfo 760 Oct 30 16:34 /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai

head /p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai
    chr1    247249719       6       50      51
    chr2    242951149       252194726       50      51
    chr3    199501827       500004904       50      51
    chr4    191273063       703496774       50      51
    chr5    180857866       898595305       50      51
    chr6    170899992       1083070335      50      51
    chr7    158821424       1257388333      50      51
    chr8    146274826       1419386192      50      51
    chr9    140273252       1568586521      50      51
    chr10   135374737       1711665246      50      51


3. CONVERT SAM FILE TO BINARY BAM FORMAT (SAM->BAM)

time /nethome/syoung/base/apps/samtools/0.1.6/samtools import \
/p/NGS/syoung/base/pipeline/human-genome-fa/genome.fa.fai \
/p/NGS/syoung/base/pipeline/SRA/maq/1/out.sam \
/p/NGS/syoung/base/pipeline/SRA/maq/1/out.bam   

WHICH OUTPUTS:

[sam_header_read2] 24 sequences loaded.

real    19m26.333s
user    18m8.493s
sys     0m34.976s

CREATES THIS FILE:

    -rw-r-----+ 1 syoung bioinfo  3447485425 Oct 30 18:06 out.bam


4. # index BAM
ll
cd /p/NGS/syoung/base/pipeline/SRA/maq/1
time /nethome/syoung/base/apps/samtools/0.1.6/samtools index out.bam                

    real    2m9.597s
    user    1m31.412s
    sys     0m3.527s

CREATES THIS FILE:

    -rw-rw----+ 1 syoung bioinfo     7701704 Oct 31 23:53 out.bam.bai


5. EXTRACT MAQ ALIGNMENTS WITH samtools view AND samtools fixmate

NB: 40 BP OFFSET FOR READ LENGTH (I.E., 40 BP SHORTER AT EITHER END THAN REFERENCE)
    
cd /p/NGS/syoung/base/pipeline/SRA/maq/1
time /nethome/syoung/base/apps/samtools/0.1.6/samtools view out.bam 2:2044001-2045500
time /nethome/syoung/base/apps/samtools/0.1.6/samtools view out.bam 20:68001-69500

    
    Usage:   samtools view [options] <in.bam>|<in.sam> [region1 [...]]
    
    Options: -b       output BAM
             -h       print header for the SAM output
             -H       print header only (no alignments)
             -S       input is SAM
             -u       uncompressed BAM output (force -b)
             -x       output FLAG in HEX (samtools-C specific)
             -X       output FLAG in string (samtools-C specific)
             -t FILE  list of reference names and lengths (force -S) [null]
             -T FILE  reference sequence file (force -S) [null]
             -o FILE  output file name [stdout]
             -f INT   required flag, 0 for unset [0]
             -F INT   filtering flag, 0 for unset [0]
             -q INT   minimum mapping quality [0]
             -l STR   only output reads in library STR [null]
             -r STR   only output reads in read group STR [null]
             -?       longer help
    

PROCESS WITH samtools fixmate (to make it self-consistent as a standalone alignment)








5. # view alignment
/nethome/syoung/base/apps/samtools/0.1.6/samtools tview out.bam ex1.fa


6. # pileup and consensus
/nethome/syoung/base/apps/samtools/0.1.6/samtools pileup -cf ex1.fa ex1.bam


7. ANOTHER PILEUP USING -t FLAG

/nethome/syoung/base/apps/samtools/0.1.6/samtools pileup -cf ex1.fa -t ex1.fa.fai ex1.sam.gz



/p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \







</entry>



<entry [Mon Oct  5 10:17:26 EDT 2009] CREATED clusterELAND.pl>



USE GERALD.pl INSTEAD OF ELAND_standalone.pl

GERALD USER GUIDE
http://bisr.osumc.edu/docs/GERALD%20User%20Guide%20and%20FAQ.html


Usage: ./GERALD.pl [config.txt|-] [--RUN] [--FORCE] [--EXPT_DIR dir] [--compression <gzip|bzip2>] [--OUT_DIR dir]



perform 'GERALD' run:

cd /project/solexb
Pipeline/Gerald/GERALD.pl config.txt --FORCE


The program performs "make self_test" automatically.
If everything OK, go to the GERALD-directory and run "make":


cd /project/solexb/data/harddisk-20070220/070216_SLXA-EAS12_0034/Data/C1-27_Firecrest1.8.26_06-03-2007_solexb.2/Bustard1.8.26_06-03-2007_solexb/GERALD_06-03-2007_solexb/
make





Gerald can be run without the rest of the pipeline. A typical invocation would be

Pipeline/Gerald/GERALD.pl  gerald_config.txt --EXPT_DIR path_to_bustard_folder --FORCE


Running ELAND from the pipeline using GERALD
This requires revision v1.12 or later of GERALD.pl in Pipeline/Gerald. For more information on Gerald see Gerald User Guide and FAQ.

The config file you run GERALD on should contain lines such as

ELAND_GENOME /usr/local/share/eland/ncbi35
(or wherever your directory of squashed genome files is held)

ELAND_REPEAT /usr/local/share/eland/reps30_5
(or wherever your list of repeats is held)
and either

ANALYSIS eland
or use

34:ANALYSIS eland
to run ELAND on particular lanes.

Note that ELAND_GENOME referes to a directory, not a file. The usual Gerald variables GENOME_DIR and GENOME_FILE are not used for Eland analysis. As described above, Eland expects a different file format and not Fasta.

You should then be able to run make. Under the hood a script convertToFasta.pl converts and concatenates all the reads into a single large FASTA file which is then passed as an input to ELAND. A script convertFromELAND.pl converts the results back into the by-tile PhageAlign format expected by the rest of the pipeline.

For longer runs you will need to bear in mind that at the moment ELAND can cope with read lengths of at most 32.
Also note that at the moment you can only specify one ELAND_GENOME per experiment. This is a GERALD not an ELAND limitation but I'm unlikely to get round to fixing it in the near future.
CAUTION: ELAND will only detect matches having 2 differences or less from your reads. This means it is less sensitive than PhageAlign, which will always find a best match (although possibly not a unique one) for your reads. This is the price you pay for it being ~10000 times faster than PhageAlign. This means
If your data is noisy not all of it is going to align. If this happens to a significant proportion of your data then it is probably the case that your data is too noisy to get good results anyway. "Talk to the hand," as they say.
Estimates of error rates based on ELAND output will underestimate the true error rate (since the noisiest reads will not get aligned and hence won't contribute to the calculation).
Eland uses up to 1GB of memory. The pipeline starts one Eland job per lane. In order to prevent most computers from running out of memory, an artificial dependency in the GERALD Makefile prevents multiple instances of Eland from running at the same time. This limitation can be removed by using the option

ELAND_MULTIPLE_INSTANCES 8
in the Gerald config file. Be aware that this may use up to 8 GB of memory on your analysis computer; if not enough memory is available, the analysis is likely to crash. Allowed values for this option are 1, 2, 4, 8. (1 means no lane parallelisation, and uses up to 1 GB RAM, 2 means two parallel jobs and up to 2 GB etc.)




</entry>



<entry [Mon Oct  5 09:17:26 EDT 2009] QUICK CONVERSION FROM SANGER .fastq TO ILLUMINA/SOLEXA .fastq>



file:///E:/04-comparison/eland/ELAND_standalone%20howto.htm

A quick and dirty conversion from 'rest of the world' to 'us' can be done by

 
cat file.fastq | perl -lane '{ if ($l=~/^\+/) { s/(.)/chr(ord($1)+32)/eg;} print; $l=$_ }' > new.fastq
I propose to make ELAND_standalone.pl part of the 0.4 release as several of our informed external users have asked for it and it can't break the existing pipeline code to do so.


</entry>



<entry [Mon Sept 21 20:59:23 EDT 2009] maq export2maq (CONVERT ELAND EXPORT FILE TO out.map) AND maq map (DUMP UNMAPPED READS)>



http://maq.sourceforge.net/maq-manpage.shtml

maq map

-u FILE 	Dump unmapped reads and reads containing more than nmis mismatches to a separate file [null]



export2maq

maq export2maq [-1 read1len] [-2 read2len] [-a maxdist] [-n] out.map in.list in.export

Convert Illuminas Export format to Maqs .map format. Export format is a new alignment format since SolexaPipeline-0.3.0 which also calculates mapping qualities like maq. The resultant file can be used to call consensus genotypes as most of necessary information is available for maq to do this accurately.

OPTIONS:
-1 INT 	Length of the first read [0]
-2 INT 	Length of the second read [0]
-a INT 	Maximum outer distance for a correct read pair [250]
-n 	Retain filtered reads



NB: indelsoa FAILED ON LARGE INPUT FILE SIZE

indelsoa 	maq indelsoa in.ref.bfa in.aln.map > out.indelsoa

Call potential homozygous indels and break points by detecting the abnormal alignment pattern around indels and break points. The output is also TAB delimited with each line consisting of chromosome, approximate coordinate, length of the abnormal region, number of reads mapped across the position, number of reads on the left-hand side of the position and number of reads on the right-hand side. The last column can be ignored.

The output contains many false positives. A recommended filter could be:

  awk $5+$6-$4 >= 3 && $4 <= 1 in.indelsoa

Note that this command does not aim to be an accurate indel detector, but mainly helps to avoid some false positives in substitution calling. In addition, it only works well given deep depth (~40X for example); otherwise the false negative rate would be very high.


</entry>



<entry [Sun Sep 13 13:28:16 EDT 2009] RUN clusterELAND ON SAMPLE 1>




NB: CHANGED LINE 645 IN ELAND_standalone.pl TO ACCEPT FASTA ID WITH '.'

#    if( !($_[0] =~ /^(\w+):(\d+):(\d+):(\d+):(\d+)/) ) {                                        if( !($_[0] =~ /^(\S+):(\d+):(\d+):(\d+):(\d+)/) ) {


1. CONVERT HEADER IN NA18507 FILE TO FORMAT ACCEPTABLE TO ELAND_standalone.pl

/home/syoung/base/bin/comparison/convertHeader.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.1.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_ELAND_1.1.fastq \
--paired 1 \
--dot 100000
	
	Run time: 00:20:49
	Completed /home/syoung/base/bin/comparison/convertHeader.pl
	1:35PM, 21 September 2009
	****************************************
	
	tail /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_ELAND_1.1.fastq
	+SRR005735.32898496:7:98:1296:1082#/1
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIEII
	@SRR005735.32898547:7:98:1724:801#/1
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	+SRR005735.32898547:7:98:1724:801#/1
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
	@SRR005735.32898581:7:98:326:758#/1
	CCGTGTGAAAAGACCACCAAACAGGCTTTGGGTTAC
	+SRR005735.32898581:7:98:326:758#/1
	IIIIIIIIIIIIIIIIIIIIAIIIIIIIII*I%II+



/home/syoung/base/bin/comparison/convertHeader.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.1.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_ELAND_2.1.fastq \
--paired 2 \
--dot 100000


	Run time: 00:21:33
	Completed /home/syoung/base/bin/comparison/convertHeader.pl
	1:36PM, 21 September 2009
	****************************************

	tail /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_ELAND_2.1.fastq
	+SRR005735.32898496:7:98:1296:1082#/2
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII;II.I
	@SRR005735.32898547:7:98:1724:801#/2
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	+SRR005735.32898547:7:98:1724:801#/2
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
	@SRR005735.32898581:7:98:326:758#/2
	TCAAAAGTGAATTGCAGCTGGGTGTGGTAGCTCACC
	+SRR005735.32898581:7:98:326:758#/2
	IIIIIIIIIIIIIIIIIII&III<2III1IIII/I.


2. RUN clusterELAND.pl


mkdir -p /p/NGS/syoung/base/pipeline/SRA/eland/1
cd /p/NGS/syoung/base/pipeline/SRA/eland/1
screen -S clusterELAND-sample1


/nethome/syoung/base/bin/nextgen/clusterELAND.pl \
--splitfile /p/NGS/syoung/base/pipeline/SRA/eland/1/reads.1.fastq.split \
--inputtype fastq \
--referencedir /q/nextGen/GA/refSeqs/chromosomes/hs_chr_sq \
--outputdir /p/NGS/syoung/base/pipeline/SRA/eland/1 \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_ELAND_1.1.fastq,/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_ELAND_2.1.fastq \
--paired \
--queue "-q psmall" \
--jobs 40 \
--clean


\
&> /p/NGS/syoung/base/pipeline/SRA/eland/1/outerr.txt




RAN ONE INSTANCE OF ELAND_standalone.pl, WHICH EXITED WITH THIS ERROR:

	Can't take log of -4.01187 at /home/syoung/base/apps/GAPipeline-1.4.0/lib/perl/Gerald/Common.pm line 1601, <READ2> line 500001.

	exit code: 2304
	pickBestPair did not finish properly!


TAIL OF OUTPUT:


	FileReader: opened file /q/nextGen/GA/refSeqs/chromosomes/hs_chr_sq/chr22.fa.2bpb of size 12422860 bytes.
	squash: opened file /q/nextGen/GA/refSeqs/chromosomes/hs_chr_sq/chr22.fa.vld of size 223 bytes.
	Comment: >chr22
	finished making FileReader
	No contig index found for /q/nextGen/GA/refSeqs/chromosomes/hs_chr_sq/chr22.fa
	FileReader: unmapping 12422860 bytes of memory
	FileReader: unmapping 223 bytes of memory
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: unquash succeded
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run paste ./reanalysis_2_eland_multi.txt ./reanalysis_2_frag.txt | /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/buildExtendedAlign.pl 36 32 > ./reanalysis_2_eland_extended.txt
	
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: buildExtendedAlign succeded
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/squashGenome /q/nextGen/GA/refSeqs/chromosomes/hs_chr_sq > ./reanalysis_genomesize.xml
	
	User: 0s System: 0s Actual: 5e-06s Efficiency: 0%
	Trying to open directory /q/nextGen/GA/refSeqs/chromosomes/hs_chr_sq ...
	 ... success, will output file sizes to XML
	User: 0.001s System: 0.002s Actual: 0.038951s Efficiency: 7.70198%
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: squashGenome succeded
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: About to run /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl --circular 32 32 ./reanalysis_1_eland_extended.txt  ./reanalysis_2_eland_extended.txt ./reanalysis_1_qseq.txt ./reanalysis_2_qseq.txt ./reanalysis_1_calsaf.txt ./reanalysis_2_calsaf.txt ./reanalysis_anomaly.txt ./reanalysis_genomesize.xml > ./reanalysis_pair.xml
	
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: setting circular to Y
	Obtained total genome size of 3079768480 bp
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Found 310621 initial pairs from 500000 clusters
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Nominal orientation of this sample appears to be Rp
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Deduced read length of 36 for read 1
	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/../bin/pickBestPair.pl: Deduced read length of 36 for read 2
	Obtained rest-of-genome correction of 1.30433268623765e-12
	Obtained rest-of-genome correction of 1.30433268623765e-12
	Obtained rest-of-genome correction of 2.76203189855998e-34
	Can't take log of -4.01187 at /home/syoung/base/apps/GAPipeline-1.4.0/lib/perl/Gerald/Common.pm line 1601, <READ2> line 500001.
	
	
	=======================================================================
	exit code: 2304
	pickBestPair did not finish properly!
	
	Exiting...
	=======================================================================





NOTES

PROBLEM

http://bioinfo.cgrb.oregonstate.edu/docs/solexa/New%20analysis%20modes%20for%20GERALD%20in%20Pipeline%20Version%200.3.html

Multiple-match ELAND

Both new modes are built around the new multiple match ELAND output obtained by specifying --multi on the command line for ELAND.
Example of raw ELAND output

Just for interest, here are examples of the same data aligned using "standard" and multiple-match ELAND. Note carefully that both eland_pair and eland_extended treat the multiple-match ELAND output as raw data and apply considerable post-processing to it. For export into a user's own application other files - most notably the export.txt format - should be preferred over the "raw" ELAND output, in particular because the raw ELAND output has not had signal purity filtering applied.

Standard ELAND format (separating tabs changed to spaces for clarity)

>SLXA-B3_604:6:1:533:275 GATTATTCACGATGGGGAACTGGTTTTTGATTTTTT U0 1 0 0 BAC_plus_vector.fa 153585 R ..
>SLXA-B3_604:6:1:562:335 TTTCGGTGTTTTCATTTTTTTTTCCTTTGTTAAATC U0 1 0 0 BAC_plus_vector.fa 68238 R ..
>SLXA-B3_604:6:1:613:330 AATAATCAGACCGACGATACTAGTGGGACCGTGGTC R1 0 6 1

ELAND --multi format

>SLXA-B3_604:6:1:533:275 GATTATTCACGATGGGGAACTGGTTTTTGATTTTTT 1:0:0 BAC_plus_vector.fa:153585R0
>SLXA-B3_604:6:1:562:335 TTTCGGTGTTTTCATTTTTTTTTCCTTTGTTAAATC 1:0:0 BAC_plus_vector.fa:68238R0
>SLXA-B3_604:6:1:613:330 AATAATCAGACCGACGATACTAGTGGGACCGTGGTC 0:6:1
BAC_plus_vector.fa:168839R1,168882R1,168968R1,169011R2,169054R1,169097R1,169140R1


The read ID
Each read is given a unique identifier string, which is used to identify the read in most of the intermediate files mentioned below.

>SLXA-B3_604:6:1:533:275 

denotes an unpaired read. It is from lane 6 tile 1 of run 604 on machine SLXA-B3, and the (X,Y) coordinates of the cluster on the tile (in pixel units) are (533,275). Taken together these data are sufficient to uniquely identify a cluster - importantly for multi-run projects, this uniqueness should extend across runs, although this is of course reliant upon machine naming and run numbering being done in a sensible way. Furthermore

>SLXA-B3_604:6:1:533:275/1 

would denote read 1 of a paired read and

>SLXA-B3_604:6:1:533:275/2 

denotes read 2 of a paired read.

Note that for the final export.txt format the read ID is split into tab separated fields.

Handling indexing

To support possible future applications, pipeline version 0.3 allows a subset of bases in the read to be specified as index bases (otherwise known as a bar code). These bases are removed from the read and incorporated into the read ID, they play no other part in the analysis. However, having the index string embedded in the read ID in this way gives the potential for reads and/or alignments to be easily separated by index for the purposes of e.g. SNP calling or assembly. Index bases are specified by an extension to the syntax for the USE_BASES parameter in the GERALD config file - see the user guide for details.

Single read example:
>SLXA-B3_604:6:10:838:622#TCA
Paired read example:
>SLXA-B3_604:6:10:838:622#TCA/1

Again note that for the final export.txt format the read ID is split into tab separated fields, of which the index string is one.


parseHeader SUBROUTINE IN ELAND_standalone.pl DOESN'T ACCEPT NA18507 FASTQ HEADER

emacs /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl

LINE 607

	# check the fasta header and extract information for the qseq file
	# we assume the fasta header to be of the following format:
	# --- {shortRunfolderName}:{lane}:{tile}:}{x}:{y}#{indexBases}/[1|2]
	sub parseHeader($)
	{
		my ($machineNum,$lane,$tile,$x,$y,$index,$read);
		# initialize                                      



NA18507 HEADER FORMAT:

head /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.1.fastq
	@SRR002271.28 FC2012M_R1:1:1:881:458                         
	GATGATAGTTTCCAATTCACAAAGCTTATTTTTTTA
	+SRR002271.28 FC2012M_R1:1:1:881:458
	...
	
head /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.1.fastq
	@SRR002271.28 FC2012M_R1:1:1:881:458                         
	TTAGGATTAGAATTAAGCTTTCCTGTACCAGGCTGG
	+SRR002271.28 FC2012M_R1:1:1:881:458                         
	...


EDITED ELAND_standalone.pl TO ACCEPT NA18507 FILE FORMAT
--------------------------------------------------------

1. ADDED $inputFileIndex ARGUMENT TO unpackInputFile SUBROUTINE TO SIGNIFY READ 1
OR READ 2 STATUS, TO BE USED IN 

LINE 108

#### CHANGED THE NUMBER OF ARGUMENTS TO ALLOW ELAND_standalone.pl TO ACCEPT THE NA18507 SEQUENCE
#### HEADER FORMAT:
####
sub unpackInputFile($$$$$$$$)
{
    my ($inputFileName,$inputFileType,
	$qrawFileName,$seqpreFileName,$filtFileName,$qseqFileName,$readLength,$inputFileIndex)=@_;

LINE 554

#          #$options{'read-length'}[0] );
          $options{'read-length'}[0],
          '');





LINE 576

#          $options{'read-length'}[0]  );
          $options{'read-length'}[0],
		  1);


line 594

          #$options{'read-length'}[1]  );
          $options{'read-length'}[1],
		  2);





LINE 171

            #### GET READ STATUS FROM $inputFileIndex                                                                                                                                               \
            use Data::Dumper;
            print "Split header BEFORE pop and push: \n";
            print Dumper @split_header;
            pop(@split_header);
            push @split_header, $inputFileIndex;
            print "Split header AFTER pop and push: \n";
            print Dumper @split_header;
            exit;


LINE 657

#### CHANGED CODE IN parseHeaders SUBROUTINE TO NOT DIE WHEN NO READ NUMBER AT END OF HEADER,
#### AND NO indexBases NUMBER IN HEADER.
#### I.E.: {shortRunfolderName}:{lane}:{tile}:}{x}:{y}#{indexBases}/[1|2]

#    # look if the pair read information is present                                                                                                                                                   #    if( $_[0] =~ /\/([12])/ ) {                                                                                                                                                                      #       $read = $1;                                                                                                                                                                                   #    } else {                                                                                                                                                                                         #       die "\nCould not identify pair information of the following line: $_[0] \nPlease check your files.\n";                                                                                        #    }                                                                                                                                                                                                    #### INSERT DUMMY VALUE, WHICH WILL BE POPPED AND SUBSTITUTED WITH '1' OR '2' DEPENDING ON                                                                                                            #### THE INPUT FILE INDEX IN unpackInputFile()                                                                                                                                                        $read = '';


LINE 667


    ## check basic information                                                                                                                                                                                                              
    #if( !($_[0] =~ /^(\w+):(\d+):(\d+):(\d+):(\d+)/) ) {
    #    die "\nCould not parse the following line: $_[0] \nPlease check your files.\n";
    #}

	#### ALLOW IT TO MATCH NA18507 FORMAT HEADER: @SRR002271.28 FC2012M_R1:1:1:881:458                         
	print "header: $_[0]\n";
    if( !($_[0] =~ /^(\S+)[:\s]+([^:]*:*)?(\d+):(\d+):(\d+):(\d+)/) ) {
        die "\nCould not parse the following line: $_[0] \nPlease check your files.\n";
    }





</entry>



<entry [Sun Sep 13 13:28:16 EDT 2009] RUN clusterMAQ ON SAMPLE 3>




1. REPLACE '@' SYMBOL IN QUALITY WITH 'A' TO AVOID PROBLEMS WITH MAQ'S sanger2fastq

/home/syoung/base/bin/comparison/replaceAtQual.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.3.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.3.fastq \
--dot 100000
	
	Run time: 00:30:57
	Completed /home/syoung/base/bin/comparison/replaceAtQual.pl
	0:31AM, 18 September 2009
	****************************************


/home/syoung/base/bin/comparison/replaceAtQual.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.3.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.3.fastq \
--dot 100000

	Run time: 00:31:49
	Completed /home/syoung/base/bin/comparison/replaceAtQual.pl
	0:33AM, 18 September 2009
	****************************************

	

2. CHECK READS ARE PAIRED CORRECTLY 

perl /nethome/syoung/base/bin/utils/comparePair.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.3.fastq \
--pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.3.fastq \
--type fastq
    




3. RUN clusterMAQ.pl ON ngsdev

mkdir -p /p/NGS/syoung/base/pipeline/SRA/maq/3
cd /p/NGS/syoung/base/pipeline/SRA/maq/3
screen -S clusterMAQ-sample3

#### 	NB: USE --clean OPTION IF RUNNING FOR FIRST TIME

/nethome/syoung/base/bin/nextgen/clusterMAQ.pl \
--splitfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.3.fastq.split \
--referencefile /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \
--outputdir /p/NGS/syoung/base/pipeline/SRA/maq/3 \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.3.fastq,/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.3.fastq \
--clean \
--convert \
--queue "-q psmall" \
--jobs 40 \
&> /p/NGS/syoung/base/pipeline/SRA/maq/3/outerr.txt


tail -f /p/NGS/syoung/base/pipeline/SRA/maq/3/outerr.txt

	real    4m34.908s
	user    4m30.092s
	sys     0m30.746s
	
	Run time: 38:14:05
	Completed /nethome/syoung/base/bin/nextgen/clusterMAQ.pl
	3:00PM, 19 September 2009
	****************************************




</entry>



<entry [Sun Sep 13 13:28:16 EDT 2009] RUN clusterMAQ ON SAMPLE 2>




1. REPLACE '@' SYMBOL IN QUALITY WITH 'A' TO AVOID PROBLEMS WITH MAQ'S sanger2fastq

/home/syoung/base/bin/comparison/replaceAtQual.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.2.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.2.fastq \
--dot 100000

	Run time: 00:13:34
	Completed /home/syoung/base/bin/comparison/replaceAtQual.pl
	3:11AM, 16 September 2009
	****************************************


/home/syoung/base/bin/comparison/replaceAtQual.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.2.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.2.fastq \
--dot 100000

	Run time: 00:13:21
	Completed /home/syoung/base/bin/comparison/replaceAtQual.pl
	3:11AM, 16 September 2009
	****************************************
	

2. CHECK READS ARE PAIRED CORRECTLY 

perl /nethome/syoung/base/bin/utils/comparePair.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.2.fastq \
--pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.2.fastq \
--type fastq
    
	49900000
	No unmatched. Total entries: 49999884
	
	Run time: 00:10:26
	Completed /nethome/syoung/base/bin/utils/comparePair.pl
	3:14AM, 14 September 2009
	****************************************


3. RUN clusterMAQ.pl ON ngsdev

mkdir -p /p/NGS/syoung/base/pipeline/SRA/maq/2
cd /p/NGS/syoung/base/pipeline/SRA/maq/2
screen -S clusterMAQ-sample2

#### 	NB: USE --clean OPTION IF RUNNING FOR FIRST TIME

/nethome/syoung/base/bin/nextgen/clusterMAQ.pl \
--splitfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.2.fastq.split \
--referencefile /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \
--outputdir /p/NGS/syoung/base/pipeline/SRA/maq/2 \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.2.fastq,/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.2.fastq \
--convert \
--queue "-q psmall" \
--jobs 40 \
&> /p/NGS/syoung/base/pipeline/SRA/maq/2/outerr.txt


tail -f /p/NGS/syoung/base/pipeline/SRA/maq/2/outerr.txt
	
	real    4m21.793s
	user    4m9.393s
	sys     0m1.826s
	
	Run time: 35:33:26
	Completed /nethome/syoung/base/bin/nextgen/clusterMAQ.pl
	6:46PM, 17 September 2009
	****************************************

	


</entry>



<entry [Sun Sep 13 13:28:16 EDT 2009] FIRST RUN clusterMAQ ON FIRST SAMPLE USING ORDERED READ DATA>



1. SAVE FASTA, QUAL AND FASTQ FILES TO ARCHIVE

cd /p/NGS/syoung/base/pipeline/SRA/NA18507/zipfiles
tar cvfz NA18507.samples.fastq.tar.gz /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_*.fastq

#### PENDING COMPLETION

###cd /p/NGS/syoung/base/pipeline/SRA/NA18507/zipfiles
###tar cvfz NA18507.samples.fasta.tar.gz /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_*.fasta
###
###cd /p/NGS/syoung/base/pipeline/SRA/NA18507/zipfiles
###tar cvfz NA18507.samples.qual.tar.gz /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_*.qual


2. REPLACE '@' SYMBOL IN QUALITY WITH 'A' TO AVOID PROBLEMS WITH MAQ'S sanger2fastq

/home/syoung/base/bin/comparison/replaceAtQual.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.1.fastq \
--dot 100000

	Run time: 00:12:44
	Completed /home/syoung/base/bin/comparison/replaceAtQual.pl
	2:59AM, 14 September 2009
	****************************************


/home/syoung/base/bin/comparison/replaceAtQual.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--outputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.1.fastq \
--dot 100000
	
	Run time: 00:08:52
	Completed /home/syoung/base/bin/comparison/replaceAtQual.pl
	11:17PM, 13 September 2009
	****************************************


3. CHECK READS ARE PAIRED CORRECTLY 

perl /nethome/syoung/base/bin/utils/comparePair.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.1.fastq \
--pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.1.fastq \
--type fastq
    
	49900000
	No unmatched. Total entries: 49999884
	
	Run time: 00:10:26
	Completed /nethome/syoung/base/bin/utils/comparePair.pl
	3:14AM, 14 September 2009
	****************************************



###4. CHECK FOR '@' SYMBOL:
###
###cd /p/NGS/syoung/base/pipeline/SRA/NA18507/samples
###grep -n "IIII=IAII<I:II8I7I7*" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.1.fastq
###
###	44:IIIIIIIIIIIIIIIAIIII=IAII<I:II8I7I7*




4. RUN clusterMAQ.pl ON ngsdev

mkdir -p /p/NGS/syoung/base/pipeline/SRA/maq/1
cd /p/NGS/syoung/base/pipeline/SRA/maq/1/
screen -S clusterMAQ-sample1

#### 	NB: USE --clean OPTION IF RUNNING FOR FIRST TIME

/nethome/syoung/base/bin/nextgen/clusterMAQ.pl \
--splitfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \
--outputdir /p/NGS/syoung/base/pipeline/SRA/maq/1 \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_1.1.fastq,/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_SANGER_2.1.fastq \
--convert \
--clean \
--queue "-q psmall" \
--jobs 40 \
&> /p/NGS/syoung/base/pipeline/SRA/maq/1/outerr.txt


tail -f /p/NGS/syoung/base/pipeline/SRA/maq/1/outerr.txt

	real    2m53.683s
	user    2m47.865s
	sys     0m0.997s
	
	Run time: 32:32:03
	Completed /nethome/syoung/base/bin/nextgen/clusterMAQ.pl
	12:07AM, 15 September 2009
	****************************************


qstat
	


	84272.kronos              maq.sh           syoung          00:28:27 R psmall         
	84273.kronos              maq.sh           syoung          00:28:27 R psmall         
	84274.kronos              maq.sh           syoung          00:28:18 R psmall         
	84275.kronos              maq.sh           syoung          00:28:03 R psmall         
	84276.kronos              maq.sh           syoung          00:28:01 R psmall         
	84277.kronos              maq.sh           syoung          00:27:48 R psmall         
	84278.kronos              maq.sh           syoung          00:27:35 R psmall         
	84279.kronos              maq.sh           syoung          00:27:34 R psmall         
	84280.kronos              maq.sh           syoung          00:28:03 R psmall         
	84281.kronos              maq.sh           syoung          00:27:56 R psmall         
	84282.kronos              maq.sh           syoung          00:27:43 R psmall         
	84283.kronos              maq.sh           syoung          00:27:36 R psmall         
	84284.kronos              maq.sh           syoung          00:27:09 R psmall         
	84285.kronos              maq.sh           syoung          00:27:12 R psmall         
	84286.kronos              maq.sh           syoung          00:27:12 R psmall         
	84287.kronos              maq.sh           syoung          00:27:08 R psmall         
	84288.kronos              maq.sh           syoung          00:28:12 R psmall         
	84289.kronos              maq.sh           syoung          00:28:13 R psmall         
	84290.kronos              maq.sh           syoung          00:27:49 R psmall         
	84291.kronos              maq.sh           syoung          00:26:44 R psmall         
	84292.kronos              maq.sh           syoung          00:26:40 R psmall         
	84293.kronos              maq.sh           syoung          00:26:42 R psmall         
	84294.kronos              maq.sh           syoung          00:10:56 R psmall         
	84295.kronos              maq.sh           syoung          00:26:48 R psmall         
	84296.kronos              maq.sh           syoung          00:26:48 R psmall         
	84297.kronos              maq.sh           syoung          00:26:44 R psmall         
	84298.kronos              maq.sh           syoung          00:26:22 R psmall         
	84299.kronos              maq.sh           syoung          00:26:21 R psmall         
	84300.kronos              maq.sh           syoung          00:26:19 R psmall         
	84301.kronos              maq.sh           syoung          00:26:16 R psmall         
	84302.kronos              maq.sh           syoung          00:10:32 R psmall         
	84303.kronos              maq.sh           syoung          00:26:51 R psmall         
	84304.kronos              maq.sh           syoung          00:26:29 R psmall         
	84305.kronos              maq.sh           syoung          00:26:25 R psmall         
	84306.kronos              maq.sh           syoung          00:26:27 R psmall         
	84307.kronos              maq.sh           syoung          00:26:26 R psmall         
	84308.kronos              maq.sh           syoung          00:26:24 R psmall         
	84309.kronos              maq.sh           syoung          00:26:25 R psmall         
	84310.kronos              maq.sh           syoung          00:26:23 R psmall         
	84311.kronos              maq.sh           syoung          00:00:42 R psmall      


OUTPUT

emacs /p/NGS/syoung/base/pipeline/SRA/maq/1/outerr.txt

	...
	#### Doing submap 48 of 49
	Can't exec "####": No such file or directory at /nethome/syoung/base/bin/nextgen/clusterMAQ.pl line 438.
	
	time /nethome/syoung/base/apps/maq/0.7.1/maq mapmerge /p/NGS/syoung/base/pipeline/SRA/maq/1/out.map /p/NGS/syou\
	ng/base/pipeline/SRA/maq/1/temp.map /p/NGS/syoung/base/pipeline/SRA/maq/1/50/out.map
	1546.32user 9.07system 26:09.66elapsed 99%CPU (0avgtext+0avgdata 0maxresident)k
	0inputs+0outputs (0major+400minor)pagefaults 0swaps
	
	ls -al /p/NGS/syoung/base/pipeline/SRA/maq/1/out.map
	-rw-rw----+ 1 syoung bioinfo 3638429147 Sep 15 09:43 /p/NGS/syoung/base/pipeline/SRA/maq/1/out.map
	
	mv /p/NGS/syoung/base/pipeline/SRA/maq/1/out.map /p/NGS/syoung/base/pipeline/SRA/maq/1/temp.map
	
	cp /p/NGS/syoung/base/pipeline/SRA/maq/1/temp.map /p/NGS/syoung/base/pipeline/SRA/maq/1/out.map
	
	time /nethome/syoung/base/apps/maq/0.7.1/maq assemble consensus.cns /p/NGS/syoung/base/pipeline/human-genome-bf\
	a/genome.bfa out.map 2> assemble.log
	
	real    63m2.643s
	user    61m32.397s
	pwd
	sys     0m15.421s
	
	time /nethome/syoung/base/apps/maq/0.7.1/maq cns2fq consensus.cns > cns.fq
	
	real    17m10.942s
	user    16m15.287s
	sys     0m17.209s
	
	time /nethome/syoung/base/apps/maq/0.7.1/maq cns2snp consensus.cns > cns.snp
	
	real    15m30.796s
	user    15m18.260s
	sys     0m5.175s
	
	time /nethome/syoung/base/apps/maq/0.7.1/maq rmdup out.rmdup out.map
	[maq_rmdup_core] processing reference chr1...
	[maq_rmdup_core] processing reference chr2...
	[maq_rmdup_core] processing reference chr3...
	[maq_rmdup_core] processing reference chr4...
	[maq_rmdup_core] processing reference chr5...
	[maq_rmdup_core] processing reference chr6...
	[maq_rmdup_core] processing reference chr7...
	[maq_rmdup_core] processing reference chr8...
	[maq_rmdup_core] processing reference chr9...
	[maq_rmdup_core] processing reference chr10...
	[maq_rmdup_core] processing reference chr11...
	[maq_rmdup_core] processing reference chr12...
	[maq_rmdup_core] processing reference chr13...
	[maq_rmdup_core] processing reference chr14...
	[maq_rmdup_core] processing reference chr15...
	[maq_rmdup_core] processing reference chr16...
	[maq_rmdup_core] processing reference chr17...
	[maq_rmdup_core] processing reference chr18...
	[maq_rmdup_core] processing reference chr19...
	[maq_rmdup_core] processing reference chr20...
	[maq_rmdup_core] processing reference chr21...
	[maq_rmdup_core] processing reference chr22...
	[maq_rmdup_core] processing reference chrX...
	[maq_rmdup_core] processing reference chrY...
	[maq_rmdup_core] 577366 / 45878903 = 0.0126
	1557.04user 10.04system 26:24.29elapsed 98%CPU (0avgtext+0avgdata 0maxresident)k
	0inputs+0outputs (0major+3442minor)pagefaults 0swaps
	
	time /nethome/syoung/base/apps/maq/0.7.1/maq indelpe /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa ou\
	t.rmdup > out.indelpe
	
	real    12m39.685s
	user    11m6.080s
	sys     0m8.004s
	
	time /nethome/syoung/base/apps/maq/0.7.1/maq indelsoa /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa o\
	ut.map > out.indelsoa
	sh: line 1: 14049 Segmentation fault      /nethome/syoung/base/apps/maq/0.7.1/maq indelsoa /p/NGS/syoung/base/p\
	ipeline/human-genome-bfa/genome.bfa out.map >out.indelsoa
	
	real    0m0.303s
	user    0m0.001s
	sys     0m0.158s
	
	awk '$5+$6-$4 >= 3 && $4 <= 1' out.indelsoa > out.indelsoa.filter
	
	time /nethome/syoung/base/apps/maq/0.7.1/scripts/maq.pl SNPfilter -d 1 -s out.indelsoa -F out.indelpe cns.snp &\
	> out.SNPfilter
	
	real    2m53.683s
	user    2m47.865s
	sys     0m0.997s
	
	Run time: 32:32:03
	Completed /nethome/syoung/base/bin/nextgen/clusterMAQ.pl
	12:07AM, 15 September 2009
	****************************************



NOTE SEGMENTATION FAULT WITH indelsoa COMMAND:

time /nethome/syoung/base/apps/maq/0.7.1/maq indelsoa /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa out.map > out.indelsoa
	sh: line 1: 14049 Segmentation fault      /nethome/syoung/base/apps/maq/0.7.1/maq indelsoa /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa out.map >out.indelsoa





</entry>



<entry [Sat Sep 12 05:35:10 EDT 2009] FIX READ MISMATCH PROBLEM>



PROBLEM
-------


WE HAVE NON-MATCHING READS IN THE SPLIT READ FILES:

cd /p/NGS/syoung/base/pipeline/SRA/maq/1/2

head reads_sanger_1.10.fastq

	@SRR002299.6012193
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANN
	+
	(&!!!!*@3!"!"!!!"!""!!!+++++++++++++
	@SRR002299.6012247
	ACTCAACTCTCTCTGAATACTTGGAAAGCCTTCCNN
	+
	(&!!!!*@3!"!"!!!"!"""!!!++++++++++++
	@SRR002299.6012280
	AAGGGTTAGCTTTTATTTTCTCAAAAACACAAATNN

head reads_sanger_2.10.fastq

	@SRR002276.22887549
	AAGAACAAAGGAATATATGTTCCTATAAAAATTTTT
	+
	(&!!!!!%%99@3!"!"!""!""!""#++!+!""!#
	@SRR002276.22887601
	GAGGGATGATAACACAAACAAGAGGTAGCACATCAG
	+
	(&!!!!!%%99@3!"!"!""!"!"!!"+!%(%!!"!
	@SRR002276.22887630
	TATCACTCAAATTAGGCTCCCTGAAGTCTTCGAGGT






CHECK IF THE PROBLEM LIES IN NON-MATCHING READS IN THE INPUT FILES:


head /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_1.1.fastq
#
head /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_2.1.fastq

time grep -n "@SRR002299.6012193" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_1.1.fastq
36000001:@SRR002299.6012193 FC2033H_R1:2:326:28:404

time grep -n "@SRR002299.6012193" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_2.1.fastq
40555297:@SRR002299.6012193 FC2033H_R1:2:326:28:404 


grep -n "@SRR002276.22887549" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_1.1.fastq
38549361:@SRR002276.22887549 FC20433AAXX_R1:4:18:39:178

grep -n "@SRR002276.22887549" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_2.1.fastq
36000001:@SRR002276.22887549 FC20433AAXX_R1:4:18:39:178



SAME STORY WITH FASTA FILES - THE READS DO NOT MATCH IN THE PAIRED END FILES - SO PROBLEM MUST BE IN printFile.pl OR listFiles.pl STAGE.


EXPERIMENT SRR002299
--------------------

grep -n ">SRR002299.6012193" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fasta

grep -n ">SRR002299.6012193" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fasta
18000001:>SRR002299.6012193 FC2033H_R1:2:326:28:404 

grep -n ">SRR002299.6012193" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fasta
20277649:>SRR002299.6012193 FC2033H_R1:2:326:28:404


EXPERIMENT SRR002276
--------------------

grep -n ">SRR002276.22887549" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fasta
19274681:>SRR002276.22887549 FC20433AAXX_R1:4:18:39:178 

grep -n ">SRR002276.22887549" /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fasta
18000001:>SRR002276.22887549 FC20433AAXX_R1:4:18:39:178



/tmp/reads_2.1.fastq





**** YES - THE PROBLEM LIES IN THE NON-MATCHING READS IN THE INPUT FILES ****



NB: THE ORIGINAL FASTA FILES DO NOT HAVE NON-MATCHING READ IDS:

cd /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta
grep -n "SRR002299.6012193" SRR002299_*.fasta

    SRR002299_1.fasta:12024385:>SRR002299.6012193 FC2033H_R1:2:326:28:404 
    SRR002299_2.fasta:12024385:>SRR002299.6012193 FC2033H_R1:2:326:28:404


cd /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta
grep -n "SRR002276.22887549" SRR002276_*.fasta

    SRR002276_1.fasta:45775097:>SRR002276.22887549 FC20433AAXX_R1:4:18:39:178               
    SRR002276_2.fasta:45775097:>SRR002276.22887549 FC20433AAXX_R1:4:18:39:178 




DIAGNOSIS
---------


1. FASTQ FILE FOR EACH EXPERIMENT 

/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR002299_1.fastq.gz
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR002299_2.fastq.gz



2. FASTA FILE FOR EACH EXPERIMENT IN fasta DIRECTORY

/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002299_1.fasta
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002299_2.fasta



3. INFO FILES CONTAIN LENGTH OF RECORD AND NUMBER OF READS IN EACH FILE

/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002299_1.fasta.info
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002299_2.fasta.info

E.G.: 

    6080299 60      36      99



4. LIST FILES CONTAIN THE BYTE-OFFSET LOCATIONS OF RANDOMLY 'SHUFFLED' RECORDS


CHECK THE LIST FILES FOR MISMATCHES (SHOULD NOT BE BECAUSE THE READ 2 LIST FILES ARE
COPIED FROM THE READ 1 LIST FILES)


FIND THE FILES WITH THE READS INVOLVED IN THE KNOWN ANOMALY:


EXPERIMENT SRR002276
--------------------
cd /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/
grep -n "@SRR002276.22887549" *fastq


EXPERIMENT SRR002299
--------------------

cd /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00229/
grep -n "@SRR002299.6012193" *fastq


CHECK LIST FILES WITH comparePair.pl
------------------------------------

perl /nethome/syoung/base/bin/utils/comparePair.pl --inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002277_1.fasta.9.list --pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002277_2.fasta.9.list --type line

    No unmatched. Total entries: 187743
    

*** RANDOMLY CHECKED 10 DIFFERENT .list FILE PAIRS AND ALL HAD 'No unmatched'.


CHECK FASTQ FILES WITH comparePair.pl
-------------------------------------


cd /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/

perl /nethome/syoung/base/bin/utils/comparePair.pl --inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002276_1.fasta.9-37.reads-fastq --pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002276_2.fasta.9-37.reads-fastq --type fastq
    
    OK

    
perl /nethome/syoung/base/bin/utils/comparePair.pl --inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002276_1.fasta.1-37.reads-fastq --pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002276_2.fasta.1-37.reads-fastq --type fastq

    ++++ FileTools::readLengths(args)
    inputfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002276_1.fasta.1-37.reads-fastq
    type: fastq
    No unmatched. Total entries: 1305368
    
    Run time: 00:00:20
    Completed /nethome/syoung/base/bin/utils/comparePair.pl
    5:26AM, 12 September 2009
    ****************************************



CHECK MERGED READ FILES, THIS TIME WITH comparePair.pl


perl /nethome/syoung/base/bin/utils/comparePair.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_1.1.fastq \
--pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_2.1.fastq \
--type fastq &> fastq.out


    ...
    4000000
    4100000
    Mismatch at counter: 4104197
    sequence header: @SRR002274.32 FC20471AAXX_R1:1:1:638:757
    
    paired header: @SRR002281.30 FC203VOAAXX_R1:5:1:341:881
    
    Mismatch at counter: 4104198227
    sequence header: @SRR002274.41 FC20471AAXX_R1:1:1:613:663
    
    paired header: @SRR002281.68 FC203VOAAXX_R1:5:1:241:380
    
    Mismatch at counter: 4104199
    sequence header: @SRR002274.89 FC20471AAXX_R1:1:1:299:662
    
    paired header: @SRR002281.82 FC203VOAAXX_R1:5:1:361:772
    
    Mismatch at counter: 4104200
    sequence header: @SRR002274.118 FC20471AAXX_R1:1:1:40:886
    
    paired header: @SRR002281.137 FC203VOAAXX_R1:5:1:249:638
    
    Mismatch at counter: 4104201
    sequence header: @SRR002274.173 FC20471AAXX_R1:1:1:210:567


NB: THE FASTA READS SAMPLE FILE HAS THE SAME PROBLEM:

perl /nethome/syoung/base/bin/utils/comparePair.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fasta \
--pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fasta \
--type fasta


    First nonMatch at read number 4104197
    Name >SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
    
    Paired >SRR002281.30 FC203VOAAXX_R1:5:1:341:881                     
    
    
    Run time: 00:00:07
    Completed /nethome/syoung/base/bin/utils/comparePair.pl
    7:21AM, 12 September 2009
    ****************************************



getlines.pl -f /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_1.1.fastq -n 16416778 -l 40

    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIEII
    @SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    +SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
    CCGTGTGAAAAGACCACCAAACAGGCTTTGGGTTAC
    +SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
    IIIIIIIIIIIIIIIIIIIIAIIIIIIIII*I%II+
    @SRR002274.32 FC20471AAXX_R1:1:1:638:757   <======= NEW INPUT FILE STARTS HERE
    GGTTTGCAGACAAAAGGCAATTTTTTAAATGCTGAG
    +SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
    IIIIIIIIIBI5<I1III=9IIIIII1A1ID4I?(I
    @SRR002274.41 FC20471AAXX_R1:1:1:613:663                     
    GGTTATACTGTTTTAGTTACCACCAGTACATATGCG
    +SRR002274.41 FC20471AAXX_R1:1:1:613:663                     
    IIIIIIIIIIIIII&IIF1I=,=C%GA/>,;-I8#=




getlines.pl -f /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_2.1.fastq -n 16416778 -l 40

    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII;II.I
    @SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    +SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
    @SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
    TCAAAAGTGAATTGCAGCTGGGTGTGGTAGCTCACC
    +SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
    IIIIIIIIIIIIIIIIIII&III<2III1IIII/I.
    @SRR002281.30 FC203VOAAXX_R1:5:1:341:881   <======= DIFFERENT INPUT FILE STARTS HERE         
    GTTCCTGATTGTTTTTGCTGTATGCAGTTTCATAAT
    +SRR002281.30 FC203VOAAXX_R1:5:1:341:881                     
    IIIIIII<IIIIIIII1=III5I7/$IIII*(I),I
    @SRR002281.68 FC203VOAAXX_R1:5:1:241:380                     
    GAATCCAAGTAGGAGAAACACCAGAAGTCCACGCAG
    +SRR002281.68 FC203VOAAXX_R1:5:1:241:380                     
    IIIIIIIAIIIIIII;I'I8IIIIIII/IIIFI24I
    @SRR002281.82 FC203VOAAXX_R1:5:1:361:772                     
    CCACTCTCAGCGATAACAGTGCACAAGGGCATCTTG
    +SRR002281.82 FC203VOAAXX_R1:5:1:361:772                     
    IIIII>IADI8I2IA-I+I:I2&-4+III+(:"086



DIAGNOSIS


MISSING INPUT FILE FOR READ 2 OF SRR002274, SO mergeFiles.pl SKIPS TO NEXT READ 2 FILE.



INFO FILE EXISTS
cat /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_2.fasta.info
    18100083        60      36      99



LIST FILE IS PRESENT

head /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002274_2.fasta.9.list
    3366
    4158
    9900
    10989
    14256
    18018
    24453
    27225
    31284
    32472
    ...







LOOK TO SEE IF READ 2 SUBFILES ARE MISSING (THEY ARE PRESENT):


cd /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/

head SRR002274_1.fasta.1-37.reads-fastq | grep "SRR002274.32"

    @SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
    +SRR002274.32 FC20471AAXX_R1:1:1:638:757      


head SRR002274_2.fasta.1-37.reads-fastq | grep "SRR002274.32"

    @SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
    +SRR002274.32 FC20471AAXX_R1:1:1:638:757                     




4. SPLIT FILES ARE


/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split

E.G.:
    
    0       0       /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_sanger_1.1.fastq
    1       0       /p/NGS/syoung/base/pipeline/SRA/maq/1/2/reads_sanger_1.2.fastq
    2       0       /p/NGS/syoung/base/pipeline/SRA/maq/1/3/reads_sanger_1.3.fastq
    3       0       /p/NGS/syoung/base/pipeline/SRA/maq/1/4/reads_sanger_1.4.fastq
    ...
    49      0       /p/NGS/syoung/base/pipeline/SRA/maq/1/50/reads_sanger_1.50.fastq
    0       1       /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_sanger_2.1.fastq
    1       1       /p/NGS/syoung/base/pipeline/SRA/maq/1/2/reads_sanger_2.2.fastq
    2       1       /p/NGS/syoung/base/pipeline/SRA/maq/1/3/reads_sanger_2.3.fastq
    ...
    48      1       /p/NGS/syoung/base/pipeline/SRA/maq/1/49/reads_sanger_2.49.fastq
    49      1       /p/NGS/syoung/base/pipeline/SRA/maq/1/50/reads_sanger_2.50.fastq



FASTQ

cd /p/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fastq.sh
emacs mergeFiles-fastq.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 1-37 \
--mode fastq \
--paired

echo "PBS ID: $PBS_ID"
echo `/usr/local/bin/qstat -f $PBS_ID`;
echo "Completed"

### END printFiles-fastq-h


cd /p/NGS/syoung/base/pipeline/SRA/NA18507
chmod 755 mergeFiles-qual.sh



FASTA

cd /p/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fasta.sh
emacs mergeFiles-fasta.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 1-37 \
--mode fasta \
--paired

echo "PBS ID: $PBS_ID"
echo `/usr/local/bin/qstat -f $PBS_ID`;
echo "Completed"

### END printFiles-fasta-h


cd /p/NGS/syoung/base/pipeline/SRA/NA18507
chmod 755 mergeFiles-qual.sh



RUN mergeFiles.pl FOR FASTQ, FASTA AND QUAL
-------------------------------------------


cd /p/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles.sh
emacs mergeFiles.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 1-37 \
--mode fastq \
--paired \
--queue "-q psmall" \
--jobs 40 \
--dot 10 \
--cluster &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/mergeFiles-fastq.log


/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 1-37 \
--mode fasta \
--paired \
--queue "-q psmall" \
--jobs 40 \
--dot 10 \
--cluster &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/mergeFiles-fasta.log




/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 1-37 \
--mode qual \
--paired \
--queue "-q psmall" \
--jobs 40 \
--dot 10 \
--cluster &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/mergeFiles-qual.log


#### END

chmod 755 mergeFiles.sh




TEST INDIVIDUAL MERGE OF INDEX 1 READ FILE
------------------------------------------


cd /p/NGS/syoung/base/pipeline/SRA/NA18507

/home/syoung/base/bin/comparison/mergeFile.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--mode fastq \
--index 1 \
--maxindex 37  \
--paired &> mergeFile.out



	cat /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR00396/SRR003964_2.fasta.1-37.reads-fastq >> /tmp/reads_2.1.fastq
	done
	move: mv /tmp/reads_2.1.fastq /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq
	
	Run time: 00:22:16
	Completed /home/syoung/base/bin/comparison/mergeFile.pl
	11:36PM, 12 September 2009
	****************************************


OUTPUT FILES

/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq



getlines.pl -f /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq -n 16416778 -l 40

IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIEII
@SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
+SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
CCGTGTGAAAAGACCACCAAACAGGCTTTGGGTTAC
+SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
IIIIIIIIIIIIIIIIIIII@IIIIIIIII*I%II+
@SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
GGTTTGCAGACAAAAGGCAATTTTTTAAATGCTGAG
+SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
IIIIIIIIIBI5<I1III=9IIIIII1A1ID4I?(I
@SRR002274.41 FC20471AAXX_R1:1:1:613:663                     
GGTTATACTGTTTTAGTTACCACCAGTACATATGCG
+SRR002274.41 FC20471AAXX_R1:1:1:613:663



getlines.pl -f /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq -n 16416778 -l 40


IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII;II.I
@SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
+SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
@SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
TCAAAAGTGAATTGCAGCTGGGTGTGGTAGCTCACC
+SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
IIIIIIIIIIIIIIIIIII&III<2III1IIII/I.
@SRR002281.30 FC203VOAAXX_R1:5:1:341:881      <===== SAME OLD PROBLEM               
GTTCCTGATTGTTTTTGCTGTATGCAGTTTCATAAT
+SRR002281.30 FC203VOAAXX_R1:5:1:341:881                     
IIIIIII<IIIIIIII1=III5I7/$IIII*(I),I
@SRR002281.68 FC203VOAAXX_R1:5:1:241:380                     
GAATCCAAGTAGGAGAAACACCAGAAGTCCACGCAG
+SRR002281.68 FC203VOAAXX_R1:5:1:241:380                     
IIIIIII@IIIIIII;I'I8IIIIIII/IIIFI24I
@SRR002281.82 FC203VOAAXX_R1:5:1:361:772                     
CCACTCTCAGCGATAACAGTGCACAAGGGCATCTTG
+SRR002281.82 FC203VOAAXX_R1:5:1:361:772      


cd /p/NGS/syoung/base/pipeline/SRA/NA18507
emacs mergeFile.out

	...
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR00573/SRR005735_1.fasta.1-37.reads-fastq
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR00573/SRR005735_2.fasta.1-37.reads-fastq
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00228/SRR002281_2.fasta.1-37.reads-fastq
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002274_1.fasta.1-37.reads-fastq
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002271_2.fasta.1-37.reads-fastq
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002271_1.fasta.1-37.reads-fastq
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00228/SRR002281_1.fasta.1-37.reads-fastq
	smallfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002274_2.fasta.1-37.reads-fastq
	...



NB: THE DISTRURBED ORDER ORIGINATES IN THE Sampler::filepaths SUBROUTINE

	...
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005735_1.fasta.info
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005735_2.fasta.info
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR00572
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR00573
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002281_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_1.fasta.qual
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_1.fasta.qual
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_2.fasta.qual
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_1.fasta.info
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002281_1.fasta
	...


SO I SORTED THEM:

/home/syoung/base/bin/comparison/mergeFile.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--mode fastq \
--index 1 \
--maxindex 37  \
--paired &> mergeFile3.out

	...
	Sampler::filepaths    BEFORE Util::by_suffix(..., fasta) files:
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005719_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005719_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005718_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005718_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005721_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005721_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005734_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005734_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005720_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005720_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005735_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005735_2.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002281_2.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_1.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_2.fasta	
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_1.fasta	
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002281_1.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_2.fasta	<====
	...


	Sampler::filepaths    AFTER Util::by_suffix(..., fasta) files:
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005719_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005719_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005718_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005718_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005721_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005721_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005734_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005734_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005720_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005720_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005735_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005735_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002281_2.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_1.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_2.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002271_1.fasta
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002281_1.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002274_2.fasta	<====
	/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002278_2.fasta


THEN RERAN mergeFiles.pl. CHECKED OUTPUT fastq FILES:


cd /p/NGS/syoung/base/pipeline/SRA/NA18507/samples
grep -n "SRR002274\.32" reads_1.1.fastq > out
head out
	
	6437505:@SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
	6437507:+SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
	6437861:@SRR002274.3224 FC20471AAXX_R1:1:1:455:586                   


grep -n "SRR002274\.32" reads_2.1.fastq > out
head out

	6437505:@SRR002274.32 FC20471AAXX_R1:1:1:638:757
	6437507:+SRR002274.32 FC20471AAXX_R1:1:1:638:757
	6437861:@SRR002274.3224 FC20471AAXX_R1:1:1:455:586


getlines.pl -f /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq -n 6437495 -l 40

	@SRR002272.35727870 FC2046H_R1:8:197:567:827                 
	CAAGTGTACTTTATTTCCTTTCCTTCCTGCTCTAAA
	+SRR002272.35727870 FC2046H_R1:8:197:567:827                 
	IIII@IICIIII:IIID<II;/:G=62;'2?7G)+*
	@SRR002272.35727886 FC2046H_R1:8:197:679:185                 
	TATCTGGGTCAGTTAATCCCAGCTCCCAGCTGCCAG
	+SRR002272.35727886 FC2046H_R1:8:197:679:185                 
	01=?84B+(4/30:.&-&&&()(%*"&#""$$%,#!
	@SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
	GGTTTGCAGACAAAAGGCAATTTTTTAAATGCTGAG
	+SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
	IIIIIIIIIBI5<I1III=9IIIIII1A1ID4I?(I
	@SRR002274.41 FC20471AAXX_R1:1:1:613:663                     
	GGTTATACTGTTTTAGTTACCACCAGTACATATGCG
	+SRR002274.41 FC20471AAXX_R1:1:1:613:663                     
	IIIIIIIIIIIIII&IIF1I=,=C%GA/>,;-I8#=
	@SRR002274.89 FC20471AAXX_R1:1:1:299:662                     
	GGAATGGAATAGAATGGAATTGAATCAAGCCAAGTG


getlines.pl -f /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq -n 6437495 -l 40

	@SRR002272.35727870 FC2046H_R1:8:197:567:827                 
	AATATCTGAGCAACGTGGCATCAAAGTATGTTACTG
	+SRR002272.35727870 FC2046H_R1:8:197:567:827                 
	IIII>BGIIA6I3.7,*5)*.(',+-%-/+(,+$%'
	@SRR002272.35727886 FC2046H_R1:8:197:679:185                 
	AGCCAGTGACCCGCTTGAGGACTAGCGGGTTAACCC
	+SRR002272.35727886 FC2046H_R1:8:197:679:185                 
	4?,*-@%7-%(,/(+,%(%*%"&%$"$*!$!"&!%!
	@SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
	TTCATTGCTCCTTATCTCTGTAATGTTCATTTCAAC
	+SRR002274.32 FC20471AAXX_R1:1:1:638:757                     
	IIIIIIIIIDIIIAIIIBI2H;;IGII57III)?+&
	@SRR002274.41 FC20471AAXX_R1:1:1:613:663                     
	ACTTTCCAAATGAAGATATATGATTGGCCAATAAAC
	+SRR002274.41 FC20471AAXX_R1:1:1:613:663                     
	IIIIIII19III:ID<III4I31II&782=6769/+
	@SRR002274.89 FC20471AAXX_R1:1:1:299:662                     
	ATTATATTCCATTCCACTCGGGTTGATTCAATCCCT


LAST CHECK - RUN comparePair.pl:

perl /nethome/syoung/base/bin/utils/comparePair.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq \
--pairedfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--type fastq

	
	40700000
	40800000
	No unmatched. Total entries: 40823819
	
	Run time: 00:11:38
	Completed /nethome/syoung/base/bin/utils/comparePair.pl
	1:12PM, 13 September 2009
	****************************************


BUT FILE SIZES ARE DIFFERENT:

cd /p/NGS/syoung/base/pipeline/SRA/NA18507/samples
ll *.1.fastq

-rw-rw-rw-  1 syoung bioinfo 7.6G Sep 13 05:26 reads_1.1.fastq
-rw-rw-rw-  1 syoung bioinfo 9.3G Sep 13 07:53 reads_2.1.fastq
-rw-rw----+ 1 syoung bioinfo 9.3G Sep  5 01:58 reads_sanger_1.1.fastq
-rw-rw----+ 1 syoung bioinfo 7.6G Sep 13 12:48 reads_SANGER_1.1.fastq
-rw-rw----+ 1 syoung bioinfo 9.3G Sep 13 12:51 reads_sanger_2.1.fastq


tail reads_1.1.fastq
		
	@SRR003970.2435396 FC20476AAXX_R1:7:138:647:967              
	CAACACATGGCCTCTGCACATGACTTGAGCTTCCCA
	+SRR003970.2435396 FC20476AAXX_R1:7:138:647:967              
	IIIIIIIIIIIIIIFIIII25C@A=>960IB?+2I+
	@SRR003970.2435423 FC20476AAXX_R1:7:138:925:281              
	CTGACCTTGAATCAGCAGAAAACTCAGAAGAAACTG
	+SRR003970.2435423 FC20476AAXX_R1:7:138:925:281              
	IIIIIIIIIIIIIIIIIIIIII@IIIGCIIA:IF6H
	@SRR003970.2435468 FC20476AAXX_R1:7:138:203:152
	
	
tail reads_2.1.fastq

	+SRR005735.32898496 FC301L3AAXX:7:98:1296:1082               
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII;II.I
	@SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	+SRR005735.32898547 FC301L3AAXX:7:98:1724:801                
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
	@SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
	TCAAAAGTGAATTGCAGCTGGGTGTGGTAGCTCACC
	+SRR005735.32898581 FC301L3AAXX:7:98:326:758                 
	IIIIIIIIIIIIIIIIIII&III<2III1IIII/I.


cd /p/NGS/syoung/base/pipeline/SRA/NA18507/samples
tail reads_1.3.fastq

	[syoung@kronos samples]$ tail reads_1.3.fastq
	ATTCAACTCACAGAGTTGAACGATCCTTTACACAGA
	+SRR006555.438521 FC202M4_AAXX_R1:6:19:567:792               
	(ACC;A@>II>'.-7+?--.,,()(%*'4+*&'#!&
	@SRR006555.438558 FC202M4_AAXX_R1:6:19:28:969                
	TCTGTCTTGCTTTGTGTCTTTATGAGCTTAACCTTT
	+SRR006555.438558 FC202M4_AAXX_R1:6:19:28:969                
	;@<I1GI;A=<I;21/5-;3;-6(*')22)&''--%
	@SRR006555.438618 FC202M4_AAXX_R1:6:19:330:339               
	ATTTCCTTCTGAGATGATGAAAATGCTGAGCAACTA

tail reads_2.3.fastq

	+SRR005735.32898512 FC301L3AAXX:7:98:1649:1220               
	IIIIIIIIIIII(IIIIII.IIIII+IIH0III<IE
	@SRR005735.32898557 FC301L3AAXX:7:98:1390:1228               
	GGGACGCCCCGTCGCAGCGTCACATGCCAGTGTCAC
	+SRR005735.32898557 FC301L3AAXX:7:98:1390:1228               
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
	@SRR005735.32898594 FC301L3AAXX:7:98:440:244                 
	CCCACCTACCAGAGGACAGTATGTAAAAACCACCCC
	+SRR005735.32898594 FC301L3AAXX:7:98:440:244                 
	IIIIIIIIIIII8IDII?IIII@IGIIIIII02I/3



RERAN mergeFiles.pl BUT WITH MORE DETAILED ERROR TRACKING OUTPUT:



[syoung@kronos NA18507]$ /nethome/syoung/base/bin/comparison/mergeFiles.pl \
> --inputdir \
> /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
> /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
> /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
> /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
> /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
> /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
> --outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
> --maxindex 37 \
> --indices 1-37 \
> --mode fastq \
> --paired \
> --queue "-q psmall" \
> --jobs 40 \
> --dot 10 \
> --cluster &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/mergeFiles-fastq.log










CURRENTLY USING THESE NODES

Job ID               Username Queue    Jobname    SessID NDS   TSK Memory Time  S Time
84170.kronos.ccs.mia syoung   psmall   mergeFile-  11955   --   --    --    --  R 00:33	n15/0
84171.kronos.ccs.mia syoung   psmall   mergeFile-  11987   --   --    --    --  R 00:33	n15/1
84172.kronos.ccs.mia syoung   psmall   mergeFile-  12023   --   --    --    --  R 00:33	n15/2
84173.kronos.ccs.mia syoung   psmall   mergeFile-  12057   --   --    --    --  R 00:33	n15/3
84174.kronos.ccs.mia syoung   psmall   mergeFile-  12093   --   --    --    --  R 00:33	n15/4
84175.kronos.ccs.mia syoung   psmall   mergeFile-  12125   --   --    --    --  R 00:33	n15/5
84176.kronos.ccs.mia syoung   psmall   mergeFile-  12159   --   --    --    --  R 00:33	n15/6
84177.kronos.ccs.mia syoung   psmall   mergeFile-  12199   --   --    --    --  R 00:32	n15/7
84178.kronos.ccs.mia syoung   psmall   mergeFile-  23773   --   --    --    --  R 00:33	n14/0
84179.kronos.ccs.mia syoung   psmall   mergeFile-  23791   --   --    --    --  R 00:32	n14/1
84180.kronos.ccs.mia syoung   psmall   mergeFile-  23809   --   --    --    --  R 00:32	n14/2
84181.kronos.ccs.mia syoung   psmall   mergeFile-  23831   --   --    --    --  R 00:32	n14/3
84182.kronos.ccs.mia syoung   psmall   mergeFile-  23849   --   --    --    --  R 00:31	n14/4
84183.kronos.ccs.mia syoung   psmall   mergeFile-  23869   --   --    --    --  R 00:31	n14/5
84184.kronos.ccs.mia syoung   psmall   mergeFile-  23889   --   --    --    --  R 00:31	n14/6
84185.kronos.ccs.mia syoung   psmall   mergeFile-  23913   --   --    --    --  R 00:31	n14/7

<--- START OF FAILED JOBS -->
84186.kronos.ccs.mia syoung   psmall   mergeFile-  16600   --   --    --    --  R 00:31	n13/1
84187.kronos.ccs.mia syoung   psmall   mergeFile-  16618   --   --    --    --  R 00:31	n13/2
84188.kronos.ccs.mia syoung   psmall   mergeFile-  16636   --   --    --    --  R 00:31	n13/3
84189.kronos.ccs.mia syoung   psmall   mergeFile-  16656   --   --    --    --  R 00:31	n13/4
84190.kronos.ccs.mia syoung   psmall   mergeFile-  16676   --   --    --    --  R 00:31	n13/5
84191.kronos.ccs.mia syoung   psmall   mergeFile-  16696   --   --    --    --  R 00:30	n13/6
84192.kronos.ccs.mia syoung   psmall   mergeFile-  16718   --   --    --    --  R 00:30	n13/7
<---  END OF FAILED JOBS -->

84193.kronos.ccs.mia syoung   psmall   mergeFile-  13265   --   --    --    --  R 00:31	n12/0
84194.kronos.ccs.mia syoung   psmall   mergeFile-  13284   --   --    --    --  R 00:31	n12/1
84195.kronos.ccs.mia syoung   psmall   mergeFile-  13302   --   --    --    --  R 00:30	n12/2
84196.kronos.ccs.mia syoung   psmall   mergeFile-  13322   --   --    --    --  R 00:30	n12/3
84197.kronos.ccs.mia syoung   psmall   mergeFile-  13340   --   --    --    --  R 00:30	n12/4
84198.kronos.ccs.mia syoung   psmall   mergeFile-  13360   --   --    --    --  R 00:30	n12/5
84199.kronos.ccs.mia syoung   psmall   mergeFile-  13378   --   --    --    --  R 00:30	n12/6
84200.kronos.ccs.mia syoung   psmall   mergeFile-  13399   --   --    --    --  R 00:30	n12/7
84201.kronos.ccs.mia syoung   psmall   mergeFile-  23754   --   --    --    --  R 00:30	n23/5
84202.kronos.ccs.mia syoung   psmall   mergeFile-  23784   --   --    --    --  R 00:30	n23/6
84203.kronos.ccs.mia syoung   psmall   mergeFile-  23818   --   --    --    --  R 00:30	n23/7
84204.kronos.ccs.mia syoung   psmall   mergeFile-    --    --   --    --    --  Q   -- 
84205.kronos.ccs.mia syoung   psmall   mergeFile-    --    --   --    --    --  Q   -- 
84206.kronos.ccs.mia syoung   psmall   mergeFile-    --    --   --    --    --  Q   -- 


SOME JOBS FAILED DUE TO 'no space on device', ALL ON NODE 13:

reads_1.23.fastq
reads_1.22.fastq
reads_1.21.fastq
reads_1.20.fastq
reads_1.19.fastq
reads_1.18.fastq
reads_1.17.fastq

I.E., SAMPLES 17,18,19,20,21,22,23


ll -S *out

    -rw-rw----+ 1 syoung bioinfo 160K Sep 13 19:18 mergeFiles-22.out
    -rw-rw----+ 1 syoung bioinfo 160K Sep 13 19:19 mergeFiles-20.out
    -rw-rw----+ 1 syoung bioinfo 160K Sep 13 19:18 mergeFiles-23.out
    -rw-rw----+ 1 syoung bioinfo 160K Sep 13 19:17 mergeFiles-17.out
    -rw-rw----+ 1 syoung bioinfo 159K Sep 13 19:20 mergeFiles-19.out
    -rw-rw----+ 1 syoung bioinfo 159K Sep 13 19:20 mergeFiles-21.out
    -rw-rw----+ 1 syoung bioinfo 159K Sep 13 19:19 mergeFiles-18.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 21:57 mergeFiles-10.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 21:59 mergeFiles-11.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:11 mergeFiles-12.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:14 mergeFiles-13.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:14 mergeFiles-15.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:13 mergeFiles-16.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:15 mergeFiles-27.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:07 mergeFiles-28.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:08 mergeFiles-29.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:15 mergeFiles-30.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 22:15 mergeFiles-31.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 21:54 mergeFiles-14.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 21:52 mergeFiles-24.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 21:53 mergeFiles-25.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 21:54 mergeFiles-26.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 19:47 mergeFiles-32.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 19:54 mergeFiles-33.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 19:46 mergeFiles-34.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 20:36 mergeFiles-35.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 20:36 mergeFiles-36.out
    -rw-rw----+ 1 syoung bioinfo 145K Sep 13 19:27 mergeFiles-37.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 22:02 mergeFiles-1.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 22:14 mergeFiles-4.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 22:13 mergeFiles-5.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 22:09 mergeFiles-6.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 22:13 mergeFiles-7.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 22:13 mergeFiles-8.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 22:06 mergeFiles-9.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 21:45 mergeFiles-2.out
    -rw-rw----+ 1 syoung bioinfo 143K Sep 13 21:53 mergeFiles-3.out


ll -tr reads_1*fastq

    -rw-rw-rw- 1 syoung bioinfo 2.9G Sep 13 18:04 reads_1.23.fastq
    -rw-rw-rw- 1 syoung bioinfo 2.9G Sep 13 18:04 reads_1.22.fastq
    -rw-rw-rw- 1 syoung bioinfo 2.9G Sep 13 18:04 reads_1.21.fastq
    -rw-rw-rw- 1 syoung bioinfo 2.9G Sep 13 18:04 reads_1.20.fastq
    -rw-rw-rw- 1 syoung bioinfo 3.0G Sep 13 18:04 reads_1.19.fastq
    -rw-rw-rw- 1 syoung bioinfo 3.0G Sep 13 18:04 reads_1.18.fastq
    -rw-rw-rw- 1 syoung bioinfo 3.0G Sep 13 18:04 reads_1.17.fastq



    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:12 reads_1.34.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:12 reads_1.33.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:12 reads_1.32.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:42 reads_1.1.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:43 reads_1.2.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:43 reads_1.3.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:43 reads_1.10.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:43 reads_1.11.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:43 reads_1.9.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:46 reads_1.25.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:46 reads_1.24.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:46 reads_1.12.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:47 reads_1.5.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:47 reads_1.4.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:48 reads_1.14.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:48 reads_1.13.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:48 reads_1.7.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:49 reads_1.16.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:49 reads_1.28.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:49 reads_1.6.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:50 reads_1.15.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:51 reads_1.29.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:52 reads_1.26.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:53 reads_1.27.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:53 reads_1.31.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:53 reads_1.30.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 18:54 reads_1.8.fastq
    -rw-rw-rw- 1 syoung bioinfo 640M Sep 13 19:26 reads_1.37.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 19:40 reads_1.35.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 19:40 reads_1.36.fastq

ll -tr reads_2*fastq

    -rw-rw-rw- 1 syoung bioinfo 2.9G Sep 13 18:52 reads_2.23.fastq
    -rw-rw-rw- 1 syoung bioinfo 2.8G Sep 13 18:52 reads_2.22.fastq
    -rw-rw-rw- 1 syoung bioinfo 3.3G Sep 13 18:52 reads_2.21.fastq
    -rw-rw-rw- 1 syoung bioinfo 2.8G Sep 13 18:52 reads_2.20.fastq
    -rw-rw-rw- 1 syoung bioinfo 3.0G Sep 13 18:52 reads_2.19.fastq
    -rw-rw-rw- 1 syoung bioinfo 3.2G Sep 13 18:52 reads_2.18.fastq
    -rw-rw-rw- 1 syoung bioinfo 2.8G Sep 13 18:52 reads_2.17.fastq


    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 19:14 reads_2.34.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 19:14 reads_2.32.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 19:28 reads_2.33.fastq
    -rw-rw-rw- 1 syoung bioinfo 640M Sep 13 19:30 reads_2.37.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 20:16 reads_2.36.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 20:16 reads_2.35.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:08 reads_2.3.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:08 reads_2.2.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:09 reads_2.1.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:10 reads_2.11.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:10 reads_2.10.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:12 reads_2.25.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:12 reads_2.24.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:13 reads_2.14.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:13 reads_2.26.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:14 reads_2.9.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:17 reads_2.28.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:21 reads_2.6.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:22 reads_2.5.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:22 reads_2.29.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:26 reads_2.13.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:26 reads_2.12.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:26 reads_2.8.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:28 reads_2.16.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:29 reads_2.15.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:31 reads_2.7.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:33 reads_2.4.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:38 reads_2.30.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:39 reads_2.31.fastq
    -rw-rw-rw- 1 syoung bioinfo 9.3G Sep 13 21:40 reads_2.27.fastq


SO RERUN mergeFiles.pl ON SAMPLES 17,18,19,20,21,22,23



cd /p/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-RERUN.sh
emacs mergeFiles-RERUN.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 17,18,19,20,21,22,23 \
--mode fastq \
--paired \
--queue "-q psmall" \
--jobs 40 \
--dot 10 \
--cluster &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/mergeFiles-fastq.log


/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 17,18,19,20,21,22,23 \
--mode fasta \
--paired \
--queue "-q psmall" \
--jobs 40 \
--dot 10 \
--cluster &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/mergeFiles-fasta.log




/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--maxindex 37 \
--indices 17,18,19,20,21,22,23 \
--mode qual \
--paired \
--queue "-q psmall" \
--jobs 40 \
--dot 10 \
--cluster &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/mergeFiles-qual.log


#### END


ON ngsdev:


cd /p/NGS/syoung/base/pipeline/SRA/NA18507
chmod 755 mergeFiles-RERUN.sh
screen -S mergeFiles-RERUN

./mergeFiles-RERUN.sh &> ./mergeFiles-RERUN.out






OKAY!!

NOW, IN THE MEANTIME RUN clusterMAQ ON SAMPLE READS 1 (SEE ABOVE)
	


ADDITIONAL NOTES:
================


RUNNING BUT SOME JOBS FINISHED EARLY:





[syoung@kronos 50]$ mshow
ERROR:    communication error kronos.ccs.miami.edu:42559 (client timed out after 30000000 us)
[syoung@kronos 50]$ qstat
Job id                    Name             User            Time Use S Queue
------------------------- ---------------- --------------- -------- - -----
83595.kronos              maq.sh           syoung          00:02:19 R psmall         
83596.kronos              maq.sh           syoung          00:02:16 R psmall         
83597.kronos              maq.sh           syoung          00:00:11 R psmall         
83598.kronos              maq.sh           syoung          00:00:10 R psmall         
83599.kronos              maq.sh           syoung          00:00:10 R psmall         
83600.kronos              maq.sh           syoung          00:00:10 R psmall         
83601.kronos              maq.sh           syoung          00:00:10 R psmall         
83602.kronos              maq.sh           syoung          00:00:07 R psmall         
83603.kronos              maq.sh           syoung          00:00:05 R psmall         
83604.kronos              maq.sh           syoung          00:00:43 C psmall         
83605.kronos              maq.sh           syoung          00:00:43 C psmall         
83606.kronos              maq.sh           syoung          00:00:09 R psmall         
83607.kronos              maq.sh           syoung          00:00:07 R psmall         
83608.kronos              maq.sh           syoung          00:00:05 R psmall         
83609.kronos              maq.sh           syoung          00:00:05 R psmall         
83610.kronos              maq.sh           syoung          00:00:05 R psmall         
83611.kronos              maq.sh           syoung          00:00:05 R psmall         
83612.kronos              maq.sh           syoung          00:00:05 R psmall         
83613.kronos              maq.sh           syoung          00:00:05 R psmall         
83614.kronos              maq.sh           syoung          00:00:09 R psmall         
83615.kronos              maq.sh           syoung          00:00:05 R psmall         
83616.kronos              maq.sh           syoung          00:00:05 R psmall         
83617.kronos              maq.sh           syoung          00:00:05 R psmall         
83618.kronos              maq.sh           syoung          00:00:05 R psmall         
83619.kronos              maq.sh           syoung          00:00:05 R psmall         
83620.kronos              maq.sh           syoung          00:00:05 R psmall         
83621.kronos              maq.sh           syoung          00:00:05 R psmall         
83622.kronos              maq.sh           syoung          00:00:06 R psmall         
83623.kronos              maq.sh           syoung          00:00:05 R psmall         
83624.kronos              maq.sh           syoung          00:00:05 R psmall         
83625.kronos              maq.sh           syoung          00:00:05 R psmall         
83626.kronos              maq.sh           syoung          00:00:03 R psmall         
83627.kronos              maq.sh           syoung          00:00:03 R psmall         
83628.kronos              maq.sh           syoung          00:00:02 R psmall         
83629.kronos              maq.sh           syoung          00:00:02 R psmall         
83630.kronos              maq.sh           syoung          00:00:05 R psmall         
83631.kronos              maq.sh           syoung          00:00:05 R psmall         
83632.kronos              maq.sh           syoung          00:00:04 R psmall         
83633.kronos              maq.sh           syoung          00:00:02 R psmall         
83634.kronos              maq.sh           syoung          00:00:02 R psmall         
83635.kronos              maq.sh           syoung          00:00:01 R psmall         
83636.kronos              maq.sh           syoung          00:00:01 R psmall         
83637.kronos              maq.sh           syoung          00:00:01 R psmall         
83638.kronos              maq.sh           syoung          00:00:05 R psmall         
83639.kronos              maq.sh           syoung          00:00:04 R psmall         
83640.kronos              maq.sh           syoung          00:00:03 R psmall         
83641.kronos              maq.sh           syoung          00:00:02 R psmall         
83642.kronos              maq.sh           syoung          00:00:01 R psmall         
83643.kronos              maq.sh           syoung          00:00:01 R psmall         
83644.kronos              maq.sh           syoung          00:00:00 R psmall         
[syoung@kronos 50]$ checkjob -v 83604
job 83604 (RM job '83604.kronos.ccs.miami.edu')

AName: maq.sh
State: Completed 
Complete Time:  Sat Sep 12 01:53:17
  Completion Code: 0
Creds:  user:syoung  group:bioinfo  account:bioinfo  class:psmall
WallTime:   00:00:00 of 5:00:00:01
SubmitTime: Sat Sep 12 01:53:00
  (Time Queued  Total: 00:03:40  Eligible: 00:00:00)

Total Requested Tasks: 1

Req[0]  TaskCount: 1  Partition: base  
Memory >= 0  Disk >= 0  Swap >= 0

Allocated Nodes:
[n27:1]



UMask:          0000 
OutputFile:     kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/maq/1/10/maq.sh.o83604
ErrorFile:      kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/maq/1/10/maq.sh.o83604
Execution Partition:  base
SrcRM:          base  DstRM: base  DstRMJID: 83604.kronos.ccs.miami.edu
StartPriority:  0
PE:             1.00

[syoung@kronos 50]$ qstat -f 83604
Job Id: 83604.kronos.ccs.miami.edu
    Job_Name = maq.sh
    Job_Owner = syoung@kronos.ccs.miami.edu
    resources_used.cput = 00:00:43
    resources_used.mem = 3680kb
    resources_used.vmem = 143856kb
    resources_used.walltime = 00:01:33
    job_state = C
    queue = psmall
    server = kronos.ccs.miami.edu
    Checkpoint = u
    ctime = Sat Sep 12 01:53:00 2009
    Error_Path = kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/maq/1/10
        /maq.sh.e83604
    exec_host = n27/6
    Hold_Types = n
    Join_Path = oe
    Keep_Files = n
    Mail_Points = a
    mtime = Sat Sep 12 01:55:01 2009
    Output_Path = kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/maq/1/1
        0/maq.sh.o83604
    Priority = 0
    qtime = Sat Sep 12 01:53:00 2009
    Rerunable = True
    session_id = 5133
    Variable_List = PBS_O_HOME=/nethome/syoung,PBS_O_LANG=en_US.UTF-8,
        PBS_O_LOGNAME=syoung,
        PBS_O_PATH=/sw/bin:/nethome/syoung/base/bin:/usr/X11R6/bin:/nethome/s
        young/base/bin/utils:/home/syoung/base/bin/nextgen:/home/syoung/base/a
        pps/amos/bin:/usr/local/qt/bin:/home/apps/alta-cyclic/0.1.0/external.p
        rograms/libsvm-2.86:/home/apps/alta-cyclic/0.1.0/blat/bin/i386:/home/a
        pps/alta-cyclic/0.1.0/perlmods/lib64/perl5/site_perl/5.8.8/x86_64-linu
        x-thread-multi/auto:/home/apps/alta-cyclic/0.1.0/perlexternal:/home/bi
        oinfo/apps/ngs/bin/nextgen:/home/bioinfo/apps/ngs/bin/exome:/home/bioi
        nfo/apps/ngs/bin/utils:/home/bioinfo/apps/ngs/bin:/usr/local/bin:/bin:
        /usr/bin:/usr/lpp/mmfs/bin:/usr/lpp/mmfs/bin,
        PBS_O_MAIL=/var/spool/mail/syoung,PBS_O_SHELL=/bin/bash,
        PBS_SERVER=kronos.ccs.miami.edu,PBS_O_HOST=kronos.ccs.miami.edu,
        PBS_O_WORKDIR=/p/NGS/syoung/base/pipeline/SRA/maq/1/10,
        PBS_O_QUEUE=psmall
    etime = Sat Sep 12 01:53:00 2009
    exit_status = 0
    submit_args = -q psmall /p/NGS/syoung/base/pipeline/SRA/maq/1/10/maq.sh 











/nethome/syoung/base/bin/nextgen/clusterMAQ.pl \
--splitfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \
--outputdir /p/NGS/syoung/base/pipeline/SRA/maq/1 \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_1.1.fastq,/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_sanger_2.1.fastq \
--clean \
--convert \
--queue "-q psmall" \
--jobs 100 \
&> /p/NGS/syoung/base/pipeline/SRA/maq/1/outerr.txt

	real    0m10.393s
	user    0m9.809s
	sys     0m0.076s
	
	Run time: 01:32:02
	Completed /nethome/syoung/base/bin/nextgen/clusterMAQ.pl
	8:56PM, 7 September 2009
	****************************************



tail -f  /p/NGS/syoung/base/pipeline/SRA/maq/1/outerr.txt

	echo 'Converting solexa Sanger fastq files to MAQ binary fastq (.bfq) files...'
	time /nethome/syoung/base/apps/maq/0.7.1/maq match /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/50/out.map /p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/50/reads_1.50.bfq /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/50/reads_2.50.bfq  &> /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/50/outerr.txt
	`/usr/local/bin/qstat -f $PBS_ID > /p/NGS/syoung/base/pipeline/SRA/maq/1/50/usage.txt`;
	echo "Printed usage file: /p/NGS/syoung/base/pipeline/SRA/maq/1/50/usage.txt"
	/usr/local/bin/qsub -q psmall /p/NGS/syoung/base/pipeline/SRA/maq/1/50/maq.sh***
	Running job, pid: 76153
	Currently 50in list: 76104 76105 76106 76107 76108 76109 76110 76111 76112 76113 76114 76115 76116 76117 76118 76119 76120 76121 76122 76123 76124 76125 76126 76127 76128 76129 76130 76131 76132 76133 76134 76135 76136 76137 76138 76139 76140 76141 76142 76143 76144 76145 76146 76147 76148 76149 76150 76151 76152 76153
	Mon Aug 31 22:11:13 EDT 2009
	Ran inputfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq
	Waiting until the last jobs are finished (50 left)...


	...
	real    0m0.461s
	user    0m0.022s
	sys     0m0.005s
	
	Run time: 00:21:14
	Completed /nethome/syoung/base/bin/nextgen/clusterMAQ.pl
	2:38AM, 5 September 2009
	****************************************







[syoung@kronos 1]$ ll /p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_1.9.fastq
-rw-rw----+ 1 syoung bioinfo 189M Sep  7 19:22 /p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_1.9.fastq
[syoung@kronos 1]$ head /p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_1.9.fastq
@SRR002275.3678756 FC2043LAAXX_R1:1:205:50:207               
TTAAGATGGAGTCTCGCTCTGTTGCCCAGGCTTGAG
+SRR002275.3678756 FC2043LAAXX_R1:1:205:50:207               
IIII4CABEI5:IIA&*84,30C'+3-%"#-*"$&'
@SRR002275.3678789 FC2043LAAXX_R1:1:205:729:696              
TGCTTGAACCCAGGAGGCGGAGGTTGTGGTGAGCCA
+SRR002275.3678789 FC2043LAAXX_R1:1:205:729:696              
IIIIII<IIIB<II7FI8,I'IA*7?134)1!)#%&
@SRR002275.3678816 FC2043LAAXX_R1:1:205:293:728              
TGGTGGCTAGTTAATTGGAAGCACAGTTGAAAAGGA
[syoung@kronos 1]$ head /p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_2.9.fastq
@SRR002275.20554107 FC2043LAAXX_R1:6:77:329:182              
AGAATTAAAGAATATGTTTTGTGGCATAAGAGCAAG
+SRR002275.20554107 FC2043LAAXX_R1:6:77:329:182              
9I+3D:4<5=2+1+B=)A48&+)&&)1,'%')&%&'
@SRR002275.20554153 FC2043LAAXX_R1:6:77:675:469              
TTAAACTTAAAGGTGGCACTGATGGTATATTGGAAG
+SRR002275.20554153 FC2043LAAXX_R1:6:77:675:469              
II?8>;:9CI61:+/4+.")&-++))(()**%$('%
@SRR002275.20554166 FC2043LAAXX_R1:6:77:272:117              
ACTTTGAGGCCAGGAGCTTGAGACTCGCTTGGGCAA
[syoung@kronos 1]$ head /p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_2.1.fastq
head: cannot open `/p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_2.1.fastq' for reading: No such file or directory
[syoung@kronos 1]$ head /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_sanger_2.1.fastq
@SRR005719.4 FC20GBCAAXX:1:1:799:697                         
CTCAGCCTCCCAAAGTGTTGGATTACAGGCATGAGC
+SRR005719.4 FC20GBCAAXX:1:1:799:697                         
IIIIIIIIIII:I8IIIGIIIEIIIICA>H4EC58:
@SRR005719.60 FC20GBCAAXX:1:1:858:667                        
GACTTCGGACCTCCAGAACCATAAGAGACTAAATCT
+SRR005719.60 FC20GBCAAXX:1:1:858:667                        
IIIIIIIIII3IAICI9IICI;70=0,06;+60)++
@SRR005719.91 FC20GBCAAXX:1:1:944:516                        
TTCCTATGTTCAGGATTGTATTGCCTACATTGTCTT
[syoung@kronos 1]$ head /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_sanger_1.1.fastq
@SRR005719.4 FC20GBCAAXX:1:1:799:697                         
GTGAGCCCTCAAAAGTATTTATGGAGGGAATGAATG
+SRR005719.4 FC20GBCAAXX:1:1:799:697                         
IIIIIIIIIIIIIIIIIIIIAIII<IIII9IF<3FI
@SRR005719.60 FC20GBCAAXX:1:1:858:667                        
GAGCCGCAGTGATACTCATGAGGGATGGGAGGGCTG
+SRR005719.60 FC20GBCAAXX:1:1:858:667                        
IIIIIIIIIIIIIGAIB0E/.IIA/F6E&/.)9'/<
@SRR005719.91 FC20GBCAAXX:1:1:944:516                        
GCTGTTATCATCTAAACTATAAAGGTCTCCCAAAAT
[syoung@kronos 1]$ grep -n "1:205:50:207" /p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_2.9.fastq
[syoung@kronos 1]$ grep -n "1:205:50:207" /p/NGS/syoung/base/pipeline/SRA/maq/1/*/reads_sanger_2*.fastq
/p/NGS/syoung/base/pipeline/SRA/maq/1/8/reads_sanger_2.8.fastq:2124961:@SRR002275.3678756 FC2043LAAXX_R1:1:205:50:207               
/p/NGS/syoung/base/pipeline/SRA/maq/1/8/reads_sanger_2.8.fastq:2124963:+SRR002275.3678756 FC2043LAAXX_R1:1:205:50:207               
[syoung@kronos 1]$ grep -n "1:205:50:207" /p/NGS/syoung/base/pipeline/SRA/maq/1/9/reads_sanger_2.9.fastqlines 
[syoung@kronos 1]$ lines /p/NGS/syoung/base/pipeline/SRA/maq/1/8/reads_sanger_2.8.fastq
/p/NGS/syoung/base/pipeline/SRA/maq/1/8/reads_sanger_2.8.fastq: 4000000
[syoung@kronos 1]$ 









/nethome/syoung/base/apps/maq/0.7.1/maq match \
/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/1/out.map \
/p/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \
/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/1/reads_1.1.bfq \
/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/1/reads_2.1.bfq \
>&/p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/1/outerr.txt





cd /p/NGS/syoung/base/pipeline/SRA/maq/1/1
em maq.sh.o76204

	Converting solexa .fastq to .bfq files...
	[seq_read_fastq] Inconsistent sequence name: 42I. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: I31H504A2?8.36)6'-+. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: . Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: IIII=IAII<I:II8I7I7*. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: 1=65<9++1.. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: H<I93@+7I:,?*02=,8. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: @I8=E+=456:85,9.+0. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: 2B9I,>5@>5:1A. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: IA>.63*7+>4,+)60*+-/. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: 075<46I.2,+-6,1+2.I. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: I?III>II7@7=963=5.5-46.. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: :5=7158+0,+,-. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: IC<BC-B;8:DI0A*;I*.487. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: 25)8E'46)3',. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: EI*?I(I2II)I=53:.*. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: HE(./C@0+.;9)+++/+(,6. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: IIII3II<III@B8800/26<*100',&. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: :+4&7. Continue anyway.
	[seq_read_fastq] Inconsistent sequence name: III4IA;IE-(+D-1/+<')5*+#6. Continue anyway.
	

	
emacs /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_1.1.fastq


	@SRR005719.330 FC20GBCAAXX:1:1:604:767
	GTATGGCAAAATGTTAACTACTGGTTAACTTAAGTA
	+SRR005719.330 FC20GBCAAXX:1:1:604:767
	IIIIIIIIIIIII8III7>:%),G347/++2-0.&.
	@SRR005719.367 FC20GBCAAXX:1:1:638:804
	GAAAGGACAGATAGGAGAGGAAAGGAGAGGAGAGGC
	+SRR005719.367 FC20GBCAAXX:1:1:638:804
	IIIIIIIIIIIIIII@IIII=IAII<I:II8I7I7*		<=== '@' SYMBOL HERE 
	@SRR005719.418 FC20GBCAAXX:1:1:499:679
	GGAGTCTAAGTGTGAAGATCACCAACTGATGATGAA


DIAGNOSIS:

MAQ'S sol2sanger USES THE '@' SYMBOL AS THE FASTQ RECORD SEPARATOR AND SO

MISTAKES '@' SYMBOLS INSIDE THE QUALITY VALUE ENTRY AS RECORD SEPARATORS


SOLUTION:

CONVERT TO SANGER FROM SOLEXA



PROBLEM:

emacs /p/NGS/syoung/base/pipeline/SRA/maq/1/1/outerr.txt

	-- maq-0.7.1
	[ma_load_reads] loading reads...
	[ma_load_reads] 0*2 reads loaded.
	[ma_longread2read] encoding reads... 0 sequences processed.
	maq: match.cc:569: int ma_match(int, char**): Assertion `size_l >= 12 && (size_r == 0 || size_r >= 12)' failed.


SOLUTION:

chopfile /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_1.1.fastq /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_1.1-SHORT.fastq  40

cd /p/NGS/syoung/base/pipeline/SRA/maq/1/1 
/nethome/syoung/base/apps/maq/0.7.1/maq sol2sanger /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_1.1-SHORT.fastq /p/NGS/syoung/base/pipeline/SRA/maq/1/1/reads_1.1-SHORT.sanger.fastq







</entry>



<entry [Sun Aug 30 22:05:49 EDT 2009] RUN mergeFiles ON NA18507 DATA>




cd /p/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fastq.sh
emacs mergeFiles-fastq.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode fastq \
--paired

echo "PBS ID: $PBS_ID"
echo `/usr/local/bin/qstat -f $PBS_ID`;
echo "Completed"

### END printFiles-fastq-h


cd /p/NGS/syoung/base/pipeline/SRA/NA18507
chmod 755 mergeFiles-qual.sh

qsub -q psmall -M syoung@med.miami.edu -m abe -N mergeFiles-fq mergeFiles-fastq.sh ; date ; sleep 5; qstat

	Job id                    Name             User            Time Use S Queue
	------------------------- ---------------- --------------- -------- - -----
	75695.kronos              mergeFiles-fq    syoung                 0 R psmall 


	[syoung@kronos ~]$ checkjob -v 75695
	job 75695 (RM job '75695.kronos.ccs.miami.edu')
	
	AName: mergeFiles-fq
	State: Running 
	Creds:  user:syoung  group:bioinfo  account:bioinfo  class:psmall
	WallTime:   00:01:55 of 5:00:00:01
	SubmitTime: Mon Aug 31 02:34:22
	  (Time Queued  Total: 00:00:01  Eligible: 00:00:01)
	
	StartTime: Mon Aug 31 02:34:23
	Total Requested Tasks: 1
	
	Req[0]  TaskCount: 1  Partition: base  
	Memory >= 0  Disk >= 0  Swap >= 0
	Utilized Resources Per Task:  PROCS: 0.08  MEM: 10M  SWAP: 330M
	Avg Util Resources Per Task:  PROCS: 0.08
	Max Util Resources Per Task:  PROCS: 0.08  MEM: 10M  SWAP: 330M
	Average Utilized Memory: 8.07 MB
	Average Utilized Procs: 0.06
	NodeCount:  1
	
	Allocated Nodes:
	[n28:1]
	
	
	Task Distribution: n28
	
	UMask:          0000 
	OutputFile:     kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507/mergeFiles-fq.o75695
	ErrorFile:      kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507/mergeFiles-fq.o75695
	StartCount:     1
	Partition List: [ALL]
	SrcRM:          base  DstRM: base  DstRMJID: 75695.kronos.ccs.miami.edu
	Submit Args:    -q psmall -M syoung@med.miami.edu -m abe -N mergeFiles-fq mergeFiles-fastq.sh 
	Flags:          RESTARTABLE
	Attr:           checkpoint
	StartPriority:  1100
	PE:             1.00
	Reservation '75695' (-00:01:47 -> 4:23:58:14  Duration: 5:00:00:01)

	
	[syoung@kronos ~]$ qstat -f  75695
	Job Id: 75695.kronos.ccs.miami.edu
		Job_Name = mergeFiles-fq
		Job_Owner = syoung@kronos.ccs.miami.edu
		resources_used.cput = 00:00:12
		resources_used.mem = 10512kb
		resources_used.vmem = 338904kb
		resources_used.walltime = 00:01:55
		job_state = R
		queue = psmall
		server = kronos.ccs.miami.edu
		Checkpoint = u
		ctime = Mon Aug 31 02:34:22 2009
		Error_Path = kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507/
			mergeFiles-fq.e75695
		exec_host = n28/0
		Hold_Types = n
		Join_Path = n
		Keep_Files = n
		Mail_Points = abe
		Mail_Users = syoung@med.miami.edu
		mtime = Mon Aug 31 02:34:26 2009
		Output_Path = kronos.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507
			/mergeFiles-fq.o75695
		Priority = 0
		qtime = Mon Aug 31 02:34:22 2009
		Rerunable = True
		session_id = 2321
		Variable_List = PBS_O_HOME=/nethome/syoung,PBS_O_LANG=en_US.UTF-8,
			PBS_O_LOGNAME=syoung,
			PBS_O_PATH=/sw/bin:/nethome/syoung/base/bin:/usr/X11R6/bin:/nethome/s
			young/base/bin/utils:/home/syoung/base/bin/nextgen:/home/syoung/base/a
			pps/amos/bin:/usr/local/qt/bin:/home/apps/alta-cyclic/0.1.0/external.p
			rograms/libsvm-2.86:/home/apps/alta-cyclic/0.1.0/blat/bin/i386:/home/a
			pps/alta-cyclic/0.1.0/perlmods/lib64/perl5/site_perl/5.8.8/x86_64-linu
			x-thread-multi/auto:/home/apps/alta-cyclic/0.1.0/perlexternal:/home/bi
			oinfo/apps/ngs/bin/nextgen:/home/bioinfo/apps/ngs/bin/exome:/home/bioi
			nfo/apps/ngs/bin/utils:/home/bioinfo/apps/ngs/bin:/usr/local/bin:/bin:
			/usr/bin:/usr/lpp/mmfs/bin,PBS_O_MAIL=/var/spool/mail/syoung,
			PBS_O_SHELL=/bin/bash,PBS_SERVER=kronos.ccs.miami.edu,
			PBS_O_HOST=kronos.ccs.miami.edu,
			PBS_O_WORKDIR=/p/NGS/syoung/base/pipeline/SRA/NA18507,
			PBS_O_QUEUE=psmall
		etime = Mon Aug 31 02:34:22 2009
		submit_args = -q psmall -M syoung@med.miami.edu -m abe -N mergeFiles-fq me
			rgeFiles-fastq.sh 



tail /p/NGS/syoung/base/pipeline/SRA/NA18507/mergeFiles-fq.o75695

	...
	Doing paired ends...
	++++ merge(tempfile, singlefile, smallfiles)
	tempfile: /tmp/reads_1.1.fastq
	singlefile: /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
	Doing merge...
	done
	move: mv /tmp/reads_1.1.fastq /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
	++++ merge(tempfile, singlefile, smallfiles)
	tempfile: /tmp/reads_2.1.fastq
	singlefile: /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq
	Doing merge...
	done
	move: mv /tmp/reads_2.1.fastq /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq
	...
	Run time: 12:19:17
	Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
	2:53PM, 31 August 2009
	****************************************
	...
	resources_used.cput = 01:27:28
	resources_used.mem = 10532kb
	resources_used.vmem = 338904kb
	resources_used.walltime = 12:19:11 
	...
	

	#####move: mv /tmp/reads.37.fasta /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.37.fasta
	#####singlefile:
	#####-rw-rw-rw- 1 syoung bioinfo 406222080 Jun 13 06:45 /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.37.fasta
	#####
	#####Run time: 04:04:33
	#####Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
	#####6:46AM, 13 June 2009
	#####****************************************



3. VERIFY FASTQ FILES

[syoung@kronos NA18507]$ ll /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq

	-rw-rw-rw- 1 syoung bioinfo 9.3G Aug 31 02:40 /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq

[syoung@kronos NA18507]$ head /p/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq

	@SRR005719.4 FC20GBCAAXX:1:1:799:697                         
	GTGAGCCCTCAAAAGTATTTATGGAGGGAATGAATG
	+SRR005719.4 FC20GBCAAXX:1:1:799:697                         
	IIIIIIIIIIIIIIIIIIIIAIII<IIII9IF<3FI
	@SRR005719.60 FC20GBCAAXX:1:1:858:667                        
	GAGCCGCAGTGATACTCATGAGGGATGGGAGGGCTG
	+SRR005719.60 FC20GBCAAXX:1:1:858:667                        
	IIIIIIIIIIIIIGAIB0E/.IIA/F6E&/.)9'/<
	@SRR005719.91 FC20GBCAAXX:1:1:944:516                        
	GCTGTTATCATCTAAACTATAAAGGTCTCCCAAAAT



</entry>



<entry [Mon Aug 24 08:05:49 EDT 2009] INCOMPLETE JOBS FOR printFiles - RUN MANUALLY BEFORE DOING mergeFiles>



THREE JOBS, GOT 'No such file or directory' FOR ALL THEIR FILES

72080.kronos.ccs.miami.edu
emacs /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002277_1.fasta.sh
emacs /p/NGS/syoung/base/pipeline/SRA/NA18507/SRR002277_1.fasta.sh.e72080
emacs /p/NGS/syoung/base/pipeline/SRA/NA18507/SRR002277_1.fasta.sh.o72080


72081.kronos.ccs.miami.edu
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRR002279_1.fasta.sh.e72081
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRR002279_1.fasta.sh.o72081
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002279_1.fasta.sh 


72423.kronos.ccs.miami.edu

/p/NGS/syoung/base/pipeline/SRA/NA18507/SRR002291_2.fasta.sh.e72423
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRR002291_2.fasta.sh.o72423
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002291_2.fasta.sh 



RAN printFile:

screen -S printfile1

/home/syoung/base/bin/comparison/printFile.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002277_1.fasta \
--mode fastq \
--width 99 \
--dot 100000

	Run time: 00:04:06
	Completed /home/syoung/base/bin/comparison/printFile.pl
	2:19AM, 31 August 2009
	****************************************

	head -n 6 /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002277_1.fasta.9-37.reads-fastq
	@SRR002277.28 FC2043FAAXX_R1:1:1:752:730                     
	GTGTCCATGTGATCTCATTGTTCAATTCCCACCTAT
	+SRR002277.28 FC2043FAAXX_R1:1:1:752:730                     
	IIIII?IIIDI1I=I76IIGEI3:.G;3/80?.;,5
	@SRR002277.49 FC2043FAAXX_R1:1:1:241:483                     
	GAACTGCTCGGGTTAAGTGGATCCCACTTATATAGG


/home/syoung/base/bin/comparison/printFile.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002279_1.fasta \
--mode fastq \
--width 99 \
--dot 100000

	Run time: 00:05:05
	Completed /home/syoung/base/bin/comparison/printFile.pl
	2:22AM, 31 August 2009
	****************************************
	
	head /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002279_1.fasta.9-37.reads-fastq
	
	@SRR002279.3 FC2034VAAXX_R1:2:1:468:893                      
	GGTATTTTTGTGCAGTTACTCATCTTCAATATTCTT
	+SRR002279.3 FC2034VAAXX_R1:2:1:468:893                      
	IIIIIIIIIIIIIIIII;.I40F6IIB2&?/9I6FD
	@SRR002279.49 FC2034VAAXX_R1:2:1:765:691                     
	GAGAAAGAGCCTCCTTCGCAGTCAGTAGATGGGGGT
	+SRR002279.49 FC2034VAAXX_R1:2:1:765:691                     
	IIIIIIIIIIIIIIIIIII7?:I.E..1+E.56.),
	@SRR002279.76 FC2034VAAXX_R1:2:1:455:435                     
	GATCGGTGGTGATATCCCCTTTGTCAATTTTTATTT


/home/syoung/base/bin/comparison/printFile.pl \
--inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002291_2.fasta \
--mode fastq \
--width 99 \
--dot 100000


	Run time: 00:14:10
	Completed /home/syoung/base/bin/comparison/printFile.pl
	2:31AM, 31 August 2009
	****************************************


	[syoung@kronos SRR00227]$ head /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00229/SRR002291_2.fasta.9-37.reads-fastq
	@SRR002291.34 FC202P4AAXX_R1:1:1:564:664                     
	GCAATCATATGTTGGAATGAAGTTTTCTCTCCTATC
	+SRR002291.34 FC202P4AAXX_R1:1:1:564:664                     
	II$EIICI9IIHIII15IE6.ADIIF4G5I34<%B.
	@SRR002291.63 FC202P4AAXX_R1:1:1:629:376                     
	TGTCTGTAGGATCTATAGGGCTGTCCTTTTTCTTTC
	+SRR002291.63 FC202P4AAXX_R1:1:1:629:376                     
	II)IIIIEII2III.I2FB::IB@33>BIIE*GEB)
	@SRR002291.82 FC202P4AAXX_R1:1:1:465:80                      
	CACTTAGAGCACAAGTTCTCAGAGTCTCATTAGCAC


NOTES
-----

qstat -f OUTPUT:


[syoung@ngsdev bin]$ qstat -f
Job Id: 72080.kronos.ccs.miami.edu
    Job_Name = SRR002277_1.fasta.sh
    Job_Owner = syoung@ngsdev.ccs.miami.edu
    job_state = Q
    queue = psmall
    server = kronos.ccs.miami.edu
    Checkpoint = u
    ctime = Wed Aug 19 05:05:51 2009
    Error_Path = ngsdev.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507/
        SRR002277_1.fasta.sh.e72080
    Hold_Types = n
    Join_Path = oe
    Keep_Files = n
    Mail_Points = a
    mtime = Wed Aug 19 09:51:02 2009
    Output_Path = ngsdev.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507
        /SRR002277_1.fasta.sh.o72080
    Priority = 0
    qtime = Wed Aug 19 05:05:51 2009
    Rerunable = True
    Resource_List.nodect = 1
    Resource_List.nodes = n01:ppn=1
    Resource_List.walltime = 72:00:00
    Variable_List = PBS_O_HOME=/nethome/syoung,PBS_O_LANG=en_US.UTF-8,
        PBS_O_LOGNAME=syoung,
        PBS_O_PATH=/sw/bin:/nethome/syoung/base/bin:/usr/X11R6/bin:/nethome/s
        young/base/bin/utils:/home/syoung/base/bin/nextgen:/home/syoung/base/a
        pps/amos/bin:/usr/local/qt/bin:/home/apps/alta-cyclic/0.1.0/external.p
        rograms/libsvm-2.86:/home/apps/alta-cyclic/0.1.0/blat/bin/i386:/home/a
        pps/alta-cyclic/0.1.0/perlmods/lib64/perl5/site_perl/5.8.8/x86_64-linu
        x-thread-multi/auto:/home/apps/alta-cyclic/0.1.0/perlexternal:/home/bi
        oinfo/apps/ngs/bin/nextgen:/home/bioinfo/apps/ngs/bin/exome:/home/bioi
        nfo/apps/ngs/bin/utils:/home/bioinfo/apps/ngs/bin:/usr/kerberos/bin:/u
        sr/local/java/bin:/usr/local/bin:/bin:/usr/bin,
        PBS_O_MAIL=/var/spool/mail/syoung,PBS_O_SHELL=/bin/bash,
        PBS_SERVER=ngsdev.ccs.miami.edu,PBS_O_HOST=ngsdev.ccs.miami.edu,
        PBS_O_WORKDIR=/p/NGS/syoung/base/pipeline/SRA/NA18507,
        PBS_O_QUEUE=psmall
    comment = 1 nodes unavailable to start reserved job after 1 seconds (reser
        ved node n01 is in state 'Running' - check node)
    etime = Wed Aug 19 05:05:51 2009
    submit_args = -q psmall -l walltime=72:00:00 -l nodes=n01:ppn=1 /p/NGS/syo
        ung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002277_1.fasta.sh 

Job Id: 72081.kronos.ccs.miami.edu
    Job_Name = SRR002279_1.fasta.sh
    Job_Owner = syoung@ngsdev.ccs.miami.edu
    job_state = Q
    queue = psmall
    server = kronos.ccs.miami.edu
    Checkpoint = u
    ctime = Wed Aug 19 05:05:56 2009
    Error_Path = ngsdev.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507/
        SRR002279_1.fasta.sh.e72081
    Hold_Types = n
    Join_Path = oe
    Keep_Files = n
    Mail_Points = a
    mtime = Wed Aug 19 09:51:24 2009
    Output_Path = ngsdev.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507
        /SRR002279_1.fasta.sh.o72081
    Priority = 0
    qtime = Wed Aug 19 05:05:56 2009
    Rerunable = True
    Resource_List.nodect = 1
    Resource_List.nodes = n01:ppn=1
    Resource_List.walltime = 72:00:00
    Variable_List = PBS_O_HOME=/nethome/syoung,PBS_O_LANG=en_US.UTF-8,
        PBS_O_LOGNAME=syoung,
        PBS_O_PATH=/sw/bin:/nethome/syoung/base/bin:/usr/X11R6/bin:/nethome/s
        young/base/bin/utils:/home/syoung/base/bin/nextgen:/home/syoung/base/a
        pps/amos/bin:/usr/local/qt/bin:/home/apps/alta-cyclic/0.1.0/external.p
        rograms/libsvm-2.86:/home/apps/alta-cyclic/0.1.0/blat/bin/i386:/home/a
        pps/alta-cyclic/0.1.0/perlmods/lib64/perl5/site_perl/5.8.8/x86_64-linu
        x-thread-multi/auto:/home/apps/alta-cyclic/0.1.0/perlexternal:/home/bi
        oinfo/apps/ngs/bin/nextgen:/home/bioinfo/apps/ngs/bin/exome:/home/bioi
        nfo/apps/ngs/bin/utils:/home/bioinfo/apps/ngs/bin:/usr/kerberos/bin:/u
        sr/local/java/bin:/usr/local/bin:/bin:/usr/bin,
        PBS_O_MAIL=/var/spool/mail/syoung,PBS_O_SHELL=/bin/bash,
        PBS_SERVER=ngsdev.ccs.miami.edu,PBS_O_HOST=ngsdev.ccs.miami.edu,
        PBS_O_WORKDIR=/p/NGS/syoung/base/pipeline/SRA/NA18507,
        PBS_O_QUEUE=psmall
    comment = 1 nodes unavailable to start reserved job after 1 seconds (reser
        ved node n01 is in state 'Running' - check node)
    etime = Wed Aug 19 05:05:56 2009
    submit_args = -q psmall -l walltime=72:00:00 -l nodes=n01:ppn=1 /p/NGS/syo
        ung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002279_1.fasta.sh 

Job Id: 72423.kronos.ccs.miami.edu
    Job_Name = SRR002291_2.fasta.sh
    Job_Owner = syoung@ngsdev.ccs.miami.edu
    job_state = Q
    queue = psmall
    server = kronos.ccs.miami.edu
    Checkpoint = u
    ctime = Thu Aug 20 18:01:22 2009
    Error_Path = ngsdev.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507/
        SRR002291_2.fasta.sh.e72423
    Hold_Types = n
    Join_Path = oe
    Keep_Files = n
    Mail_Points = a
    mtime = Thu Aug 20 22:34:24 2009
    Output_Path = ngsdev.ccs.miami.edu:/p/NGS/syoung/base/pipeline/SRA/NA18507
        /SRR002291_2.fasta.sh.o72423
    Priority = 0
    qtime = Thu Aug 20 18:01:22 2009
    Rerunable = True
    Resource_List.nodect = 1
    Resource_List.nodes = n01:ppn=1
    Resource_List.walltime = 72:00:00
    Variable_List = PBS_O_HOME=/nethome/syoung,PBS_O_LANG=en_US.UTF-8,
        PBS_O_LOGNAME=syoung,
        PBS_O_PATH=/sw/bin:/nethome/syoung/base/bin:/usr/X11R6/bin:/nethome/s
        young/base/bin/utils:/home/syoung/base/bin/nextgen:/home/syoung/base/a
        pps/amos/bin:/usr/local/qt/bin:/home/apps/alta-cyclic/0.1.0/external.p
        rograms/libsvm-2.86:/home/apps/alta-cyclic/0.1.0/blat/bin/i386:/home/a
        pps/alta-cyclic/0.1.0/perlmods/lib64/perl5/site_perl/5.8.8/x86_64-linu
        x-thread-multi/auto:/home/apps/alta-cyclic/0.1.0/perlexternal:/home/bi
        oinfo/apps/ngs/bin/nextgen:/home/bioinfo/apps/ngs/bin/exome:/home/bioi
        nfo/apps/ngs/bin/utils:/home/bioinfo/apps/ngs/bin:/usr/kerberos/bin:/u
        sr/local/java/bin:/usr/local/bin:/bin:/usr/bin,
        PBS_O_MAIL=/var/spool/mail/syoung,PBS_O_SHELL=/bin/bash,
        PBS_SERVER=ngsdev.ccs.miami.edu,PBS_O_HOST=ngsdev.ccs.miami.edu,
        PBS_O_WORKDIR=/p/NGS/syoung/base/pipeline/SRA/NA18507,
        PBS_O_QUEUE=psmall
    comment = 1 nodes unavailable to start reserved job after 1 seconds (reser
        ved node n01 is in state 'Running' - check node)
    etime = Thu Aug 20 18:01:22 2009
    submit_args = -q psmall -l walltime=72:00:00 -l nodes=n01:ppn=1 /p/NGS/syo
        ung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002291_2.fasta.sh 




</entry>



<entry [Sat Jul 8 08:05:49 EDT 2009] FIRST RUN OF 1ST NA15407 SAMPLE MAQ ON USING WHOLE HUMAN GENOME>




cd /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1

screen -S cMAQ-yoruba1

/nethome/syoung/base/bin/nextgen/clusterMAQ.pl \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /mihg/data/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1/ \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq --queue "-q plarge" --jobs 100 \
&> /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1/outerr.txt


	Run time: 17:30:41
	Completed /nethome/syoung/base/bin/nextgen/clusterMAQ.pl
	1:35AM, 9 August 2009
	****************************************

PROBLEM

THE FASTQ FILES ONLY CONTAIN A FEW READS

SOLUTION

REMOVED EARLY TERMINATION FOR DEBUGGING IN Sampler::fastq.





1. RERUN printFiles AND mergeFiles for FASTQ:

0600
----

cd /p/NGS/syoung/base/pipeline/SRA/NA18507
screen -S printFiles-fastq-0600

rm -fr /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0600.sh
emacs /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0600.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--mode fastq \
--cluster \
--jobs 8 \
--queue "-q psmall -l walltime=72:00:00 -l nodes=n01:ppn=1" 

#### END

chmod 755 printFiles-fastq-0600.sh
./printFiles-fastq-0600.sh &> printFiles-fastq-0600.out



0601
----

cd /p/NGS/syoung/base/pipeline/SRA/NA18507
screen -S printFiles-fastq-0601

rm -fr /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0601.sh
emacs /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0601.sh
#!/bin/sh


/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta \
--mode fastq \
--cluster \
--jobs 8 \
--queue "-q psmall -l walltime=72:00:00  -l nodes=n02:ppn=1" 

#### END

chmod 755 printFiles-fastq-0601.sh
./printFiles-fastq-0601.sh &> printFiles-fastq-0601.out



0602, 1539, 1540
----------------

screen -S printFiles-fastq-0602
cd /p/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0602.sh
emacs /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0602.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta \
--mode fastq \
--cluster \
--jobs 8 \
--queue "-q psmall -l walltime=72:00:00  -l nodes=n03:ppn=1" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--mode fastq \
--cluster \
--jobs 8 \
--queue "-q psmall -l walltime=72:00:00  -l nodes=n03:ppn=1" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--mode fastq \
--cluster \
--jobs 8 \
--queue "-q psmall -l walltime=72:00:00  -l nodes=n03:ppn=1" 

#### END


chmod 755 printFiles-fastq-0602.sh
./printFiles-fastq-0602.sh &> printFiles-fastq-0602.out





0603
----

cd /p/NGS/syoung/base/pipeline/SRA/NA18507
screen -S printFiles-fastq-0603

rm -fr /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0603.sh
emacs /p/NGS/syoung/base/pipeline/SRA/NA18507/printFiles-fastq-0603.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--mode fastq \
--cluster \
--jobs 8 \
--queue "-q psmall -l walltime=72:00:00  -l nodes=n04:ppn=1" 

### END printFiles-fastq-all.sh


chmod 755 printFiles-fastq-0603.sh
./printFiles-fastq-0603.sh &> printFiles-fastq-0603.out



	RUNNING
	Wed Aug 19 05:39:58 EDT 2009

	kronos.ccs.miami.edu: 
																	   Req'd  Req'd   Elap
	Job ID               Username Queue    Jobname    SessID NDS   TSK Memory Time  S Time
	-------------------- -------- -------- ---------- ------ ----- --- ------ ----- - -----
	72072.kronos.ccs.mia syoung   psmall   SRR002281_  28936     1  --    --  72:00 R 00:41
	   n01/0
	72073.kronos.ccs.mia syoung   psmall   SRR002274_  28953     1  --    --  72:00 R 00:41
	   n01/1
	72074.kronos.ccs.mia syoung   psmall   SRR002271_  28970     1  --    --  72:00 R 00:41
	   n01/2
	72075.kronos.ccs.mia syoung   psmall   SRR002271_  28987     1  --    --  72:00 R 00:41
	   n01/3
	72076.kronos.ccs.mia syoung   psmall   SRR002281_  29004     1  --    --  72:00 R 00:42
	   n01/4
	72077.kronos.ccs.mia syoung   psmall   SRR002274_  29021     1  --    --  72:00 R 00:42
	   n01/5
	72080.kronos.ccs.mia syoung   psmall   SRR002277_    --      1  --    --  72:00 Q   -- 
		-- 
	72081.kronos.ccs.mia syoung   psmall   SRR002279_    --      1  --    --  72:00 Q   -- 
		-- 
	72082.kronos.ccs.mia syoung   psmall   SRR003967_   3790     1  --    --  72:00 R 00:02
	   n02/0
	72083.kronos.ccs.mia syoung   psmall   SRR003967_   3821     1  --    --  72:00 R 00:02
	   n02/1
	72084.kronos.ccs.mia syoung   psmall   SRR003968_   3853     1  --    --  72:00 R 00:02
	   n02/2
	72085.kronos.ccs.mia syoung   psmall   SRR003968_   3884     1  --    --  72:00 R 00:01
	   n02/3
	72086.kronos.ccs.mia syoung   psmall   SRR003970_   3915     1  --    --  72:00 R 00:01
	   n02/4
	72087.kronos.ccs.mia syoung   psmall   SRR003969_   3947     1  --    --  72:00 R 00:01
	   n02/5
	72088.kronos.ccs.mia syoung   psmall   SRR003971_   3978     1  --    --  72:00 R 00:01
	   n02/6
	72089.kronos.ccs.mia syoung   psmall   SRR003970_   4009     1  --    --  72:00 R 00:01
	   n02/7
	72090.kronos.ccs.mia syoung   psmall   SRR003877_  21376     1  --    --  72:00 R 00:00
	   n03/0
	72091.kronos.ccs.mia syoung   psmall   SRR002318_  21393     1  --    --  72:00 R 00:00
	   n03/1
	72092.kronos.ccs.mia syoung   psmall   SRR003868_  21410     1  --    --  72:00 R 00:00
	   n03/2
	72093.kronos.ccs.mia syoung   psmall   SRR003868_  21427     1  --    --  72:00 R 00:00
	   n03/3
	72094.kronos.ccs.mia syoung   psmall   SRR002317_  21444     1  --    --  72:00 R 00:00
	   n03/4
	72095.kronos.ccs.mia syoung   psmall   SRR002317_  21461     1  --    --  72:00 R 00:00
	   n03/5
	72096.kronos.ccs.mia syoung   psmall   SRR002316_  21478     1  --    --  72:00 R 00:00
	   n03/6
	72097.kronos.ccs.mia syoung   psmall   SRR002316_  21495     1  --    --  72:00 R 00:00
	   n03/7
	72098.kronos.ccs.mia syoung   psmall   SRR003960_   4534     1  --    --  72:00 R 00:00
	   n04/0
	72099.kronos.ccs.mia syoung   psmall   SRR003960_   4551     1  --    --  72:00 R 00:00
	   n04/1
	72100.kronos.ccs.mia syoung   psmall   SRR003962_   4568     1  --    --  72:00 R 00:00
	   n04/2
	72101.kronos.ccs.mia syoung   psmall   SRR003962_   4585     1  --    --  72:00 R 00:00
	   n04/3
	72102.kronos.ccs.mia syoung   psmall   SRR003963_   4602     1  --    --  72:00 R   -- 
	   n04/4
	72103.kronos.ccs.mia syoung   psmall   SRR003963_   4619     1  --    --  72:00 R   -- 
	   n04/5
	72104.kronos.ccs.mia syoung   psmall   SRR002319_   4636     1  --    --  72:00 R   -- 
	   n04/6
	72105.kronos.ccs.mia syoung   psmall   SRR002319_   4653     1  --    --  72:00 R   -- 
	   n04/7





tail -f printFiles-fastq-0603.out

... STRANGE, SUBMITTED ALL JOBS TO FOUR DIFFERENT HOSTS BUT ONLY THE JOBS TO BE EXECUTED ON THE FIRST NODE HAVE BEEN RUN SO FAR:

qstat -n
		-- 
	71861.kronos.ccs.mia syoung   psmall   SRR002319_    --      1  --    --  72:00 Q   -- 
		-- 
	71862.kronos.ccs.mia syoung   psmall   SRR002319_    --      1  --    --  72:00 Q   -- 
		-- 
	71863.kronos.ccs.mia syoung   psmall   SRR003965_    --      1  --    --  72:00 Q   -- 
		-- 
	71864.kronos.ccs.mia syoung   psmall   SRR003965_    --      1  --    --  72:00 Q   -- 
		-- 
	71865.kronos.ccs.mia syoung   psmall   SRR003964_    --      1  --    --  72:00 Q   -- 
		-- 
	71866.kronos.ccs.mia syoung   psmall   SRR003964_    --      1  --    --  72:00 Q   -- 
		-- 

tail -f printFiles-fastq-0603.out

	Waiting for number_pids (11) < jobs (100)...
	Ran inputfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR003964_1.fasta
	inputfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR003964_2.fasta
	command: /nethome/syoung/base/bin/comparison/printFile.pl --inputfile /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR003964_2.fasta --mode fastq --width 99 --dot 100000
	Submitting job to cluster...
	qsub command: /usr/local/bin/qsub -q psmall -l walltime=72:00:00  -l nodes=n04:ppn=1 /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR003964_2.fasta.sh
	Just ran job with pid: 71866
	Waiting for number_pids (12) < jobs (100)...
	Ran inputfile: /p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR003964_2.fasta
	Remaining jobs: 71855 71856 71857 71858 71859 71860 71861 71862 71863 71864 71865 71866







RUN printFiles-fastq-all.sh ON ngsdev


qsub -q psmall -M syoung@med.miami.edu -m abe -N printFiles-fastq-all -l nodes=n01:ppn=8 -l walltime=72:00:00 printFiles-fastq-all.sh

	71186.kronos.ccs.miami.edu
	Sat Aug 15 13:34:57 EDT 2009


2. RUN MERGE ON NODE 1


cd /p/NGS/syoung/base/pipeline/SRA/NA18507

FASTQ
-----

cd /p/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fastq.sh
emacs mergeFiles-fastq.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/p/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /p/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode fastq \
--paired

echo "PBS ID: $PBS_ID"
echo `/usr/local/bin/qstat -f $PBS_ID`;
echo "Completed"

### END printFiles-fastq-h


chmod 755 mergeFiles-qual.sh

qsub -q psmall -M syoung@med.miami.edu -m abe -N mergeFiles-fa -l nodes=n01:ppn=8 -l walltime=72:00:00 mergeFiles-fastq.sh

qsub -q "psmall" mergeFiles-qual.sh ; date ; qstat




3. VERIFY FASTQ FILES

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR00571






</entry>



<entry [Wed Jul 15 17:52:49 EDT 2009] FIRST TEST RUN OF MAQ ON 1ST NA15407 SAMPLE AGAINST HUMAN CHROMOSOME 1>



1. SAMPLE LOOKS GOOD - HEADER ID INFORMATION IS PRESENT

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples

head  reads_2.9.*
	==> reads_2.9.fasta <==
	>SRR005719.34 FC20GBCAAXX:1:1:470:548                        
	CTGGGCTCAAACAATAGTACTCTCCAAATTCCAAAA
	>SRR005719.66 FC20GBCAAXX:1:1:585:813                        
	GTCGATATGCATATAATGGGTGCCACAAGCCAGTGT
	>SRR005719.83 FC20GBCAAXX:1:1:437:716                        
	GAACTTATAGTACGATAAGCCTCCAGAGTAGCTGGG
	>SRR005719.144 FC20GBCAAXX:1:1:942:648                       
	TTATCTGCCTTTGGATCTTGTCTTTCTCATGTGAAC
	>SRR005719.176 FC20GBCAAXX:1:1:494:586                       
	ACAGAGACACAGACACACACATAGACAAATGCAGAG
	
	==> reads_2.9.fasta.qual <==
	>SRR005719.34 FC20GBCAAXX:1:1:470:548                        
	34 51 38 38 38 34 51 34 32 32 32 34 32 32 51 32 38 51 32 34 51 34 51 34 34 32 32 32 51 51 34 34 32 32 32 32
	>SRR005719.66 FC20GBCAAXX:1:1:585:813                        
	38 51 34 38 32 51 32 51 38 34 32 51 32 51 32 32 51 38 38 38 51 38 34 34 32 34 32 32 38 34 34 32 38 51 38 51
	>SRR005719.83 FC20GBCAAXX:1:1:437:716                        
	38 32 32 34 51 51 32 51 32 38 51 32 34 38 32 51 32 32 38 34 34 51 34 34 32 38 32 38 51 32 38 34 51 38 38 38
	>SRR005719.144 FC20GBCAAXX:1:1:942:648                       
	51 51 32 51 34 51 38 34 34 51 51 51 38 38 32 51 34 51 51 38 51 34 51 51 51 34 51 34 32 51 38 51 38 32 32 34
	>SRR005719.176 FC20GBCAAXX:1:1:494:586                       
	32 34 32 38 32 38 32 34 32 34 32 38 32 34 32 34 32 34 32 34 32 51 32 38 32 34 32 32 32 51 38 34 32 38 32 38
	
	==> reads_2.9.fastq <==
	@SRR005719.34 FC20GBCAAXX:1:1:470:548                        
	CTGGGCTCAAACAATAGTACTCTCCAAATTCCAAAA
	+SRR005719.34 FC20GBCAAXX:1:1:470:548                        
	IIIIIIIIIIGII;IIG45IIIICE;+*9,92,(+-
	@SRR005719.66 FC20GBCAAXX:1:1:585:813                        
	GTCGATATGCATATAATGGGTGCCACAAGCCAGTGT
	+SRR005719.66 FC20GBCAAXX:1:1:585:813                        
	IIIIIIIIIIIIIIIIIII6ACIA/C<BI0-?:+C(
	@SRR005719.83 FC20GBCAAXX:1:1:437:716                        
	GAACTTATAGTACGATAAGCCTCCAGAGTAGCTGGG


2. RUN clusterMAQ ON FIRST SAMPLE

mkdir -p /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1
cd /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1/

screen -S clusterMAQ-sample1

/nethome/syoung/base/bin/nextgen/clusterMAQ.pl \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /mihg/data/NGS/syoung/base/pipeline/human-genome-bfa/genome.bfa \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1 \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--queue "-q plarge" \
--jobs 100 \
&> /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1/outerr.txt



cd /mihg/data/NGS/syoung/base/pipeline/SRA/maq/1
tail -f outerr.txt




</entry>



<entry [Wed Jul 15 17:52:49 EDT 2009] SECOND TEST RUN OF ELAND ON 1ST NA15407 SAMPLE AGAINST HUMAN CHROMOSOME 1>



HAVING REDONE THE SAMPLED READS TO INCLUDE THE READ IDENTIFIER IN THE HEADER, TO
AVOID THIS ERROR:

	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: single input-file specified, will do single read analysis
	
	Could not identify index of the following line: SRR005718.10          
	Please check your files.


1. READ SAMPLE FILES ARE HERE:

ll /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples

	-rw-rw-rw-   1 syoung bioinfo 2.8G Jun 16 21:52 reads_1.10.fasta
	-rw-rw-rw-   1 syoung bioinfo 6.2G Jun 17 16:22 reads_1.10.fasta.qual
	-rw-rw-rw-   1 syoung bioinfo 5.6G Jun 17 16:12 reads_1.10.fastq
	-rw-rw-rw-   1 syoung bioinfo 2.8G Jun 16 22:04 reads_1.11.fasta
	-rw-rw-rw-   1 syoung bioinfo 6.2G Jun 17 16:52 reads_1.11.fasta.qual
	-rw-rw-rw-   1 syoung bioinfo 5.6G Jun 17 16:45 reads_1.11.fastq
	...


2. SELECT FIRST PAIRED END SAMPLE

/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq


3. CREATE SHELL SCRIPT USING ELAND_standalone.pl

/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl
Usage: /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl options
--input-file|if 
  must specify at least one file, specify two for paired analysis
--input-type|it 
  type of input file: fastq, fasta, export or qseq
--read-length|rl
  will work it out from input file(s) if not specified
--seed-length|sl
  length of read used for ELAND alignment 
  - default is to min of read-length and 32
--eland-genome|eg
  full path of a squashed genome directory
--output-prefix|op
  will produce a set of output files whose names prefixed by this
  - defaults to 'reanalysis'  
--pipeline-dir|pd
  path of pipeline installation to call 
  - by default, looks in same dir as executable is found)
--base-quality|bq
  in fasta mode assume all bases have this quality
  - default is set to 30
--pair-params|pp
  paired read analysis parameters to pass to pickBestPair
  - multiple arguments must go in quotes
  - defaults to '--circular' - treats all chromosomes as circular
  NB: for a paired read analysis, both reads must share same
  input-type, read-length and seed-length


emacs /mihg/data/NGS/syoung/base/pipeline/SRA/eland/1/eland.sh
#!/bin/sh

#PBS -j oe
#PBS -M syoung@med.miami.edu
#PBS -m abe
..
echo `hostname`;

cd /mihg/data/NGS/syoung/base/pipeline/SRA/eland/1

time /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl \
--input-file head  /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--input-type fastq \
--read-length 36 \
--eland-genome /mihg/data/NGS/syoung/base/pipeline/human-genome \
--output-prefix reads_1


4. RUN SHELL SCRIPT

cd /mihg/data/NGS/syoung/base/pipeline/SRA/eland/1

qsub -q psmall eland.sh; date

		67823.kronos.ccs.miami.edu
		Wed Aug  5 13:12:30 EDT 2009
	
	






</entry>



<entry [Thu Jul 16 03:09:35 EDT 2009] RERUN WHOLE NA18507 SAMPLING PIPELINE USING Sampler.pm TO INCLUDE READ IDENTIFIER IN FASTA>



1. GET FIXED LENGTH OF FASTA HEADER

zcat /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/SRR005718_2.fastq.gz | less

SOME SAMPLED READS:

	@SRR005718.1 FC20CMYAAXX:1:1:697:785
	@SRR005718.63 FC20CMYAAXX:1:1:1000:282 length=36

DUMMY READ

@SRR005718.1700000036 FC20CMYAAXX:1:1:540:28000 length=36
											   ^
											   |
											   |
											  47 CHARS


SO SET FIXED LENGTH AT 60 CHARACTERS, JUST IN CASE



2. FIX fastaInfo.pl SO THAT IT NOW INCLUDES THE READ IDENTIFIER IN THE FASTA HEADER

OK



3. CLEAN UP THE DIRECTORIES TO RUN listFiles.pl AGAIN

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507

cd SRX001539
rm -fr fasta
mkdir fasta
cd ..
ll SRX001539/fasta


cd SRX001540
rm -fr fasta
mkdir fasta
cd ..
ll SRX001540/fasta


cd SRX000600
rm -fr fasta
mkdir fasta
cd ..
ll SRX000600/fasta


cd SRX000601
rm -fr fasta
mkdir fasta
cd ..
ll SRX000601/fasta


cd SRX000602
rm -fr fasta
mkdir fasta
cd ..
ll SRX000602/fasta


cd SRX000603
rm -fr fasta
mkdir fasta
cd ..
ll SRX000603/fasta


4. RUN fastaInfos.pl TO CREATE FASTA AND QUAL FILES FOR EACH FASTQ READ FILE
(ALSO CREATES .info FILE CONTAINING THE NUMBER OF READS IN THE FILE)

fastaInfos
-----------

screen -S fastaInfos-1539
/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--fixed \
--id_length 60 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 10

OK

	Created chromosome fasta files in directory:
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta
	
	Run time: 00:45:48
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	4:22AM, 16 July 2009
	****************************************


screen -S fastaInfos-1540
/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--fixed \
--id_length 60 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 10

OK
	
	Created chromosome fasta files in directory:	
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta
	
	Run time: 00:37:44
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	4:16AM, 16 July 2009
	****************************************
	


screen -S fastaInfos-0600
/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--fixed \
--id_length 60 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 50


	TWO JOBS FAILED TO DUE CRASH ON NODE 19:

	[syoung@kronos comparison]$ qstat -f 61367
	Job Id: 61367.kronos.ccs.miami.edu
		Job_Name = SRR003849_2.fastq.gz.sh
		Job_Owner = syoung@kronos.ccs.miami.edu
		resources_used.cput = 00:00:21
		resources_used.mem = 8388kb
		resources_used.vmem = 218008kb
		resources_used.walltime = 00:00:26
		job_state = R
		queue = psmall
		server = kronos.ccs.miami.edu
		Checkpoint = u
		ctime = Thu Jul 16 06:07:48 2009
		Error_Path = kronos.ccs.miami.edu:/mihg/data/NGS/syoung/base/pipeline/SRA/
			NA18507/SRR003849_2.fastq.gz.sh.e61367
		exec_host = n19/3
	
		submit_args = -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SR
			X000600/fasta/SRR003849_2.fastq.gz.sh 

ll
	[syoung@kronos comparison]$ qstat -f 61368
	Job Id: 61368.kronos.ccs.miami.edu
		Job_Name = SRR003850_1.fastq.gz.sh
		Job_Owner = syoung@kronos.ccs.miami.edu
		job_state = R
		queue = psmall
		server = kronos.ccs.miami.edu
		Checkpoint = u
		ctime = Thu Jul 16 06:07:48 2009
		Error_Path = kronos.ccs.miami.edu:/mihg/data/NGS/syoung/base/pipeline/SRA/
			NA18507/SRR003850_1.fastq.gz.sh.e61368
		exec_host = n19/4
		...
		submit_args = -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SR
			X000600/fasta/SRR003850_1.fastq.gz.sh 



	RERUN MANUALLY:
	
####	qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003849_2.fastq.gz.sh 


emacs /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003849_2.fastq.gz.sh 
#!/bin/sh

#PBS -j oe
#PBS -M syoung@med.miami.edu
#PBS -m abe

time /home/syoung/base/bin/comparison/fastaInfo.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR003849_2.fastq.gz \
--outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003849_2.fasta \
--dot 100000 \
--fixed  \
--id_length 60  \
--sequence_length 36 
#### END

qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003849_2.fastq.gz.sh; date

	61860.kronos.ccs.miami.edu
	Thu Jul 16 15:33:40 EDT 2009


####	qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003850_1.fastq.gz.sh 


emacs /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003850_1.fastq.gz.sh 
#!/bin/sh

#PBS -j oe
#PBS -M syoung@med.miami.edu
#PBS -m abe

time /home/syoung/base/bin/comparison/fastaInfo.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR003850_1.fastq.gz \
--outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003850_1.fasta \
--dot 100000 \
--fixed  \
--id_length 60  \
--sequence_length 36 
#### END

qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR003850_1.fastq.gz.sh; date

	61861.kronos.ccs.miami.edu
	Thu Jul 16 15:33:57 EDT 2009



screen -S fastaInfos-0601
/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta \
--fixed \
--id_length 60 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 50

OK

	Created chromosome fasta files in directory:
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta
	
	Run time: 05:24:33
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	9:04AM, 16 July 2009
	****************************************

	###RUNNING Fri Jun  5 01:47:53 EDT 2009
	###Run time: 00:06:43
	###Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	###1:53AM, 5 June 2009
	###****************************************


screen -S fastaInfos-0602
/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta \
--fixed \mshow
--id_length 60 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 20

	SOME JOBS IN 0600 AND 0602 FAILED TO END IN qstat DUE TO NODE 27 CRASHING:

	Job id                    Name             User            Time Use S Queue
	------------------------- ---------------- --------------- -------- - -----
	61004.kronos              run-maq.sh       syoung          53:30:55 R pbigmem        
	61030.kronos              run-maq.sh       syoung          53:04:36 R pbigmem        
	61273.kronos              ...2.fastq.gz.sh syoung                 0 R psmall         
	61276.kronos              ...1.fastq.gz.sh syoung                 0 R psmall         
	61367.kronos              ...2.fastq.gz.sh syoung          00:00:21 R psmall         
	61368.kronos              ...1.fastq.gz.sh syoung                 0 R psmall         
	[syoung@kronos comparison]$ qstat -f 61276


	NODE 27:

	[syoung@kronos comparison]$ qstat -f 61273
	Job Id: 61273.kronos.ccs.miami.edu
		Job_Name = SRR003867_2.fastq.gz.sh
		Job_Owner = syoung@kronos.ccs.miami.edu
		job_state = R
		queue = psmall
		server = kronos.ccs.miami.edu
		Checkpoint = u
		ctime = Thu Jul 16 03:40:14 2009
		Error_Path = kronos.ccs.miami.edu:/mihg/data/NGS/syoung/base/pipeline/SRA/
			NA18507/SRR003867_2.fastq.gz.sh.e61273
		exec_host = n27/4
		...
		submit_args = -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SR
			X000602/fasta/SRR003867_2.fastq.gz.sh 
	
	
	
	
	[syoung@kronos comparison]$ qstat -f 61276
	Job Id: 61276.kronos.ccs.miami.edu
		Job_Name = SRR003869_1.fastq.gz.sh
		Job_Owner = syoung@kronos.ccs.miami.edu
		job_state = R
		queue = psmall
		server = kronos.ccs.miami.edu
		Checkpoint = u
		ctime = Thu Jul 16 03:40:14 2009
		Error_Path = kronos.ccs.miami.edu:/mihg/data/NGS/syoung/base/pipeline/SRA/
			NA18507/SRR003869_1.fastq.gz.sh.e61276
		exec_host = n27/5
		...	
		submit_args = -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SR
			X000602/fasta/SRR003869_1.fastq.gz.sh 



	RERUN MANUALLY:


#### -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003867_2.fastq.gz.sh 


emacs /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003867_2.fastq.gz.sh
#!/bin/sh

#PBS -j oe
#PBS -M syoung@med.miami.edu
#PBS -m abe

time /home/syoung/base/bin/comparison/fastaInfo.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/SRR003867_2.fastq.gz \
--outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003867_2.fasta \
--dot 100000 \
--fixed  \
--id_length 60  \
--sequence_length 36 
#### END

qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003867_2.fastq.gz.sh; date
	
	61857.kronos.ccs.miami.edu
	Thu Jul 16 15:30:01 EDT 2009


#### -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003869_1.fastq.gz.sh 


emacs /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003869_1.fastq.gz.sh 
#!/bin/sh

#PBS -j oe
#PBS -M syoung@med.miami.edu
#PBS -m abe

time /home/syoung/base/bin/comparison/fastaInfo.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/SRR003869_1.fastq.gz \
--outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003869_1.fasta \
--dot 100000 \
--fixed  \
--id_length 60  \
--sequence_length 36 
#### END

qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003869_1.fastq.gz.sh; date

	61858.kronos.ccs.miami.edu
	Thu Jul 16 15:30:51 EDT 2009


	qd.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date;qstat
	Thu Jul 16 14:35:49 EDT 2009
	Job id                    Name             User            Time Use S Queue
	------------------------- ---------------- --------------- -------- - -----
	61004.kronos              run-maq.sh       syoung          53:30:55 R pbigmem        
	61030.kronos              run-maq.sh       syoung          53:38:10 R pbigmem        
	61273.kronos              ...2.fastq.gz.sh syoung                 0 R psmall         
	61367.kronos              ...2.fastq.gz.sh syoung          00:00:21 R psmall         
	61786.kronos              ...1.fastq.gz.sh syoung                 0 R psmall         
	61787.kronos              ...2.fastq.gz.sh syoung                 0 Q psmall         
	[syoung@kronos NA18507]$ 

	###RUNNING Fri Jun  5 01:47:53 EDT 2009
	###Run time: 00:45:25
	###Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	###2:33AM, 5 June 2009
	###****************************************

screen -S fastaInfos-0603
/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--fixed \
--id_length 60 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 20

OK

	Created chromosome fasta files in directory:
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta
	
	Unknown Job Id: 61285. Returning undef
	Removed pid: 61285
	Run time: 05:24:12
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	9:04AM, 16 July 2009
	****************************************

	###RUNNING Fri Jun  5 01:47:53 EDT 2009
	###Run time: 00:25:51
	###Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	###2:15AM, 5 June 2009
	###****************************************

	
5. GENERATE LIST FILES OF RANDOMLY SELECTED READ POSITIONS INSIDE FASTA FILES
(NB: THESE ARE THE SAME POSITIONS INSIDE THE QUAL FILES BECAUSE THEY ARE
FIXED-WIDTH RECORDS). EACH LIST FILE HAS A USER-DEFINED NUMBER OF READS.

listFiles
---------

####RERUN Fri Jun 12 01:30:50 EDT 2009
####RERUN Sun Jun 14 22:42:08 EDT 2009 WITH PAIRED END COPY FROM READ1 TO READ2
####	
####	Run time: 00:49:12
####	Completed /nethome/syoung/base/bin/comparison/listFiles.pl
####	11:33PM, 14 June 2009
####	****************************************

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507

screen -S listFiles

emacs /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/listFiles.sh
#!/bin/sh

#PBS -j oe
#PBS -M syoung@med.miami.edu
#PBS -m abe

/nethome/syoung/base/bin/comparison/listFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--size 100000000 \
--paired \
&> /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/listfiles.out7


qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/listFiles.sh; date 

	61868.kronos.ccs.miami.edu
	Thu Jul 16 16:00:18 EDT 2009

tail -f /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/listfiles.out7

OK

	...
	cp /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR00396/SRR003964_1.fasta.37.list /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR00396/SRR003964_2.fasta.37.list
	Finished generating read list files
	Completed samples
	
	Run time: 01:30:55
	Completed /nethome/syoung/base/bin/comparison/listFiles.pl
	5:31PM, 16 July 2009
	****************************************


COMPLETED

checkjob 61868

	job 61868
	
	AName: listFiles.sh
	State: Completed 
	Complete Time:  Thu Jul 16 17:31:02
	  Completion Code: 0
	Creds:  user:syoung  group:bioinfo  account:bioinfo  class:psmall
	WallTime:   1:30:44 of 5:00:00:01
	SubmitTime: Thu Jul 16 16:00:18
	  (Time Queued  Total: 1:40:10  Eligible: 00:00:00)
	
	Total Requested Tasks: 1
	
	Req[0]  TaskCount: 1  Partition: base  
	Memory >= 0  Disk >= 0  Swap >= 0
	NodeCount:  1
	
	Allocated Nodes:
	[n27:1]



	####/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002272_1.fasta.37.list
	####
	####
	####Run time: 02:19:02
	####Completed /nethome/syoung/base/bin/comparison/listFiles.pl
	####4:13AM, 12 June 2009
	####****************************************


	total: 111737062
	
	directory       total reads
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta 2902742286
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta 111737062
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta 243457620
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta 192132426
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta 52767544
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta 103925078
	global reads: 3606762016
	directory       fraction
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta 0.804805604895225
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta 0.0309798820948878
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta 0.0675003282501021
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta 0.0532700591687722
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta 0.0146301707087735
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta 0.0288139548822397


	####total: 111737062
	####
	####directory       total reads
	####SRX000600/fasta 2902742286
	####SRX000603/fasta 111737062
	####SRX000602/fasta 243457620
	####SRX001540/fasta 192132426
	####SRX000601/fasta 52767544
	####
	####global reads: 3502836938
	####
	####directory       fraction
	####SRX000600/fasta 0.828683246573666
	####SRX000603/fasta 0.0318990189888194
	####SRX000602/fasta 0.0695029840980853
	####SRX001540/fasta 0.0548505195647791
	####SRX000601/fasta 0.0150642307746499


6. USE THE LIST FILES TO PRINT FASTA, QUAL AND FASTQ FILES WITH A FIXED
NUMBER OF READS

printFiles
----------

DO FASTA, QUAL AND FASTQ IN SUCCESSION FOR EACH EXPERIMENT:)

	EXAMPLE SRX001539/sampler-1539.sh:
	
	#!/bin/sh
	
	#PBS -j oe
	###PBS -m b
	###PBS -M syoung@med.miami.edu
	
	
	/nethome/syoung/base/bin/comparison/printFiles.pl \
	--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
	--mode fasta \
	--cluster \
	--queue "-q psmall" 
	
	/nethome/syoung/base/bin/comparison/printFiles.pl \
	--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
	--mode qual \
	--cluster \
	--queue "-q psmall" 
	
	/nethome/syoung/base/bin/comparison/printFiles.pl \
	--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
	--mode fastq \
	--cluster \
	--queue "-q psmall" 


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 1539-printFiles
SRX001539/1539-printFiles.sh &> 1539-printFiles.out
tail 1539-printFiles.out

	Run time: 00:00:11
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	7:21PM, 16 July 2009
	****************************************


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 1540-printFiles
SRX001540/1540-printFiles.sh &> 1540-printFiles.out
tail 1540-printFiles.out

	Run time: 00:01:39
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	7:10PM, 16 July 2009
	****************************************

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0600-printFiles
SRX000600/0600-printFiles.sh &> 0600-printFiles.out
tail 0600-printFiles.out

	Run time: 02:09:23
	Completed /home/syoung/base/bin/comparison/printFile.pl
	7:53PM, 16 July 2009
	****************************************

STARTED THE ABOVE

	FINISHED READ 1:
	
	Waiting for number_pids (100) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR006562_2.fasta
	Remaining jobs: 62635 62636 62637 62638 62639 62640 62641 62642 62643 62644 62645 62646 62647 62648 62649 62650 62651 62652 62653 62654 62655 62656 62657 62658 62659 62660 62661 62662 62663 62664 62665 62666 62667 62668 62669 62670 62671 62672 62673 62674 62675 62676 62677 62678 62679 62680 62681 62682 62683 62684 62685 62686 62687 62688 62689 62690 62691 62692 62693 62694 62695 62696 62697 62698 62699 62700 62701 62702 62703 62704 62705 62706 62707 62708 62709 62710 62711 62712 62713 62714 62715 62716 62717 62718 62719 62720 62721 62722 62723 62724 62725 62726 62727 62728 62729 62730 62731 62732
	
	Run time: 00:08:45
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	10:29PM, 16 July 2009
	****************************************



cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0601-printFiles
SRX000601/0601-printFiles.sh &> 0601-printFiles.out
tail 0601-printFiles.out

????

	Run time: 00:00:16
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	7:19PM, 16 July 2009
	****************************************

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0602-printFiles
SRX000602/0602-printFiles.sh &> 0602-printFiles.out
tail 0602-printFiles.out

????

	Run time: 00:00:58
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	7:50PM, 16 July 2009
	****************************************


CHECK OUT WHETHER THE FASTA, QUAL AND FASTQ FILES ARE INSIDE SUBDIR IN THE fasta DIR:

CD /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta

[syoung@kronos fasta]$ ll | egrep "^d"
drwxrwx---+ 2 syoung bioinfo      28672 Jul 16 19:47 SRR00231
drwxrwx---+ 2 syoung bioinfo      36864 Jul 16 19:47 SRR00386
drwxrwx---+ 2 syoung bioinfo      69632 Jul 16 19:47 SRR00387
drwxrwx---+ 2 syoung bioinfo      20480 Jul 16 19:47 SRR00656

cd SRR00231
ll 
cd SRR00386
cd SRR00387
cd SRR00656


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0603-printFiles
SRX000603/0603-printFiles.sh &> 0603-printFiles.out
tail 0603-printFiles.out


DIAGNOSIS

THIS CODE IN printFiles.pl WAS SKIPPING THE READ 2 FILES:

	#### TEMPORARY:
	#### DON'T PRINT EITHER READ 1 OR READ 2 FILES - SPECIFY BELOW
	for ( my $index = 0; $index < @$infofiles; $index++ )
	{
		my $infofile = $$infofiles[$index];
		my @keys = keys %$infofile;
		my $key = $keys[0];
		if ( $key =~ /_2[^\/]+$/ )
		{
			splice @$infofiles, $index, 1;
			$index--;
		}
	}

SOLUTION

RERAN printFiles.pl, THIS TIME SKIPPING THE READ 1 FILES BY CHANGING THE
LINE IN printFiles.pl TO:

		if ( $key =~ /_1[^\/]+$/ )



NOTE: !!!COMMENT OUT THIS CODE AFTER RUNNING printFiles.pl TO DO THE READ 2 FILES!!!

	FINISHED READ 1:

	Waiting for number_pids (100) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR006562_2.fasta
	Remaining jobs: 62635 62636 62637 62638 62639 62640 62641 62642 62643 62644 62645 62646 62647 62648 62649 62650 62651 62652 62653 62654 62655 62656 62657 62658 62659 62660 62661 62662 62663 62664 62665 62666 62667 62668 62669 62670 62671 62672 62673 62674 62675 62676 62677 62678 62679 62680 62681 62682 62683 62684 62685 62686 62687 62688 62689 62690 62691 62692 62693 62694 62695 62696 62697 62698 62699 62700 62701 62702 62703 62704 62705 62706 62707 62708 62709 62710 62711 62712 62713 62714 62715 62716 62717 62718 62719 62720 62721 62722 62723 62724 62725 62726 62727 62728 62729 62730 62731 62732
	
	Run time: 00:08:45
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	10:29PM, 16 July 2009
	****************************************



	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR003964_1.fasta
	Remaining jobs: 62284 62285 62286 62287 62288 62289
	
	Run time: 00:00:11
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	7:31PM, 16 July 2009
	****************************************




	####SRX001539/1539-printFiles.sh &> 1539-printFiles.out
	####
	####	FASTQ
	####	Run time: 01:06:29
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	####	1:27PM, 12 June 2009
	####	****************************************
	####
	####SRX001540/1540-printFiles.sh &> 1540-printFiles.out
	####	
	####	FASTQ
	####	Run time: 00:14:53
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.plX
	####	3:49PM, 12 June 2009
	####	****************************************
	####
	####SRX000600/0600-printFiles.sh &> 0600-printFiles.out
	####
	####	FASTQ
	####	Run time: 01:46:59
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	####	10:42AM, 12 June 2009
	####	****************************************
	####
	####SRX000601/0601-printFiles.sh &> 0601-printFiles.out
	####
	####	FASTA
	####	Run time: 00:36:45
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	####	12:55AM, 12 June 2009
	####	****************************************
	####
	####	QUAL
	####	Run time: 00:43:58
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	####	1:39PM, 12 June 2009
	####	****************************************
	####	
	####	FASTQ
	####	Run time: 00:48:58
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	####	2:28PM, 12 June 2009
	####	****************************************
	####
	####
	####SRX000602/0602-printFiles.sh &> 0602-printFiles.out
	####
	####	FASTQ
	####	Run time: 01:03:27
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	####	3:06PM, 12 June 2009
	####	****************************************
	####
	####SRX000603/0603-printFiles.sh &> 0603-printFiles.out
	####	
	####	FASTQ
	####	Run time: 01:14:04
	####	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	####	3:28PM, 12 June 2009
	####	****************************************



RERUN PRINTFILES FOR READ 2:

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 1539-printFiles
SRX001539/1539-printFiles.sh &> 1539-printFiles.out
tail 1539-printFiles.out
	
	[syoung@kronos NA18507]$ SRX001539/1539-printFiles.sh &> 1539-printFiles.out
	[syoung@kronos NA18507]$ tail 1539-printFiles.out
	Waiting for number_pids (2) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/SRR005718_2.fasta
	Remaining jobs: 63878 63879
	
	Run time: 00:34:02
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	1:03PM, 18 July 2009
	****************************************


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 1540-printFiles
SRX001540/1540-printFiles.sh &> 1540-printFiles.out
tail 1540-printFiles.out

	[syoung@kronos NA18507]$ SRX001540/1540-printFiles.sh &> 1540-printFiles.out
	[syoung@kronos NA18507]$ tail 1540-printFiles.out
	Waiting for number_pids (4) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005735_2.fasta
	Remaining jobs: 63745 63746 63747 63748
	
	Run time: 00:00:11
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	11:59AM, 18 July 2009
	****************************************


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0600-printFiles
SRX000600/0600-printFiles.sh &> 0600-printFiles.out
tail 0600-printFiles.out

	[syoung@kronos NA18507]$ em &> 0600-printFiles.out
	[syoung@kronos NA18507]$ tail 0600-printFiles.out
	Waiting for number_pids (99) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR006562_2.fasta
	Remaining jobs: 64022 64023 64024 64025 64026 64027 64028 64029 64030 64031 64032 64033 64034 64035 64036 64037 64038 64039 64040 64041 64042 64043 64044 64045 64046 64047 64048 64049 64050 64053 64054 64055 64056 64057 64058 64059 64060 64061 64062 64063 64064 64065 64066 64067 64068 64069 64070 64071 64072 64073 64074 64075 64076 64077 64078 64079 64080 64083 64084 64085 64086 64087 64088 64089 64090 64091 64092 64093 64094 64095 64096 64097 64098 64099 64100 64101 64102 64103 64104 64105 64106 64107 64108 64109 64110 64111 64112 64113 64114 64115 64116 64117 64118 64119 64120 64121 64122 64123 64124
	
	Run time: 00:08:52
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	2:42PM, 18 July 2009
	****************************************


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0601-printFiles
SRX000601/0601-printFiles.sh &> 0601-printFiles.out
tail 0601-printFiles.out

	[syoung@kronos NA18507]$ SRX000601/0601-printFiles.sh &> 0601-printFiles.out
	[syoung@kronos NA18507]$ tail 0601-printFiles.out
	Waiting for number_pids (5) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta/SRR003971_2.fasta
	Remaining jobs: 63711 63712 63713 63714 63715
	
	Run time: 00:00:16
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	11:10AM, 18 July 2009
	****************************************


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0602-printFiles
SRX000602/0602-printFiles.sh &> 0602-printFiles.out
tail 0602-printFiles.out


	[syoung@kronos NA18507]$ SRX000602/0602-printFiles.sh &> 0602-printFiles.out
	[syoung@kronos NA18507]$ tail 0602-printFiles.out
	Waiting for number_pids (17) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta/SRR003867_2.fasta
	Remaining jobs: 63716 63717 63718 63719 63720 63721 63722 63723 63724 63725 63726 63727 63728 63729 63730 63731 63732
	
	Run time: 00:00:34
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	11:18AM, 18 July 2009
	****************************************


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
screen -S 0603-printFiles
SRX000603/0603-printFiles.sh &> 0603-printFiles.out
tail 0603-printFiles.out

	[syoung@kronos NA18507]$ SRX000603/0603-printFiles.sh &> 0603-printFiles.out
	[syoung@kronos NA18507]$ tail 0603-printFiles.out
	Waiting for number_pids (6) < jobs (100)...
	Ran inputfile: /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta/SRR003964_2.fasta
	Remaining jobs: 63733 63734 63735 63736 63737 63738
	
	Run time: 00:00:47
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	11:20AM, 18 July 2009
	****************************************












7. MERGE ALL OF THE PRINTED FILES FROM ALL READ FILES IN ALL EXPERIMENTS TO CREATE
FASTA, QUAL AND FASTQ FILES CONTAINING THE USER-DEFINED NUMBER OF READS (DEFINED AT
LISTFILES STAGE EARLIER)

mergeFiles
----------

#### REMOVE ALL FILES IN SAMPLES
#### rm -fr /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads*


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fasta.sh
emacs mergeFiles-fasta.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode fasta \
--paired


chmod 755 mergeFiles-fasta.sh 
qsub -q psmall mergeFiles-fasta.sh ; date


	64596.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date
	Mon Jul 20 04:21:07 EDT 2009
	
	###[syoung@kronos NA18507]$ qsub -q psmall mergeFiles-fasta.sh 
	###53534.kronos.ccs.miami.edu
	###[syoung@kronos NA18507]$ date
	###Tue Jun 16 20:26:26 EDT 2009



	#####move: mv /tmp/reads.37.fasta /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.37.fasta
	#####singlefile:
	#####-rw-rw-rw- 1 syoung bioinfo 406222080 Jun 13 06:45 /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.37.fasta
	#####
	#####Run time: 04:04:33
	#####Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
	#####6:46AM, 13 June 2009
	#####****************************************




QUAL
----

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-qual.sh
emacs mergeFiles-qual.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode qual \
--paired

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507

chmod 755 mergeFiles-qual.sh

qsub -q "psmall" mergeFiles-qual.sh ; date

	64597.kronos.ccs.miami.edu
	Mon Jul 20 04:22:13 EDT 2009

	####[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	####53539.kronos.ccs.miami.edu
	####[syoung@kronos NA18507]$ date
	####Wed Jun 17 10:17:52 EDT 2009


	##[syoung@kronos NA18507]$ chmod 755 mergeFiles-qual.sh
	##[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	##52114.kronos.ccs.miami.edu
	##[syoung@kronos NA18507]$ date
	##Sun Jun 14 03:33:02 EDT 2009



FASTQ
-----

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fastq.sh
emacs mergeFiles-fastq.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode fastq \
--paired





chmod 755 mergeFiles-fastq.sh
qsub -q "psmall" mergeFiles-fastq.sh ; date


	64598.kronos.ccs.miami.edu
	Mon Jul 20 04:22:45 EDT 2009




RUNNING READ 2 FASTA, QUAL AND FASTQ:


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
qsub -q "psmall" mergeFiles-fastq.sh
qsub -q psmall mergeFiles-fasta.sh 
qsub -q "psmall" mergeFiles-qual.sh
date

	
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-fastq.sh
	53088.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q psmall mergeFiles-fasta.sh 
	53089.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	53090.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date
	Mon Jun 15 13:06:29 EDT 2009



FASTQ
Run time: 05:40:37
Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
6:47PM, 15 June 2009
****************************************

FASTA
Run time: 06:29:33
Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
7:36PM, 15 June 2009
****************************************

QUAL
Run time: 08:37:40
Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
9:44PM, 15 June 2009
****************************************



RUNNING READ 1 FASTA, QUAL AND FASTQ:

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
qsub -q "psmall" mergeFiles-fastq.sh
qsub -q psmall mergeFiles-fasta.sh 
qsub -q "psmall" mergeFiles-qual.sh
date

	[syoung@kronos samples]$ cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-fastq.sh
	53189.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q psmall mergeFiles-fasta.sh 
	53190.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	53191.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date
	Mon Jun 15 23:18:45 EDT 2009




RUN MAQ ON THE CLUSTER


/nethome/syoung/base/bin/nextgen/runMAQ-cluster.pl \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /mihg/data/NGS/syoung/base/pipeline/human-genome/chr1.fa \
--paired \
--queue "-q psmall" \
--jobs 100


TEST
----

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1 \
--mode fasta


	move: mv /tmp/reads.1.fasta /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fasta
	singlefile:
	-rw-rw-rw- 1 syoung bioinfo 5999986080 Jun 13 02:33 /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fasta
	
	Run time: 00:07:17
	Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
	2:36AM, 13 June 2009
	****************************************




</entry>



<entry [Wed Jul 15 17:52:49 EDT 2009] TEST RUN OF ELAND ON 1ST NA15407 SAMPLE AGAINST HUMAN CHROMOSOME 1>



1. READ SAMPLE FILES ARE HERE:

ll /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples

	-rw-rw-rw-   1 syoung bioinfo 2.8G Jun 16 21:52 reads_1.10.fasta
	-rw-rw-rw-   1 syoung bioinfo 6.2G Jun 17 16:22 reads_1.10.fasta.qual
	-rw-rw-rw-   1 syoung bioinfo 5.6G Jun 17 16:12 reads_1.10.fastq
	-rw-rw-rw-   1 syoung bioinfo 2.8G Jun 16 22:04 reads_1.11.fasta
	-rw-rw-rw-   1 syoung bioinfo 6.2G Jun 17 16:52 reads_1.11.fasta.qual
	-rw-rw-rw-   1 syoung bioinfo 5.6G Jun 17 16:45 reads_1.11.fastq
	...


2. SELECT FIRST PAIRED END SAMPLE

/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq


3. CREATE SHELL SCRIPT USING ELAND_standalone.pl

/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl
Usage: /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl options
--input-file|if 
  must specify at least one file, specify two for paired analysis
--input-type|it 
  type of input file: fastq, fasta, export or qseq
--read-length|rl
  will work it out from input file(s) if not specified
--seed-length|sl
  length of read used for ELAND alignment 
  - default is to min of read-length and 32
--eland-genome|eg
  full path of a squashed genome directory
--output-prefix|op
  will produce a set of output files whose names prefixed by this
  - defaults to 'reanalysis'  
--pipeline-dir|pd
  path of pipeline installation to call 
  - by default, looks in same dir as executable is found)
--base-quality|bq
  in fasta mode assume all bases have this quality
  - default is set to 30
--pair-params|pp
  paired read analysis parameters to pass to pickBestPair
  - multiple arguments must go in quotes
  - defaults to '--circular' - treats all chromosomes as circular
  NB: for a paired read analysis, both reads must share same
  input-type, read-length and seed-length



#!/bin/sh

#PBS -j oe
#PBS -M syoung@med.miami.edu
#PBS -m abe

echo `hostname`;

cd /mihg/data/NGS/syoung/base/pipeline/SRA/eland/1

time /nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl \
--input-file head  /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq \
--input-type fastq \
--read-length 36 \
--eland-genome /mihg/data/NGS/syoung/base/pipeline/human-genome \
--output-prefix reads_1



PROBLEM


	/nethome/syoung/base/apps/GAPipeline-1.4.0/bin/ELAND_standalone.pl: single input-file specified, will do single read analysis
	
	Could not identify index of the following line: SRR005718.10          
	Please check your files.
	
	real    0m0.750s
	user    0m0.052s
	sys     0m0.016s
	[syoung@kronos 1]$ head /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq
	@SRR005718.10         
	GTAGTTTTTTAGTGGATTTCTTATTATTTTCTTTTT
	+SRR005718.10         
	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
	@SRR005718.70         
	GCTCAGAGTAAGTAGCAGAAAATTACCTTCCCTTAG
	+SRR005718.70         


SOLUTION

RERUN SAMPLER FROM BEGINNING TO INCLUDE READ IDENTIFIER IN FASTA HEADER







</entry>



<entry [Wed Jul 15 17:11:30 EDT 2009] INSTALL COMPLETE GENOMICS API>




CONTINUATION OF PARTIAL INSTALL ON:
Sat May 23 23:44:09 EDT 2009

This API is delivered as a set of source code files that can be compiled to produce a statically linkable library for accessing and using data delivered by Complete Genomics to its customers.

These instructions have several pre-requisites including:

1. A successfully installed Centos 5.2 64 Bit Intel based computer with at least 200 GB of disk space available. Allow the installer to update the installation with all available updates.

2. An installed distribution of GCC 4.1.1, or later

    Using built-in specs.
    Target: x86_64-redhat-linux
    Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-libgcj-multifile --enable-languages=c,c++,objc,obj-c++,java,fortran,ada --enable-java-awt=gtk --disable-dssi --enable-plugin --with-java-home=/usr/lib/jvm/java-1.4.2-gcj-1.4.2.0/jre --with-cpu=generic --host=x86_64-redhat-linux
    Thread model: posix
    gcc version 4.1.2 20071124 (Red Hat 4.1.2-42)
    

3. An installed distribution of Xerces 2.8.

Xerces IS AN XML PARSER
http://xerces.apache.org/xerces-c/download.cgi

If using a source distribution be sure that you read and follow the Xerces-C installation instructions. There are decisions to be made that could involve bypassing many manual steps but need care and understanding before making these decisions.


In the case of a default installation of Centos 5.2, the following commands represent one example:

sudo su
mkdir /usr/local/apache
cd /usr/local/apache
wget http://apache.seekmeup.com/xerces/c/2/sources/xerces-c-src_2_8_0.tar.gz
tar xvfz xerces-c-src_2_8_0.tar.gz
cd xerces-c-src_2_8_0/src/xercesc/
export XERCESCROOT="/usr/local/apache/xerces-c-src_2_8_0"
./configure 
make
make install

    OK

    ...    
    /usr/bin/install -c .libs/XInclude /usr/local/bin/XInclude
    make[2]: Nothing to be done for `install-data-am'.
    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
    make[1]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
    make[2]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
    make[2]: Nothing to be done for `install-exec-am'.
    test -z "/usr/local/lib/pkgconfig" || /bin/mkdir -p "/usr/local/lib/pkgconfig"
     /usr/bin/install -c -m 644 'xerces-c.pc' '/usr/local/lib/pkgconfig/xerces-c.pc'
    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'
    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'


#### INSTALLED THIS VERSION BUT GOT ERROR WHEN COMPILING complete
####wget http://mirrors.isc.org/pub/apache/xerces/c/3/sources/xerces-c-3.0.1.tar.gz
####tar xvfz xerces-c-3.0.1.tar.gz
#####cd xerces-c-3.0.1/src/xercesc/
####
####export XERCESCROOT="/usr/local/apache/xerces-c-3.0.1"
####./configure 
####make
####make install
####
####    OK
####
####    ...    
####    /usr/bin/install -c .libs/XInclude /usr/local/bin/XInclude
####    make[2]: Nothing to be done for `install-data-am'.
####    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
####    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
####    make[1]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
####    make[2]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
####    make[2]: Nothing to be done for `install-exec-am'.
####    test -z "/usr/local/lib/pkgconfig" || /bin/mkdir -p "/usr/local/lib/pkgconfig"
####     /usr/bin/install -c -m 644 'xerces-c.pc' '/usr/local/lib/pkgconfig/xerces-c.pc'
####    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'
####    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'



????? After building Xerces-C you may wish to modify the contents of the src/makefile and examples/dump-dnbs/makefile file to point to your installed directory.



4. An installed distribution of Boost 1.37, including bjam.


Centos 5.2 may require a manual build of Boost if you wish to use some of the later versions. The distribution may be easily built and instructions can be found on the boost.org web site. This can typically be done using two web download operations and two command lines.

BOOST

A collection of C libraries aimed at boosting productivity.

mkdir -p /nethome/syoung/base/apps/complete/1.1.0/boost
cd /nethome/syoung/base/apps/complete/1.1.0/boost

#### THIS DOESN'T WORK: wget http://sourceforge.net/project/downloading.php?group_id=7586&filename=boost_1_39_0.tar.gz&a=89204328
DOWNLOAD FROM boost.jam (~40MB)

tar xvfz  boost_1_39_0.tar.gz
cd /nethome/syoung/base/apps/complete/1.1.0/boost/boost_1_39_0

    OK




./bootstrap.sh


cd /nethome/syoung/base/apps/complete/1.1.0/boost
chmod 777 boost_1_39_0 
chmod 777 boost-jam-3.1.17-1-linuxx86
cd boost_1_39_0

ls
    boost            boost.css  bootstrap.bat  CMakeLists.txt  index.htm   INSTALL  libs             more    README.txt  status  wiki
    boost-build.jam  boost.png  bootstrap.sh   doc             index.html  Jamroot  LICENSE_1_0.txt  people  rst.css     tools


sudo su
./bootstrap.sh 

    Building Boost.Jam with toolset gcc... tools/jam/src/bin.linuxx86_64/bjam
    Detecting Python version... 2.4
    Detecting Python root... /usr
    Unicode/ICU support for Boost.Regex?... not found.
    Generating Boost.Build configuration in project-config.jam...
    
    Bootstrapping is done. To build, run:
    
        ./bjam
        
    To adjust configuration, edit 'project-config.jam'.
    Further information:
    
       - Command line help:
         ./bjam --help
         
       - Getting started guide: 
         http://www.boost.org/more/getting_started/unix-variants.html
         
       - Boost.Build documentation:
         http://www.boost.org/boost-build2/doc/html/index.html


BOOST JAM

sudo su
cd /nethome/syoung/base/apps/complete/1.1.0/boost
./bjam install


5. An installed copy of the Code Synthesis distribution.

This distribution is a run time for C++ of the XML DOM and can be obtained from http://www.codesynthesis.com/products/xsd/download.xhtml as an easily installed RPM.

Here are some example commands used to download and use the 3.0 version of the code synthesis runtime.


CODE SYNTHESIS
--------------

mkdir -p /nethome/syoung/base/apps/complete/1.1.0/code-synthesis
cd /nethome/syoung/base/apps/complete/1.1.0/code-synthesis

wget http://codesynthesis.com/download/xsd/3.0/linux-gnu/i686/xsd-3.0.0-1.i686.rpm
chmod 755 *
sudo su
rpm -i xsd-3.0.0-1.i686.rpm

    OK




6. REPLACE BOOST AND BOOSTJAM REFERENCES IN COMPLETE GENOMICS 1.1.0 AND 1.0.1 makefiles 

cd /nethome/syoung/base/apps/complete/1.1.0/src
emacs makefile

    CC=g++
    CCFLAGS= -Wall -g -c -I/usr/local/include/boost-1_37 \
             -I. -I./common -I./libdnbcollection -I./libpipeline -I./libmapper \
             -I/usr/local/apache/xerces-c-src_2_8_0/include \
             -D__STDC_CONSTANT_MACROS -DCGI_MAX_DNB_BASE_COUNT=70
    ...

INCORRECT:

boost-1_37
xerces-c-src_2_8_0

CORRECT:

boost-1_39
xerces-c-3.0.1


7. RUN make IN src FOLDER

NB: MUST RUN AS ***ROOT***
AND CAN'T RUN ON /nethome



cd /nethome/syoung/base/apps/complete/1.1.0/src
make

GIVES THIS ERROR (WITH USER root):

    In file included from libdnbcollection/CollectionUtilities.hpp:40,
                     from libdnbcollection/DnbCollection.cpp:58:
    libdnbcollection/Collection.hxx:4775:42: error: xercesc/dom/DOMInputSource.hpp: No such file or directory
    

THE FILE SYSTEM IS THERE BUT NO FILE xercesc/dom/DOMInputSource.hpp:
ll
/nethome/syoung/base/apps/complete/1.1.0/xerces/xerces-c-3.0.1/src/xercesc/dom














To commence installation you must first obtain a copy of the Apache 2.0 licensed source code distribution from Complete Genomics.
Unpack the compressed archive file distribution to a directory of your choice to be used to compile and prepare the code, for example on Centos:

cd /DESTINATION_LOCATION
unzip CompleteGenomics_API.zip


Upon unpacking the distribution you will observe two source directories, src which contains the main source ll
code for an object code library, and examples, containing example software for exercising the File Access API's.


Within the source code directories you will find makefile file instances.
In order to successfully compile code provided by this distribution you will need to modify these makefile's to point at the installation locations resulting from steps 1-5 above.




The following list of libraries shows the external library dependencies for the File Access API and its associated examples :

libboost_iostreams-gcc41-mt.a
libboost_serialization-gcc41-mt.a
libboost_thread-gcc41-mt.a
libboost_wserialization-gcc41-mt.a
libxerces-depdom.a
libboost_regex-gcc41-mt.a
libboost_filesystem-gcc41-mt.a
libxerces-c.a




[root@ngsdev src]# make 

    make: Warning: File `makefile' has modification time 1.5e+02 s in the future
    g++ -Wall -g -c -I/usr/local/include/boost-1_39 -I. -I./common -I./libdnbcollection -I./libpipeline -I./libmapper -I/usr/local/apache/xerces-c-3.0.1/include -D__STDC_CONSTANT_MACROS -DCGI_MAX_DNB_BASE_COUNT=70 libdnbcollection/DnbCollection.cpp -o libdnbcollection/DnbCollection.o
    In file included from libdnbcollection/CollectionUtilities.hpp:40,
                     from libdnbcollection/DnbCollection.cpp:58:
    libdnbcollection/Collection.hxx:4775:42: error: xercesc/dom/DOMInputSource.hpp: No such file or directory



To build the main File Access API library you can change directory into the src directory and type "make".

Another alternative is to use the makefile within the root directory to compile all source code within the distribution.

The examples can also be compiled by changing to those directories, validating that the library locations are correct to link Xerces and boost and then using make. It can be seen that currently the library path is set to ../../libs. You should replace this with the locations of the installed libraries.
To run the example programs you will need to add an environment variable called CGI_HOME. This variable should point to your installation directory where you unpacked the CGI source distribution.





</entry>



<entry [Wed Jul 15 16:00:18 EDT 2009] INSTALL Convert::Binary TO TEST READ/WRITE OF BINARY FILES USING C HEADER STRUCTS>



.calls AND .scores FILES ARE BINARY

collection.xml
This file is a compound collection of all the information for all the lanes used in the assembly. It provides links into the *.calls and *.scores files in the ADF or FDF directories. For more information on the structure of the collection.xml file, see the section on [ADF-ID].xml.




</entry>



<entry [Wed Jul 15 16:00:18 EDT 2009] INSTALL Convert::Binary TO TEST READ/WRITE OF BINARY FILES USING C HEADER STRUCTS>



[syoung@kronos Convert-Binary-C-0.74]$ pwd
/home/syoung/base/perlmods/Convert-Binary-C-0.74

perl Makefile.PL PREFIX=../temp
make
make test
		...
		All tests successful, 1 test and 568 subtests skipped.
		Files=58, Tests=50433, 51 wallclock secs (33.39 cusr +  2.89 csys = 36.28 CPU)

make install

		Installing ../temp/lib64/perl5/site_perl/5.8.8/x86_64-linux-thread-multi/auto/Convert/Binary/C/C.so
		Installing ../temp/lib64/perl5/site_perl/5.8.8/x86_64-linux-thread-multi/auto/Convert/Binary/C/C.bs
		Files found in blib/arch: installing files in blib/lib into architecture dependent library tree
		Installing ../temp/lib64/perl5/site_perl/5.8.8/x86_64-linux-thread-multi/Convert/Binary/C.pm
		Installing ../temp/lib64/perl5/site_perl/5.8.8/x86_64-linux-thread-multi/Convert/Binary/C/Cached.pm
		Installing ../temp/share/man/man1/ccconfig.1
		Installing ../temp/share/man/man3/Convert::Binary::C::Cached.3pm
		Installing ../temp/share/man/man3/Convert::Binary::C.3pm
		Installing ../temp/bin/ccconfig
		Writing ../temp/lib64/perl5/site_perl/5.8.8/x86_64-linux-thread-multi/auto/Convert/Binary/C/.packlist
		Appending installation info to ../temp/lib64/perl5/5.8.8/x86_64-linux-thread-multi/perllocal.pod


NB: MUST TRANSFER auto/Convert/Binary FILES AS WELL AS Convert/Binary.pm, etc.


cp -r ../temp/lib64/perl5/site_perl/5.8.8/x86_64-linux-thread-multi/Convert /nethome/syoung/base/lib/5.8.8/x86_64-linux-thread-multi

cp -r ../temp/lib64/perl5/site_perl/5.8.8/x86_64-linux-thread-multi/auto/Convert /nethome/syoung/base/lib/5.8.8/x86_64-linux-thread-multi/auto




ALSO INSTALLLED File::Binary BY STRAIGHT COPY INTO 5.8.8/x86... DIR



</entry>



<entry [Fri Jun 19 19:57:56 EDT 2009] DOWNLOAD Harismendy 2008 PAPER DATA FOR 3 PLATFORMS ON KRONOS>



mkdir /mihg/data/NGS/syoung/base/pipeline/platforms
cd /mihg/data/NGS/syoung/base/pipeline/platforms

wget ftp://ftp.jcvi.org/pub/data/NGS_cross_validation/454_reads.tar.gz
wget ftp://ftp.jcvi.org/pub/data/NGS_cross_validation/Illumina-fastq.tar.gz
wget ftp://ftp.jcvi.org/pub/data/NGS_cross_validation/all.genotype.filtered.final.gz	






</entry>



<entry [Sun Jun 14 11:37:56 EDT 2009] RUN MAQ ON CLUSTER>



1. PER CHROMOSOME
2. reads.1_1.fastq AND reads.1_2.fastq


1. SPLIT 5.6 GB FASTQ FILE INTO 1M READ SUBFILES

/nethome/syoung/base/bin/comparison/splitFile.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_1.1.fastq,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads_2.1.fastq --outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1 --splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split --lines 4000000 --suffix fastq

	Run time: 00:17:47
	Completed /nethome/syoung/base/bin/comparison/splitFile.pl
	4:10AM, 16 June 2009
	****************************************

ls /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1
	1   11  13  15  17  19  20  22  24  26  28  3   31  33  35  37  39  40  42  44  46  48  5   6  8
	10  12  14  16  18  2   21  23  25  27  29  30  32  34  36  38  4   41  43  45  47  49  50  7  9

head /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split
	0       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/1/reads_1.1.fastq
	1       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/2/reads_1.2.fastq
	2       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/3/reads_1.3.fastq
	3       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/4/reads_1.4.fastq
	4       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/5/reads_1.5.fastq
	5       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/6/reads_1.6.fastq
	6       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/7/reads_1.7.fastq
	7       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/8/reads_1.8.fastq
	8       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/9/reads_1.9.fastq
	9       0       /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1/10/reads_1.10.fastq


2. RUN runMAQ-cluster.pl

/nethome/syoung/base/bin/comparison/runMAQ-cluster.pl \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /mihg/data/NGS/syoung/base/pipeline/human-genome/chr1.fa \
--paired \
--queue "-q psmall" \
--jobs 100

/nethome/syoung/base/bin/nextgen/runMAQ-cluster.pl \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /mihg/data/NGS/syoung/base/pipeline/human-genome/chr1.fa \
--paired \
--queue "-q psmall" \
--jobs 100



</entry>



<entry [Sat Jun 13 23:32:19 EDT 2009] SPLIT reads.X.fastq FILES INTO 1M READ SUBFILES>



cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples
lines reads.4.fastq
	reads.4.fastq: 399999072

[syoung@kronos NA18507]$ qsub -q psmall mergeFiles-fasta.sh 
53534.kronos.ccs.miami.edu
[syoung@kronos NA18507]$ date
Tue Jun 16 20:26:26 EDT 2009
SPLIT INTO 100 1M-READ FILES (FOR RUNNING MAQ)

FASTQ
-----

/nethome/syoung/base/bin/comparison/splitFile.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1 \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--lines 4000000 \
--suffix fastq
	
	Run time: 00:17:01
	Completed /nethome/syoung/base/bin/comparison/splitFile.pl
	1:06AM, 14 June 2009
	****************************************


FASTA
-----

/nethome/syoung/base/bin/comparison/splitFile.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1 \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fasta.split \
--lines 1000000 \
--suffix fasta



</entry>



<entry [Fri Jun 12 12:14:22 EDT 2009] DELETE ALL CLUSTER JOBS>




qdel `qstat | grep syoung | cut -c 1,2,3,4,5`




</entry>



<entry [Sun Jun  7 23:44:30 EDT 2009] RUN ELAND ON ARTIFICIAL READS AND CONVERT ELAND TO MAQ AND CALL SNPs>



1. 
cd /home/syoung/base/bin/nextgen
./eland.pl \
--inputfile /home/syoung/base/pipeline/herpes-eland/assembly/herpes.fasta \
--outputfile /home/syoung/base/pipeline/herpes-eland/assembly/herpes-eland-contigs.fa \
--refdir /home/syoung/base/pipeline/herpes-eland/data \
--length 30


Convert eland alignment to MAQ .map file

eland2maq	maq eland2maq [-q defqual] out.map in.list in.eland

in.list FILE = sequence names that appear at the seventh column of the eland alignment file in.eland and the name you expect to see in maq alignment.

EXAMPLE OF THE in.list FILE:

  cX.fa chrX
  c1.fa chr1
  c2.fa chr2




TEST
Usage: maq eland2maq [-q qual] <out.map> <in.list> <in.eland>

cd 
/nethome/syoung/base/apps/maq/0.7.1/maq eland2maq 



SOLiD Related

fasta2csfa	maq fasta2csfa in.nucl-ref.fasta > out.colour-ref.fasta
Convert nucleotide FASTA to colour-coded FASTA. Flag -c should be then applied to map command. In the output, letter A stands for color 0, C for 1, G for 2 and T for 3. Each sequence in the output is 1bp shorter than the input.

csmap2nt	maq csmap2nt out.nt.map in.ref.nt.bfa in.cs.map
Convert color alignment to nucleotide alignment. The input in.ref.nt.bfa is the nucleotide binary FASTA reference file. It must correspond to the original file from which the color reference is converted. Nucleotide consensus can be called from the resultant alignment.





</entry>



<entry [Sun Jun  7 23:44:30 EDT 2009] TEST ELAND, BOWTIE, MAQ, NOVOALIGN, SOAP AND SHRIMP ON SIMULATED PAIRED END READS GENERATED BY MAQ>



REFERENCE: 	/nethome/syoung/base/pipeline/comparison/maq/CCDS_nucleotide.20090327.fa
READS: 		/nethome/syoung/base/pipeline/comparison/


BOWTIE
------


1. BUILD REFERENCE ebwt FILE FOR BOWTIE

/nethome/syoung/base/apps/bowtie/0.9.4/bowtie-build \
-f /nethome/syoung/base/pipeline/comparison/mtDNA-AC_000021.fa \
/nethome/syoung/base/pipeline/comparison/bowtie/mtDNA-AC_000021.ebwt 
	
	-rw-r--r-- 1 syoung bioinfo 4.1M Jun  8  2009 mtDNA-AC_000021.ebwt.1.ebwt
	-rw-r--r-- 1 syoung bioinfo 2.2K Jun  8  2009 mtDNA-AC_000021.ebwt.2.ebwt
	-rw-r--r-- 1 syoung bioinfo 4.1M Jun  8  2009 mtDNA-AC_000021.ebwt.rev.1.ebwt
	-rw-r--r-- 1 syoung bioinfo 2.2K Jun  8  2009 mtDNA-AC_000021.ebwt.rev.2.ebwt
	
	

2. RUN bowtie

COPY SIMREAD FILES FROM maq TO bowtie FOLDER

cp ../maq/simread_* ./


RUN bowtie
	Usage: bowtie [options]* <ebwt> {-1 <mates1> -2 <mates2> | <singles>} [<hits>] 

cd /nethome/syoung/base/pipeline/comparison/bowtie
/nethome/syoung/base/apps/bowtie/0.9.4/bowtie -q /nethome/syoung/base/pipeline/comparison/bowtie/mtDNA-AC_000021.ebwt /nethome/syoung/base/pipeline/comparison/bowtie/simread_1.fastq,/nethome/syoung/base/pipeline/comparison/bowtie/simread_2.fastq /nethome/syoung/base/pipeline/comparison/bowtie/mtDNA-simread-match.txt

	-rw-r--r-- 1 syoung bioinfo 163G Jun  8  2009 mtDNA-simread-match.txt

VERY LARGE OUTPUT FILE











</entry>



<entry [Sun Jun  7 23:44:30 EDT 2009] GENERATE SIMULATED PAIRED END READS WITH MAQ>



/nethome/syoung/base/bin/nextgen/run-maq.pl --outputdir /nethome/syoung/base/pipeline/comparison/maq --inputfile /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt --referencefile /nethome/syoung/base/pipeline/comparison/CCDS_nucleotide.20090327.fa &> /nethome/syoung/base/pipeline/comparison/maq/s_4_sequence-maq-runlog.txt

1. GENERATE in.simupars.dat

simutrain GENERATES THE FILE in.simupars.dat, WHICH DETERMINES THE READ LENGTHS AND QUALITY

Usage: maq simutrain <simupars.dat> <known_reads.fastq>

time /nethome/syoung/base/apps/maq/0.7.1/maq simutrain /nethome/syoung/base/pipeline/comparison/maq/in.sumupars.dat /nethome/syoung/base/pipeline/comparison/maq/s_4_sequence.txt 

	-rw-r--r-- 1 syoung bioinfo 164K Jun  8  2009 in.sumupars.dat

2. RUN simulate

GENERATE SIMULATED PAIRED END simread_1.fastq AND simread_2.fastq FILES:

cd /nethome/syoung/base/pipeline/comparison/maq 
time /nethome/syoung/base/apps/maq/0.7.1/maq simulate \
-d 170 -s 20 -N 1000000 -1 32 -2 32 -r 0.001 -R 0.1 \
simread_1.fastq simread_2.fastq \
/nethome/syoung/base/pipeline/comparison/maq/mtDNA-AC_000021.fa \
/nethome/syoung/base/pipeline/comparison/maq/in.sumupars.dat \
&> /nethome/syoung/base/pipeline/comparison/maq/simulate-log.txt 

	real    0m24.909s
	user    0m13.625s
	sys     0m4.533s

	-rw-r--r-- 1 syoung bioinfo 113M Jun  8  2009 simread_1.fastq
	-rw-r--r-- 1 syoung bioinfo 113M Jun  8  2009 simread_2.fastq

	
head /nethome/syoung/base/pipeline/comparison/maq/simulate-log.txt 
	
	-- 1 sequences, total length: 16569
	gi|115315570|ref|AC_000021.2|   403     T       K       +
	gi|115315570|ref|AC_000021.2|   482     -       A       -
	gi|115315570|ref|AC_000021.2|   571     C       T       -
	gi|115315570|ref|AC_000021.2|   1695    C       -       +
	gi|115315570|ref|AC_000021.2|   4548    T       W       +
	gi|115315570|ref|AC_000021.2|   4678    T       W       +
	gi|115315570|ref|AC_000021.2|   4798    C       S       +
	gi|115315570|ref|AC_000021.2|   6120    A       R       +
	gi|115315570|ref|AC_000021.2|   6359    A       M       +
	gi|115315570|ref|AC_000021.2|   6920    C       M       +
	gi|115315570|ref|AC_000021.2|   8559    C       Y       +
	gi|115315570|ref|AC_000021.2|   8637    C       T       -
	gi|115315570|ref|AC_000021.2|   9155    A       T       -
	gi|115315570|ref|AC_000021.2|   10000   G       R       +
	gi|115315570|ref|AC_000021.2|   11192   G       A       -
	gi|115315570|ref|AC_000021.2|   12686   T       G       -
	gi|115315570|ref|AC_000021.2|   13486   C       A       -
	gi|115315570|ref|AC_000021.2|   14011   G       C       -





NOTES:


    fakemut     simulate references: randomly generate mutations
    simutrain   train parameters for simulation
    simulate    simulate reads: randomly generate sequencing errors
    simucns     evaluate consensus based on simulation
    simustat    evaluate alignment based on simulation


simulate	maq simulate [-d insize] [-s stdev] [-N nReads] [-1 readLen1] [-2 readLen2] [-r mutRate] [-R indelFrac] [-h] out.read1.fastq out.read2.fastq in.ref.fasta in.simupars.dat

Simulate paired end reads. File in.simupars.dat determines the read lengths and quality distribution. It is generated from simutrain, or can be downloaded from Maq website. In the output read files, a read name consists of the reference sequence name and the outer coordinates of the pair of simulated reads. By default, simulate assumes reads come from a diploid sequence which is generated by adding two different sets of mutations, including one base-pair indels, to in.ref.fasta.

OPTIONS:
-d INT	 mean of the outer distance of insert sizes [170]
-s INT	 standard deviation of insert sizes [20]
-N INT	 number of pairs of reads to be generated [1000000]
-1 INT	 length of the first read [set by in.simupars.dat]
-2 INT	 length of the second read [set by in.simupars.dat]
-r FLOAT	 mutation rate [0.001]
-R FLOAT	 fraction of 1bp indels [0.1]
-h	 add all mutations to in.ref.fasta and generate reads from the single mutated sequence (haploid mode)
NOTE:
*	 Reads generated from this command are independent, which deviates from the truth. Whereas alignment evaluation is less affected by this, evaluation on SNP calling should be performed with caution. Error dependency may be one of the major causes of wrong SNP calls.
simustat	maq simustat in.simu-aln.map > out.simustat
Evaluate mapping qualities from simulated reads.




fakemut	maq fakemut [-r mutrate] [-R indelfrac] in.ref.fasta > out.fakeref.fasta 2> out.fake.snp

Randomly introduce substitutions and indels to the reference. Substitutions and sinlge base-pair indels can be added.

OPTIONS:
-r FLOAT	 Mutation rate [0.001]
-R FLOAT	 Fraction of mutations to be indels [0.1]
simutrain	maq simutrain out.simupars.dat in.read.fastq
Estimate/train parameters for read simulation.


time /nethome/syoung/base/apps/maq/0.7.1/maq fakemut  mtDNA-AC_000021.fa > mtDNA-mut-R0.1-r0.001

	gi|115315570|ref|AC_000021.2|   1294    G       A       99
	gi|115315570|ref|AC_000021.2|   1513    G       A       99
	gi|115315570|ref|AC_000021.2|   2991    G       T       99
	gi|115315570|ref|AC_000021.2|   3583    T       A       99
	gi|115315570|ref|AC_000021.2|   4052    G       C       99
	gi|115315570|ref|AC_000021.2|   5630    G       A       99
	gi|115315570|ref|AC_000021.2|   6794    T       A       99
	gi|115315570|ref|AC_000021.2|   6865    A       T       99
	gi|115315570|ref|AC_000021.2|   8705    C       T       99
	gi|115315570|ref|AC_000021.2|   9233    A       T       99
	gi|115315570|ref|AC_000021.2|   9805    A       C       99
	gi|115315570|ref|AC_000021.2|   10813   A       C       99
	gi|115315570|ref|AC_000021.2|   11286   C       T       99
	gi|115315570|ref|AC_000021.2|   11995   -       C       99
	gi|115315570|ref|AC_000021.2|   12592   A       C       99
	gi|115315570|ref|AC_000021.2|   12999   T       G       99
	gi|115315570|ref|AC_000021.2|   13997   T       C       99
	gi|115315570|ref|AC_000021.2|   14224   G       C       99
	gi|115315570|ref|AC_000021.2|   15970   C       T       99
	
	real    0m0.147s
	user    0m0.004s
	sys     0m0.018s



</entry>



<entry [Thu Jun  4 18:53:47 EDT 2009] RUN TEST OF BOWTIE, MAQ, SOAP, ELAND, ETC ON ngsdev (kronos IS DOWN, NO MOUNT OF pluto)>



http://vancouvershortr.wiki.sourceforge.net/MaqPetToBedFormat


HUMAN mtDNA VS UNKNOWN READS
----------------------------

1. RUN MAQ

/nethome/syoung/base/bin/nextgen/run-maq.pl --outputdir /nethome/syoung/base/pipeline/comparison/maq --inputfile /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt --referencefile /nethome/syoung/base/pipeline/comparison/mtDNA-AC_000021.fa &> /nethome/syoung/base/pipeline/comparison/maq/s_4_sequence-maq-runlog.txt

	Run time: 00:03:08
	Completed /nethome/syoung/base/bin/nextgen/run-maq.pl
	10:42PM, 7 June 2009
	****************************************

PROBLEM:

NO RESULT IN OUTPUT FILES

SOLUTION:

GENERATE SIMULATED READS WITH MAQ (SEE ABOVE)



CCDS VS UNKNOWN READS
---------------------

1. DOWNLOAD CCDS 

CCDS HOMEPAGE
http://www.ncbi.nlm.nih.gov/projects/CCDS/CcdsBrowse.cgi

cd /nethome/syoung/base/pipeline/ccds

CCDS GENOME POSITIONS
wget ftp://ftp.ncbi.nlm.nih.gov/pub/CCDS/current_human/CCDS.20090327.txt

CCDS FASTA
wget ftp://ftp.ncbi.nlm.nih.gov/pub/CCDS/current_human/CCDS_nucleotide.20090327.fna.gz

CCDS REFERENCE LOCATION
/nethome/syoung/base/pipeline/ccds/CCDS_nucleotide.20090327.fna

head /nethome/syoung/base/pipeline/ccds/CCDS_nucleotide.20090327.fna

	>CCDS2.2|Hs36.3|chr1
	ATGTCCAAGGGGATCCTGCAGGTGCATCCTCCGATCTGCGACTGCCCGGGCTGCCGAATA
	TCCTCCCCGGTGAACCGGGGGCGGCTGGCAGACAAGAGGACAGTCGCCCTGCCTGCCGCC
	CGGAACCTGAAGAAGGAGCGAACTCCCAGCTTCTCTGCCAGCGATGGTGACAGCGACGGG
	AGTGGCCCCACCTGTGGGCGGCGGCCAGGCTTGAAGCAGGAGGATGGTCCGCACATCCGT
	ATCATGAAGAGAAGAGTCCACACCCACTGGGACGTGAACATCTCTTTCCGAGAGGCGTCC
	TGCAGCCAGGACGGCAACCTTCCCACCCTCATATCCAGCGTCCACCGCAGCCGCCACCTC
	GTTATGCCCGAGCATCAGAGCCGCTGTGAATTCCAGAGAGGCAGCCTGGAGATTGGCCTG
	CGACCCGCCGGTGACCTGTTGGGCAAGAGGCTGGGCCGCTCCCCCCGTATCAGCAGCGAC
	TGCTTTTCAGAGAAGAGGGCACGAAGCGAATCGCCTCAAGAGGCGCTGCTGCTGCCGCGG


2. GET READS FOR TESTING

(183,035 READS)
cp /nethome/syoung/base/pipeline/velvet/s_4_sequence.txt /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt

READS LOCATION
/nethome/syoung/base/pipeline/comparison/s_4_sequence.txt


3. BUILD REFERENCE ebwt FILE FOR BOWTIE

/nethome/syoung/base/apps/bowtie/0.9.4/bowtie-build -f /nethome/syoung/base/pipeline/ccds/CCDS_nucleotide.20090327.fna /nethome/syoung/base/pipeline/comparison/bowtie/CCDS_nucleotide.20090327.ebwt 



4. RUN bowtie

	Usage: bowtie [options]* <ebwt> {-1 <mates1> -2 <mates2> | <singles>} [<hits>] 

#TRIM ONE 3'
/nethome/syoung/base/apps/bowtie/0.9.4/bowtie -q -3 1 /nethome/syoung/base/pipeline/comparison/bowtie/CCDS_nucleotide.20090327.ebwt /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt /nethome/syoung/base/pipeline/comparison/bowtie/match-q-31.txt

#DEFAULT
/nethome/syoung/base/apps/bowtie/0.9.4/bowtie -q /nethome/syoung/base/pipeline/comparison/bowtie/CCDS_nucleotide.20090327.ebwt /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt /nethome/syoung/base/pipeline/comparison/bowtie/match-q.txt


5. RUN MAQ

/nethome/syoung/base/bin/nextgen/run-maq.pl --outputdir /nethome/syoung/base/pipeline/comparison/maq --inputfile /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt --referencefile /nethome/syoung/base/pipeline/comparison/CCDS_nucleotide.20090327.fa &> /nethome/syoung/base/pipeline/comparison/maq/s_4_sequence-maq-runlog.txt
	
	Run time: 00:03:11
	Completed /nethome/syoung/base/bin/nextgen/run-maq.pl
	10:22PM, 7 June 2009
	****************************************



RUN bwa


[syoung@ngsdev 0.4.9]$ ./bwa

Program: bwa (alignment via Burrows-Wheeler transformation)
Version: 0.4.9
Contact: Heng Li <lh3@sanger.ac.uk>

Usage:   bwa <command> [options]

Command: index         index sequences in the FASTA format
         aln           gapped/ungapped alignment
         samse         generate alignment (single ended)
         sampe         generate alignment (paired ended)

         fa2pac        convert FASTA to PAC format
         pac2bwt       generate BWT from PAC
         pac2bwtgen    alternative algorithm for generating BWT
         bwtupdate     update .bwt to the new format
         pac_rev       generate reverse PAC
         bwt2sa        generate SA from BWT and Occ
         pac2cspac     convert PAC to color-space PAC
         stdsw         standard SW/NW alignment








**** BELOW IS A TEST WITH UNKNOWN READS, PROBABLY HUMAN MITOCHONDRIAL




1. DOWNLOAD CCDS 

CCDS HOMEPAGE
http://www.ncbi.nlm.nih.gov/projects/CCDS/CcdsBrowse.cgi

cd /nethome/syoung/base/pipeline/ccds

CCDS GENOME POSITIONS
wget ftp://ftp.ncbi.nlm.nih.gov/pub/CCDS/current_human/CCDS.20090327.txt

CCDS FASTA
wget ftp://ftp.ncbi.nlm.nih.gov/pub/CCDS/current_human/CCDS_nucleotide.20090327.fna.gz

CCDS REFERENCE LOCATION
/nethome/syoung/base/pipeline/ccds/CCDS_nucleotide.20090327.fna

head /nethome/syoung/base/pipeline/ccds/CCDS_nucleotide.20090327.fna

	>CCDS2.2|Hs36.3|chr1
	ATGTCCAAGGGGATCCTGCAGGTGCATCCTCCGATCTGCGACTGCCCGGGCTGCCGAATA
	TCCTCCCCGGTGAACCGGGGGCGGCTGGCAGACAAGAGGACAGTCGCCCTGCCTGCCGCC
	CGGAACCTGAAGAAGGAGCGAACTCCCAGCTTCTCTGCCAGCGATGGTGACAGCGACGGG
	AGTGGCCCCACCTGTGGGCGGCGGCCAGGCTTGAAGCAGGAGGATGGTCCGCACATCCGT
	ATCATGAAGAGAAGAGTCCACACCCACTGGGACGTGAACATCTCTTTCCGAGAGGCGTCC
	TGCAGCCAGGACGGCAACCTTCCCACCCTCATATCCAGCGTCCACCGCAGCCGCCACCTC
	GTTATGCCCGAGCATCAGAGCCGCTGTGAATTCCAGAGAGGCAGCCTGGAGATTGGCCTG
	CGACCCGCCGGTGACCTGTTGGGCAAGAGGCTGGGCCGCTCCCCCCGTATCAGCAGCGAC
	TGCTTTTCAGAGAAGAGGGCACGAAGCGAATCGCCTCAAGAGGCGCTGCTGCTGCCGCGG


2. GET READS FOR TESTING

(183,035 READS)
cp /nethome/syoung/base/pipeline/velvet/s_4_sequence.txt /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt

READS LOCATION
/nethome/syoung/base/pipeline/comparison/s_4_sequence.txt

head /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt
	@HWI-EAS185_1_JIA_cDNA_JH:4:150:316:264
	TCAGTTCCATCAACATCATAGCCAGATGCCCTGA
	+HWI-EAS185_1_JIA_cDNA_JH:4:150:316:264
	]]]]]]]]]]]]]]]]][]]]]]]][][[[[[[Z
	@HWI-EAS185_1_JIA_cDNA_JH:4:150:660:361
	CGCTCTCCGTCTTTCTCCATTGCGTCGTGGCCTT
	+HWI-EAS185_1_JIA_cDNA_JH:4:150:660:361
	]][X]]]]][]]][][]]][]]]]]]][]]ZWZZ
	@HWI-EAS185_1_JIA_cDNA_JH:4:150:355:335
	TTTTTGAGATGGCAGCAACGGAAACCATAACGAG


3. BUILD REFERENCE ebwt FILE FOR BOWTIE

/nethome/syoung/base/apps/bowtie/0.9.4/bowtie-build -f /nethome/syoung/base/pipeline/ccds/CCDS_nucleotide.20090327.fna /nethome/syoung/base/pipeline/comparison/bowtie/CCDS_nucleotide.20090327.ebwt 

OUTPUT FILES:

ll /nethome/syoung/base/pipeline/comparison/bowtie
	-rw-r--r-- 1 syoung bioinfo  17M Jun  7  2009 CCDS_nucleotide.20090327.ebwt.1.ebwt
	-rw-r--r-- 1 syoung bioinfo 4.3M Jun  7  2009 CCDS_nucleotide.20090327.ebwt.2.ebwt
	-rw-r--r-- 1 syoung bioinfo  17M Jun  7  2009 CCDS_nucleotide.20090327.ebwt.rev.1.ebwt
	-rw-r--r-- 1 syoung bioinfo 4.3M Jun  7  2009 CCDS_nucleotide.20090327.ebwt.rev.2.ebwt
	

	./bowtie-build
	No input sequence or sequence file specified!
	Usage: bowtie-build [options]* <reference_in> <ebwt_outfile_base>
		reference_in            comma-separated list of files with ref sequences
		ebwt_outfile_base       write Ebwt data to files with this dir/basename
	Options:
		-f                      reference files are Fasta (default)
		-c                      reference sequences given on cmd line (as <seq_in>)
		--bmax <int>            max bucket sz for blockwise suffix-array builder
		--bmaxmultsqrt <int>    max bucket sz as multiple of sqrt(ref len)
		--bmaxdivn <int>        max bucket sz as divisor of ref len
		--dcv <int>             diff-cover period for blockwise (default: 1024)
		--nodc                  disable difference cover (blockwise is quadratic)
		-o/--offrate <int>      SA index is kept every 2^offRate BWT chars
		-t/--ftabchars <int>    # of characters in initial lookup table key
		--big --little          endianness (default: little, this host: little)
		--seed <int>            seed for random number generator
		--cutoff <int>          truncate reference at prefix of <int> bases
		-v/--verbose            verbose output (for debugging)
		--version               print version information and quit



4. RUN bowtie

	Usage: bowtie [options]* <ebwt> {-1 <mates1> -2 <mates2> | <singles>} [<hits>] 

/nethome/syoung/base/apps/bowtie/0.9.4/bowtie -q /nethome/syoung/base/pipeline/comparison/bowtie/CCDS_nucleotide.20090327.ebwt /nethome/syoung/base/pipeline/comparison/s_4_sequence.txt /nethome/syoung/base/pipeline/comparison/bowtie/match.txt

OUTPUT FILE (ONLY ONE LINE!!):

ll /nethome/syoung/base/pipeline/comparison/bowtie/match.txt
	-rw-r--r-- 1 syoung bioinfo      143 Jun  7  2009 match.txt

head match.txt 
	HWI-EAS185_1_JIA_cDNA_JH:4:157:364:45   +       CCDS8596.2|Hs36.3|chr12 1696    TCTCCCCCTCCCAGCAGCTTCCAGGAGCAGAAGT      ]]]]]]]]]]]]]]]]]]]]]][]]]]][]\[[Z 0



	Usage: bowtie [options]* <ebwt_base> <query_in> [<hit_outfile>]
	  <ebwt_base>        ebwt filename minus trailing .1.ebwt/.2.ebwt
	  <query_in>         comma-separated list of files containing query reads
						 (or the sequences themselves, if -c is specified)
	  <hit_outfile>      file to write hits to (default: stdout)
	Options:
	  -q                 query input files are FASTQ .fq/.fastq (default)
	  -f                 query input files are (multi-)FASTA .fa/.mfa
	  -r                 query input files are raw one-sequence-per-line
	  -c                 query sequences given on command line (as <query_in>)
	  -e/--maqerr <int>  max sum of mismatch quals (rounds like maq; default: 70)
	  -l/--seedlen <int> seed length (default: 28)
	  -n/--seedmms <int> max mismatches in seed (can be 0-3, default: 2)
	  -v <int>           report end-to-end hits w/ <=v mismatches; ignore qualities
	  -5/--trim5 <int>   trim <int> bases from 5' (left) end of reads
	  -3/--trim3 <int>   trim <int> bases from 3' (right) end of reads
	  -u/--qupto <int>   stop after the first <int> reads
	  -t/--time          print wall-clock time taken by search phases
	  --solexa-quals     convert FASTQ qualities from solexa-scaled to phred
	  --ntoa             Ns in reads become As; default: Ns match nothing
	  --concise          write hits in a concise format
	  --maxns <int>      skip reads w/ >n no-confidence bases (default: no limit)
	  -o/--offrate <int> override offrate of Ebwt; must be <= value in index
	  --seed <int>       seed for random number generator
	  --verbose          verbose output (for debugging)
	  --version          print version information and quit


5. CONVERT BOWTIE OUTPUT TO 


5. RUN MAQ





</entry>



<entry [Thu Jun  4 18:53:47 EDT 2009] RUN WHOLE SAMPLING PIPELINE USING Sampler.pm>



@SRR005718.1 FC20CMYAAXX:1:1:697:785
@SRR005718.63 FC20CMYAAXX:1:1:1000:282 length=36
@SRR005718.1700000036 FC20CMYAAXX:1:1:540:28000 length=36
fastaInfos
-----------

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 10

	OK

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 10
	
	Run time: 00:47:36
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	2:37AM, 5 June 2009
	****************************************

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 50

	OK

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 50

	RUNNING Fri Jun  5 01:47:53 EDT 2009
	Run time: 00:06:43
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	1:53AM, 5 June 2009
	****************************************

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 20

	RUNNING Fri Jun  5 01:47:53 EDT 2009
	Run time: 00:45:25
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	2:33AM, 5 June 2009
	****************************************

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 \
--cluster \
--queue "-q psmall" \
--jobs 20

	RUNNING Fri Jun  5 01:47:53 EDT 2009
	Run time: 00:25:51
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	2:15AM, 5 June 2009
	****************************************

	
	
listFiles
---------

RERUN Fri Jun 12 01:30:50 EDT 2009
RERUN Sun Jun 14 22:42:08 EDT 2009 WITH PAIRED END COPY FROM READ1 TO READ2
	
	Run time: 00:49:12
	Completed /nethome/syoung/base/bin/comparison/listFiles.pl
	11:33PM, 14 June 2009
	****************************************

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507

screen -S listFiles

/nethome/syoung/base/bin/comparison/listFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--size 100000000 \
--paired \
&> /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/listfiles.out6


tail -f /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/listfiles.out5

/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR00227/SRR002272_1.fasta.37.list


	Run time: 02:19:02
	Completed /nethome/syoung/base/bin/comparison/listFiles.pl
	4:13AM, 12 June 2009
	****************************************


	total: 111737062
	
	directory       total reads
	SRX000600/fasta 2902742286
	SRX000603/fasta 111737062
	SRX000602/fasta 243457620
	SRX001540/fasta 192132426
	SRX000601/fasta 52767544
	
	global reads: 3502836938
	
	directory       fraction
	SRX000600/fasta 0.828683246573666
	SRX000603/fasta 0.0318990189888194
	SRX000602/fasta 0.0695029840980853
	SRX001540/fasta 0.0548505195647791
	SRX000601/fasta 0.0150642307746499



# CLEAN UP THE DIRECTORIES TO RUN listFiles.pl AGAIN

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507

cd SRX001539
mv fasta fasta.bkp5
mkdir fasta
mv fasta.bkp5/*fasta fasta
mv fasta.bkp5/*qual fasta
mv fasta.bkp5/*info fasta
cd ..
ll SRX001539/fasta


cd SRX001540
mv fasta fasta.bkp5
mkdir fasta
mv fasta.bkp5/*fasta fasta
mv fasta.bkp5/*qual fasta
mv fasta.bkp5/*info fasta
cd ..
ll SRX001540/fasta


cd SRX000600
mv fasta fasta.bkp5
mkdir fasta
mv fasta.bkp5/*fasta fasta
mv fasta.bkp5/*qual fasta
mv fasta.bkp5/*info fasta
cd ..
ll SRX000600/fasta


cd SRX000601
mv fasta fasta.bkp5
mkdir fasta
mv fasta.bkp5/*fasta fasta
mv fasta.bkp5/*qual fasta
mv fasta.bkp5/*info fasta
cd ..
ll SRX000601/fasta


cd SRX000602
mv fasta fasta.bkp5
mkdir fasta
mv fasta.bkp5/*fasta fasta
mv fasta.bkp5/*qual fasta
mv fasta.bkp5/*info fasta
cd ..
ll SRX000602/fasta


cd SRX000603
mv fasta fasta.bkp5
mkdir fasta
mv fasta.bkp5/*fasta fasta
mv fasta.bkp5/*qual fasta
mv fasta.bkp5/*info fasta
cd ..
ll SRX000603/fasta


printFiles
----------

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--mode fastq \
--cluster \
--queue "-q psmall" 


INDIVIDUAL SHELL SCRIPTS FOR printFiles (FA, FQ, or QU) FOR EACH

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507

cp SRX000601/0601-prntFA.sh SRX000602/0602-prntFA.sh
cp SRX000601/0601-prntFQ.sh SRX000602/0602-prntFQ.sh
cp SRX000601/0601-prntQU.sh SRX000602/0602-prntQU.sh

cp SRX000601/0601-prntFA.sh SRX000603/0603-prntFA.sh
cp SRX000601/0601-prntFQ.sh SRX000603/0603-prntFQ.sh
cp SRX000601/0601-prntQU.sh SRX000603/0603-prntQU.sh

cp SRX000601/0601-prntFA.sh SRX000600/0600-prntFA.sh
cp SRX000601/0601-prntFQ.sh SRX000600/0600-prntFQ.sh
cp SRX000601/0601-prntQU.sh SRX000600/0600-prntQU.sh

cp SRX000601/0601-prntFA.sh SRX001539/1539-prntFA.sh
cp SRX000601/0601-prntFQ.sh SRX001539/1539-prntFQ.sh
cp SRX000601/0601-prntQU.sh SRX001539/1539-prntQU.sh

cp SRX000601/0601-prntFA.sh SRX001540/1540-prntFA.sh
cp SRX000601/0601-prntFQ.sh SRX001540/1540-prntFQ.sh
cp SRX000601/0601-prntQU.sh SRX001540/1540-prntQU.sh


CORRECT EXPERIMENT NAME INSIDE COPIED FILES:

perl  -pi -e 's/0601/1540/' SRX001540/1540-prnt*.sh
perl  -pi -e 's/0601/1539/' SRX001539/1539-prnt*.sh
perl  -pi -e 's/0601/0600/' SRX000600/0600-prnt*.sh
perl  -pi -e 's/0601/0602/' SRX000602/0602-prnt*.sh
perl  -pi -e 's/0601/0603/' SRX000603/0603-prnt*.sh


RERUN FASTQ FOR READ_1 IN ALL EXPERIMENTS


screen -S 0600-prntFQ
SRX000600/0600-prntFQ.sh &> SRX000600/0600-prntFQ.sh.out

screen -S 0601-prntFQ
SRX000601/0601-prntFQ.sh &> SRX000601/0601-prntFQ.sh.out

screen -S 0602-prntFQ
SRX000602/0602-prntFQ.sh &> SRX000602/0602-prntFQ.sh.out

screen -S 0603-prntFQ
SRX000603/0603-prntFQ.sh &> SRX000603/0603-prntFQ.sh.out

screen -S 1539-prntFQ
SRX001539/1539-prntFQ.sh &> SRX001539/1539-prntFQ.sh.out

screen -S 1540-prntFQ
SRX001540/1540-prntFQ.sh &> SRX001540/1540-prntFQ.sh.out

	RUNNING
	Mon Jun 15 10:05:03 EDT 2009



(ALTERNATELY, DO FASTA, QUAL AND FASTQ IN SUCCESSION FOR EACH EXPERIMENT:)


screen -S 1539-printFiles
SRX001539/1539-printFiles.sh &> 1539-printFiles.out

screen -S 1540-printFiles
SRX001540/1540-printFiles.sh &> 1540-printFiles.out

screen -S 0600-printFiles
SRX000600/0600-printFiles.sh &> 0600-printFiles.out

screen -S 0601-printFiles
SRX000601/0601-printFiles.sh &> 0601-printFiles.out

screen -S 0602-printFiles
SRX000602/0602-printFiles.sh &> 0602-printFiles.out

screen -S 0603-printFiles
SRX000603/0603-printFiles.sh &> 0603-printFiles.out


		Run time: 01:44:16
		Completed /nethome/syoung/base/bin/comparison/printFiles.pl
		6:46AM, 15 June 2009
		****************************************



SRX001539/1539-printFiles.sh &> 1539-printFiles.out

	FASTQ
	Run time: 01:06:29
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	1:27PM, 12 June 2009
	****************************************

SRX001540/1540-printFiles.sh &> 1540-printFiles.out
	
	FASTQ
	Run time: 00:14:53
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	3:49PM, 12 June 2009
	****************************************

SRX000600/0600-printFiles.sh &> 0600-printFiles.out

	FASTQ
	Run time: 01:46:59
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	10:42AM, 12 June 2009
	****************************************

SRX000601/0601-printFiles.sh &> 0601-printFiles.out

	FASTA
	Run time: 00:36:45
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	12:55AM, 12 June 2009
	****************************************

	QUAL
	Run time: 00:43:58
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	1:39PM, 12 June 2009
	****************************************
	
	FASTQ
	Run time: 00:48:58
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	2:28PM, 12 June 2009
	****************************************


SRX000602/0602-printFiles.sh &> 0602-printFiles.out

	FASTQ
	Run time: 01:03:27
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	3:06PM, 12 June 2009
	****************************************

SRX000603/0603-printFiles.sh &> 0603-printFiles.out
	
	FASTQ
	Run time: 01:14:04
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	3:28PM, 12 June 2009
	****************************************





EXAMPLE SRX001539/sampler-1539.sh:

#!/bin/sh

#PBS -j oe
###PBS -m b
###PBS -M syoung@med.miami.edu


/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--mode fasta \
--cluster \
--queue "-q psmall" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--mode qual \
--cluster \
--queue "-q psmall" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--mode fastq \
--cluster \
--queue "-q psmall" 





mergeFiles
----------

#### REMOVE ALL FILES IN SAMPLES
#### rm -fr /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads*


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fasta.sh
emacs mergeFiles-fasta.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode fasta \
--paired


chmod 755 mergeFiles-fasta.sh 
qsub -q psmall mergeFiles-fasta.sh 
date

	
	[syoung@kronos NA18507]$ qsub -q psmall mergeFiles-fasta.sh 
	53534.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date
	Tue Jun 16 20:26:26 EDT 2009



	#####move: mv /tmp/reads.37.fasta /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.37.fasta
	#####singlefile:
	#####-rw-rw-rw- 1 syoung bioinfo 406222080 Jun 13 06:45 /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.37.fasta
	#####
	#####Run time: 04:04:33
	#####Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
	#####6:46AM, 13 June 2009
	#####****************************************




QUAL
----

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-qual.sh
emacs mergeFiles-qual.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode qual \
--paired

chmod 755 mergeFiles-qual.sh
qsub -q "psmall" mergeFiles-qual.sh
date


	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	53539.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date
	Wed Jun 17 10:17:52 EDT 2009


	##[syoung@kronos NA18507]$ chmod 755 mergeFiles-qual.sh
	##[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	##52114.kronos.ccs.miami.edu
	##[syoung@kronos NA18507]$ date
	##Sun Jun 14 03:33:02 EDT 2009



FASTQ
-----

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
rm -fr mergeFiles-fastq.sh
emacs mergeFiles-fastq.sh
#!/bin/sh

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1-37 \
--mode fastq \
--paired

chmod 755 mergeFiles-fastq.sh
qsub -q "psmall" mergeFiles-fastq.sh
date





RUNNING READ 2 FASTA, QUAL AND FASTQ:


cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
qsub -q "psmall" mergeFiles-fastq.sh
qsub -q psmall mergeFiles-fasta.sh 
qsub -q "psmall" mergeFiles-qual.sh
date

	
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-fastq.sh
	53088.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q psmall mergeFiles-fasta.sh 
	53089.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	53090.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date
	Mon Jun 15 13:06:29 EDT 2009



FASTQ
Run time: 05:40:37
Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
6:47PM, 15 June 2009
****************************************

FASTA
Run time: 06:29:33
Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
7:36PM, 15 June 2009
****************************************

QUAL
Run time: 08:37:40
Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
9:44PM, 15 June 2009
****************************************



RUNNING READ 1 FASTA, QUAL AND FASTQ:

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
qsub -q "psmall" mergeFiles-fastq.sh
qsub -q psmall mergeFiles-fasta.sh 
qsub -q "psmall" mergeFiles-qual.sh
date

	[syoung@kronos samples]$ cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-fastq.sh
	53189.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q psmall mergeFiles-fasta.sh 
	53190.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ qsub -q "psmall" mergeFiles-qual.sh
	53191.kronos.ccs.miami.edu
	[syoung@kronos NA18507]$ date
	Mon Jun 15 23:18:45 EDT 2009




RUN MAQ ON THE CLUSTER


/nethome/syoung/base/bin/nextgen/runMAQ-cluster.pl \
--splitfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fastq.split \
--referencefile /mihg/data/NGS/syoung/base/pipeline/human-genome/chr1.fa \
--paired \
--queue "-q psmall" \
--jobs 100


TEST
----

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir \
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,\
/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples \
--max_index 37 \
--indices 1 \
--mode fasta


	move: mv /tmp/reads.1.fasta /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fasta
	singlefile:
	-rw-rw-rw- 1 syoung bioinfo 5999986080 Jun 13 02:33 /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/reads.1.fasta
	
	Run time: 00:07:17
	Completed /nethome/syoung/base/bin/comparison/mergeFiles.pl
	2:36AM, 13 June 2009
	****************************************



TEST
----

fastaInfos
----------

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test2 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

listFiles
---------

/nethome/syoung/base/bin/comparison/listFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--size 10000

printFiles
----------

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
--mode fasta \
--cluster \
--queue "-q psmall" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
--mode qual \
--cluster \
--queue "-q psmall" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
--mode fastq \
--cluster \
--queue "-q psmall" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--mode fasta \
--cluster \
--queue "-q psmall" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--mode qual \
--cluster \
--queue "-q psmall" 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--mode fastq \
--cluster \
--queue "-q psmall" 


mergeFiles
----------

/nethome/syoung/base/bin/comparison/mergeFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/samples \
--mode fastq




</entry>



<entry [Wed June  3 23:29:43 EDT 2009] RUN NEW VERSION OF printFile.pl (PRINTS FIRST TO LOCAL TEMPDIR):>



1. KILLED RUNNING VERSION

/nethome/syoung/base/bin/comparison/printFiles.pl --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta --outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/samples --cluster --queue "-q psmall" --mode qual >&printFiles-qual.out


2. KILL ALL RUNNING QUEUE JOBS

qdel `qstat | grep syoung | cut -c 1,2,3,4,5`


3. RUN NEW VERSION OF printFile.pl

cd /mihg/data/NGS/syoung/base/pipeqstatline/SRA/NA18507/SRX000600
emacs printFile.sh
#!/bin/sh

#PBS -j oe
#PBS -m bea
#PBS -M syoung@med.miami.edu

echo "Running printFile..."
/home/syoung/base/bin/comparison/printFile.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR004829_2.fasta --outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/samples --mode qual --width 60 --dot 100000
echo "printFile completed."
echo "Sleeping 300 seconds..."
sleep 300;
echo "done."


qsub -q psmall printFile.sh






</entry>



<entry [Mon June  1 23:29:43 EDT 2009] KILL ALL gsmall JOBS AND RUN WITH psmall>



KILL ALL gsmall JOBS:

qdel `qstat | grep syoung | grep "Q gsmall" | cut -c 1,2,3,4,5`


RUN JOBS WITH psmall

/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--compress gzip \
--cluster \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10  &> fastaInfos.out

	Run time: 02:26:53
	Completed /nethome/syoung/base/bin/comparison/fastaInfos.pl
	4:04AM, 2 June 2009
	****************************************


/nethome/syoung/base/bin/comparison/listFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/samples \
--mode samples \
--size 10000000 &> listFiles.out

	Run time: 01:41:39
	Completed /nethome/syoung/base/bin/comparison/listFiles.pl
	5:46AM, 2 June 2009
	****************************************


/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/samples \
--cluster \
--mode fasta &> printFiles-fasta.out

	
	Run time: 18:02:55
	Completed /nethome/syoung/base/bin/comparison/printFiles.pl
	11:49PM, 2 June 2009
	****************************************


/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/samples \
--cluster \
--queue "-q psmall" \
--mode qual  &> printFiles-qual.out

	NOT FINISHED


/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRA/NA18507/SRX000600/fasta/SRR002271_1.fasta.sh


/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/samples \
--cluster \
--queue "-q psmall" \
--mode fastq &> printFiles-fastq.out






</entry>



<entry [Mon June  1 23:29:43 EDT 2009] MAKE NODE c26 SLEEP TO EXCLUDE FROM JOB>




NB: THIS REQUESTS 26 NODES

echo sleep 600 | qsub -l nodes=26:ppn=8

###echo sleep 600 | qsub -l nodes=26:ppn=8,walltime=1000


How do I exclude a node from running a job?


Sometimes one need to be able to exclude a node from running a job.
Sometimes it is useful to exclude a specific node from running your jobs. This can be due to hardware or software problems on that node. For instance the node seems to have problems with the interconnect.

The simplest way to do this is to submit a dummy job to this node:

echo sleep 600 | qsub -lnodes=cX-Y:ppn=8,walltime=1000


Then this job will be running a sleep job for 600 seconds and you can submit your real job afterwards that will run on other nodes. This will cost you some cpu hours off your quota, but let us know and we will refund this to you later.

Please let us know if you think some nodes have problems.


[syoung@ngsdev SRX001539]$ qsub -q psmall samplePrep.sh
40553.kronos.ccs.miami.edu
[syoung@ngsdev SRX001539]$ date
Mon Jun  1 14:27:56 EDT 2009



</entry>



<entry [Fri May 29 04:29:43 EDT 2009] RUN ELAND>



1. RUN elandChromosomes.pl WITH runSamples.pl


/nethome/syoung/base/bin/comparison/elandChromosomes.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed \
--readfile /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/reads.1-12.fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/eland \
--length 36 \
--multi 



TEST elandChromosomes.pl

/nethome/syoung/base/bin/comparison/elandChromosomes.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed \
--readfile /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/reads.1-12.fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/eland \
--length 36 \
--multi 

	...
	Comment: >chr4
	finished making FileReader
	Finishing block: 13
	... done User: 30.8553s System: 0.041993s Actual: 31.073s Efficiency: 99.4345%
	FileReader: unmapping 47815680 bytes of memory
	FileReader: unmapping 366 bytes of memory
	Will look for index file /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr4/chr4.fa.idx
	... not found, will not index
	Outputting results: User: 0s System: 0.002s Actual: 0.01023s Efficiency: 19.5503%
	Info: 124420 matches were stored
	Info: 497680 bytes of temp storage used for oligo numbers
	Info: 497680 bytes of temp storage used for match positions
	... done User: 0.096985s System: 0.008999s Actual: 0.107851s Efficiency: 98.2689%
	Run complete! Time now: Fri May 29 04:27:38 2009
	
	Run time: 00:01:31
	Completed /home/syoung/base/bin/comparison/../nextgen/eland.pl
	4:27AM, 29 May 2009
	****************************************




</entry>



<entry [Thu May 28 23:26:52 EDT 2009] INSTALL ALIGNERS - SOAP, SHRimP, Bowtie, Novoalign>




ELAND
MAQ
SOAP
Mosaik
SHRimP		OK
Novoalign
Bowtie


At different coverages:

total coverage: 38X
global reads: 3,498,519,123
batches: 	50M reads x 70
			20M reads x 175 
			10M reads x 350 

Approx file sizes (36 bp reads)

1 million reads = 15 MB
10 million reads = 150 MB
100 million reads = 1.5 GB


Coverage vs reads

3.5 B reads = 38X
2.9 B reads = 30X
1.8 B reads = 20X
0.9 B reads = 10X
0.45 B reads = 5X


On reads from these genomes:

NA18507 genome
Yanhuang genome
X chromosome (NA073540???)
Complete genomics Cau
Other deep-coverage SRA genomes?


Evaluate SNP callers:

MAQ             
CASSAVA         
SSAHASNP        http://www.sanger.ac.uk/Software/analysis/ssahaSNP/
PolyBayesShort  http://bioinformatics.bc.edu/marthlab/PbShort


Later:

Create an application for detecting large chromosomal rearrangments using different sets of reads (paired with varying insert, single)


</entry>



<entry [Thurs May 28 23:02:26 EDT 2009] DATA PREPARATION PIPELINE - TWO STEPS>



TEST readsFastqFasta.pl

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 


TEST sampleReads.pl

/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta1 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta1/sample \
--compress gzip \
--mode samples \
--size 60000 \
&> /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/sample/sampleReads.out




</entry>



<entry [Wed May 27 23:02:26 EDT 2009] DATA PREPARATION PIPELINE>



1. DOWNLOAD NA18507 READS
2. RUN fastaInfos.pl TO CREATE FIXED-LENGTH FASTA, QUAL AND info FILES
3. RUN listFiles.pl TO RANDOMLY SAMPLE FASTA AND QUAL RECORDS
3. RUN printFiles.pl TO GENERATE RANDOMLY SAMPLED FASTA AND QUAL FILES


1. DOWNLOAD NA18507 READS

SHOULD GET THESE NUMBERS OF FILES

/nethome/syoung/base/bin/comparison/sampleReads.pl --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta --compress gzip --mode total
Number files: 367
Total reads: 2794499393

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta 
Number files: 10
Total reads: 52767544

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta 
Number files: 34
Total reads: 243457620

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta 
Number files: 12
Total reads: 111737062

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/f
asta 
Number files: 4
Total reads: 103925078

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta 
Number files: 8
Total reads: 192132426


DOWNLOAD ON PLUTO:

cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507

screen -S deepvac-SRX000600
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600 \
--outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600

	ONGOING

screen -S deepvac-SRX000601
cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000601 \
--outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601

	Run time: 00:22:46
	Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
	0:38AM, 28 May 2009
	****************************************


screen -S deepvac-SRX000602
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000602 \
--outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602

	Run time: 01:39:45
	Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
	2:18AM, 28 May 2009
	****************************************

screen -S deepvac-SRX000603
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000603 \
--outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603


cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
mkdir SRX001539
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001539 \
--outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539

	Run time: 00:25:57
	Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
	10:43AM, 28 May 2009
	****************************************

cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
mkdir SRX001540
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001540 \
--outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540
	
	Run time: 00:33:49
	Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
	1:14PM, 28 May 2009
	****************************************




###ON MENDEL3
###
###NO CONTENTS!!!
###screen -S deepvac-SRX000600
###/nethome/syoung/base/bin/utils/deepvac.pl \
###--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600 \
###--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600
###
###NO CONTENTS!!!
###screen -S deepvac-SRX000602
###/nethome/syoung/base/bin/utils/deepvac.pl \
###--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000602 \
###--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602




----------
2. RERUN fileInfos.pl TO CREATE FIXED-LENGTH FASTA, QUAL AND info FILES


1539 
----

screen -S readsFq-1539

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--compress gzip \
--cluster \
--jobs 10 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

	COMPLETED

1540 
----

screen -S readsFq-1540

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--compress gzip \
--cluster \
--jobs 10 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

	COMPLETED

0601
----

screen -S readsFq-0601

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta \
--compress gzip \
--cluster \
--jobs 8 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

	RUNNING
	Fri May 29 04:51:45 EDT 2009
	Current pids list: 38210 38211 38212 38213 38214 38215 38216 38217
	Doing sleep...


0602
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta \
--compress gzip \
--cluster \
--jobs 8 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

	RUNNING
	Fri May 29 04:49:39 EDT 2009
	
	Job id                    Name             User            Time Use S Queue
	------------------------- ---------------- --------------- -------- - -----
	38194.kronos              ...1.fastq.gz.sh syoung                 0 R psmall         
	38195.kronos              ...2.fastq.gz.sh syoung                 0 R psmall         
	38196.kronos              ...1.fastq.gz.sh syoung                 0 R psmall         
	38197.kronos              ...2.fastq.gz.sh syoung                 0 Q psmall         
	38198.kronos              ...1.fastq.gz.sh syoung                 0 Q psmall         
	38199.kronos              ...2.fastq.gz.sh syoung                 0 Q psmall         
	38200.kronos              ...1.fastq.gz.sh syoung                 0 Q psmall         
	38201.kronos              ...2.fastq.gz.sh syoung                 0 Q psmall         


0603
----

screen -S readsFq-0603

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--compress gzip \
--cluster \
--jobs 8 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

	RUNNING
	Fri May 29 04:51:08 EDT 2009

0600
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--compress gzip \
--cluster \
--jobs 60 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

	COMPLETED




DO TEST :


/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta \
--cluster \
--jobs 60 \
--queue "-q psmall" \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 


/nethome/syoung/base/bin/comparison/fastaInfos.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test2 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--cluster \
--jobs 60 \
--queue "-q psmall" \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 






3. RUN listFiles.pl TO GENERATE RANDOMIZED LISTS OF READ BYTE POSITIONS IN FASTA FILES


TESTING - REQUEST 8 CPUS TO RUN TESTS

msub -I -l nodes=1:ppn=8 -q gdebug

	qsub: waiting for job 39355.kronos.ccs.miami.edu to start
	qsub: job 39355.kronos.ccs.miami.edu ready
	
	[syoung@c22 ~]$ 


/nethome/syoung/base/bin/comparison/listFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta/samples \
--mode samples \
--size 100000000




/nethome/syoung/base/bin/comparison/listFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
--mode samples \
--size 10000

	OK








4. RUN printFiles.pl TO PRINT FASTA, QUAL AND FASTQ FILES


/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
--mode fasta \
--size 10000 


/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
--mode qual \
--size 10000 

/nethome/syoung/base/bin/comparison/printFiles.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/test2/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test/fasta/samples \
--mode fastq \
--size 10000 







emacs /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA18507-10M/sampleReads-10M.sh 

#!/bin/sh

/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA18507-10M \
--compress gzip \
--mode samples \
--size 10000000 \
&> /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA18507-10M/sampleReads.out


qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA18507-10M/sampleReads-10M.sh 


	39362.kronos.ccs.miami.edu
	Sat May 30 01:19:41 EDT 2009


KILL ALL gsmall JOBS:

qdel `cat mshow | grep syoung | grep Idle | cut -c 1,2,3,4,5`






</entry>



<entry [Wed May 27 00:00:30 EDT 2009] RUN sampleReads.pl ON NA18507 DATA>



1. ALL FOLDERS
2. 10M READ CHUNKS
3. OUTPUT TO /mihg/data/NGS/syoung/base/pipeline/SRA/samples/NA17507-10M

mkdir -p /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA17507-10M
cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA17507-10M

emacs sampleReads.sh

#!/bin/sh

/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA17507-10M \
--compress gzip \
--mode samples \
--size 10000000 \
&> /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/NA17507-10M/sampleReads.out


chmod 755 sampleReads.sh

qsub -q psmall sampleReads.sh

36205.kronos.ccs.miami.edu
Wed May 27 16:51:22 EDT 2009


	directory       total reads
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta 2794499393
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta 111737062
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta 243457620
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta 192132426
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta 103925078
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta 52767544
	global reads: 3,498,519,123
	directory       fraction
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta 0.798766362209763
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta 0.0319383882355872
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta 0.0695887635426825
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta 0.0549182151776393
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta 0.0297054480327904
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta 0.0150828228015377
	Generating read list files...


[syoung@kronos NA17507-10M]$ qstat -f 36205
Job Id: 36205.kronos.ccs.miami.edu
    Job_Name = sampleReads.sh
    Job_Owner = syoung@kronos.ccs.miami.edu
    resources_used.cput = 00:03:41
    resources_used.mem = 13044kb
    resources_used.vmem = 220256kb
    resources_used.walltime = 00:05:15
    job_state = R
    queue = psmall
    server = kronos.ccs.miami.edu
    Checkpoint = u
    ctime = Wed May 27 17:05:21 2009
    Error_Path = kronos.ccs.miami.edu:/mihg/data/NGS/syoung/base/pipeline/SRA/
        NA18507/samples/NA17507-10M/sampleReads.sh.e36205
    exec_host = n10/0
    Hold_Types = n
    Join_Path = n
    Keep_Files = n
    Mail_Points = a
    mtime = Wed May 27 17:05:24 2009
    Output_Path = kronos.ccs.miami.edu:/mihg/data/NGS/syoung/base/pipeline/SRA
        /NA18507/samples/NA17507-10M/sampleReads.sh.o36205
    Priority = 0
    qtime = Wed May 27 17:05:21 2009
    Rerunable = True
    session_id = 21870
    Variable_List = PBS_O_HOME=/nethome/syoung,PBS_O_LANG=en_US.UTF-8,
        PBS_O_LOGNAME=syoung,
        PBS_O_PATH=/sw/bin:/nethome/syoung/base/bin:/usr/X11R6/bin:/nethome/s
        young/base/bin/utils:/home/syoung/base/bin/nextgen:/home/syoung/base/a
        pps/amos/bin:/usr/local/qt/bin:/home/apps/alta-cyclic/0.1.0/external.p
        rograms/libsvm-2.86:/home/apps/alta-cyclic/0.1.0/blat/bin/i386:/home/a
        pps/alta-cyclic/0.1.0/perlmods/lib64/perl5/site_perl/5.8.8/x86_64-linu
        x-thread-multi/auto:/home/apps/alta-cyclic/0.1.0/perlexternal:/home/bi
        oinfo/apps/ngs/bin/nextgen:/home/bioinfo/apps/ngs/bin/exome:/home/bioi
        nfo/apps/ngs/bin/utils:/home/bioinfo/apps/ngs/bin:/usr/local/bin:/bin:
        /usr/bin,PBS_O_MAIL=/var/spool/mail/syoung,PBS_O_SHELL=/bin/bash,
        PBS_SERVER=kronos.ccs.miami.edu,PBS_O_HOST=kronos.ccs.miami.edu,
        PBS_O_WORKDIR=/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples
        /NA17507-10M,PBS_O_QUEUE=psmall
    etime = Wed May 27 17:05:21 2009
    submit_args = -q psmall sampleReads.sh 


</entry>



<entry [Wed May 27 00:00:30 EDT 2009] TROUBLESHOOTING sampleReads.pl>




CHECK RECORDS IN .fasta.gz FILES:

/nethome/syoung/base/bin/comparison/getIndex.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005720_1.fasta.gz --width 57 --index 27157344 --compress gzip

	>SRR005720.1          
	GGGGGAAATTCACTCCTGTGAAATTGCCTACGCA

PRINTED FASTA SMALL FILE:

/nethome/syoung/base/bin/utils/getFasta.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta.1-6.fasta --id SRR005720.1

cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540
grep -n SRR005720.1 fasta.1-6.fasta

	18095624:>SRR005720.1          
	65145940:>SRR005720.1


GET LINES FROM PRINTED FASTA FILE:

/nethome/syoung/base/bin/utils/getLines.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta.1-6.fasta --number 18095624 --lines 20

	>SRR005734.4009523    
	GCAGCTT
	>SRR005720.1          
	GGGGGAAATTCACTCCTGTGAAATTGCCTACGCA
	TA
	>SRR005720.2          
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	AAAAA
	>SRR005720.3          
	GAAAATATAAGTTGACCCCTAACTAGGG
	TTGCCCCA
	>SRR005720.4          
	GTTTCAGGAGATTGCAGTCTGAATG
	TTGGCTGGGTC
	>SRR005720.5          
	GGTGTTTTTTTTTTTCTTTTAT
	TTCTTTTTCTCCAT
	>SRR005720.6          
	GGGAGGAAATTAGTTCATG
	AGGGTAGACACAGCTGA
	
	
	TIDIED UP:
	
	>SRR005734.4009523    
	GCAGCTT
	>SRR005720.1          
	GGGGGAAATTCACTCCTGTGAAATTGCCTACGCATA
	>SRR005720.2          
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	>SRR005720.3          
	GAAAATATAAGTTGACCCCTAACTAGGGTTGCCCCA
	>SRR005720.4          
	GTTTCAGGAGATTGCAGTCTGAATGTTGGCTGGGTC
	>SRR005720.5          
	GGTGTTTTTTTTTTTCTTTTATTTCTTTTTCTCCAT
	>SRR005720.6          
	GGGAGGAAATTAGTTCATGAGGGTAGACACAGCTGA


/nethome/syoung/base/bin/utils/getLines.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta.1-6.fasta --number 65145938 --lines 20

	>SRR005720.1          
	GCATTTCTGTGAAAACTGCATAGCAGGATCATGT
	GA
	>SRR005720.2          
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	AAAAA
	>SRR005720.3          
	ACTCATCATTTTTAATGTAAGTATGTTT
	CATGCAAT
	>SRR005720.4          
	TGCAGAAGAAAAGATTGGAGCTAGC
	AGAGCTTGGTT
	>SRR005720.5          
	ATGACATGATACTGCAAATTCC
	ACAGGGCAGGCAAA
	>SRR005720.6          
	TTAAAGTATATATAGGATT
	TTATAGTTTTTGTACTT
	>SRR005720.7          
	AACATAAGCAGATTGT


FIND THE SAME RECORDS IN THE ORIGINAL FASTA FILE:

/nethome/syoung/base/bin/utils/getFasta.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta/SRR005720_1.fasta.gz --id SRR005720.1 --compress




SRX001540
---------
[syoung@kronos fasta]$ tail -n 1 SRR0057*_*.fasta.gz.1.list


==> SRR005720_1.fasta.gz.1.list <==
1259078073

==> SRR005720_2.fasta.gz.1.list <==
1259077959

==> SRR005721_1.fasta.gz.1.list <==
575506143

==> SRR005721_2.fasta.gz.1.list <==
575506086

==> SRR005734_1.fasta.gz.1.list <==
1202856465

==> SRR005734_2.fasta.gz.1.list <==
1202856465

==> SRR005735_1.fasta.gz.1.list <==
1586469258

==> SRR005735_2.fasta.gz.1.list <==
	1586469087

SRX001539
---------

==> SRR005718_1.fasta.gz.1.list <==
1547968608

==> SRR005718_2.fasta.gz.1.list <==
1547968437

==> SRR005719_1.fasta.gz.1.list <==
953119857

==> SRR005719_2.fasta.gz.1.list <==
953119857


</entry>



<entry [Mon May 25 17:25:09 EDT 2009] SAMPLE READS WITH sampleReads.pl FOR NA18507>



/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--compress gzip \
--mode samples \
--size 100000000


/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--compress gzip \
--mode samples \
--size 100000000


/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta,/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/1539,1540-50M \
--compress gzip \
--mode samples \
--size 50000000

	WITHOUT MERGE

	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta.5-6.fasta
	/mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta.6-6.fasta
	Finished generating fasta files
	
	Run time: 00:15:03
	Completed /nethome/syoung/base/bin/comparison/sampleReads.pl
	5:25PM, 26 May 2009
	****************************************

	MERGE ONLY
	
	Run time: 00:10:04
	Completed /nethome/syoung/base/bin/comparison/sampleReads.pl
	7:08PM, 26 May 2009
	****************************************
	
	
	cd  /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/samples/1539,1540-50M/
	[syoung@kronos 1539,1540-50M]$ ls -alh
	total 16G
	drwxrwx---+ 2 syoung bioinfo 4.0K May 26 18:59 .
	drwxrwx---+ 4 syoung bioinfo   45 May 26 18:48 ..
	-rw-rw----+ 1 syoung bioinfo 2.8G May 26 18:51 reads.1-6.fasta
	-rw-rw----+ 1 syoung bioinfo 2.8G May 26 18:52 reads.2-6.fasta
	-rw-rw----+ 1 syoung bioinfo 2.8G May 26 18:55 reads.3-6.fasta
	-rw-rw----+ 1 syoung bioinfo 2.8G May 26 18:57 reads.4-6.fasta
	-rw-rw----+ 1 syoung bioinfo 2.8G May 26 18:59 reads.5-6.fasta
	-rw-rw----+ 1 syoung bioinfo 2.5G May 26 19:01 reads.6-6.fasta



/nethome/syoung/base/bin/comparison/sampleReads.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/test,/mihg/data/NGS/syoung/base/pipeline/SRA/test2 \
--compress gzip \
--mode samples \
--size 100000000





	SUBROUTINE		samples
	
	PURPOSE
	
		EXTRACT FASTA RECORDS FROM FILES IN THE INPUT DIRECTORY

			1. GET READ COUNTS AND RECORD LENGTHS FROM .info FILES
			
			1. GENERATE READ LISTS FOR divide PORTIONS PER FILE WITH RANDOMISER

				1) PRINT divide NUMBER OF .N.readlist FILES PER .info FILE,
				
					ONE READ LOCATION PER LINE
				
			2. GENERATE SAMPLED .N.fasta FILES FROM .N.readlist FILES, ONE
			
				FOR EACH ORIGINAL READ FILE
			
			3. CONCAT FASTA FILES IN EACH FOLDER INTO SINGLE FASTA FILE





</entry>



<entry [Mon May 25 17:25:09 EDT 2009] GET TOTAL READS WITH sampleReads.pl FOR NA18507>



    TAKE INCRMENTS OF 100,000,000 READS (~1X COVERAGE AT READ LENGTH = 36 BP)

    NA18507 READS AND COVERAGE  
	Experiment	Reads	
	SRX000600	2,794,499,393	
	SRX000601	52,767,544	
	SRX000602	243,457,620	
	SRX000603	111,737,062	
	SRX001539	103,925,078	
	SRX001540	192,132,426	
	Total	3,498,519,123	
			
	Bp per read	36	
	Total bps	125,946,688,428	
	Genome length	3,170,000,000	
	Coverage (X-fold)	39.73	


/nethome/syoung/base/bin/comparison/sampleReads.pl --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta --compress gzip --mode total
Number files: 367
Total reads: 2794499393

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta 
Number files: 10
Total reads: 52767544

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta 
Number files: 34
Total reads: 243457620

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta 
Number files: 12
Total reads: 111737062

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/f
asta 
Number files: 4
Total reads: 103925078

/nethome/syoung/base/bin/comparison/sampleReads.pl --compress gzip --mode total --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta 
Number files: 8
Total reads: 192132426

    Run time: 00:00:00
    Completed /nethome/syoung/base/bin/comparison/sampleReads.pl
    5:30PM, 25 May 2009
    ****************************************





</entry>



<entry [Sun May 24 13:44:09 EDT 2009] Wang et al. 2008 HAN CHINESE GENOME>




du -hs /data/NGS/syoung/base/pipeline/SRA/yanhuang/paired
    37G     paired

du -hs /data/NGS/syoung/base/pipeline/SRA/yanhuang/single
    66G     single


1. DOWNLOAD SINGLE END READS DATA
------------------------------
ftp://ftp.era-xml.ebi.ac.uk/ERA000/ERA000005/single_end_data/

MENDEL4

cd /data/NGS/syoung/base/pipeline/SRA/yanhuang
/nethome/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.era-xml.ebi.ac.uk/ERA000/ERA000005/single_end_data/ --outputdir /data/NGS/syoung/base/pipeline/SRA/yanhuang/single --inputfile ERA000005-single.txt

    Run time: 09:21:58
    Completed /nethome/syoung/base/bin/utils/deepvac.pl
    11:08PM, 25 May 2009
    ****************************************


####TEST - OKAY
####cd /data/NGS/syoung/base/pipeline/SRA/yanhuang
####wget ftp://ftp.era-xml.ebi.ac.uk/ERA000/ERA000005/single_end_data/071031_S85_FC7167_L5_YHCDSA.fq.gz

#### THIS DOESN'T WORK (HANGS)
####/nethome/syoung/base/bin/utils/ftpAgent.pl --url ftp://ftp.era-xml.ebi.ac.uk/ERA000/ERA000005/single_end_data/ --outputdir /data/NGS/syoung/base/pipeline/SRA/yanhuang/single --regex "\.gz$" &> ftpAgent-single-mendel4.out



2. DOWNLOAD PAIRED END READS DATA
------------------------------
ftp://ftp.era-xml.ebi.ac.uk/ERA000/ERA000005/pair_end_data/

cd /data/NGS/syoung/base/pipeline/SRA/yanhuang
/nethome/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.era-xml.ebi.ac.uk/ERA000/ERA000005/pair_end_data/ --outputdir /data/NGS/syoung/base/pipeline/SRA/yanhuang/paired --inputfile ERA000005-paired.txt

    Run time: 05:36:36
    Completed /nethome/syoung/base/bin/utils/deepvac.pl
    7:24PM, 25 May 2009
    ****************************************


####TEST - OKAY
####cd /data/NGS/syoung/base/pipeline/SRA/yanhuang
####wget ftp://ftp.era-xml.ebi.ac.uk/ERA000/ERA000005/pair_end_data/071022_HWI-EAS68_0001_FC12991_L1_YHPE_PE1.fq.gz

#### THIS DOESN'T WORK
./ftpAgent.pl \
--url ftp://yh.genomics.org.cn/Rawdata \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/yanhuang  \
--username yhdata \
--password yhdownload \
--regex "\.gz$"

#### THIS DOES WORK
/nethome/syoung/base/bin/utils/ftpAgent.pl \
--url http://yh.genomics.org.cn/download.jsp \
--outputdir /data/NGS/syoung/base/pipeline/SRA/yanhuang  \
--username yhdata \
--password yhdownload \
--regex "\.gz$"



3. DOWNLOAD REFERENCE GENOME, SNPs, ETC. USING ftpAgent.pl

MENDEL1
-------
cd /data/NGS/syoung/base/pipeline/SRA/yanhuang
/nethome/syoung/base/bin/utils/ftpAgent.pl --url http://yh.genomics.org.cn/download.jsp --outputdir /data/NGS/syoung/base/pipeline/SRA/yanhuang  --username yhdata --password yhdownload --regex "\.gz$" &> ftpAgent-mendel1.out

MENDEL2
-------
cd /data/NGS/syoung/base/pipeline/SRA/yanhuang
/nethome/syoung/base/bin/utils/ftpAgent.pl --url http://yh.genomics.org.cn/download.jsp --outputdir /data/NGS/syoung/base/pipeline/SRA/yanhuang  --username yhdata --password yhdownload --regex "\.gz$" &> ftpAgent-mendel2.out

MENDEL3
-------
cd /data/NGS/syoung/base/pipeline/SRA/yanhuang
/nethome/syoung/base/bin/utils/ftpAgent.pl --url http://yh.genomics.org.cn/download.jsp --outputdir /data/NGS/syoung/base/pipeline/SRA/yanhuang  --username yhdata --password yhdownload --regex "\.gz$" &> ftpAgent-mendel3.out



YANHUANG README

This directory contains the SNP calls and hapotypes for the 1000 Genomes Pilot 1 release of April 2009.

There are separate files for each population: CEU, YRI and JPTCHB.

In each case, there is a site file, e.g. CEU.sites.2009_04, with typical line:

1	211	A	G	0.201754

<chromosome>, <position>, <ref base>, <non-reference (variant) base>, <inferred non-reference allele frequency>

and a haplotype file, e.g. CEU.hap, with typical line

1	211	aaaaagaaaaaaAAaaaaaagggaaaggGAaaAAAAaaaaaaaaggagaaaggaaaagaaaaggagaaaaAAaaAAaaaaagaagaaaaaaaaaaaAAAGaagaaaAAgagaga

<chromosome>, <position>, 2N*haplotype calls

where the first two calls correspond to the phased alleles of first
sample, calls three and four to the phased alleles of the second
sample etc.

The sample order is given in CEU.Samples etc., which have one line per sample as below:

NA06985
NA06986
NA06994
...

Quang Le <lsq@sanger.ac.uk> and Richard Durbin <rd@sanger.ac.uk>



YANHUANG WEBSITE
http://yh.genomics.org.cn/

YH genome was assembled based on 3.3 billion reads generated by Illumina Genome Analyzer. We achieved 117.7G nucleotides data and the genome was sequenced to 36-fold average coverage. By aligning the short reads with SOAP, 102.9G nucleotides are mapped onto the NCBI reference genome and 99.97% of the genome has been covered. The raw sequences, aligments, consensus genome, variants and relevant tools are released for public use. And the documents about donor consent and sample collection are avialable at the bottom of this page.

Note:BGI FTP username: yhdata password:yhdownload

Raw Data   

  a)    Single_end_data  FTP1  FTP2

  b)    Pair_end_data  FTP1  FTP2

Processed Data

1 YH genome sequence

a) Fasta by chromosome   FTP1

These files are YH chromosome sequences in FASTA format. In order to make them easy to use, all indels are not taken into the sequences, so the sequences have the same coordinates as UCSC build hg18, which is essentially same to NCBI human v36.1.

b)Fasta.qual by chromosome  FTP1

The files contain quality information of consensus bases.

c) Total genome : YH Fasta  YH Fasta.qual
The files are concatenated from above FASTA sequences and the quality information.



2 YH variants and annotations

These files are variants results extracted from SOAP alignments.

    * SNPs:YH-SNPs.gff Download  Open
    * Indels :YH-Indels.gff Download  Open
    * Structural Variations : YH-sv.gff Download  Open


README: GFFDefinitions.doc


3 Short read alignments

    * Alignment by chr  FTP1
      These files are alignments in format of SOAP output. 


README: AlignmentDTD.doc


4 Genotyping

    * Genotyping  FTP1


README:README


5 Original Illumina 1M Duo genotyping result.

    * FTP1

      These are the original base-calls from Illumina 1M Duo bead chip. These include sites that are inconsistent between the two replicates and those failed. 


6 Phased haplotype blocks of YH based on HapMap data.

    * FTP1




About donor consent

These are documents about donor consent to participate.

    * Donor consent of the Yanhuang Project-Phase I(in chinese): Download
    * IRB Validation: Download
    * The Informed Consent forms: Download
    * The Protocol: Download



#### NOT FOUND ON SRA
SRA ACCESSION ERA000005
The data have been deposited in the EBI/NCBI short read archive (accession number ERA000005).
http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=gene&cmd=search&term=ERA000005


These data, together with all the associated analyses, are freely availably at
http://yh.genomics.org.cn

SNPs and indels have been submitted to NCBI dbSNP and will be available in dbSNP version 130
http://yh.genomics.org.cn/download.jsp

ftp://yh.genomics.org.cn/Rawdata


SRA README
http://www.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?cmd=show&f=faspftp_analyses&m=downloads&s=analyses

Data production and short read alignment

The genomic DNA used in this study came from an anonymous male Han Chinese individual who has no known genetic diseases. The donor gave written consent for public release of the genomic data for use in scientific research (see Supplementary Information for consent forms).

We carried out G-banded karyotyping to check the overall structural suitability of this DNA for use as a genomic standard for other genetic comparison and found no obvious chromosomal abnormalities (Supplementary Fig. 1). We then proceeded with whole-genome sequencing of the individual's DNA (hereafter referred to as YH) using Illumina Genome Analysers (GA; see Methods for details). To minimize the likelihood of systematic biases in genome representation, multiple DNA libraries were prepared and data were generated from eight single-end and two paired-end libraries (Supplementary Table 1). The read lengths averaged 35 base pairs (bp), and the two paired-end libraries had a span size of 135 bp and 440 bp, respectively. We collected a total of 3.3 billion reads of high-quality data: approximately 117.7 gigabases (Gb) of sequence (72 Gb from single-end reads and 45.7 Gb from paired-end reads). The data have been deposited in the EBI/NCBI Short Read Archive (accession number ERA000005). (See Supplementary Information for details concerning the availability of all data.)

Using the Short Oligonucleotide Alignment Program (SOAP)6, 102.9 Gb of sequence (87.4% of all data) was properly aligned to the NCBI human reference genome (build 36.1; hereafter called NCBI36). This resulted in a 36-fold average coverage of NCBI36 (Table 1). The effective genome coverage of the single- and paired-end sequencing was 22.5-fold and 13.5-fold, respectively. In total, 99.97% of NCBI36 (excluding Ns, which are undetermined sequence of the reference genome) was covered by at least one uniquely or repeatedly aligned read (uniquely aligned reads had only one best hit on NBCI36; repeatedly aligned reads had multiple possible alignments; see Methods for details).


</entry>



<entry [Sun May 24 13:44:09 EDT 2009] RUN readsFastqFasta.pl TO CREATE FIXED-LENGTH FASTA FILES>




1540
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--compress gzip \
--cluster \
--jobs 10 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 


1539
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--compress gzip \
--cluster \
--jobs 10 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 


0601
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta \
--compress gzip \
--cluster \
--jobs 8 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 


0602
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta \
--compress gzip \
--cluster \
--jobs 8 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 



0603
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--compress gzip \
--cluster \
--jobs 8 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 


0600
----

/nethome/syoung/base/bin/comparison/readsFastqFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--compress gzip \
--cluster \
--jobs 60 \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 




Run time: 01:34:47
Completed /nethome/syoung/base/bin/comparison/readsFastqFasta.pl
0:05AM, 25 May 2009
****************************************


[syoung@kronos fasta]$ date
Wed May 27 21:36:42 EDT 2009
[syoung@kronos fasta]$ /nethome/syoung/base/bin/comparison/readsFastqFasta.pl --inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 --outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta --compress gzip --cluster --jobs 60 --queue "-q psmall" --compress gzip --fixed --id_length 21 --sequence_length 36 --dot 10



</entry>



<entry [Sat May 23 23:44:09 EDT 2009] INSTALL COMPLETE GENOMICS API>



This API is delivered as a set of source code files that can be compiled to produce a statically linkable library for accessing and using data delivered by Complete Genomics to its customers.

These instructions have several pre-requisites including:

1. A successfully installed Centos 5.2 64 Bit Intel based computer with at least 200 GB of disk space available. Allow the installer to update the installation with all available updates.

2. An installed distribution of GCC 4.1.1, or later

    Using built-in specs.
    Target: x86_64-redhat-linux
    Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-libgcj-multifile --enable-languages=c,c++,objc,obj-c++,java,fortran,ada --enable-java-awt=gtk --disable-dssi --enable-plugin --with-java-home=/usr/lib/jvm/java-1.4.2-gcj-1.4.2.0/jre --with-cpu=generic --host=x86_64-redhat-linux
    Thread model: posix
    gcc version 4.1.2 20071124 (Red Hat 4.1.2-42)
    

3. An installed distribution of Xerces 2.8.

Xerces IS AN XML PARSER
http://xerces.apache.org/xerces-c/download.cgi

If using a source distribution be sure that you read and follow the Xerces-C installation instructions. There are decisions to be made that could involve bypassing many manual steps but need care and understanding before making these decisions.


In the case of a default installation of Centos 5.2, the following commands represent one example:

sudo su
mkdir /usr/local/apache
cd /usr/local/apache
wget http://apache.seekmeup.com/xerces/c/2/sources/xerces-c-src_2_8_0.tar.gz
tar xvfz xerces-c-src_2_8_0.tar.gz
cd xerces-c-src_2_8_0/src/xercesc/
export XERCESCROOT="/usr/local/apache/xerces-c-src_2_8_0"
./configure 
make
make install

    OK

    ...    
    /usr/bin/install -c .libs/XInclude /usr/local/bin/XInclude
    make[2]: Nothing to be done for `install-data-am'.
    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
    make[1]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
    make[2]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
    make[2]: Nothing to be done for `install-exec-am'.
    test -z "/usr/local/lib/pkgconfig" || /bin/mkdir -p "/usr/local/lib/pkgconfig"
     /usr/bin/install -c -m 644 'xerces-c.pc' '/usr/local/lib/pkgconfig/xerces-c.pc'
    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'
    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'


#### INSTALLED THIS VERSION BUT GOT ERROR WHEN COMPILING complete
####wget http://mirrors.isc.org/pub/apache/xerces/c/3/sources/xerces-c-3.0.1.tar.gz
####tar xvfz xerces-c-3.0.1.tar.gz
#####cd xerces-c-3.0.1/src/xercesc/
####
####export XERCESCROOT="/usr/local/apache/xerces-c-3.0.1"
####./configure 
####make
####make install
####
####    OK
####
####    ...    
####    /usr/bin/install -c .libs/XInclude /usr/local/bin/XInclude
####    make[2]: Nothing to be done for `install-data-am'.
####    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
####    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1/samples'
####    make[1]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
####    make[2]: Entering directory `/usr/local/apache/xerces-c-3.0.1'
####    make[2]: Nothing to be done for `install-exec-am'.
####    test -z "/usr/local/lib/pkgconfig" || /bin/mkdir -p "/usr/local/lib/pkgconfig"
####     /usr/bin/install -c -m 644 'xerces-c.pc' '/usr/local/lib/pkgconfig/xerces-c.pc'
####    make[2]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'
####    make[1]: Leaving directory `/usr/local/apache/xerces-c-3.0.1'



????? After building Xerces-C you may wish to modify the contents of the src/makefile and examples/dump-dnbs/makefile file to point to your installed directory.



4. An installed distribution of Boost 1.37, including bjam.


Centos 5.2 may require a manual build of Boost if you wish to use some of the later versions. The distribution may be easily built and instructions can be found on the boost.org web site. This can typically be done using two web download operations and two command lines.

BOOST

A collection of C libraries aimed at boosting productivity.

mkdir -p /nethome/syoung/base/apps/complete/1.1.0/boost
cd /nethome/syoung/base/apps/complete/1.1.0/boost

#### THIS DOESN'T WORK: wget http://sourceforge.net/project/downloading.php?group_id=7586&filename=boost_1_39_0.tar.gz&a=89204328
DOWNLOAD FROM boost.jam (~40MB)

tar xvfz  boost_1_39_0.tar.gz
cd /nethome/syoung/base/apps/complete/1.1.0/boost/boost_1_39_0

    OK




./bootstrap.sh


cd /nethome/syoung/base/apps/complete/1.1.0/boost
chmod 777 boost_1_39_0 
chmod 777 boost-jam-3.1.17-1-linuxx86
cd boost_1_39_0

ls
    boost            boost.css  bootstrap.bat  CMakeLists.txt  index.htm   INSTALL  libs             more    README.txt  status  wiki
    boost-build.jam  boost.png  bootstrap.sh   doc             index.html  Jamroot  LICENSE_1_0.txt  people  rst.css     tools


sudo su
./bootstrap.sh 

    Building Boost.Jam with toolset gcc... tools/jam/src/bin.linuxx86_64/bjam
    Detecting Python version... 2.4
    Detecting Python root... /usr
    Unicode/ICU support for Boost.Regex?... not found.
    Generating Boost.Build configuration in project-config.jam...
    
    Bootstrapping is done. To build, run:
    
        ./bjam
        
    To adjust configuration, edit 'project-config.jam'.
    Further information:
    
       - Command line help:
         ./bjam --help
         
       - Getting started guide: 
         http://www.boost.org/more/getting_started/unix-variants.html
         
       - Boost.Build documentation:
         http://www.boost.org/boost-build2/doc/html/index.html


BOOST JAM

sudo su
cd /nethome/syoung/base/apps/complete/1.1.0/boost
./bjam install


5. An installed copy of the Code Synthesis distribution.

This distribution is a run time for C++ of the XML DOM and can be obtained from http://www.codesynthesis.com/products/xsd/download.xhtml as an easily installed RPM.

Here are some example commands used to download and use the 3.0 version of the code synthesis runtime.


CODE SYNTHESIS
--------------

mkdir -p /nethome/syoung/base/apps/complete/1.1.0/code-synthesis
cd /nethome/syoung/base/apps/complete/1.1.0/code-synthesis

wget http://codesynthesis.com/download/xsd/3.0/linux-gnu/i686/xsd-3.0.0-1.i686.rpm
chmod 755 *
sudo su
rpm -i xsd-3.0.0-1.i686.rpm

    OK




6. REPLACE BOOST AND BOOSTJAM REFERENCES IN COMPLETE GENOMICS 1.1.0 AND 1.0.1 makefiles 

cd /nethome/syoung/base/apps/complete/1.1.0/src
emacs makefile

    CC=g++
    CCFLAGS= -Wall -g -c -I/usr/local/include/boost-1_37 \
             -I. -I./common -I./libdnbcollection -I./libpipeline -I./libmapper \
             -I/usr/local/apache/xerces-c-src_2_8_0/include \
             -D__STDC_CONSTANT_MACROS -DCGI_MAX_DNB_BASE_COUNT=70
    ...

INCORRECT:

boost-1_37
xerces-c-src_2_8_0

CORRECT:

boost-1_39
xerces-c-3.0.1


7. RUN make IN src FOLDER

NB: MUST RUN AS ***ROOT***
AND CAN'T RUN ON /nethome



cd /nethome/syoung/base/apps/complete/1.1.0/src
make

GIVES THIS ERROR (WITH USER root):

    In file included from libdnbcollection/CollectionUtilities.hpp:40,
                     from libdnbcollection/DnbCollection.cpp:58:
    libdnbcollection/Collection.hxx:4775:42: error: xercesc/dom/DOMInputSource.hpp: No such file or directory
    

THE FILE SYSTEM IS THERE BUT NO FILE xercesc/dom/DOMInputSource.hpp:
ll
/nethome/syoung/base/apps/complete/1.1.0/xerces/xerces-c-3.0.1/src/xercesc/dom














To commence installation you must first obtain a copy of the Apache 2.0 licensed source code distribution from Complete Genomics.
Unpack the compressed archive file distribution to a directory of your choice to be used to compile and prepare the code, for example on Centos:

cd /DESTINATION_LOCATION
unzip CompleteGenomics_API.zip


Upon unpacking the distribution you will observe two source directories, src which contains the main source ll
code for an object code library, and examples, containing example software for exercising the File Access API's.


Within the source code directories you will find makefile file instances.
In order to successfully compile code provided by this distribution you will need to modify these makefile's to point at the installation locations resulting from steps 1-5 above.




The following list of libraries shows the external library dependencies for the File Access API and its associated examples :

libboost_iostreams-gcc41-mt.a
libboost_serialization-gcc41-mt.a
libboost_thread-gcc41-mt.a
libboost_wserialization-gcc41-mt.a
libxerces-depdom.a
libboost_regex-gcc41-mt.a
libboost_filesystem-gcc41-mt.a
libxerces-c.a




[root@ngsdev src]# make 

    make: Warning: File `makefile' has modification time 1.5e+02 s in the future
    g++ -Wall -g -c -I/usr/local/include/boost-1_39 -I. -I./common -I./libdnbcollection -I./libpipeline -I./libmapper -I/usr/local/apache/xerces-c-3.0.1/include -D__STDC_CONSTANT_MACROS -DCGI_MAX_DNB_BASE_COUNT=70 libdnbcollection/DnbCollection.cpp -o libdnbcollection/DnbCollection.o
    In file included from libdnbcollection/CollectionUtilities.hpp:40,
                     from libdnbcollection/DnbCollection.cpp:58:
    libdnbcollection/Collection.hxx:4775:42: error: xercesc/dom/DOMInputSource.hpp: No such file or directory



To build the main File Access API library you can change directory into the src directory and type "make".

Another alternative is to use the makefile within the root directory to compile all source code within the distribution.

The examples can also be compiled by changing to those directories, validating that the library locations are correct to link Xerces and boost and then using make. It can be seen that currently the library path is set to ../../libs. You should replace this with the locations of the installed libraries.
To run the example programs you will need to add an environment variable called CGI_HOME. This variable should point to your installation directory where you unpacked the CGI source distribution.



</entry>



<entry [Thurs May 21 23:44:09 EDT 2009] SANGER MAQ DATA WITH YRI AND CEU TRIOS>



#  1000 Genomes Project. MAQ alignment: ftp://ftp.sanger.ac.uk/pub/1000genomes
    
    Name  	Size  	Last Modified
    090407-test.bams 		4/7/2009 	4:44:00 PM
    File:ARG_10Trees.tgz 	128189 KB 	5/1/2009 	1:17:00 PM
    CEU43 		12/17/2008 	3:32:00 AM
    F3C-Trio-YRI 		11/18/2008 	12:00:00 AM
    June-CEU-trio 		11/16/2008 	12:00:00 AM
    LC29 		9/26/2008 	12:00:00 AM
    LC52 		10/25/2008 	12:00:00 AM
    LC52-extra 		10/21/2008 	12:00:00 AM
    NA12878 		5/11/2009 	11:42:00 AM
    REL-0902 		1/20/2009 	1:33:00 AM
    REL-0904 		4/21/2009 	12:51:00 PM
    goncalo 		4/30/2009 	10:40:00 AM
    lsq 		5/1/2009 	1:13:00 PM
    reference 		12/19/2008 	5:47:00 PM
    tk2 		5/11/2009 	11:42:00 AM





</entry>



<entry [Wed May 20 16:33:09 EDT 2009] qseq FORMAT HAS CHANGED TO ASCII='@'+10*log10(1/p) (where p = prob. base error) as of Pipeline 1.3.>



http://seqanswers.com/forums/showthread.php?t=1110

sparks
Hi Tony,
I've been given a couple of qseq.txt files to align for clients and the format looks pretty simple except for the quality values. I'm seeing a lot of B's in the quality string and it looks like this is the lowest quality value. In earlier _sequence.txt files quality values were in form log(p/(1-p)) + '@' and codes went as low as ';'
These qseq.txt files look like you may be using phred type log(p) + '@'. Any chance you could enlighten us.

Thanks, Colin

coxtonyj
Hi Colin

You have it spot on, they are now in Phred format. Just to state it fully for the benefit of others: ASCII='@'+10*log10(1/p), p being the estimated probability of the base being in error. This change was made as of Pipeline 1.3.

Cheers

Tony 





 kmcarr
Member

Instrument(s):
Illumina GAI-II Roche 454
 
Member #: 519
Join Date: May 2008
Location: USA, Midwest
Posts: 43
	
Default
Quote:
Originally Posted by coxtonyj View Post
Hi Colin

You have it spot on, they are now in Phred format. Just to state it fully for the benefit of others: ASCII='@'+10*log10(1/p), p being the estimated probability of the base being in error. This change was made as of Pipeline 1.3.

Cheers

Tony


Q kmcarr:

Out of curiosity why did you stick with ASCII(Q+64) instead of the standard ASCII(Q+33)? It results in the minor annoyance of having to remember to convert before use in programs which are expecting Sanger FASTQ. It also means that there are now three types of FASTQ files floating about; standard Sanger FASTQ with quality scores expressed as ASCII(Qphred+33), Solexa FASTQ with ASCII(Qsolexa+64) and Solexa FASTQ with ASCII(Qphred+64).

A coxtonyj:
That is a fair point. The need to convert has always been present of course. We did give this some thought at the time and as I recall the rationale was that any code (ours or others) that was expecting Qsolexa+64 would probably still work if given Qphred+64, but that the conversion to Qphred+33 was at least now just a simple subtraction. But perhaps we should have bitten the bullet and gone with Qphred+33.

Q fadista:

Default sol2sanger
Hi,

Just want to be sure here:

1 - Is the sol2sanger function of maq 0.7.1 not working for solexa pipeline 1.3?

2 - If not, how can I convert the scores that I already computed (sol2sanger of maq 0.7.1 with solexa pipeline 1.3) to the sanger phred score system?


Best regards,
Joo

</entry>



<entry [Wed May 20 16:33:09 EDT 2009] DOWNLOAD CASAVA>




https://icom.illumina.com/icom/login.ilmn
Username: syoung@med.miami.edu
Password: q$Rt&Qzu

DOWNLOADED CASAVA AND GA PIPELINE 1.4, PUT IN 04-comparison/casava




apfejes
Senior Member

Join Date: Feb 2008

I thought CASAVA was an Illumina product, as is Eland. I don't think you're missing anything - of course they want you to use their products end to end. (= On the other hand, even the WTSS SNP & Exon expression software I wrote handles more than one input format, so I think it's just Illumina trying to bring people back into the Eland fold.

Frankly, there are so many SNP callers out there, until I see some solid reason to switch to CASAVA (and back to Eland), its not even on my radar.


 coxtonyj
Junior Member

Join Date: Apr 2008
Location: Cambridge, UK
Posts: 8
	
Hi apfejes

Disclaimer: I work at Illumina and am one of the developers of CASAVA, but these are my personal opinions.

As I see it, the beauty of sequencing data is that once you've got it into As,Cs,Gs and Ts it becomes a 'commodity item' and I think trying to compete with the combined brainpower of the entire sequencing community by trying to 'lock users in' beyond that stage would be extremely tough, and it's not clear to me if we would gain much by doing so.

CASAVA is more meant to make it easier to process datasets on 'human genome resequencing' scales - a human genome at say 30x sequence coverage presents logistical issues beyond those associated with, say, a ChipSeq dataset of a couple of Gbases (and I in no way wish to trivialize those, I know this is already a dauntingly large dataset in many ways) and now we are not so far away from "1 run (from whatever platform) = 1 genome" we don't want these to stand in the way of the science. Ideally algorithm developers would be able concentrate on algorithms and not file formats and so forth.

The idea is that 'under the hood' CASAVA handles the necessary sorting, binning and filtering of reads. SNP callers and other downstream applications then access the alignment data they need by making function calls to a library.

The software evolved from the code we used for our Yoruba genome analysis and can be used as a standalone genome analysis tool. The currently released version only includes the SNP calling module but internally we have modules for e.g. short indel and structural variant detection that we are looking to move towards release. CASAVA is also used as a backend to provide input data for the Genome Studio software we are releasing.

I would actually be very happy if people were to use CASAVA to process MAQ and/or BowTie data and I imagine it would be quite straightforward to write a parser, lack of time is the only reason we haven't looked at this ourselves.

Cheers

Tony


</entry>



<entry [Wed May 20 16:57:56 EDT 2009] SHORT READ FORMAT>



http://srf.sf.net/

illumina2srf and srf2illumina utilities 
http://www.illumina.com/pagesnrn.ilmn?ID=84

Q1. What is SRF?
      A1. SRF (Single Read Format) is a generic format for DNA sequence data. Some public sequence databases, such as NCBI, require that you post data from published manuscripts and other sequencing projects using SRF. The format is defined at http://srf.sf.net.
Q2. What is the illumina2srf utility and what does it do?
      A2. The Illumina2srf utility converts analyses from Genome Analyzer Pipeline Analysis Software to SRF. It can create simple SRF archives containing only sequences and quality values. It is also capable of creating SRFs with raw intensity and noise values. If these values are stored, the SRF file is significantly larger (~8X larger), but this allows base calling to be rerun from the archived files. Note: Intensity and noise values are stored in SRF with one less significant digit than is contained in the original pipeline files.

      illumina2srf runs in Genome Analyzer Pipeline Analysis Software and produces SRF files containing sequences and quality values from the standard pipeline output files. Using Illumina2srf can be specified as part of the GERALD config file:

      SRF_ARCHIVE_REQUIRED yes

      Or from the command line:

      For Genome Analyzer Pipeline Analysis Software v1.3:

      ${PipelineDir}/bin/illumina2srf -o lane_${lane_no}.srf
      ${BustardDir}/s_${lane_no}_*_qseq.txt

      For Genome Analyzer Pipeline Analysis Software v1.0:

      ${BustardDir}/s_${lane_no}_*_seq.txt

      where ${PipelineDir} is the root location of the Genome Analyzer pipeline, ${BustardDir} is the bustard directory of the run to be archived, and ${lane_no} is the number of the lane to archive from this run.

      To include intensity and noise values in the archive, include the "-b" flag:

      ${PipelineDir}/bin/illumina2srf -b -o lane_${lane_no}.srf
      ${BustardDir}/s_${lane_no}_*_qseq.txt
Q3. What is the srf2illumina utility and what does it do?
      A3. The srf2illumina utility unpacks SRF files from Genome Analyzer Pipeline Analysis Software into multiple files. It can unpack these files into a single directory, or it can place files so as to reflect the distribution of files in a pipeline analysis directory tree.

      To unpack an SRF archive, enter:

      ${PipelineDir}/bin/srf2illumina file.srf

      To unpack an SRF archive into a pipeline directory tree, enter:

      ${PipelineDir}/bin/srf2illumina -b file.srf
Q4. How do I unpack my SRF files from public databases that were created from Illumina data?
      A4. You can unpack SRF files with the srf2illumina utility supplied with Genome Analyzer Pipeline Analysis Software.
Q5. What if I don't have the Illumina Pipeline at my disposal?
      A5. The io_lib package contains a variety of vendor-neutral SRF utilities. Download this utility from http://sourceforge.net/projects/staden/, and compile the code following the instructions provided with this distribution. To unpack the sequences and quality values from SRF file using this package, you can use the utility srf2fastq by entering the command:

      srf2fastq -c file.srf
Q6. What should I do if I get an error indicating that the program can't be found? For example:

-bash-3.1$ GAPipeline-1.3.2/bin/illumina2srf -o lane_1.srf / /Data/IPAR_1.3/Bustard1.3.2_01-03-2009/s_1_*_qseq.txt

-bash: /GAPipeline-1.3.2/bin/illumina2srf: No such file or directory
      A6. If you get this message, you should explicitly install the io_lib. To do this, run the following command from the Pipeline Install directory:

      /GAPipeline_1.3.2 make WITH_IO_LIB=1 install

      Then retry the command from Q2, above.





</entry>



<entry [Wed May 20 15:57:56 EDT 2009] MEETING WITH NICK ON PAPER>



Paper will test five aligners (criteria: correct read alignment, non-alignment for non-matching reads):

ELAND
MAQ
SOAP
Mosaik
SHRimP

(also Bowtie?)

At different coverages:

38X
30X
20X
10X
5X


On reads from these genomes:

NA18507 genome
X chromosome
other deep-coverage SRA genomes


Paper will then evaluate SNP callers:

MAQ             
CASSAVA         
SSAHASNP        http://www.sanger.ac.uk/Software/analysis/ssahaSNP/
PolyBayesShort  http://bioinformatics.bc.edu/marthlab/PbShort


Later:

Create an application for detecting large chromosomal rearrangments using different sets of reads (paired with varying insert, single)






</entry>



<entry [Tues May 19 16:40:56 EDT 2009] NA18507 SOLEXA AND SOLID DOWNLOADS + MAQ OUTPUTS>



NEXT GENERATION VIRTUAL ISSUE
http://www.oxfordjournals.org/our_journals/bioinformatics/nextgenerationsequencing.html

INFO FROM THIS Li Heng PAGE:
http://www.sccas.cn/~nbf/resources.htm




IN REPLY TO THE SEQANSWERS PAGE ON NEXTGEN ASSEMBLERS: http://seqanswers.com/forums/showthread.php?t=43

#  NA18507, by Illumina/Solexa:  ftp://ftp.ncbi.nih.gov/pub/TraceDB/ShortRead/SRA000271
#  NA18507, by AB SOLiD: ftp://ftp.ncbi.nih.gov/pub/TraceDB/ShortRead/SRA000272
#  1000 Genomes Project. MAQ alignment: ftp://ftp.sanger.ac.uk/pub/1000genomes
#  Latest release:  ftp://ftp-trace.ncbi.nih.gov/1000genomes/release/2009_04/

GET DOWN THE SOLID DATA FOR NA18507 ON pluto:

/nethome/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.ncbi.nih.gov/pub/TraceDB/ShortRead/SRA000272 --outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/SRA000272

    RUNNING Tue May 19 16:43:02 EDT 2009

SOME REFERENCE ASSEMBLERS

    * MAQ (Mapping and Assembly with Qualities). For Illumina and SOLiD only. My own software.
    * ELAND (Efficient Large-Scale Alignment of Nucleotide Databases), by Anthony J. Cox at Illumina. For Illumina data only. This is the software in GAPipeline (previously known as SolexaPipeline). It is incredibly fast. I learnt a lot from this masterpiece when I was mentally designing MAQ. The latest ELAND in GAPipeline-0.3.0 is able to find multiple hits. Other programs in the pipeline can calculate MAQ-like mapping qualities.
    * SOAP (Short Oligonucleotide Alignment Program), by Ruiqiang Li at the Beijing Genomics Institute. For Illumina data only. Published in Bioinformatics [PMID: 18227114]. So far as I know, this is the first peer-reviewed software that is specifically designed for short reads. SOAP is featured as gapped alignment. Apparently, it resembles SSAHA2 in its indexing the reference genome, resembles ELAND in its 4-segment seeding and resembles MAQ in its random mapping.
    * RMAP, by Andrew D. Smith and Zhenyu Xuan at CSHL. For Illumina data only. Published in BMC Bioinformatics [PMID: 18307793]. RMAP makes use of base qualities to improve the accuracy of alignments. The authors compared RMAP with MAQ and concluded that RMAP is much more accurate. However, they ignore MAQ's mapping qualities, which is unfair.
    * SSAHA2 (Sequence Search and Alignment by Hashing Algorithm), by Adam Spargo and Zemin Ning at the Sanger Institute. For Illumina, 454 and capillary data. This is one of the leading alignment programs at the age of capillary sequencing, and it still works elegantly with both short and long reads. However, being generic slows SSAHA down. Short read specific softwares like ELAND is faster.
    * Mosaik, by Michael Strmberg at Boston College. For Illumina, 454 and capillary data. This is the software used in a recent Nature Methods paper by LaDeana et al.
    * GMAP, by Thomas D Wu at the department of bioinformatics Genentech, Inc. For Illumina, 454 and capillary data. A great software from its paper, but I am not quite sure how it performs on Illumina/Solexa data. NCGR uses this software in its Alpheus commercial package.
    * SHRiMP (SHort Read Mapping Package), by Stephen Rumble and Michael Brudno at the University of Toronto. For Illumina and SOLiD only. SHRiMP uses q-gram filters to map reads. Aha, q-gram filtering was my second best choice when I was planning MAQ algorithm. A really promising candidate, but at the moment (2008-02-06), it seems that SHRiMP is not as fast as ELAND or MAQ.
    * Myrialign by Paul Harrison.
    * SRMA by Beifang Niu. For Illumina/SOLiD only.
    * xMAN by Wei Li et al. For oligonucleotide alignment. Published in BMC Genomics [PMID:18366610].
    * PatMaN by Kay Prfer et al. For oligonucleotide alignment and short reads. Published in Bioinformatics [online].


MORE ASSEMBLERS ON SEQANSWERS:
http://seqanswers.com/forums/showthread.php?t=43

Euler-SR (Euler-Short Reads Assembly, http://euler-assembler.ucsd.edu/portal/) by Mark J. Chaisson and Pavel A. Pevzner from UCSD. (published in Genome Research)
RMAP (A program for mapping Solexa reads, http://rulai.cshl.edu/rmap/) by Andrew D. Smith and Zhenyu Xuan at CSHL. (published in BMC Bioinformatics)



 How are people making use of outputs from various tools?

For instance
soap has this one line format with its way of representing variation
shrimp seems even more complicated with a fasta line format not even mentioning where the substitutions / indels are ... even if you look at the prettyplot

Any views on visualizing the data on global scale .. giving an indication of depth of sequencing at various regions on the reference, % variation... etc?
bioinfosm is offline   	Reply With Quote


A FEJES
 To answer the part on visualization, I have several tools that create files that are viewable on the UCSC genome browser. or generate a text file showing the aligned reads against the canonical sequence. I now even have a tool for generating post script files of peaks (for Chip-Seq experiments) along entire chromosomes.

The question is really what you're looking for. It's easy to visualize this data, but very hard to create new views that give new insight.





</entry>



<entry [Mon May 18 16:05:56 EDT 2009] TO DO LIST FOR PAPER>




1. GENERATE NA18507 GENOME FROM HUMAN GENOME 36.3 AND SNP & INDEL FILES

    - USE ERROR RATE IN Harismendy PAPER EXTRAPOLATED BASED ON COVERAGE

    - EXCLUDE ALL SNPS BELOW ERROR RATE PERCENTILE IN QUALITY SCORE

    - CALCULATE THE 20th PERCENTILE SCORE FOR THE SNPs FILE

    - DISCARD ANY SNPS WITH QUALITY VALUES <= 81 (THIS SHOULD LEAVE US WITH A FILE CONTAINING 20% LESS SNPS.)

    - CALCULATE THE 5th PERCENTILE SCORE FOR THE INDELS FILE

    - DISCARD INDELS WITH QUALITY VALUES <= 23 
    
    - APPLY THESE SNPS TO HUMAN GENOME 36.3 TO GENERATE NA18507 DIPLOID GENOME



2. CONVERT GENOME INTO SEQUENCE-ONLY CHROMOSOME FILES

/nethome/syoung/base/bin/comparison/chromosomeSequences.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/human-genome/genome.fa \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes
    
    Run time: 00:03:56
    Completed /nethome/syoung/base/bin/comparison/chromosomeSequences.pl
    1:01PM, 19 May 2009
    ****************************************



3. CONVERT snp AND indel FILES INTO CHROMOSOME-SPECIFIC FILES

/nethome/syoung/base/bin/utils/columnSplit.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-20pct-filtered.snp \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes \
--prefix chr \
--suffix snp \
--column 1

    Run time: 00:00:34
    Completed /nethome/syoung/base/bin/utils/columnSplit.pl
    1:17PM, 19 May 2009
    ****************************************

/nethome/syoung/base/bin/utils/columnSplit.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-5pct-filtered.indel \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes \
--prefix chr \
--suffix indel \
--column 1

    Run time: 00:00:02
    Completed /nethome/syoung/base/bin/utils/columnSplit.pl
    1:17PM, 19 May 2009
    ****************************************



4. MOVE THE NT_*** FILES TO chrNT DIRECTORY

rm -fr /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chrNT
mkdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chrNT
cd /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes
mv chrNT* chrNT


5. FOR EACH CHROMOSOME FILE, CONVERT USING snp AND indel FILES

mkdir -p /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507

/nethome/syoung/base/bin/comparison/convertChromosomes.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507

        ...
        /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chrY.fa
        
        Finished Genome::convert_indels()
        Printed output file:
        
        /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chrY.fa
        
        Run time: 00:00:03
        Completed /home/syoung/base/bin/comparison/convertChromosome.pl
        10:12AM, 19 May 2009
        ****************************************    
    
    Run time: 00:03:53
    Completed /nethome/syoung/base/bin/comparison/convertChromosomes.pl
    1:23PM, 19 May 2009
    ****************************************



6. ADD THE MITOCHONDRIAL GENOME

cd /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507

wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_MT/hs_ref_chrMT.fa.gz
gunzip hs_ref_chrMT.fa.gz
mv hs_ref_chrMT.fa chrMT.fa

    OK

    

7. FOR EACH CHROMOSOME FILE, SQUASH CHROMOSOME FILES

rm -fr /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed

/nethome/syoung/base/bin/comparison/squashChromosomes.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed

    Run time: 00:00:41
    Completed /nethome/syoung/base/bin/comparison/squashChromosomes.pl
    1:49PM, 19 May 2009
    ****************************************





8. GENERATE RANDOMLY SELECTED SET OF READS FROM MULTIPLE DIRECTORIES OF READ FILES

SEPARATE ILLUMINA NA18507 READS INTO THREE POOLS:

1) PAIRED END SHORT 200 BP INSERT

2) PAIRED END LONG 2000 BP INSERT

3) SINGLE READS (FIRST READS OF 1 AND 2 ABOVE)


    Insert  Accession	Spots	Bases
    200bp    SRX000600	1.5G	209.0G
    200bp   SRX000601	26.4M	3.9G
    200bp   SRX000602	121.7M	18.0G
    200bp   SRX000603	55.9M	9.2G
    2kb	    SRX001539	52.0M	7.5G  **** LONG
    2kb	    SRX001540	96.1M	13.8G **** LONG
    Total:      6		1.8G	261.3G



    1. CREATE INDEX FILES WITH NUMBERS OF READS AND READ POSITIONS IN BYTES
    
    2. SCAN ALL INDEX FILES TO GET CUMULATIVE COUNT OF LINES --> PUT IN MEMORY
    
    3. RANDOMLY SELECT ANY LINE --> SCAN MEMORY FOR INDEX FILE, SCAN INDEX FILE FOR READ
    
    4. EXTRACT READ AND PLACE IN OUTPUT FILE
    
    5. CONVERT READ FILE TO FASTA FORMAT FOR INPUT INTO eland.pl 


#### PROBLEM WITH CLUSTER...?

#####GENERATE READ .fasta FILES WITHOUT UNZIPPING .fastq.gz FILES:
#####
#####/nethome/syoung/base/bin/comparison/readsFasta.pl \
#####--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
#####--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
#####--compress gzip \
#####--cluster \
#####--queue "-q psmall" \
#####--dot 10 
#####
#####
#####WHICH RUNS clusterSubmit.pl:
#####
#####/home/syoung/base/bin/comparison/../utils/clusterSubmit.pl --queue "-q psmall" \
#####> --scriptfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR002308_2.fastq.gz.sh \
#####> --outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
#####> --command "/home/syoung/base/bin/comparison/../nextgen/fastq2fasta.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR002308_2.fastq.gz --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002308_2.fasta --dot 100000
#####
#####
#####WHICH RUNS fastq2fasta.pl ON THE CLUSTER:
#####
#####/nethome/syoung/base/bin/nextgen/fastq2fasta.pl \
#####--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.fastq.gz \
#####--outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.fasta \
#####--dot 10000 \
#####--compress gzip
#####    
#####


SCRIPTFILE CREATED BY readsFasta.pl USING --cluster OPTION:
emacs /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR004107_2.fastq.gz.sh
*****************************************************
#!/bin/sh                                                                                                                                                                         

HOST=`hostname`
echo $HOST

echo "/home/syoung/base/bin/comparison/../nextgen/fastq2fasta.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR004107_2.fastq.gz --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR004107_2.fasta --dot 100000 --compress gzip"
cd /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta;
echo `pwd`;

/home/syoung/base/bin/comparison/../nextgen/fastq2fasta.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR004107_2.fastq.gz --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR004107_2.fasta --dot 100000 --compress gzip

echo "Completed."
*****************************************************


COMMAND TO RUN readsFasta.pl ON CLUSTER:

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--compress gzip \
--cluster \
--queue "-q psmall" \
--dot 10 


*****************************************************



RUN readsFasta.pl ON MENDEL1, 0600:
----------------------------------

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--compress gzip \
--dot 10 &

    /nethome/syoung/base/bin/comparison/readsFasta.pl --inputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 --outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta --compress gzip --dot 10 &
    [3] 5138
    [syoung@mendel1 bin]$ executable: /mihg/users/syoung/base/bin/comparison/../nextgen/fastq2fasta.pl
    No. files: 374
    0
    /mihg/users/syoung/base/bin/comparison/../nextgen/fastq2fasta.pl --inputfile /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/SRR002272_1.fastq.gz --outputfile /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta/SRR002272_1.fasta --dot 100000 --compress gzip



RUN readsFasta.pl ON MENDEL2, 0603:
-----------------------------------

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603 \
--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603/fasta \
--compress gzip \
--dot 10 &

    Run time: 01:01:03
    Completed /nethome/syoung/base/bin/comparison/readsFasta.pl
    6:46AM, 22 May 2009
    ****************************************



RUN readsFasta.pl ON MENDEL3, 0601, 1540:
-----------------------------------------

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601 \
--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta \
--compress gzip \
--dot 10 &

    OK

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540 \
--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--compress gzip \
--dot 10 &

    Run time: 01:24:44
    Completed /nethome/syoung/base/bin/comparison/readsFasta.pl
    7:45AM, 22 May 2009
    ****************************************



RUN readsFasta.pl ON MENDEL4, 0602, 1539:
----------------------------------------


/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602 \
--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta \
--compress gzip \
--dot 10 &

    OK    

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539 \
--outputdir /data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--compress gzip \
--dot 10 &

    OK



USING pack TO GENERATE INDEX FILES:

/nethome/syoung/base/bin/comparison/indexFasta.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.fasta.gz --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.index --dot 10000 --fixed

    /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.index
    Run time: 00:00:06
    Completed /nethome/syoung/base/bin/comparison/indexFasta.pl
    11:47AM, 23 May 2009
    ****************************************

ll /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.index
    -rw-rw----+ 1 syoung bioinfo 22M May 23 11:40 /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.index


    
    /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.index.text
    Run time: 00:00:04
    Completed /nethome/syoung/base/bin/comparison/indexFasta.pl
    12:19AM, 23 May 2009
    *************************************


ll /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.index.text
-rw-rw----+ 1 syoung bioinfo 22M May 23 12:12 /mihg/data/NGS/syoung/base/pipeline/SRA/test/test.index.text





REDO ALL FASTA WITH FIXED WIDTHS:
---------------------------------

SRX001540

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540/fasta \
--cluster \
--queue "-q psmall" \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 

    
KILL ALL JOBS
-------------

kill -9 `ps aux | grep syoung | cut -f 5  -d " "` 




SRX000600

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600/fasta \
--cluster \
--queue "-q psmall" \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 



SRX000601

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601/fasta \
--cluster \
--queue "-q psmall" \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 


SRX000602

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602/fasta \
--cluster \
--queue "-q psmall" \
--compress gzip \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 



SRX0000603

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX0000603 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX0000603/fasta \
--cluster \
--queue "-q psmall" \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 



SRX001539

/nethome/syoung/base/bin/comparison/readsFasta.pl \
--inputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539 \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539/fasta \
--cluster \
--queue "-q psmall" \
--fixed \
--id_length 21 \
--sequence_length 36 \
--dot 10 




9. GENERATE MAPPING POSITIONS FOR SELECTED READS

    1. RUN ELAND AGAINST GENOME WITH SOME READS

/nethome/syoung/base/bin/nextgen/elandChromosomes.pl \

/nethome/syoung/base/bin/nextgen/cluster-eland.pl \
--inputfile /data/NGS/syoung/base/pipeline/SRA/eland/reads1.fasta \
--outputfile /data/NGS/syoung/base/pipeline/SRA/eland/reads1-chr1.eland \
--refdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chr1/squashed \
--length 32 \
--multi


    WHICH RUNS ON EACH CHROMOSOME:

/nethome/syoung/base/bin/nextgen/cluster-eland.pl \
--inputfile /data/NGS/syoung/base/pipeline/SRA/eland/reads1.fasta \
--outputfile /data/NGS/syoung/base/pipeline/SRA/eland/reads1-chr1.eland \
--refdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chr1/squashed \
--length 32 \
--multi


    1. IDENTIFY UNIQUE MATCHES ACROSS WHOLE GENOME - LABEL 'U', STORE MATCH LOCATIONS IN FASTA ID

    2. IDENTIFY MULTIPLE MATCHES ACROSS WHOLE GENOME - LABEL 'M', STORE MATCH LOCATIONS IN FASTA ID
    
    3. DISCARD FIRST TWO BASES AND LAST TWO BASES OF UNMATCHED READS

    4. USE ELAND AND/OR BLAT ON UNMATCHED READS TO SEE HOW MANY MATCH UNIQUELY WITH 90% IDENTITY
        
        CHOP EDGES???

    5. LABEL UNIQUE 'SU' AND MULTIPLE 'SM' MATCHES, STORE MATCH LOCATIONS IN FASTA ID

    6. KEEP UNMAPPED READS - LABEL 'N'
    
    





</entry>



<entry [Fri May 8 14:17:56 EDT 2009] TO DO LIST FOR PAPER>



1. GENERATE NA18507 GENOME FROM HUMAN GENOME 36.3 AND SNP & INDEL FILES

    - USE ERROR RATE IN Harismendy PAPER EXTRAPOLATED BASED ON COVERAGE

        Figure 5 - 40X coverage corresponds to a simulated false positive rate of 0.2
                -   "   "           "       "  "     "     false negative rate of 0.02
                    (i.e., we'll miss 2% of all SNPs at 40X coverage)


    - EXCLUDE ALL SNPS BELOW ERROR RATE PERCENTILE IN QUALITY SCORE

        So, exclude all SNPs with quality scores in the 20th percentile or less
            

    - FIRST, CALCULATE THE 20th PERCENTILE SCORE FOR THE SNPs FILE
    
        NA18507.snp.gz
        ==============
        1	469	C	S	63	44	2.56	63	62	C	130	G
        1	18455	T	K	48	20	2.31	63	34	G	3	T
        1	18456	T	K	35	21	2.56	63	48	G	46	T
        1	45027	C	A	38	14	2.12	63	48	M	9	C
        1	45162	C	Y	128	76	1.44	63	62	T	47	C
        1	51305	A	G	75	16	2.38	63	62	N	81	N
        1	51325	T	W	145	62	1.62	63	62	A	27	T
        
        COLUMNS ARE AS FOLLOWS: 
            1. chromosome
            2. position
            3. reference base
            4. consensus base
            5. ***Phred-like consensus quality***
            6. read depth
            7. the average number of hits of reads covering this position
            8. the highest mapping quality of the reads covering the position
            9. the minimum consensus quality in the 3bp flanking regions at each side of the site (6bp in total)
            10. the second best call
            11. log likelihood ratio of the second best and the third best call
            12. the third best call.
        

        /nethome/syoung/base/bin/utils/columnPercentile.pl --column 5  --percentile 20  --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp.20pct.score
        
            /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp.20pct.score
            Run time: 00:00:32
            Completed /nethome/syoung/base/bin/utils/columnPercentile.pl
            10:11PM, 10 May 2009
            ****************************************
            
            
        cat /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp.20pct.score
            81
        
        lines /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp
            4192779
        
        SO 81 IS THE 20TH PERCENTILE QUALITY VALUE.

    - DISCARD ANY SNPS WITH QUALITY VALUES <= 81. THIS SHOULD LEAVE US WITH A FILE CONTAINING 20% LESS SNPS.


        /nethome/syoung/base/bin/utils/columnFilter.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-20pct-filtered.snp --column 5 --operator ">" --threshold 81

            /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-20pct-filtered.snp
            Run time: 00:00:32
            Completed /nethome/syoung/base/bin/utils/columnFilter.pl
            10:40PM, 10 May 2009
            ****************************************
                
        lines /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-20pct-filtered.snp
            3350169
        

        REDUCED FROM 4.2 MILLION SNPS TO 3.35 SNPS, WHICH IS THE CORRECT NUMBER OF SNPS LEFT (I.E., 20% HAVE BEEN REMOVED)


    - DO THE SAME FOR THE INDELS, USING 5th PERCENTILE CUTOFF

        Bentley et al. 2008 

        This genome from a Yoruba individual contains significantly more
        polymorphism than a genome of European descent. The autosomal
        heterozygosity (p) of NA18507 is 9.9431024 (1 SNP per 1,006 bp),
        higher than previous values for Caucasians (7.631024, ref. 12).
        Heterozygosity in the pseudoautosomal region 1 (PAR1) is substantially
        higher (1.9231023) than the autosomal value. PAR1 (2.7 Mb)
        at the tip of the short arm of chromosomes X and Y undergoes
        obligatory recombination in male meiosis, which is equivalent to
        203 the autosome average. This illustrates a clear correlation
        between recombination and nucleotide diversity. By contrast, the
        0.33-Mb PAR2 region has a much lower recombination rate than
        PAR1; we observed that heterozygosity in PAR2 is identical to that
        of the autosomes in NA18507. Heterozygosity in coding regions is
        lower (0.5431023) than the total autosome average, consistent with
        the model that some coding changes are deleterious and are lost as the
        result of natural selection22. Nevertheless, the 26,140 coding SNPs
        (Supplementary Fig. 15) include 5,361 non-conservative amino acid
        substitutions plus 153 premature termination codons
        (Supplementary Table 9), many of which are expected to affect protein
        function.
        We performed a genome-wide survey of structural variation in this
        individual and found excellent correlation with variants that had
        been reported in previous studies, as well as detecting many new
        variants.
        
        ******
        We found 0.4 million short indels (116 bp;
        Supplementary Fig. 16), most of which are length polymorphisms
        in homopolymeric tracts of A or T. Half of these events are corroborated
        by entries in dbSNP, and 95 of 100 examined were present in
        amplicons sequenced from this individual in ENCODE regions, confirming
        the high specificity of this method of short indel detection.
        ******
    
        NA18507.indel.gz
        ================
        1       709353  */+ATAAT        16
        1       741363  */+AT   45
        1       757983  */-TTG  13
        1       768166  +CT/+CT 373
        1       770921  -C/*    723
        1       776933  */-AG   114
        1       780560  +AT/+AT 879
        1       780622  */-TA   437
        1       783192  */+T    175
        1       783277  */+AT   196
        
        COLUMNS ARE AS FOLLOWS:
        
        1. chromosome
        2. position
        3. genotype
        4. score. The higher the score the more reliable the call.
            
        /nethome/syoung/base/bin/utils/columnPercentile.pl --column 4  --percentile 5  --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel.5pct.score
            
            /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel.5pct.score
            Run time: 00:00:03
            Completed /nethome/syoung/base/bin/utils/columnPercentile.pl
            9:25PM, 11 May 2009
            ****************************************
        
            cat /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel.5pct.score
            
                23
                # /nethome/syoung/base/bin/utils/columnPercentile.pl --column 4 --percentile 5 --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel.5pct.score    
        
            SO THE SCORE CUTOFF FOR THE 5TH PERCENTILE IS 23

        /nethome/syoung/base/bin/utils/columnFilter.pl --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-5pct-filtered.indel --column 4 --operator ">" --threshold 23

            /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-5pct-filtered.indel
            Run time: 00:00:03
            Completed /nethome/syoung/base/bin/utils/columnFilter.pl
            9:30PM, 11 May 2009
            ****************************************

        lines /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-5pct-filtered.indel
            473588
        lines /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.indel
            499208

        REDUCED FROM 499,000 TO 473,000 - I.E., 5% HAVE BEEN REMOVED
    
    - APPLY THESE SNPS TO HUMAN GENOME 36.3 TO GENERATE NA18507 DIPLOID GENOME

        NUCLEOTIDE SYMBOLS
        http://www.mun.ca/biochem/courses/3107/symbols.html

        * = FOUND IN NA18507.snp FILE

        A		A	adenine
        C		C	cytosine
        G		G	guanine
        T		T	thymine
        U		U	uracil
                    
        *R		A or G	purine
        *Y		C or T (U)	pyrimidine
        *M		A or C	amino
        *K		G or T (U)	keto
        *S		C or G	strong (3 H bonds)
        *W		A or T (U)	weak (2 H bonds)
        B		C or G or T (U)	not A
        D		A or G or T (U)	not C
        H		A or C or T (U)	not G
        V		A or C or G	not T (U)
        N		A or C or G or T (U)	any nucleotide


        GET UNIQUE VALUES FOR CONSENSUS BASE
        
        /nethome/syoung/base/bin/utils/columnUniqueValues.pl --column 4  --inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp --outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp.unique-consensus
        
            /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp.unique-consensus
            Run time: 00:00:30
            Completed /nethome/syoung/base/bin/utils/columnUniqueValues.pl
            11:13PM, 10 May 2009
            ****************************************
            
            cat /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507.snp.unique-consensus

            W       196469  A or T weak (2 H bonds)
            K       227208  G or T keto
            M       227829  A or C amino
            S       228517  C or G strong (3 H bonds)
            A       352022
            T       352103
            G       401777  
            C       401833
            R       902400  A or G	purine
            Y       902621  C or T  pyrimidine
        

        CONVERT HUMAN GENOME 36.3 TO NA18507 GENOME USING SNPs
        
/nethome/syoung/base/bin/comparison/convertGenome.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/human-genome/genome.fa \
--outputdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/genome \
--snpfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-20pct-filtered.snp \
--indelfile /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-5pct-filtered.indel

	...
	Run time: 22:00:04
	Completed /nethome/syoung/base/bin/comparison/convertGenome.pl
	10:05PM, 14 May 2009
	****************************************



    ...    
    Sequence length: 247249719
    INDEL file found: /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/genome/chr1.indel
    Left +GG != -G Right
    Left +A != +AA Right
    Left -G != -GG Right
    Left -GG != -G Right
    Left +A != -AAA Right
    Left -T != -TT Right
    Left -GTGT != -GT Right
    Left -TT != -T Right
    Left +A != +AA Right
    Left +C != -C Right
    Left -T != -TT Right
    Left +AT != +ATAT Right
    Left +ACACA != +A Right
    Left -A != -AA Right
    Left -TT != -TTT Right
    Left +CC != +C Right
    Left +T != +TT Right
    Left +C != +CC Right
    Left -T != -TT Right
    Left +TT != -T Right
    Left +AA != +A Right
    Left -T != -TT Right
    Left -T != +T Right
    Left -A != -AA Right
    Left +C != +TC Right
    Left -A != -AA Right
    Left -TT != -T Right
    Left -CCCCCCCC != -CC Right
    Left -T != +T Right
    Left -T != -TT Right
    Left -TTTTTTTT != -TTTTTTTTT Right
    Left -A != -AA Right
    Left +A != -A Right
    Left +T != +TT Right
    Left -A != +AA Right
    Left -T != +TT Right
    ...
    



        NOTE: SOME ISSUES WITH THE 'INDELS':
        
            1. MANY INDELS RESULT IN NO CHANGE, E.G.:
                1 6490831 +GGG/+GGG

                THESE ARE IGNORED.

            2. MANY INDELS HAVE REFERENCE BASES THAT DON'T CORRESPOND TO THE 36.3 GENOME SEQUENCE
                        
                THESE ARE USED - THE CONSENSUS BASES ARE SUBSTITUTED INTO THE CHROMOSOME SEQUENCE.
                RATIONALE: MAY BE SOME DIFFERENCES BETWEEN 

                


                SOLUTION: The March 2006 human reference sequence (NCBI Build 36.1) was used (p.44 of Bentley
                et al. Supplementary).
                
                http://www.ncbi.nlm.nih.gov/genome/guide/human/release_notes.html
                http://www.ncbi.nlm.nih.gov/mapview/stats/BuildStats.cgi?taxid=9606&build=36&ver=1
                
                DOWNLOAD NCBI 36.1
                ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/README

                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_01/hs_ref_chr1.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_02/hs_ref_chr2.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_03/hs_ref_chr3.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_04/hs_ref_chr4.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_05/hs_ref_chr5.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_06/hs_ref_chr6.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_07/hs_ref_chr7.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_08/hs_ref_chr8.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_09/hs_ref_chr9.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_10/hs_ref_chr10.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_11/hs_ref_chr11.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_12/hs_ref_chr12.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_13/hs_ref_chr13.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_14/hs_ref_chr14.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_15/hs_ref_chr15.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_16/hs_ref_chr16.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_17/hs_ref_chr17.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_18/hs_ref_chr18.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_19/hs_ref_chr19.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_20/hs_ref_chr20.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_21/hs_ref_chr21.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_22/hs_ref_chr22.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_X/hs_ref_chrX.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_Y/hs_ref_chrY.fa.gz
                wget ftp://ftp.ncbi.nih.gov/genomes/H_sapiens/ARCHIVE/BUILD.36.1/CHR_MT/hs_ref_chrMT.fa.gz
                
                head hs_ref_chr11.fa
                >gi|51493057|ref|NT_035113.6|Hs11_35275 Homo sapiens chromosome 11 genomic contig, reference assembly
                
                CHANGE ALL HEADERS TO JUST CHROMOSOME NAME >chr11
                
                BUT FOUND THAT EACH CHROMOSOME FILE CONTAINED MULTIPLE FASTA ENTRIES, SO JUNKED THIS DATA DIR AS '36.1-old'
                
                THEN FOUND THAT BUILDS 36.1 AND 36.3 ARE IDENTICAL ASSEMBLIES...

                http://www.ncbi.nlm.nih.gov/genome/guide/human/release_notes.html#36.3assembly


        CHECK IF THESE CAN BE USED IN AN ELAND

        mkdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/squashed
        /mihg/analysis/GAPipeline-1.3.2/bin/squashGenome /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/squashed /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-genome.fa
        

PROBLEM:

USING SEQUENCE STRING IN MEMORY WAS EXTREMELY SLOW
USING Tie::File ON INDIVIDUAL CHROMOSOMES RAN OUT OF MEMORY

SOLUTION:

seek AND read THROUGH FASTA FILE - FAST AND LOW MEMORY


1. CONVERT GENOME INTO SEQUENCE-ONLY CHROMOSOME FILES

[syoung@mendel1 comparison]$
/nethome/syoung/base/bin/comparison/chromosomeSequences.pl \
--inputfile /data/NGS/syoung/base/pipeline/human-genome/genome.fa \
--outputdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes

    Printing chromosomes to sequence-only files (no fasta header)...
    chromosome: chr1
    chromosome: chr2
    ...
    chromosome: chr22
    chromosome: chrX
    chromosome: chrY
    
    Run time: 00:03:12
    Completed /nethome/syoung/base/bin/comparison/chromosomeSequences.pl
    2:59AM, 15 May 2009
    ****************************************

2. CONVERT snp AND indel FILES INTO CHROMOSOME-SPECIFIC FILES

[syoung@mendel1 comparison]$

/nethome/syoung/base/bin/utils/columnSplit.pl \
--inputfile /data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-20pct-filtered.snp \
--outputdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes \
--prefix chr \
--suffix snp \
--column 1

    Using default separator: whitespace
    Printing files with unique values in column 1...
    outfile: /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr1.snp
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr1.snp
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr2.snp
    ...
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chrNT_113877.snp
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chrNT_113899.snp
    done.
    
    Run time: 00:00:25
    Completed /nethome/syoung/base/bin/utils/columnSplit.pl
    3:29AM, 15 May 2009
    ****************************************



[syoung@mendel1 comparison]$

/nethome/syoung/base/bin/utils/columnSplit.pl \
--inputfile /data/NGS/syoung/base/pipeline/SRA/SRA000271/NA18507-5pct-filtered.indel \
--outputdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes \
--prefix chr \
--suffix indel \
--column 1

    Using default separator: whitespace
    Printing files with unique values in column 1...
    outfile: /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr1.indel
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr1.indel
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr2.indel
    ...
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chrNT_113888.indel
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chrNT_113899.indel
    done.
    
    Run time: 00:00:02
    Completed /nethome/syoung/base/bin/utils/columnSplit.pl
    3:32AM, 15 May 2009
    ****************************************


3. FOR EACH CHROMOSOME FILE, CONVERT USING snp AND indel FILES


mkdir -p /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507

/nethome/syoung/base/bin/comparison/convertChromosome.pl \
--inputfile /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr1.fa \
--snpfile /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr1.snp \
--indelfile /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/chr1.indel \
--outputfile /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chr1.fa

    
    Run time: 00:00:11
    Completed /nethome/syoung/base/bin/comparison/convertChromosome.pl
    1:26AM, 18 May 2009
    ****************************************



4. SQUASH CHROMOSOME FILES

mkdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed
/mihg/analysis/GAPipeline-1.3.2/bin/squashGenome /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chr1.fa

    User: 0s System: 0s Actual: 8e-06s Efficiency: 0%
    Full file path: /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chr1.fa
    Extracted file name:chr1.fa
    /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.2bpb /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.vld
    squash: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chr1.fa of size 247237623 bytes.
    finished file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/chr1.fa
    247237617 bases
    225018350 valid bases (91.013%)
    28553 valid regions
    User: 1.43209s System: 1.22008s Actual: 4.15057s Efficiency: 63.8988%



            NB: SQUASH DOES NOT RECOGNIZE NON-AGTC BASE SYMBOLS

            mkdir -p /data/NGS/syoung/base/pipeline/SRA/eland/test/squashed
            emacs /data/NGS/syoung/base/pipeline/SRA/eland/test/nonAGTC.fa
            >nonAGTC
            AAAAAAAAAAAAAAAAMMMMMMMMYYYYYYYYRRRRRRRRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGgggggggggggggggggggggggggggggggggggggggTtttttttttttttttttttttttttttttttttCCcccccccccccccccccccccccccccccccccccccccccccccccc
            
            NB: AGTC BASES
            
            AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGgggggggggggggggggggggggggggggggggggggggTtttttttttttttttttttttttttttttttttCCcccccccccccccccccccccccccccccccccccccccccccccccc
            
            /mihg/analysis/GAPipeline-1.3.2/bin/squashGenome /data/NGS/syoung/base/pipeline/SRA/eland/test/squashed /data/NGS/syoung/base/pipeline/SRA/eland/test/nonAGTC.fa
            


5. CONVERT READ FILE TO FASTA FORMAT FOR INPUT INTO eland.pl 

/nethome/syoung/base/bin/nextgen/fastq2fasta.pl \
--inputfile /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fastq \
--outputfile /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fast
--dot 100000
    
    ...
    /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta
    
    Run time: 00:05:37
    Completed /nethome/syoung/base/bin/nextgen/fastq2fasta.pl
    1:38AM, 18 May 2009
    ****************************************
    

head /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta

    >SRR002271.1 
    GTGATTAGTGAAACATAAAATAGTTTCATGTTGAAA
    ...
    

            NB: CONVERSION TO SANGER FASTQ IS MUCH SLOWER:
            
            cd /nethome/syoung/base/bin/nextgen
            ./solexa2fastq.pl \
            -i /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fastq \
            -o /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.sanger.fastq
            
                22250000
                22251000
                Output file printed:
                
                /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta
                
                Run time: 00:27:11
                Completed ./fastq2fasta.pl
                11:25PM, 17 May 2009
                ****************************************


6. RUN ELAND AGAINST GENOME WITH SOME READS

/nethome/syoung/base/bin/nextgen/eland.pl \
--inputfile /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta \
--outputfile /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.NA18507.eland \
--refdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed \
--length 32 \
--multi


    ELAND: Efficient Local Alignment of Nucleotide Data
    Copyright (c) 2003-2006 Solexa Limited. All rights reserved.
    Author: Anthony J. Cox
    
    Publications incorporating data generated by the use of
    this software or modified versions thereof should cite:
    Anthony J. Cox.
    Ultra high throughput alignment of short sequence tags.
    In preparation.
    
    WARNING: this software is compiled to process oligos of length 32.
    To change this value, edit OLIGO_LENGTH and recompile.
    
    Will use at most 25 bits in hash table
    Can process at most 2147483647 oligos per batch
    Will find all matches having 2 errors or less
    getOligoSourceFile: detected fasta format oligo file
    WARNING: first sequence of /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta contains 36 bases, but only the first 32 bases will be used in the alignment.
    To change this value, edit OLIGO_LENGTH and recompile.
    
    Starting run! Time now: Mon May 18 01:46:56 2009
    Will read oligos from file /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta
    Built MatchTableMulti: will store at most 10,10,10 0,1,2 error matches per read
    Trying to open directory /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed ...
    Sorting chromosome names
    made hash table, pointer table sizes = 0, 0
    About to build hash tables for pass 0: User: 0.004001s System: 0s Actual: 0.011576s Efficiency: 34.5629%
    partition hash table will run in split prefix mode, split is 25/7
    Setting partition hash table size to 25 bits
    partition hash table will run in split prefix mode, split is 25/7
    Setting partition hash table size to 25 bits
    counting oligos
    read 22251361 oligos from source
    Will hash 22232382 oligos
    converting count values to pointer arrays
    will place 44360077 entries in table
    will place 44360077 entries in table
    44360077 entries reduced to 44360077 entries
    44360077 entries reduced to 44360077 entries
    successful table build
    Built hash tables: User: 93.0298s System: 3.62823s Actual: 96.6708s Efficiency: 99.9868%
    Scanning file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa: User: 0s System: 0s Actual: 0.000115s Efficiency: 0%
    Starting block: 1
    FileReader: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.2bpb of size 61809408 bytes.
    squash: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.vld of size 228430 bytes.
    Comment: >chr1
    finished making FileReader
    
    
    Finishing block: 16
    ... done User: 991.202s System: 2.90418s Actual: 994.666s Efficiency: 99.9437%
    FileReader: unmapping 61809408 bytes of memory
    FileReader: unmapping 228430 bytes of memory
    made hash table, pointer table sizes = 33554434, 33554434
    About to build hash tables for pass 1: User: 0s System: 0.020002s Actual: 0.018388s Efficiency: 108.777%
    partition hash table will run in split prefix mode, split is 25/7
    Setting partition hash table size to 25 bits
    partition hash table will run in split prefix mode, split is 25/7
    Setting partition hash table size to 25 bits
    counting oligos
    read 22251361 oligos from source
    Will hash 20972632 oligos
    converting count values to pointer arrays
    will place 41873233 entries in table
    will place 41808615 entries in table
    41873233 entries reduced to 41873233 entries
    41808615 entries reduced to 41808615 entries
    successful table build
    Built hash tables: User: 93.2738s System: 2.14013s Actual: 95.4173s Efficiency: 99.9965%
    Scanning file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa: User: 0s System: 0s Actual: 8.7e-05s Efficiency: 0%
    Starting block: 1
    FileReader: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.2bpb of size 61809408 bytes.
    squash: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.vld of size 228430 bytes.
    Comment: >chr1
    finished making FileReader
    Finishing block: 16
    ... done User: 273.677s System: 0.504032s Actual: 274.174s Efficiency: 100.002%
    FileReader: unmapping 61809408 bytes of memory
    FileReader: unmapping 228430 bytes of memory
    made hash table, pointer table sizes = 33554434, 33554434
    About to build hash tables for pass 2: User: 0s System: 0.020001s Actual: 0.018373s Efficiency: 108.861%
    partition hash table will run in split prefix mode, split is 25/7
    Setting partition hash table size to 25 bits
    partition hash table will run in split prefix mode, split is 25/7
    Setting partition hash table size to 25 bits
    counting oligos
    read 22251361 oligos from source
    Will hash 20972632 oligos
    converting count values to pointer arrays
    will place 41842226 entries in table
    will place 41842226 entries in table
    41842226 entries reduced to 41842226 entries
    41842226 entries reduced to 41842226 entries
    successful table build
    Built hash tables: User: 89.4576s System: 2.16013s Actual: 91.6695s Efficiency: 99.9435%
    Scanning file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa: User: 0s System: 0s Actual: 0.000105s Efficiency: 0%
    Starting block: 1
    FileReader: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.2bpb of size 61809408 bytes.
    squash: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.vld of size 228430 bytes.
    Comment: >chr1
    finished making FileReader
    Finishing block: 16
    ... done User: 253.496s System: 0.428027s Actual: 253.932s Efficiency: 99.9967%
    FileReader: unmapping 61809408 bytes of memory
    FileReader: unmapping 228430 bytes of memory
    Will look for index file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.idx
    ... not found, will not index
    Outputting results: User: 0s System: 0.028002s Actual: 0.0218s Efficiency: 128.45%
    Info: 52061314 matches were stored
    Info: 208245256 bytes of temp storage used for oligo numbers
    Info: 208245256 bytes of temp storage used for match positions
    ... done User: 47.515s System: 5.17232s Actual: 52.9902s Efficiency: 99.4283%
    Run complete! Time now: Mon May 18 02:17:55 2009
    
    Run time: 00:31:30
    Completed /nethome/syoung/base/bin/nextgen/eland.pl
    2:18AM, 18 May 2009
    ****************************************


6. (ALTERNATIVE) SPLIT INPUT FILE INTO TWO PARTS AND THEN RUN ELAND ON KRONOS


/nethome/syoung/base/bin/nextgen/elandfasta.pl \
-i/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta
-m 12000000

    /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta.1
    /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta.2
        
    Run time: 00:00:31
    Completed /nethome/syoung/base/bin/nextgen/elandfasta.pl
    2:04AM, 18 May 2009
    ****************************************


ON KRONOS:

emacs /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.1.NA18507.eland.sh
#!/bin/sh

/nethome/syoung/base/bin/nextgen/eland.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta.1 \
--outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.1.NA18507.eland \
--refdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed \
--length 32 \
--multi


emacs /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.2.NA18507.eland.sh
#!/bin/sh

/nethome/syoung/base/bin/nextgen/eland.pl \
--inputfile /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.fasta.2 \
--outputfile /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.2.NA18507.eland \
--refdir /mihg/data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed \
--length 32 \
--multi

cd /mihg/data/NGS/syoung/base/pipeline/SRA/eland
chmod 755 *sh

qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.1.NA18507.eland.sh
qsub -q psmall /mihg/data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.2.NA18507.eland.sh

    [syoung@kronos eland]$ mshow
    
    active jobs------------------------
    JOBID              USERNAME      STATE PROCS   REMAINING            STARTTIME
    
    29133               tozgokm    Running    88    19:09:57  Sun May 17 21:33:49
    27188               abarman    Running    16  1:12:56:12  Tue May 12 15:20:04
    29070               wcooper    Running     8  2:00:21:00  Sat May 16 18:44:52
    27788              sschurer    Running    32  3:14:01:21  Thu May 14 16:25:13
    27176                 ezeng    Running     1  4:16:32:59  Sat May 16 12:56:51
    29232              famelung    Running     1  4:23:50:40  Mon May 18 02:14:31
    29233              famelung    Running     1  4:23:51:40  Mon May 18 02:15:31
    29234              famelung    Running     1  4:23:55:55  Mon May 18 02:19:46
    29237                syoung    Running     1  4:23:59:53  Mon May 18 02:23:44
    29238                syoung    Running     1  4:23:59:57  Mon May 18 02:23:48
    
    10 active jobs          150 of 232 processors in use by local jobs (64.66%)
                              19 of 29 nodes active      (65.52%)
    


lines /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.NA18507.eland
    22251361

grep -c NM /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.NA18507.eland
    16985221

head /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1.NA18507.eland
    >SRR002271.1    GTGATTAGTGAAACATAAAATAGTTTCATGTTGAAA    NM
    >SRR002271.2    GTGGGAAAAACTGAAATACATTGCTTATGGATTCAT    NM
    >SRR002271.3    TTTTCTTGATTTCATTTTAGCACAATCATTAATTAC    NM
    >SRR002271.4    TTCCATTCCATTCCATTCCATTCCAGTTGATTCCAT    0:0:2   chr1.fa:716781R2,222255279R2
    >SRR002271.5    GGAAAGGAATGGAATGGAATGGAATGGAATGGAATG    0:63:56
    >SRR002271.6    GTGGTGAACAAAGTAGGCTGCTTGGAACTGGGAAGT    NM
    >SRR002271.7    GATGGATGCTAGAGTTTGAGAAACACTGTATTGTAT    0:1:0   chr1.fa:59543580R1
    >SRR002271.8    GCTATTAGTTGATTTTTATTTTTACATAGATACACC    NM
    >SRR002271.9    TATATTCATCTGCATGTTTTAGCACTGAGATGCATG    NM
    >SRR002271.10   TGTAAGCCACTGTGCCCAGCTATAGTTGTTAACATT    NM





            NB: THE FASTA HEADER MUST ONLY HAVE ONE \S+ ENTRY, OTHERWISE ELAND WILL THINK THE REMAINING PARTS OF THE HEADER ARE THE SEQUENCE
            
            emacs  /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.fastq
            
            >SRR002271.1 
            GTGATTAGTGAAACATAAAATAGTTTCATGTTGAAA
            >SRR002271.2 
            GTGGGAAAAACTGAAATACATTGCTTATGGATTCAT
            >SRR002271.3 
            TTTTCTTGATTTCATTTTAGCACAATCATTAATTAC
            >SRR002271.4 
            TTCCATTCCATTCCATTCCATTCCAGTTGATTCCAT
            >SRR002271.5 
            GGAAAGGAATGGAATGGAATGGAATGGAATGGAATG
            >SRR002271.6 
            GTGGTGAACAAAGTAGGCTGCTTGGAACTGGGAAGT
            >SRR002271.7 
            GATGGATGCTAGAGTTTGAGAAACACTGTATTGTAT
            >SRR002271.8 
            GCTATTAGTTGATTTTTATTTTTACATAGATACACC
            >SRR002271.9 
            TATATTCATCTGCATGTTTTAGCACTGAGATGCATG
            >SRR002271.10 
            TGTAAGCCACTGTGCCCAGCTATAGTTGTTAACATT
            
            
            cd /nethome/syoung/base/bin/nextgen
            ./eland.pl \
            --inputfile /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.fastq \
            --outputfile /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.NA18507.eland \
            --refdir /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed \
            --length 30
            
                Eland: /mihg/analysis/GAPipeline-1.3.2/bin
                Eland: /mihg/analysis/GAPipeline-1.3.2/bin/eland_30
                Output directory: /data/NGS/syoung/base/pipeline/SRA/eland
                /mihg/analysis/GAPipeline-1.3.2/bin/eland_30 /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.fastq /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.NA18507.eland 
                ELAND: Efficient Local Alignment of Nucleotide Data
                Copyright (c) 2003-2006 Solexa Limited. All rights reserved.
                Author: Anthony J. Cox
                
                Publications incorporating data generated by the use of
                this software or modified versions thereof should cite:
                Anthony J. Cox.
                Ultra high throughput alignment of short sequence tags.
                In preparation.
                
                WARNING: this software is compiled to process oligos of length 30.
                To change this value, edit OLIGO_LENGTH and recompile.
                
                Will use at most 25 bits in hash table
                Can process at most 2147483647 oligos per batch
                Will find all matches having 2 errors or less
                getOligoSourceFile: detected fasta format oligo file
                WARNING: first sequence of /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.fastq contains 36 bases, but only the first 30 bases will be used in the alignment.
                To change this value, edit OLIGO_LENGTH and recompile.
                
                Starting run! Time now: Sun May 17 23:55:37 2009
                Will read oligos from file /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.fastq
                Will output assembly format match details to file /data/NGS/syoung/base/pipeline/SRA/eland/SRR002271_1-10.NA18507.eland
                Trying to open directory /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed ...
                Sorting chromosome names
                made hash table, pointer table sizes = 0, 0
                About to build hash tables for pass 0: User: 0.004s System: 0s Actual: 0.065178s Efficiency: 6.13704%
                partition hash table will run in split prefix mode, split is 25/5
                Setting partition hash table size to 25 bits
                partition hash table will run in split prefix mode, split is 25/5
                Setting partition hash table size to 25 bits
                counting oligos
                read 10 oligos from source
                Will hash 10 oligos
                converting count values to pointer arrays
                will place 20 entries in table
                will place 20 entries in table
                20 entries reduced to 20 entries
                20 entries reduced to 20 entries
                successful table build
                Built hash tables: User: 1.03207s System: 0.272017s Actual: 1.31339s Efficiency: 99.2911%
                Scanning file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa: User: 0s System: 0s Actual: 0.00069s Efficiency: 0%
                Starting block: 1
                FileReader: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.2bpb of size 61809408 bytes.
                squash: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.vld of size 1400926 bytes.
                Comment: >chr1
                finished making FileReader
                Finishing block: 16
                ... done User: 30.3459s System: 0.300018s Actual: 31.9236s Efficiency: 95.9978%
                FileReader: unmapping 61809408 bytes of memory
                FileReader: unmapping 1400926 bytes of memory
                made hash table, pointer table sizes = 33554434, 33554434
                About to build hash tables for pass 1: User: 0s System: 0.020002s Actual: 0.01821s Efficiency: 109.841%
                partition hash table will run in split prefix mode, split is 25/5
                Setting partition hash table size to 25 bits
                partition hash table will run in split prefix mode, split is 25/5
                Setting partition hash table size to 25 bits
                counting oligos
                read 10 oligos from source
                Will hash 10 oligos
                converting count values to pointer arrays
                will place 20 entries in table
                will place 20 entries in table
                20 entries reduced to 20 entries
                20 entries reduced to 20 entries
                successful table build
                Built hash tables: User: 1.04807s System: 0s Actual: 1.05057s Efficiency: 99.7617%
                Scanning file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa: User: 0s System: 0s Actual: 0.0001s Efficiency: 0%
                Starting block: 1
                FileReader: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.2bpb of size 61809408 bytes.
                squash: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.vld of size 1400926 bytes.
                Comment: >chr1
                finished making FileReader
                Finishing block: 16
                ... done User: 39.9025s System: 0.112007s Actual: 40.0204s Efficiency: 99.9852%
                FileReader: unmapping 61809408 bytes of memory
                FileReader: unmapping 1400926 bytes of memory
                made hash table, pointer table sizes = 33554434, 33554434
                About to build hash tables for pass 2: User: 0s System: 0.020001s Actual: 0.019247s Efficiency: 103.917%
                partition hash table will run in split prefix mode, split is 25/7
                Setting partition hash table size to 25 bits
                partition hash table will run in split prefix mode, split is 25/3
                Setting partition hash table size to 25 bits
                counting oligos
                read 10 oligos from source
                Will hash 10 oligos
                converting count values to pointer arrays
                will place 20 entries in table
                will place 20 entries in table
                20 entries reduced to 20 entries
                20 entries reduced to 20 entries
                successful table build
                Built hash tables: User: 1.05207s System: 0s Actual: 1.05216s Efficiency: 99.9909%
                Scanning file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa: User: 0s System: 0s Actual: 0.000584s Efficiency: 0%
                Starting block: 1
                FileReader: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.2bpb of size 61809408 bytes.
                squash: opened file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.vld of size 1400926 bytes.
                Comment: >chr1
                finished making FileReader
                Finishing block: 16
                ... done User: 39.8625s System: 0.108007s Actual: 39.9831s Efficiency: 99.9684%
                FileReader: unmapping 61809408 bytes of memory
                FileReader: unmapping 1400926 bytes of memory
                Will look for index file /data/NGS/syoung/base/pipeline/SRA/SRA000271/chromosomes/NA18507/squashed/chr1.fa.idx
                ... not found, will not index
                Outputting results: User: 0s System: 0.020001s Actual: 0.020918s Efficiency: 95.6162%
                ... done User: 0s System: 0s Actual: 0.000819s Efficiency: 0%
                Run complete! Time now: Sun May 17 23:57:33 2009
                
                Run time: 00:01:56
                Completed ./eland.pl
                11:57PM, 17 May 2009
                ****************************************
            





USE BLAT TO:

1) CHARACTERISE MIHG HUMAN NUCLEAR READS THAT DIDN'T MATCH THE 36.3 REFERENCE 

2) CHARACTERISE THE ERRORS IN THE NA18507 SEQUENCE RELATIVE TO GENERATED

    -   FLANKING REGION (GC)
    -   START POINT (ATGC)
 
 
 
</entry>



<entry [Fri May 8 14:17:56 EDT 2009] CONVERT BLAT OUTPUT TO GFF>



[syoung@solexa01 apps]$ locate blat
/store/home/syoung/base/apps/gff2aplot/bin/blat2gff.pl
/store/home/syoung/base/apps/gff2aplot/src/blat2gff.pl
/store/home/syoung/base/apps/sam/bioperl/bioperl-1.4/t/data/blat.psLayout3
/store/home/syoung/base/dev/dev/plmods/Bio-Pipeline/bioperl-pipeline/t/data/blat_dna.fa
/store/home/syoung/base/dev/dev/plmods/Bio-Pipeline/bioperl-run/t/data/blat_dna.fa
/usr/local/bin/blat2gff.pl
[syoung@solexa01 apps]$ 



</entry>



<entry [Fri May 8 11:04:56 EDT 2009] INSTALL BLAT FOR CHECKING WHICH READS MATCH REFERENCE WITH VARYING DEGREES OF IDENTITY>



REASONS FOR USING BLAT - FAST, SHORT MATCHES (WILL USE DEFAULT 11BP FRAGMENT SIZE)

1. FIGURE OUT WHAT THESE NON-ELAND HIT READS ARE UP TO

    FOR THESE SAMPLES:
    
    1) HUMAN NEUROLOGICAL DISEASE SAMPLE FROM MIHG SOLEXA (RUN 1, RUN 2)
    
    2) SRA DOWNLOADED SAMPLES FROM DIFFERENT LABS
    
    METHOD
    
    ELAND MISMATCHES --> BLAT : 1. GET PERCENTAGE WITH MORE THAN 2 ERRORS (3, 4, 5, ETC.)
                                2. GET POSITIONS OF ERRORS, ANY BIAS (5' OR 3'?)
                                3. GET GC/AT CONTENT OF MISMATCHES COMPARED TO ELAND MATCHES
                                
2. GET ERROR PROFILE FOR NA18507 READS AGAINST NA18507 CONSENSUS* TO USE IN TESTING SIMULATED READ GENERATORS LIKE metasim

* GENERATE NA18507 CONSENSUS USING DOWNLOADED SNP AND INDELS SUBSTITUTED INTO REFERENCE 36.3 HUMAN GENOME

DOWNLOAD BLAT

mkdir /nethome/syoung/base/apps/blat
cd /nethome/syoung/base/apps/blat
wget http://users.soe.ucsc.edu/~kent/src/blatSrc34.zip
unzip blatSrc34.zip
mv blatSrc v34
ls blat  gfClient  gfServer  hg  inc  jkOwnLib  lib  makefile  README  utils  webBlat

INSTALL 

1. echo $MACHTYPE
    x86_64-redhat-linux-gnu

2. Make the directory ~/bin/$MACHTYPE which is where the (non-web) executables will go.
   
   mkdir -p /nethome/syoung/base/apps/blat/v34/bin/x86_64-redhat-linux-gnu

3. Add this directory to your path.

    export PATH=/nethome/syoung/base/apps/blat/v34/bin/x86_64-redhat-linux-gnu:$PATH

4. Go to the lib directory.  If it doesn't already exist do a mkdir $MACHTYPE.

   mkdir -p /nethome/syoung/base/apps/blat/v34/lib/x86_64-redhat-linux-gnu


6. At the blatSrc directory type 'make'

make




[syoung@kronos v34]$ cat makefile 
all:
        cd lib && ${MAKE}
        cd jkOwnLib && ${MAKE}
        cd blat && $(MAKE)
        cd gfClient && $(MAKE)
        cd gfServer && $(MAKE)
        cd hg/pslPretty && $(MAKE)
        cd hg/pslReps && $(MAKE)
        cd hg/pslSort && $(MAKE)
        cd utils/nibFrag && $(MAKE)
        cd utils/faToNib && $(MAKE)
        cd utils/faToTwoBit && $(MAKE)
        cd utils/twoBitToFa && $(MAKE)
        cd utils/twoBitInfo && $(MAKE)
        cd webBlat && $(MAKE)

clean:
        rm -f */*.o */*/*.o


BLAT README

1. Unzip this to create a blatSrc directory.
2. Check that the environment variable MACHTYPE
   exists on your system.  It should on Unix.
   (And making this on non-Unix systems is beyond
   the scope of this README).  For a Linux
   system MACHTYPE will probably be 'i386', for
   and Alpha it will be 'alpha', for a Sun
   probably 'sparc'.  If necessary set up
   this environment variable.  Do this under the
   bash shell as so:
       MACHTYPE=something
       export MACHTYPE
   or under tcsh as so:
       setenv MACHTYPE something
3. Make the directory ~/bin/$MACHTYPE which is
   where the (non-web) executables will go.
   Add this directory to your path.
4. Go to the lib directory.  If it doesn't
   already exist do a mkdir $MACHTYPE.
5. If you're on an alpha system do a:
     setenv SOCKETLIB -lxnet
   on Solaris do
     setenv SOCKETLIB "-lsocket -lnsl"
   on SunOS do
     setenv SOCKETLIB "-lsocket -lnsl -lresolv"
   on Linux you can skip this step.
6. At the blatSrc directory type 'make'




</entry>



<entry [Fri May 8 11:04:56 EDT 2009] SYNTHETIC READS - ERROR FUNCTIONS>



Myers 1999 A dataset generator for whole genome shotgun sequencing
http://www.aaai.org/Papers/ISMB/1999/ISMB99-024.pdf



Evaluation of next generation sequencing platforms for population targeted sequencing studies
Harismendy et al 2009
http://genomebiology.com/2009/10/3/R32

Abstract

Background

Next generation sequencing (NGS) platforms are currently being utilized for targeted sequencing of candidate genes or genomic intervals to perform sequence-based association studies. To evaluate these platforms for this application, we analyzed human sequence generated by the Roche 454, Illumina GA, and the ABI SOLiD technologies for the same 260 kb in four individuals.
Results

Local sequence characteristics contribute to systematic variability in sequence coverage (>100-fold difference in per-base coverage), resulting in patterns for each NGS technology that are highly correlated between samples. A comparison of the base calls to 88 kb of overlapping ABI 3730xL Sanger sequence generated for the same samples showed that the NGS platforms all have high sensitivity, identifying >95% of variant sites. At high coverage, depth base calling errors are systematic, resulting from local sequence contexts; as the coverage is lowered additional 'random sampling' errors in base calling occur.
Conclusions

Our study provides important insights into systematic biases and data variability that need to be considered when utilizing NGS platforms for population targeted sequencing studies.


Background

The Sanger method [1] of sequencing by capillary electrophoresis using the ABI 3730xL platform has been employed in many historically significant large-scale sequencing projects and is considered the 'gold standard' in terms of both read length and sequencing accuracy [2]. Several next generation sequencing (NGS) technologies have recently emerged, including Roche 454, Illumina GA, and ABI SOLiD, which are able to generate three to four orders of magnitude more sequence and are considerably less expensive than the Sanger method on the ABI 3730xL platform (hereafter referred to as ABI Sanger) [2-4]. To date these new technologies have been successfully applied toward ChIP-sequencing to identify binding sites of DNA-associated proteins [5,6], RNA-sequencing to profile the mammalian transcriptome [7,8], as well as whole human genome sequencing [9-11]. Currently there is much interest in applying NGS platforms for targeted sequencing of specific candidate genes, intervals identified through single nucleotide polymorphism (SNP)-based association studies, or the entire human exome [12-15] in large numbers of individuals.

As population targeted sequencing studies are initiated, it is important to determine the issues that will be encountered in generating and analyzing data produced by NGS platforms for this application. Here, we generate 260 kb of targeted sequence in four samples using the manufacturer recommended and/or supplied sample library preparation methods, sequence generation, alignment tools, and base calling algorithms for the Roche 454, Illumina GA, and ABI SOLiD platforms (Figure 1). For each NGS technology we generated a saturating level of redundant sequence coverage, meaning that increased coverage is likely to have minimal, if any, effect on data quality and variant calling accuracies. We analyzed the sequences produced by each platform for per-base sequence coverage and for systematic biases giving rise to low coverage. We show that each NGS platform generates its own unique pattern of biased sequence coverage that is consistent between samples.

* For the short-read platforms, low coverage intervals tend to be in AT-rich repetitive sequences.

* We also performed a comparative analysis with sequence generated by the well-established ABI Sanger platform (Figure 1) to determine base calling accuracies and how average fold sequence coverage impacts base calling errors. Although the three NGS technologies correctly identify >95% of variant alleles, the average sequence coverage required to achieve this performance is greater than the targeted levels of most current studies.



maq
---


Simulation Related

    fakemut 	maq fakemut [-r mutrate] [-R indelfrac] in.ref.fasta > out.fakeref.fasta 2> out.fake.snp

    Randomly introduce substitutions and indels to the reference. Substitutions and sinlge base-pair indels can be added.

    OPTIONS:
    -r FLOAT 	Mutation rate [0.001]
    -R FLOAT 	Fraction of mutations to be indels [0.1]
    simutrain 	maq simutrain out.simupars.dat in.read.fastq

    Estimate/train parameters for read simulation.
    simulate 	maq simulate [-d insize] [-s stdev] [-N nReads] [-1 readLen1] [-2 readLen2] [-r mutRate] [-R indelFrac] [-h] out.read1.fastq out.read2.fastq in.ref.fasta in.simupars.dat

    Simulate paired end reads. File in.simupars.dat determines the read lengths and quality distribution. It is generated from simutrain, or can be downloaded from Maq website. In the output read files, a read name consists of the reference sequence name and the outer coordinates of the pair of simulated reads. By default, simulate assumes reads come from a diploid sequence which is generated by adding two different sets of mutations, including one base-pair indels, to in.ref.fasta.

    OPTIONS:
    -d INT 	mean of the outer distance of insert sizes [170]
    -s INT 	standard deviation of insert sizes [20]
    -N INT 	number of pairs of reads to be generated [1000000]
    -1 INT 	length of the first read [set by in.simupars.dat]
    -2 INT 	length of the second read [set by in.simupars.dat]
    -r FLOAT 	mutation rate [0.001]
    -R FLOAT 	fraction of 1bp indels [0.1]
    -h 	add all mutations to in.ref.fasta and generate reads from the single mutated sequence (haploid mode)

    NOTE:
    * 	Reads generated from this command are independent, which deviates from the truth. Whereas alignment evaluation is less affected by this, evaluation on SNP calling should be performed with caution. Error dependency may be one of the major causes of wrong SNP calls.
    simustat 	maq simustat in.simu-aln.map > out.simustat

    Evaluate mapping qualities from simulated reads.
    
    



random selection
----------------




EXAMPLE OF USE OF RANDOMLY SELECTED READS:

High-throughput sequence alignment using Graphics Processing
Units
Michael C Schatz*1,2, Cole Trapnell1,2, Arthur L Delcher1,2 and
Amitabh Varshney2
Published: 10 December 2007

The first test scenario was to align synthetically constructed
reads to a bacterial genome. We used synthetic
reads in order to explore MUMmerGPU's performance in
the absence of errors and over a wider variety of query
lengths then are available with genuine reads. The synthetic
test reads consisted of 50-, 100-, 200-, 400-, and
800-character substrings (uniformly randomly) sampled
from the Bacillus anthracis genome (GenBank ID:
NC_003997.3). Thus, each read exactly aligns to the
genome end-to-end at least once, and possibly more
depending on the repeat content of the genome. When
aligning each of the five sets of reads, we used l equal to
the read size for the set. Each set contained exactly
250,000,000 base pairs of query sequence divided evenly
among all the reads in the set.



metasim
-------
produces simulated metagenome reads from input genomes

RELATED TO:

genfrag.pl
http://www.mirrorservice.org/sites/download.sourceforge.net/pub/sourceforge/t/ti/tigr-closure/

celsim
OLD PROGRAM FROM 1994, UNSOPHISTICATED ERROR PROFILE?


Simulation of reads with empirical models

Using empirical data, MetaSim provides an error model for the
short reads of the Illumina technology.

As an additional feature, MetaSim includes an empirical error
model that allows the incorporation of user-defined error statistics.
The probability of an occurrence of a sequencing error often
depends on the position of the erroneous base and its surrounding
bases. The program GenFrag [35] originally developed an error

model which incorporates different error types (deletion, insertion,
substitution) at certain positions with empirical error probabilities.
MetaSim adopts this general approach. The error model is
based on mappings (error curves) that assign error rates to specific
base positions. Each mapping has three parameters (the last two
are optional):

    N type of error,
    N base at the position where the error occurs and
    N base preceding the position where the error occurs.

In this way, 48 independent mappings can be individually
determined. In addition, in case of a substitution error the user can
specify the probability of integrating a particular base depending
on the type of the base at the error position and the preceding
base.


MetaSimA Sequencing Simulator for Genomics and Metagenomics
Daniel C. Richter1*, Felix Ott1, Alexander F. Auch1, Ramona Schmid2, Daniel H. Huson1
1 ZBIT- Center for Bioinformatics Tbingen, University of Tbingen, Tbingen, Germany, 2 Boehringer Ingelheim Pharma GmbH & Co. KG, Biberach, Germany


Finally, for the construction of a realistic read data set, MetaSim includes a versatile read sequencing simulator. The user is able to choose from different (adaptable) error models of current sequencing technologies (e.g. Sanger [28], [29], Roche's 454 [7] and Illumina (former Solexa) [30]).


Abstract 
Background
The new research field of metagenomics is providing exciting insights into various, previously unclassified ecological systems. Next-generation sequencing technologies are producing a rapid increase of environmental data in public databases. There is great need for specialized software solutions and statistical methods for dealing with complex metagenome data sets.

Methodology/Principal Findings
To facilitate the development and improvement of metagenomic tools and the planning of metagenomic projects, we introduce a sequencing simulator called MetaSim. Our software can be used to generate collections of synthetic reads that reflect the diverse taxonomical composition of typical metagenome data sets. Based on a database of given genomes, the program allows the user to design a metagenome by specifying the number of genomes present at different levels of the NCBI taxonomy, and then to collect reads from the metagenome using a simulation of a number of different sequencing technologies. A population sampler optionally produces evolved sequences based on source genomes and a given evolutionary tree.

Conclusions/Significance
MetaSim allows the user to simulate individual read datasets that can be used as standardized test scenarios for planning sequencing projects or for benchmarking metagenomic software.



Dohm 2008
Substantial biases in ultra-short read data sets from high-throughput DNA sequencing

Novel sequencing technologies permit the rapid production of large sequence data sets. These technologies are likely to revolutionize genetics and biomedical research, but a thorough characterization of the ultra-short read output is necessary. We generated and analyzed two Illumina 1G ultra-short read data sets, i.e. 2.8 million 27mer reads from a Beta vulgaris genomic clone and 12.3 million 36mers from the Helicobacter acinonychis genome. We found that error rates range from 0.3% at the beginning of reads to 3.8% at the end of reads. Wrong base calls are frequently preceded by base G. Base substitution error frequencies vary by 10- to 11-fold, with A > C transversion being among the most frequent and C > G transversions among the least frequent substitution errors. Insertions and deletions of single bases occur at very low rates. When simulating re-sequencing we found a 20-fold sequencing coverage to be sufficient to compensate errors by correct reads. The read coverage of the sequenced regions is biased; the highest read density was found in intervals with elevated GC content. High Solexa quality scores are over-optimistic and low scores underestimate the data quality. Our results show different types of biases and ways to detect them. Such biases have implications on the use and interpretation of Solexa data, for de novo sequencing, re-sequencing, the identification of single nucleotide polymorphisms and DNA methylation sites, as well as for transcriptome analysis.

Perl scripts:

    - Generated 12.288 million 36-mer reads from Helicobacter acinonychis on an Illumina 1G sequencing device
        - The Helicobacter genome is 1.55 Mbp in size and has a GC content of 38%.
        - A high-quality reference sequence for Helicobacter is available (GenBank NC_008229 [GenBank])
        - ELAND software selected the 8.389 million 32-mer reads to be uniquely matched against the Helicobacter reference sequence with zero, one or two mismatches (labeled U0, U1 or U2, respectively, see Figure 1b).
        
        - Additionally, generated a 27-mer read data set for the sugar beet (Beta vulgaris) bacterial artificial chromosome (BAC) clone ZR-47B15.
        - The data set consists of 2.788 million reads, 2.156 million of which were labeled U0, U1 or U2 in the ELAND output (Figure 1a).
        
        - The Sanger reference sequence in finished quality of this BAC insert consists of 10 9563 bases with 34.85% GC (Dohm et al., manuscript submitted for publication). For all uniquely matched reads, ELAND reports the match position in the reference sequence as well as the error position(s) in the read.

        - Sequence characteristics and total number of reads starting in a sliding window of 1 kbp in width. Found a correlation of read coverage and GC content in both data sets. In regions of elevated GC content the number of reads was increased. For instance, windows with a GC content of 40% contain almost twice as many reads as windows with 30% GC in the Beta data set
    
        - Tested whether the distributions shown in Figure 3 are compatible with a uniform distribution of reads across the target sequences. We have applied a {chi}2-test (goodness of fit) to reject the hypothesis that reads have the same probability to fall into equally sized regions of the target sequence (P < 1e10 even when dividing target sequences in only five regions).
        
    
   - extract and process information from ELAND output files
   - find positions of reads that can be aligned more than once to the reference sequence without mismatches (the positions of those reads are not reported by ELAND)
    - detection of deletions and insertions of single nucleotides in otherwise error-free reads
    - analysis of quality values per base call



method ???
International Journal of Bioinformatics Research and Applications
 	 Issue: 	 Volume 5, Number 2 / 2009
 	 Pages: 	 224 - 237
 	URL: 	Linking Options
Correcting short reads with high error rates for improved sequencing result

Thomas K.F. Wong A1, T.W. Lam A2, P.Y. Chan A3, S.M. Yiu A4

A1 Faculty of Engineering, Department of Computer Science, The University of Hong Kong, Pokfulam Road, Hong Kong.
A2 Faculty of Engineering, Department of Computer Science, The University of Hong Kong, Pokfulam Road, Hong Kong.
A3 Faculty of Engineering, Department of Computer Science, The University of Hong Kong, Pokfulam Road, Hong Kong.
A4 Faculty of Engineering, Department of Computer Science, The University of Hong Kong, Pokfulam Road, Hong Kong
Abstract:

In the sequencing process, reads of the sequence are generated, then assembled to form contigs. New technologies can produce reads faster with lower cost and higher coverage. However, these reads are shorter. With errors, short reads make the assembly step more difficult. Chaisson et al. (2004) proposed an algorithm to correct the reads prior to the assembly step. The result is not satisfactory when the error rate is high (e.g., ?3%). We improve their approach to handle reads of higher error rates. Experimental results show that our approach is much more effective in correcting errors, producing contigs of higher quality.





</entry>



<entry [Sun Apr 19 22:10:56 EDT 2009] SELECT HUMAN SAMPLES FROM SHORT READ ARCHIVE>




******************
TEST DATA CRITERIA
******************

1. Pedigree (Hapmap, 1000 genomes)
2. SRA, all platforms - 454, Solexa, Solid (and Sanger?)
3. Papers


1) Amplicons of 6 human genes (Harismendy et al 2009)
=====================================================

1. Pedigree - none

2. SRA - ??? email sent to kfrazer@scripps.edu

3. Papers - Harismendy et al 2009, Evaluation of next generation sequencing platforms for population targeted sequencing studies

Sample
------

NextGen
*******
Twenty-eight LR-PCR reactions were performed to amplify six genomic intervals spanning a total of 266 kb in each of four DNA samples (NA17275, NA17460, NA17156, and NA17773) obtained from the Coriell Institute [32] (Additional data file 2).

Following LR-PCR, the 28 amplicons generated using a single DNA sample template, ranging in size from 3,088 bp to 14,477 bp, were quantified, combined in equimolar amounts, and used to create libraries for Roche 454, Illumina GA and ABI SOLiD sequencing.

NB: ADJUST FOR BIAS TOWARDS LESS REPEATS AND MORE CODING SEQUENCE IN SAMPLE - SEE FIGURE 1: "The 260 kb examined in this study is representative of human sequences containing 38% repeats and 4% coding sequence compared with 47% and 1%, respectively, genome-wide."


Sanger
******
We used an existing data set deposited by JCVI and performed under the auspices of the National Heart, Lung and Blood Re-sequencing and Genotyping program [34]. The data set included 88 kb of non-contiguous sequence encompassing the exons and the intronic sequence conserved with mouse and rat in the K+/Na+ channel proteins produced by employing 273 short-range PCR reactions generating amplicons averaging 418 bp in length.


Alignment
---------

454 - Newbler
The Roche 454 laboratory methods and protocols used were as described by Rothberg and coworkers [23]. The reads produced by the Roche 454 FLX platform were mapped to the reference sequence using the algorithm Newbler version 1.1.03.19 (provided by Roche), unless stated otherwise

Solexa - MAQ
The Illumina GA libraries were prepared according to the manufacturer's instructions from the 28 equimolar pooled PCR products except for the fragmentation step (Additional data file 2). The Illumina GA reads were aligned with MAQ 0.6.2 [33], unless stated otherwise.

SOLiD - Corona-Lite
Long mate pair (LMP) libraries DNA libraries were generated from the four 28 equimolar pooled amplicon samples and end sequenced using standard ABI SOLiD protocols at Applied Biosystems in Beverly, MA. For each sample, ABI aligned the sequence reads to the reference sequence and mate-pairing information was not employed in this project. The aligned reads and the number of calls per base for each position were used for data analysis (Additional data file 2).


SNPs
----

Calling genotypes in the NGS sequence data

We define the alternate allele as the most commonly called base (which is not the reference base) for a given position in the reference sequence. Then, the AARF is the fraction of reads corresponding to the alternate allele.

Positions called as reference homozygote by ABI Sanger have AARFs close to 0% by the NGS technologies (Supplemental Figure 2 in Additional data file 3). Also, positions called as alternate homozygous by ABI Sanger have AARFs near or at 100% by the NGS technologies. The AARFs for heterozygous calls by ABI Sanger is centered at 50% for Roche 454 and Illumina GA; for ABI SOLiD it is centered at 42% (Additional data file 2). Upon independent inspection of the three technologies, most ABI Sanger-called heterozygotes fell in the range 20-80%. Thus, for the NGS technologies, utilizing only high quality bases we call positions with AARFs between 20% and 80% as heterozygous, positions with AARFs >80% as homozygous alternate, and positions with AARFs <20% as homozygous reference (Additional data file 2).


Performance
-----------

Definitions of performance metrics

In order to assess the performance of the sequencing technologies, we define several metrics.

Comparing a genotyping microarray to a sequencing technology
Genotype accuracy

We genotyped the four samples on the Illumina Hap550 microarray according to specifications of the manufacturer. We compared the genotype calls of the SNPs on the Hap550 microarray with the genotypes observed from sequencing (Supplemental Table 8 in Additional data file 1). Genotype accuracy is defined as: (Number of genotypes matching exactly between Illumina Hap550 and a sequencing technology)/(Number of compared positions).


Metrics for comparing a NGS sequencing technology with ABI Sanger

We initially assumed the ABI Sanger sequence data are correct because it is an established method with the longest history [2]. Upon further analysis, we found that this assumption was not always true; there were some positions incorrectly called by ABI Sanger, but correctly called by the NGS technologies (see Results). We refer to Table 1 annotations to clarify these definitions.

    Table 1. Annotations of the genotypes differences to illustrate the definition of the metrics used to compare ABI Sanger and NGS Technologies
    Sequencing accuracy

This is defined as the number of concordant calls between ABI Sanger and a NGS technology. Following the diagram above, this is calculated as (A1 + B2 + C3)/Total, where Total is defined as the number of positions with genotype calls by both technologies, or (A1 + A2 + A3 + B1 + B2 + B3 + C1 + C2 + C3). Because the sequencing accuracy metric is dominated by the concordance of a large number of homozygous reference calls (A1), this metric tends to be very near 1.
Variant accuracy

Because 'sequencing accuracy' tends to be dominated by the large number of homozygous reference calls, we define another metric called 'variant accuracy'. Variant accuracy is restricted to the variant positions called by ABI Sanger and is defined as: (B2 + C3)/(A2 +A3 + B2 + B3 + C2 + C3).
False positive rate of variants (false positive rate)

We define a false positive when the NGS technology calls a variant where ABI Sanger calls a homozygous reference. The false positive rate is calculated as (B1 + C1)/(B1 + B2 + B3 + C1 + C2+ C3).
False negative rate of variants (false negative rate)

We define a false negative when ABI Sanger detects a variant, but the NGS method calls this locus as a homozygous reference. The false negative rate is calculated as (A2 + A3)/(A2 + A3 + B2 + B3 + C2 + C3).
Variant discrepancy rate

We define the variant discrepancy rate as (B3 + C2)/(B2 + B3 + C2 + C3). This metric reflects ABI Sanger variant positions that are also detected by the NGS technology, but where the genotype calls disagree.
Coverage rate

The fraction of positions with genotype calls is defined as 1-(D1 + D2 + D3)/(A1 + A2 + A3 + B1 + B2 + B3 + C1 + C2 + C3 + D1 + D2 + D3).
ABI Sanger false positive rate

We define a ABI Sanger false positive when ABI Sanger calls a variant but all three NGS technologies call the locus as homozygous reference. We assume the NGS technologies to be correct, and this was confirmed by re-inspection of the ABI Sanger traces. The ABI Sanger false positive rate is calculated as follows. The numerator is the number of loci that are called as homozygous reference by all three NGS technologies, but as a variant in ABI Sanger. In the denominator, we consider all positions that were called as variant by Sanger and also had a genotype call by all three NGS technologies.
ABI Sanger false negative rate

We define a ABI Sanger false negative as a locus where the initial call by ABI Sanger is homozygous reference but all three NGS technologies detect a variant at this locus. In the numerator of the ABI Sanger false negative rate, we count the number of variant loci that are identified by all three NGS technologies but called as homozygous reference by ABI Sanger. We note that zygosity may not agree among the three NGS technologies, but if all three technologies identify a variant at the position, the locus is included (Supplemental Table 12 in Additional data file 1). The denominator represents the number of loci called as variant by all three NGS technologies (although the zygosity may differ).


Simulations
-----------

Simulations were performed in order to assess performance of each NGS platform at lower coverage depths. For each simulation, we randomly sampled a subset of the reads and recalled genotypes. The size of the subset was determined by the desired coverage depth.
Inferring coverage at various error rate degradations

To obtain the coverage depths in Figure 5, we first examined the error rate at the maximal simulated coverage. For 50% error rate degradation, we multiplied the error rate at the maximal coverage by 1.5 to get the desired error rate. For 10% error rate degradation, we multiplied the error rate at the maximal coverage by 1.1 to get the desired error rate. We then examined the error rates from the simulations at different coverage depths, and interpolated what coverage depth corresponds to the desired error rate. For example, the false positive error rate for Illumina GA at 140 from the simulations is 0.073. At 50% error rate degradation, the false positive rate is 0.110. The false positive rates at coverage depths of 60 and 80 are 0.118 and 0.099, respectively, so we know that a coverage depth within the range of 60 to 80 will give a false positive rate of 0.110. Using linear interpolation, we deduce that a coverage depth of 68 gives a false positive rate of 0.110, and this is reported in Figure 5.

The error rates for Illumina GA and ABI SOLiD at maximum simulated coverage are slightly higher than what was experimentally observed. The additional errors observed in the simulations are largely associated with low coverage regions and are different between iterations, whereas the systematic errors present in the experimental data set at full coverage are shared between iterations. This shows that the simulation produces random sampling errors, directly associated with low coverage regions.



2) NA18507 (YRI family Y009)
============================


1. Pedigree - yes

African Human Genome Data Summary

NA18507 father
NA18506 child ****** NOT YET AVAILABLE!!
NA18508 mother

2. Short read archive - available except child

http://0-www.ncbi.nlm.nih.gov.millennium.unicatt.it/Traces/sra/sra.cgi?cmd=table&f=sample&m=data&s=sample

3. Paper - Bentley, 2008. Accurate whole human genome sequencing using reversible terminator chemistry


38x coverage of NA18507 (achieved in 8 weeks)
All paired and mate pair reads; 35-50 bases, 0.2 & 2kb gap sizes
Data submitted to NCBI (SRA000271)
17x coverage of other members of trio for public release

SRP000239  Human genome sequencing of an African male individual (HapMap: NA18507) using the Illumina Genome Analyzer
http://www.dtd.nlm.nih.gov/Traces/sra/sra.cgi?study=SRP000239

Study Type: Whole Genome Sequencing
Submission: SRA000271 by ILLUMINA on 2008-11-05T22:22:00Z
Abstract: We have generated paired-end sequence data covering the genome of an African male individual to a sequence depth of more than 40-fold using the Illumina Genome Analyzer. This individual is a member of the population samples described in the PhaseI and PhaseII HapMap Projects and is from the Yoruba in Ibadan, Nigeria (abbreviation: YRI). The DNA identifier for this individual is NA18507
Description: We obtained the DNA sample NA18507 from The Coriell Institute for Medical Research. We generated two sequencing libraries. The first had a median insert size of 200 bp and was produced following random fragmentation and gel fractionation of the genomic DNA. This library was used for generating most of the data (38x coverage). The second library provided longer range paired-read information. For this library fragments of 2 kb were produced by random fragmentation and gel fractionation. These fragments were circularised and fragmented and the junction fragments were recovered. Paired-end sequencing of the two libraries was carried out using the Illumina Genome Analyzer. We carried out purity-filtering (PF) to remove mixed reads, where two or more different template molecules are close enough on the surface of the flow-cell to form a mixed or overlapping cluster. No other filtering of the data has been carried out prior to submission. The data contain 3.77 billion PF reads from the short-insert library and 296 million PF reads from the long-insert library


INSDC Project id: 29429
External Links: NA18507

RUNs for each experiment

Insert  Accession	Spots	Bases
200bp    SRX000600	1.5G	209.0G
200bp   SRX000601	26.4M	3.9G
200bp   SRX000602	121.7M	18.0G
200bp   SRX000603	55.9M	9.2G
2kb	    SRX001539	52.0M	7.5G  **** LONG
2kb	    SRX001540	96.1M	13.8G **** LONG
Total:      6		1.8G	261.3G


DOWNLOAD THE RUNS 

FTP directory

ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600
ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000601
ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000602
ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000603
ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001539
ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001540


deepvac.pl \
--url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600 \
--outputdir /scratch/syoung/base/pipeline/SRA/NA18507/SRP000239/SRX000600

    ...
    SRR006561_2.fastq.gz
    SRR006562_1.fastq.gz
    SRR006562_2.fastq.gz
    Files found: 374
    Downloading...   
    wget ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600/SRR002271_1.fastq.gz
    --16:47:51--  ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600/SRR002271_1.fastq.gz
               => `SRR002271_1.fastq.gz'
    Resolving ftp.ncbi.nlm.nih.gov... 130.14.29.30
    Connecting to ftp.ncbi.nlm.nih.gov|130.14.29.30|:21... connected.
    Logging in as anonymous ... Logged in!
    ==> SYST ... done.    ==> PWD ... done.
    ==> TYPE I ... done.  ==> CWD /sra/Studies/SRP000/SRP000239/SRX000600 ... done.
    ==> SIZE SRR002271_1.fastq.gz ... 1132261985
    ==> PASV ... done.    ==> RETR SRR002271_1.fastq.gz ... done.
    Length: 1132261985 (1.1G)
    
    100%[===========================================================>] 1,132,261,985 6.16M/s   in 3m 57s 
    ...
    
    
ls -alh

    total 4.1G
    drwxrwx---+ 3 syoung  1072   68 May  6 16:55 .
    drwxr-x---+ 4 syoung  1072   35 May  6 16:38 ..
    -rw-rw----+ 1 syoung users 3.8G May  6 16:52 SRR002271_1.fastq
    -rw-rw----+ 1 syoung users 281M May  6 16:53 SRR002271_2.fastq.gz
    drwxrwx---+ 2 syoung  1072  16K May  6 16:40 temp



screen -S deepvac-SRX000600


mkdir SRX000600

/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600 --outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000600




ON PLUTO:

screen -S deepvac-SRX000601

cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
mkdir SRX000601
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000601 --outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000601

    Run time: 00:46:09
    Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
    9:39PM, 7 May 2009
    ****************************************


cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
mkdir SRX000602
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000602 --outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000602

    Run time: 01:57:08
    Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
    11:17PM, 6 May 2009
    ****************************************


cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
mkdir SRX000603
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000603 --outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX000603

    Run time: 00:39:20
    Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
    0:12AM, 7 May 2009
    ****************************************

cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
mkdir SRX001539
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001539 --outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX001539

    Length: 882826406 (842M)
    100%[=============================================================>] 882,826,406 2.88M/s   in 5m 59s    
    00:00:28 (2.34 MB/s) - `SRR005719_2.fastq.gz' saved [882826406]
    
    Run time: 00:26:15
    Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
    0:00AM, 7 May 2009
    ****************************************


cd /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507
mkdir SRX001540
/store/Data01/NGS/syoung/base/bin/utils/deepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX001540 --outputdir /store/Data01/NGS/syoung/base/pipeline/SRA/NA18507/SRX001540

    Run time: 00:28:34
    Completed /store/Data01/NGS/syoung/base/bin/utils/deepvac.pl
    0:04AM, 7 May 2009
    ****************************************


DOWNLOADED SNPS FOR NA18507:

http://www.ncbi.nlm.nih.gov/SNP/snp_viewBatch.cgi?sbid=857037&all=1&batch=ILLUMINA-UK|ILLUMINA_WTSI:NA18507_c1&task=download&sortOrder=chr_rs_ss&go=go
http://www.ncbi.nlm.nih.gov/SNP/snp_viewTable.cgi?type=contact&handle=ILLUMINA-UK

WHICH I ARRIVED AT THROUGH:

Illumina Human Genome Sequencing Data
http://www.illumina.com/HumanGenome

First Yoruban human genome NA18507 
Described in Bentley DR, Balasubramanian S, Swerdlow HP, Smith GP, Milton J, et al. (2008) Accurate whole human genome sequencing using reversible terminator chemistry. Nature 456: 53-59. 



DOWNLOADED SNPS AND INDELS FOR NA18507 FROM SANGER:

ftp://ftp.sanger.ac.uk/pub/rd/NA18507/NA18507.indel.gz

ftp://ftp.sanger.ac.uk/pub/rd/NA18507/NA18507.snp.gz

Sanger README:
ftp://ftp.sanger.ac.uk/pub/rd/NA18507/00README.txt

NA18507.snp.gz
==============

Each line consists of chromosome, position, reference base, consensus
base, Phred-like consensus quality, read depth, the average number of
hits of reads covering this position, the highest mapping quality of the
reads covering the position, the minimum consensus quality in the 3bp
flanking regions at each side of the site (6bp in total), the second
best call, log likelihood ratio of the second best and the third best
call, and the third best call.

NA18507.indel.gz
================

Each line consists of chromosome, position, genotype and the score. The
higher the score the more reliable the call.

NB: AT THE BOTTOM OF THE FILE, NT_113898 IS THE CHROMOSOME ENTRY

Contig	 :	 NT_113898		
Homo sapiens chromosome 6 genomic contig, reference assembly.
http://howdy.jst.go.jp/HOWDYCL//HOWDY.pl?Cls=Contig&Key=UKEY&Val=nt_113898



3) Human X chromosome NA07340 


1. Pedigree - CEPH/Utah resident with ancestry from northern and western Europe. 

2. Sequences accessible - ftp://ftp.era.ebi.ac.uk/ERA000035/

3. Paper - Bentley D, et al.also describes sequence of the X chromosomes from the female sample NA07340 (CEPH/Utah resident with ancestry from northern and western Europe). 


X chromosome data are freely available from ERA,
accession ERA000035








TRIED DOWNLOADING WITH CLUSTERDEEPVAC BUT DID NOT RUN BECAUSE THE HEAD NODE IS THE BOTTLENECK, SO USED deepvac.pl ON pluto INSTEAD.

clusterDeepvac.pl --url ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600 --outputdir /mihg/data/NGS/syoung/SRA/SRA000271 --qsub "qsub -q psmall"

    Doing get(ftp://ftp.ncbi.nlm.nih.gov/sra/Studies/SRP000/SRP000239/SRX000600)
    Moving to output directory: /mihg/data/NGS/syoung/SRA/SRA000271
    Files found: 374
    Downloading...   
    qsub -q psmall wget-SRR002271_1.fastq.gz.sh.kronos.ccs.miami.edu
    qsub -q psmall wget-SRR002271_2.fastq.gz.sh
    ...
    qsub -q psmall wget-SRR006562_2.fastq.gz.sh
    24604.kronos.ccs.miami.edu
    
    Run time: 00:13:38
    Completed /nethome/syoung/base/bin/utils/clusterDeepvac.pl
    0:35AM, 6 May 2009
    ****************************************
    






ALTERNATE DOWNLOAD URLs:

ftp://ftp.1000genomes.ebi.ac.uk/    ### not working

ftp://ftp-trace.ncbi.nih.gov/1000genomes/


********** ftp://ftp-trace.ncbi.nih.gov/1000genomes/README.ftp_structure

The 1000genomes project has two mirrored ftp sites:
ftp://ftp.1000genomes.ebi.ac.uk and ftp://ftp-trace.ncbi.nih.gov/1000genomes/ 

These follow this basic structure.

At the top level there are 3 directories:

data
release
technical
changelog_details

==== data ====:
 contains a subdirectory per individual of the project. Each individual directory
contains series of subdirectories for different data sets like sequence reads, sequence alignments etc.

e.g  ftp://ftp.1000genomes.ebi.ac.uk/data/NA12878/sequence_reads/SRR003082.recal_1.fastq.gz 
or   ftp://ftp-trace.ncbi.nih.gov/1000genomes/data/NA12878/sequence_reads/SRR003082.recal_1.fastq.gz

==== release ==== 
 contains dated directories which contain analysis results sets released on
that date plus readmes explaining how those data sets were produced.

e.g ftp://ftp.1000genomes.ebi.ac.uk/release/2008_12/
or  ftp://ftp-trace.ncbi.nih.gov/1000genomes/release/2008_12/

==== technical ==== 
 contains subdirectories for other data sets like simulations or files for
method development interm data sets etc.

e.g ftp://ftp.1000genomes.ebi.ac.uk/technical/simulations
or  ftp://ftp-trace.ncbi.nih.gov/1000genomes/technical/simulations

=== changelog_details ===

In order to make the main root-level CHANGELOG human-readable, and scrollable, when changes are made
involving lareg moves or renames of files, these are referenced in the CHANGELOG and placed in this
changelog_details directory. Wherever possible (in all cases so far) these will be in programmatically 
parseable format. Thus far they are all have column 1: old file location, column 2: new file location,
which will also allow for renaming.


=== Index ===

The volume of data generated by 1000genomes project is unprecedented. Therefore in order 
to find and easily download the sequence_read files you need an index file is provided: 
ftp://ftp.1000genomes.ebi.ac.uk/sequence.index or
ftp://ftp-trace.ncbi.nih.gov/1000genomes/sequence.index 

This is a tab-separated file whose format is documented here: 
ftp://ftp.1000genomes.ebi.ac.uk/README.sequence.index  or
ftp://ftp-trace.ncbi.nih.gov/1000genomes/README.sequence.index

This file should provide you with sufficient data to download subsets of files by 
individual, pilot, technology etc. This index also contains the md5s for the fastq 
files


mother NA18508
--------------

http://www.dtd.nlm.nih.gov/Traces/sra/sra.cgi?study=SRX003971


SHORT READ ftp DOWNLOAD

ftp://ftp.ncbi.nih.gov/pub/TraceDB/ShortRead



DOWNLOAD FASTQ FROM HERE
ftp://ftp.ncbi.nih.gov/pub/TraceDB/ShortRead/SRA000271/fastq/ 

    Index of /pub/TraceDB/ShortRead/SRA000271/fastq/
    
    Name	Size	Date Modified
    [parent directory]		
    200x36x36-071113_EAS56_0053-s_1_1.fastq.gz	167.5 MB	5/20/08 8:00:00 PM
    200x36x36-071113_EAS56_0053-s_1_2.fastq.gz	180.5 MB	5/20/08 8:00:00 PM
    200x36x36-071113_EAS56_0053-s_2_1.fastq.gz	183 MB	5/20/08 8:00:00 PM
    200x36x36-071113_EAS56_0053-s_2_2.fastq.gz	193.8 MB	5/20/08 8:00:00 PM
    200x36x36-071113_EAS56_0053-s_3_1.fastq.gz	190.2 MB	5/20/08 8:00:00 PM
    200x36x36-071113_EAS56_0053-s_3_2.fastq.gz	199.2 MB	5/20/08 8:00:00 PM
    ...

mkdir -p /mihg/data/NGS/syoung/SRA/SRA000271
cd /mihg/data/NGS/syoung/SRA/SRA000271
deepvac.pl --url ftp://ftp.ncbi.nih.gov/pub/TraceDB/ShortRead/SRA000271/fastq/ --outputdir /mihg/data/NGS/syoung/SRA/SRA000271


CHECKED FASTQ FILE:

head 200x36x36-071113_EAS56_0053-s_1_1.fastq 
    @071113_EAS56_0053:1:1:756:463
    GTGATTAGTGAAACATAAAATAGTTTCATGTTGAAA
    +
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIGIAI
    @071113_EAS56_0053:1:1:813:752
    GTGGGAAAAACTGAAATACATTGCTTATGGATTCAT
    +
    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIA?II/%I
    @071113_EAS56_0053:1:1:556:366
    TTTTCTTGATTTCATTTTAGCACAATCATTAATTAC

records 200x36x36-071113_EAS56_0053-s_1_1.fastq "@"
5840389

lines 200x36x36-071113_EAS56_0053-s_1_1.fastq 
17020968



Bentley et al 2008. Accurate whole human genome sequencing using reversible terminator chemistry

DNA samples (NA07340 and NA18507) and cell line (GM07340) were obtained from Coriell Repositories. DNA samples were genotyped on the HM550 array and the results compared to publicly available data to confirm their identity before use. Methods for DNA manipulation, including sample preparation, formation of single-molecule arrays, cluster growth and sequencing were all developed during this study and formed the basis for the standard protocols now available from Illumina, Inc. All sequencing was performed on Illumina GA1s equipped with a one-megapixel camera. All purity filtered read data are available for download from the Short Read Archive at NCBI or from the European Short Read Archive (ERA) at the EBI.












</entry>



<entry [Sun Apr 19 22:10:56 EDT 2009] HOW DIFFERENT ALIGNERS TREAT PAIRED ENDS>




http://seqanswers.com/forums/showthread.php?t=1600


Actually there are a lot to say about paired-end mapping. This is where the accuracy of different aligners differs. The algorithms can be classified into four groups.

a) Eland-like strategy. Eland finds up to 10 equally best hits first and then check which pair (10x10 in total) is consistent. SSAHA2 uses a similar strategy, but seeing more top hits.

b) SOAP-like strategy. SOAP finds almost all the hits and then pair them. I do not know whether it may map a read to a suboptimal position if its mate is hanging around. I am sure SOAP-2.0.1 and BWA do this if necessary. You can say a) and b) are essentially the same, but only b) is useful to anchor reads in repeats.

c) MAQ-like strategy. MAQ does not find all the single-end hits first. It pairs the reads while doing the alignment. For programs indexing reads, this strategy is more effective and efficient than collecting all the single-end hits first.

d) We can map one end first and then do local alignment around the region pointed by the mapped reads. This strategy is usually combined with the previous. I believe NovoAlign/MAQ/BWA use this strategy as a complement to other strategies.

For short reads, proper pairing increases the coverage of the genome and substantially reduce false alignments.


</entry>



<entry [Sun Apr 19 22:10:56 EDT 2009] Unbiased Comparisons of Short-Read Aligners>




In summary, there are a number of competing tools for short read alignment, each with its own set of strengths, weaknesses, and caveats. Its hard to trust any benchmarking comparison on tools like these because usually, its the developers of one of the tools that publish them. Heres an idea: what if NHGRI, Illumina, or another group put together a short-read-aligning contest? They generate a few short-read data sets: real, simulated, with/without errors, with/without SNPs and indels, etc. Then, the developers of each aligner are invited to throw their best efforts at it. Every group submits the results to a DCC, which analyzes the results in a simple, unbiased way: # of reads placed correctly/incorrectly. # of SNPs/indels detected, missed, or false-positives. The results are published on a web site or in the literature for all to see. Yeah, I know, there are hurdles, like the fact that most proprietary tool developers would probably chicken out of an unbiased head-to-head comparison, given the stakes. But wouldnt it be nice to know the results? Unless that happens, however, I think Hengs analysis is about as unbiased as can be.



</entry>



<entry [Sun Apr 19 12:51:56 EDT 2009] MAQ Simulation Related and CHECK SYSTEMATIC ERROR OF SEQUENCER>



USAGE:

fakemut maq fakemut [-r mutrate] [-R indelfrac] in.ref.fasta > out.fakeref.fasta 2> out.fake.snp

Randomly introduce substitutions and indels to the reference. Substitutions and sinlge basepair
indels can be added.
OPTIONS:
-r FLOAT Mutation rate [0.001]
-R FLOAT Fraction of mutations to be indels [0.1]



simutrain maq simutrain out.simupars.dat in.read.fastq

Estimate/train parameters for read simulation.



simulate maq simulate [-d insize] [-s stdev] [-N nReads] [-1 readLen1] [-2 readLen2] [-r mutRate]

[-R indelFrac] [-h] out.read1.fastq out.read2.fastq in.ref.fasta in.simupars.dat

Simulate paired end reads. File in.simupars.dat determines the read lengths and quality distribution.
It is generated from simutrain, or can be downloaded from Maq website. In the output
read ?les, a read name consists of the reference sequence name and the outer coordinates
of the pair of simulated reads. By default, simulate assumes reads come from a diploid
sequence which is generated by adding two different sets of mutations, including one basepair
indels, to in.ref.fasta.
    OPTIONS:
    -d INT mean of the outer distance of insert sizes [170]
    -s INT standard deviation of insert sizes [20]
    -N INT number of pairs of reads to be generated [1000000]
    -1 INT length of the first read [set by in.simupars.dat]
    -2 INT length of the second read [set by in.simupars.dat]
    -r FLOAT mutation rate [0.001]
    -R FLOAT

fraction of 1bp indels [0.1]
-h add all mutations to in.ref.fasta and generate reads from the single mutated
sequence (haploid mode)

NOTE:
* Reads generated from this command are independent, which deviates from the truth.

Whereas alignment evaluation is less affected by this, evaluation on SNP calling should be
performed with caution. Error dependency may be one of the major causes of wrong SNP
calls.


simustat maq simustat in.simu-aln.map > out.simustat

Evaluate mapping qualities from simulated reads.





ALGORITHM:

SEE IN version 0.71

C:\DATA\00.archive\02-ng.assembly\maq\download\maq-0.7.1\maq-0.7.1\simulate.c




Li 2008
Mapping short DNA sequencing reads and calling variants using mapping quality scores

Methods

Simulating diploid genomes and short reads
MAQ also generates in silico mutated diploid sequences by adding random mutations to the known reference sequence. The human reference genome does not contain heterozygotes, but when we resequence a human sample and map reads to the reference genome, we will see both homozygous and heterozygous variants in comparison to the reference. If the sample and the reference come from the same population and at a potential polymorphic site the allele frequency is f, the probability of observing a heterozygote is

2f(1 - f)

and of observing a homozygous variant is

f(1 - f) (= f2(1 - f) + f(1 - f)2).

Consequently, on the condition that a site is different from the reference, the probability of a heterozygote is always 2/3, regardless of the allele frequency f, assuming the sample comes from the same population as the reference.

Based on this observation, we can simulate a diploid genome as follows.

We first used the reference genome as the two preprocessed haplotypes.

We then generated a set of polymorphic sites, randomly selected two thirds of them as heterozygotes, and took the rest as homozygotes.

At a heterozygous site, we randomly selected one haplotype and mutated the base into another one; on a homozygous site, we mutated both haplotypes.

Both substitutions and indels can be simulated in this way.

This simulation ignores linkage disequilibrium between variants.

Although coalescent-based simulation (Hudson 2002) gives a more accurate long-range picture, the procedure described here is sufficient for the evaluation of the variant calling method for a single individual.

!PAIRED END!

From a known sequence, paired-end reads can be simulated with insert sizes drawn from a normal distribution and with base qualities drawn from the empirical distribution estimated from real sequence data.

Sequencing errors are introduced based on the base quality.

With sufficiently large data, we are able to estimate the position-specific distributions of base qualities and the correlation between adjacent qualities as well.

An order-one Markov chain is constructed, based on these statistics, to capture the fact that low-quality bases tend to appear at the 3--end of a read and to appear successively along a read.





mapcheck 	maq mapcheck [-s] [-m maxmis] [-q minQ] in.ref.bfa in.aln.map > out.mapcheck

Read quality check. The mapcheck first reports the composition and the depth of the reference. After that there is a form. The first column indicates the position on a read. Following four columns which show the nucleotide composition, substitution rates between the reference and reads will be given. These rates and the numbers in the following columns are scaled to 999 and rounded to nearest integer. The next group of columns show the distribution of base qualities along the reads at a quality interval of 10. A decay in quality can usually be observed, which means bases at the end of read are less accurate. The last group of columns present the fraction of substitutions for read bases at a quality interval. This measures the accuracy of base quality estimation. Idealy, we expect to see 1 in the 3? column, 10 in the 2? column and 100 in the 1? column.

OPTIONS:
-s 	Take single end mapping quality as the final mapping quality
-m INT 	Maximum number of mismatahces allowed for a read to be counted [4]
-q INT 	Minimum mapping quality allowed for a read to be counted [30]





</entry>



<entry [Tues Mar 31 23:12:24 EDT 2008] REVIEWS OF ELAND>




SEE ALSO (DETAILED)
http://analysis.yellowcouch.org/dsf/ga0.3/Whole%20genome%20alignments%20using%20ELAND.html


Thursday, January 17, 2008
Aligning DNA - Eland
http://www.fejes.ca/2008/01/aligning-dna-eland.html


Continuing in my series of blog articles on short-read sequencing, it's time for a little bit of a discussion on the first short-sequence aligner that I'd ever met: Eland. The problem with writing anything about Eland, is that 90% of the information I have on it can't be confirmed independently. In fact, the majority of what I know comes from the header of the ELAND.cpp file. I'll admit, while I've gone through the source code a couple of times, I haven't spent much time getting to know it's well - I've processed billions of lines of Eland files, but have yet to run it, myself...

Anyhow, here's what I can tell you: Eland stands for "Efficient Local Alignment of Nucleotide Data" and was written by Anthony J. Cox for Solexa Ltd. Of course, Solexa has since been bought out by Illumina, so I assume the copyright has been transferred along with the technology during that transaction.

What makes Eland so fascinating to me is that it's a direct departure from the dynamic programming based algorithms (like the venerable Smith-Waterman alignment), making it somewhat interesting as a computational program.

The basic algorithm works along these lines: Given a sequence of length N, it can be divided into four subsequences (A, B, C, and D), which are of equal (or nearly equal length). Assuming there are no more than 2 errors, at least two of these subsequences will be "error free", so that the two error free sequences can then be searched for in a database containing all possible subsequences in the genome of interest. Thus, you can search your database for the subsequence AB and CD. Of course, you don't know which subsequences are the error free ones, so you need to try all possible combination.

What Eland does to speed things up is to combine these subsequences into sets of two. Thus, rather than searching for 4 independent entries in their database, they simply have to search for 2 sets of two, and as long as one set matches, you can use looser matching criteria on the other two, ie, allowing for mismatches. That is to say, if you make two sequences out of the 4 subsequences {AB and CD}, you can search for an exact match for AB, and test all the possible results for mismatches in the {CD} portion of the sequence. This has the effect of significantly reducing the search space. (Only sequences containing the exact match to {AB}.)

Searching for the {AB and CD} subsequences would only work if the first half of your sequence has no errors. What if B and C had the errors? The simple answer is to shuffle your subsequences to make other combinations: ({AB and CD}, {AC and BD}, {AD and CD}, {BA and CD}, etc.) This still provides you with a relatively small search space for each sequence, as there are only 4! possible combinations (which is 4x3x2x1 = 24 possible sequences) to search for.

Fortunately, you can bound this even further. You always know that you want sequences in which the first pair and second pair are in the correct order, (ie {AB and CD} and {AC and BD} are ok, but {CA and DB} and {BA and DC} would give you an incorrect result) limiting you to only six possible combinations, which still allows you to find any correct match where at least two of the four subsequences are error free.

That, in general is how it works.. with a few nifty shortcuts. ie, they only need to pass over the genome search space 3 times to find all possible matches with up to two errors, because they can search for subsequence combinations simultaneously and efficiently. In other words, you get a very quick alignment.

On the other hand, the way in which ELAND was implemented is very important. The Eland aligner has some severe restrictions, some of which are algorithm specific, some of which are implementation specific:

   1. The Eland aligner can only align sequences up to 32 base pairs long. (Implementation specific: they use four integers to represent the subsequences {A,B,C and D}, which reduces the memory requirements.)

   2. The Eland aligner can only align sequences with up to two mismatches. (Algorithm specific: at least two of the keys must match, although the algorithm could be expanded to use more subsequences, at the expense of expanding the sequence space.)

   3. The Eland aligner only returns sequences that match to one unique location in the genome (Implementation specific: Eland already tells you when a sequence matches to more than one location, it just doesn't tell you what those locations are.)

   4. The Eland aligner can do mismatches in the sequence, but can not handle insertions or deletions (i.e, gapped alignments). (Algorithm specific: The algorithm for matching the keys could be expanded to include this, but it would be very costly in time/memory.)

   5. The code is not freely available. (Implementation specific: I don't know of anywhere you can go to get the code... or documentation!)

   6. Changing the length of the alignment sequence (I called it N, above), requires a recompile. (Implementation, obviously. Why this isn't a command line parameter, I don't know.)



I'm sure I could go on and list other disadvantages, but I'd like to point out the main advantage: It's FAST. Blazing fast, compared to the other aligners. From my own personal experience, Eland may only be able to map 60-70% of your sequences to the genome (compared to 70-80% for other aligners with which I have less experience), but it does so in a few hours, compared to several days or weeks for most other aligners (or years, compared to Blast). (Comparisons are for a single processor, matching 1 million+ reads to a mamalian size genome.) The only other aligner that can come close to this speed is, to the best of my knowledge, SXOligoSearch, produced by Synamatix, though that beast will cost upwards of $225,000CAD to license.

Anyhow, to close this discussion, it's worth mentioning that rumours of a new version of Eland have been circulating since March 2007. Beta versions, capable of performing searches on sequences larger than 32 base pairs in length and able to perform multi-matches, were supposed to be released in September 2007. Unfortunately, the new betas appear to be vapourware, which has prompted us to look into several other aligners, which I'll discuss in future posts.

(2008-01-28 Update: I stand corrected: I've heard that the new betas have finally arrived! I haven't seen what they can do yet, but at least we know my prediction that they're vapourware is wrong.)

Labels: Aligners, DNA, Sequencing, Solexa/Illumina

posted by Anthony Fejes at 8:51 PM
5 Comments:

OpenID stajich said...

    You may want to take a look at SHRiMP which was developed for both colorspace matching from SOLiD and for short-read technology.

    http://compbio.cs.toronto.edu/shrimp/
    2:05 PM   
Anonymous SolexaSufferer said...

    Apparently the SOAP program deals with the shortcomings of ELAND fantastically. It handles repeat hits (and can report them all, none or one random). And it can align with in-dels up to 3bp. Tried it just now. All works.

    http://soap.genomics.org.cn/ and
    http://www.ncbi.nlm.nih.gov/pubmed/18227114
    7:07 PM   
Blogger Malarky said...

    Hello
    I found your blog whilst searching for details about the way that Eland actually works.
    I understand your description of the algorithm but what interests me is the data structure that is used to hold the reads (in RAM) and which the algorithm searches over (or in SOAPs case the reference). Do you know how this is done?
    5:21 AM   
Blogger Anthony said...

    Hi Malarky,

    I don't know how happy Illumina/Solexa or Anthony Cox would be if I gave out all of the details of their implementation, so I'm going to refrain from giving too much detail. Though the algorithm is relatively involved, using look up tables and such, they appear to be using a suffix tree to hold the oligos.

    I hope that helps.

    Anthony
    9:40 AM   
Blogger Malarky said...

    Hi
    Thats good enough. Thanks




The Eland Short Read Aligner
http://attractivechaos.wordpress.com/2008/08/24/eland-short-read-aligner

Eland is a computer program that aligns short oligonucleotides against a reference genome. It is written by Anthony Cox from the Illumina company. The source codes are freely available to machine buyers. Eland is the first program for short read alignment and it profoundly influences most of its successors.

Algorithm

Eland guarantees full sensitivity for hits with up to two mismatches. To achieve this, Eland divides a read into four parts with approximately equal lengths. Six noncontiguous seed templates can be constructed with each template covering two parts. Eland applies each seed templates on reads and indexes the sequences that pass the template. After indexing it scans the reference genome sequence base by base and then looks up each K-mer in the index to find hits. As any two mismatches can only occur to at most two of the four parts, the seeding strategy used by Eland guarantees to find all 2-mismatch hits.

Eland might be the first widely used program that achieves full sensitivity given a threshold. Most of Eland successors learn from this point, and some software, such as Maq and SeqMap, even use the same seeding strategy. SOLiD read mapping software and ZOOM further extend the idea of using noncontiguous seed templates to achieve full sensitivity with fewer templates.

Efficiency

Eland is so fast that it effectively sets a goal for all its successors. Although several software are claimed to achieve so, they cannot retain the same useful information as Eland. For example, frequently a program only gives the unique best hit without couting the occurrences of a read. Counting greatly helps to reduce false alignment in some cases, but implementing this is non-trivial. Comparing Eland to a program without counting is unfair.

Limitations

Eland is not perfect, though. Natively, it does not support reads longer than 32bp, paired end mapping nor gapped alignment. Eland provides several scripts to overcome these limitations, but the power is reduced. In particular, even with the help of the additional scripts, Eland will miss a read alignment if the first 32bp of the read is nonunique or if the read has more than 10 identical hits in the reference genome. These limitations give the room for other short read aligners.





</entry>



<entry [Wed Mar 25 13:12:24 EDT 2008] MESSAGE Jennifer RE: ALIGNMENT TOOL FOR NEXT GEN RNA VS DNA DATA>



Hi Jennifer,

I'll try to answer your questions though it's just my 2 cents worth :)

1) what's the difference between an alignment tool and an assembly tool?

Generally speaking, they're understood to mean (though they're often used interchangeably):

Alignment = align against a reference
Assembly = align de novo with no reference


2) Is there any way to tell whether an alignment/assembly tool is solely for short seq DNA as opposed to short seq DNA and/or RNA? I'm having trouble distinguishing tools that may be useful for transcriptome data vs. genome data.

I think a major requirement for a NextGen transcriptome alignment/assembly tool is that it can cope with intron/exon boundaries but you could discriminate between different tools in terms of errors or capabilities:

RNA alignment against DNA reference (transcriptome data)

 - how does the algorithm deal with RNA artefact/bias (5' prime vs 3' prime degradation, surfeit of ribosomal RNAs, etc)?
 - how does it cope with alternate splice sites?
 - how does it deal with systemic errors in the read sequence predictions?

DNA alignment against DNA reference (genome data)

 - how does the algorithm deal with systemic errors in the read sequence predictions?
 - can it use the whole genome as a reference?
 - how does it deal with multiply-mapped reads?

Some more generic criteria:

 - how does the algorithm deal with multiply-mapped reads?
 - how many differences can it allow between read and reference (substitutions, indels)
 - number of reads incorporated into assembly


Cheers,

Stuart.



</entry>



<entry [Fri Mar 06 21:09:24 EDT 2008] Nick CHAT RE: CHALLENGE GRANT>



1. CHECK WHERE UNMAPPED READS (AGAINST EXOME) MAP TO ON GENOME

    IF DON'T MAP TO GENOME WITH LESS THAN 3, 4 (?) ERRORS THEN IT CAN BE COUNTED AS A TRUE SEQUENCING ERROR

    OTHERWISE, IT'S A LIMITATION OF ELAND (ONLY 2 ERRORS)

2. CHECK TO SEE IF THERE ARE ANY PATTERNS (G/C, 2D STRUCTURE) OF UNMAPPED READS DIFFERENT TO MAPPED READS


3. DO SYNTHETIC READS AGAINST ALL TOOLS

    - DIFFICULT REGIONS OF DNA
    
    - RANDOM SELECTION OF DNA OR RNA
    
    - RNA WITH MANY REPEATS



4. CHECK FOR CONTAMINATIONS

    viral gene insertion
    
    fusion genes


</entry>



<entry [Sun Jan 04 21:09:24 EDT 2008] Short reads not aligned by assemblers - USE NOVOALIGN>



SEE Notes-apps-novoalign.txt
Sun Jan 04 23:16:01 EST 2009
RUN NOVOALIGN


http://seqanswers.com/forums/archive/index.php?t-256.html

08-06-2008, 09:09 AM
Reads that aren't matched by Eland are interesting because we would suppose that they're not repeats because Eland reports the matches with multiple locations. 
I would say that gaps in a read would probably be missed by Eland, so use a short read aligner that can find gaps on these reads. I've been using novoalign (www.novocraft.com) and it can find up to 7/8 gaps in a 36bp read matching to a reference sequence, and fast on large ones. I've even tested it on simulated data with mutation rates in excess of 15% and it still finds them. Use a very high threshold e.g. -t 200 to find potentially all permutations for your read.
I'd be interested to know how much more you may be able to match out of your Eland NM reads.






</entry>



<entry [Sun Jan 04 21:09:24 EDT 2008] SUMMARY OF COMPARISON STATS>




1.1.1 ELAND ALIGNMENT AGAINST cDNA REFERENCE:
=============================================

*** ROUGHLY 10% OF READS ALIGNED TO cDNA REFERENCE ***

1.1.1.2 ELAND ALIGNMENT STATS
-----------------------------
                Number reads       %
ALIGNED           479,065        10.07
NOT ALIGNED     4,277,155        89.93
TOTAL           4,756,220       100.00


1.1.2 ELAND '--multi' ALIGNMENT AGAINST cDNA REFERENCE:
=======================================================

*** ROUGHLY 23% OF human 1 READS HAD AN ELAND HIT (UNIQUE OR NOT, PERFECT OR NOT) AGAINST THE cDNA REFERENCE ***

            READS       %
ALIGNED     1116229     23.469
NON-ALIGNED 3639991     76.531
TOTAL       4756220     100.000

1.2.1.2 VELVET ALIGNMENT STATS
------------------------------
GET NUMBER OF READS INCORPORATED INTO DENOVO CONTIGS FROM .ace FILE

                Number reads       %
ALIGNED           961,245        20.210
TOTAL           4,756,220       100.00



*** 3,821 VELVET CONTIG HITS AGAINST cDNA, OF THEM AGAINST UNIQUE cDNAs ***


1.2.1.4 FILTER NUCMER OUTPUT TO GET ONLY UNIQUE HITS, THEN DO THE COORDS FILE 
------------------------------------------------------------------------------

*** 1,469 UNIQUE RECIPROCAL HITS BETWEEN VELVET CONTIGS AND cDNA (REDUCED TO 1,443 AFTER EXLUDING Chr6 VARIANT REGION cDNAs)***






1.2.1.8 GET UNIQUE TARGETS FROM *.coords FILE
---------------------------------------------

*** FOR BEST VELVET-cDNA UNIQUE HITS, 1,105 UNIQUE cDNAs WERE HIT BY VELVET CONTIGS (1,486 HITS IN TOTAL) ***

*** FOR ALL VELVET HITS, 2,493 UNIQUE cDNAs WERE HIT BY VELVET CONTIGS (4,244 HITS IN TOTAL) ***




1.3.1 COMPARE READS IN .ace FILES OF ELAND AND VELVET ASSEMBLIES
----------------------------------------------------------------

lines eland-only.txt
    324025
lines eland-velvet.both.txt
    155040
lines velvet-only.txt
    806205





</entry>



<entry [Fri Dec 26 10:09:24 EDT 2008] Lander-Waterman READ COVERAGE STATISTIC>



Lander-Waterman Statistics

Given: N reads of length L from a genome of size G
P(? covered by read) = 1  (1  L/G)N 
		?1  e-c, where c = N L / G is coverage
P(? covered by read) ?1  e-c





</entry>



<entry [Fri Dec 26 10:09:24 EDT 2008] SLIDER ASSEMBLER USES SOLEXA QUALITY VALUES>



Friday, December 26, 2008 10:09 AM
To: 	
Young, Stuart
Cc: 	
Hedges, Dale; Zuchner, Stephan; Huang, Jia; Dittman, David; Nunez, Eduardo
Attachments: 	
Slider_alignment_tool.pdf? (152 KB?)[Open as Web Page]

Hi Stuart,

I just came across this new aligner on pubmed.

Thanks,

Josh

http://bioinformatics.oxfordjournals.org/cgi/content/full/25/1/6

</entry>



<entry [Tues Dec 09 23:37:58 EDT 2008] THE POSTER DEALS WITH TWO ISSUES: 1) DIFFERENT ASSEMBLY OVERLAPS ON A REFERENCE SEQUENCE, 2) ASSEMBLY CONSENSUS DIFFERENCES IN OVERLAPPING REGIONS>




(1) HUMAN 1 (LANE 3) ASSEMBLY OVERLAPS AGAINST cDNA (EMBL) - Eland versus Velvet
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

1.1 ELAND
=========

LOCATION:

cd /home/syoung/base/pipeline/human1-eland/assembly


1.1.1 ELAND ALIGNMENT AGAINST cDNA REFERENCE:
=============================================

1.1.1.1 DO ELAND ALIGNMENT
--------------------------
./eland.pl -i /home/syoung/base/pipeline/human-eland/data/human1.fasta \
            -r /home/syoung/base/pipeline/human-eland/data \
            -o /home/syoung/base/pipeline/human-eland/assembly/human1-cdna_embl-eland.txt \
            > /home/syoung/base/pipeline/human-eland/assembly/human1-cdna_embl-eland.log



*** ROUGHLY 10% OF READS ALIGNED TO cDNA REFERENCE ***

1.1.1.2 ELAND ALIGNMENT STATS
-----------------------------
                Number reads       %
ALIGNED           479,065        10.07
NOT ALIGNED     4,277,155        89.93
TOTAL           4,756,220       100.00


STATS OBTAINED AS FOLLOWS:

CONCENTRATE HITS INTO ONE FILE:

cd /home/syoung/base/pipeline/human1-eland/assembly
cat human1-cdna_embl-eland.txt | grep NCBI36 > human1-cdna_embl-eland.hits

lines human1-cdna_embl-eland.hits
479065

lines human1-cdna_embl-eland.txt
4756220


1.1.1.3 CONVERT 'hits' FILE INTO GFF SORTED BY START POSITION:
--------------------------------------------------------------

./eland2gff.pl \
    --inputfile /home/syoung/base/pipeline/human1-eland/assembly/human1-cdna_embl-eland.txt \
    --chromofile /home/syoung/base/pipeline/human-genome/chromosome_positions.txt \
    --cdnadir /home/syoung/base/pipeline/human-cdna-embl/gff \
    --outputdir /home/syoung/base/pipeline/human1-eland/assembly/gff \
    --readlength 34

    Run time: 00:00:34
    Completed ./eland2gff.pl
    0:10AM, 17 December 2008
    # EXECUTED FULL COMMAND:
    # ./eland2gff.pl --inputfile /home/syoung/base/pipeline/human1-eland/assembly/human1-cdna_embl-eland.txt --chromofile /home/syoung/base/pipeline/human-genome/chromosome_positions.txt --cdnadir /home/syoung/base/pipeline/human-cdna-embl/gff --outputdir /home/syoung/base/pipeline/human1-eland/assembly/gff --readlength 34
    ****************************************




1.1.2 ELAND '--multi' ALIGNMENT AGAINST cDNA REFERENCE:
=======================================================

1.1.2.1 DO ELAND MULTI ALIGNMENT
--------------------------------

cd /home/syoung/base/pipeline/human1-eland/assembly-multi

    Run time: 00:04:41
    Completed ./eland.pl
    11:55PM, 15 December 2008
    # EXECUTED FULL COMMAND:
    # ./eland.pl -i /home/syoung/base/pipeline/human1-eland/data/human1.fasta -r /home/syoung/base/pipeline/human1-eland/data -o /home/syoung/base/pipeline/human1-eland/assembly/human1-cdna_embl-eland.txt
    ****************************************

1.1.2.2 CONDENSE cDNA HITS INTO 'hits' FILE AND DO ALIGNMENT STATS:
-------------------------------------------------------------------

cd /home/syoung/base/pipeline/human1-eland/assembly-multi
cat human1-cdna_embl-eland_multi.txt | grep NCBI36 > human1-cdna_embl-eland_multi.hits
lines *hits
    1116229

lines *txt
    4756220

*** ROUGHLY 23% OF human 1 READS HAD AN ELAND HIT (UNIQUE OR NOT, PERFECT OR NOT) AGAINST THE cDNA REFERENCE ***

            READS       %
ALIGNED     1116229     23.469
NON-ALIGNED 3639991     76.531
TOTAL       4756220     100.000


1.1.2.3 CONVERT 'hits' FILE INTO GFF SORTED BY START POSITION:
--------------------------------------------------------------

./eland2gff.pl \
    --inputfile /home/syoung/base/pipeline/human1-eland/assembly-multi/human1-cdna_embl-eland_multi.hits \
    --chromofile /home/syoung/base/pipeline/human-genome/chromosome_positions.txt \
    --cdnadir /home/syoung/base/pipeline/human-cdna-embl/gff \
    --outputdir /home/syoung/base/pipeline/human1-eland/assembly-multi/gff \
    --multi \
    --readlength 34

    Run time: 00:01:47
    Completed ./eland2gff.pl
    0:02AM, 17 December 2008
    # EXECUTED FULL COMMAND:
    # ./eland2gff.pl --inputfile /home/syoung/base/pipeline/human1-eland/assembly-multi/human1-cdna_embl-eland_multi.hits --chromofile /home/syoung/base/pipeline/human-genome/chromosome_positions.txt --cdnadir /home/syoung/base/pipeline/human-cdna-embl/gff --outputdir /home/syoung/base/pipeline/human1-eland/assembly-multi/gff --multi --readlength 34
    ****************************************

CHECK CHROMOSOME 3 LINES:

cd /home/syoung/base/pipeline/human1-eland/assembly-multi/gff/
lines  human-cdna-embl-chr3.eland.sorted.gff
132244


1.1.2.4 GENERATE .ace FILE 
--------------------------

eland2ace.pl --inputfile /home/syoung/base/pipeline/run2lane6-test/eland/s_6_1_sorted.txt \
--referencefile /home/syoung/base/pipeline/run2-human-mitochondria/data/human-mtDNA-AC_000021.fasta






1.2 VELVET
==========

1.2.1 VELVET DENOVO ALIGNMENT 
=============================

cd /home/syoung/base/pipeline/human1-velvet/assembly

1.2.1.1 DO VELVET ALIGNMENT 
---------------------------
Notes-project02-ng_assembly.txt, P.178
    
./velvet.pl -i /home/syoung/base/pipeline/human1-velvet/data/human1_sequence_in.solexa.fasta -l 21 
    
    Run time: 00:08:09
    Completed ./velvet.pl
    4:08PM, 14 August 2008
    ****************************************

VELVET GENERATED 4532 CONTIGS:

    records /home/syoung/base/pipeline/human1-velvet/assembly/contigs.fa
    Records: 4532

1.2.1.2 VELVET ALIGNMENT STATS
------------------------------
GET NUMBER OF READS INCORPORATED INTO DENOVO CONTIGS FROM .ace FILE

                Number reads       %
ALIGNED           961,245        20.210
TOTAL           4,756,220       100.00


CREATE .ace FILE: http://zion.ccs.miami.edu:8080/display/NextGen/Convert+.afg+to+.ace

    cd /home/syoung/base/pipeline/human1-velvet/data
    cp human1_sequence_in.solexa.fasta human1_sequence_in.seq
    cp human1_sequence_in.solexa.fasta.qual human1_sequence_in.seq.qual
    tarchive2amos -o human1_sequence_in human1_sequence_in.seq human1_sequence_in.seq.qual
    amos2ace human1_sequence_in.afg ../assembly/velvet_assy.afg

    TOOK 28 MINS

    ... RUNNING IN screen Fri Dec 12 13:30:36 EST 2008

    ll
    -rw-r--r-- 1 syoung users  297884535 Dec 12 13:58 human1_sequence_in.ace
    -rw-r--r-- 1 syoung users 2107663479 Dec 10 15:18 human1_sequence_in.afg
    -rw-r--r-- 1 syoung users  354253372 Dec 10 13:57 human1_sequence_in.seq
    -rw-r--r-- 1 syoung users  669133428 Dec 10 13:57 human1_sequence_in.seq.qual
    -rw-r--r-- 1 syoung users  354253372 Jul 20 21:13 human1_sequence_in.solexa.fasta
    -rw-r--r-- 1 syoung users  669133428 Jul 20 21:14 human1_sequence_in.solexa.fasta.qual
    -rw-r--r-- 1 syoung users          0 Dec 10 14:51 tarchive2amos.log
    -rw-r--r-- 1 syoung users 1569316864 Dec 10 14:18 tmp.18274.red

head human1_sequence_in.ace

    AS 4531 961245
    
    CO 1 146 100 60 U
    CATGAGAGTGGTGTTAATTATCCTCCCTCCAAGTTTGCAAATAAAGAGGT
    TGATACATATAAAGATTATAACTTGCCTAGATGGATTTGCAGAAAGATTT
    ATTACTAGCAATTTGTTATATTATTTTGCATCTCTTTTATTGTTTA
    
    BQ
     19 17 36 23 17 23 17 23 36 23 23 36 23 36 36 17 17 36 36 17 36 19 19 36 19 19 19 36 19 19 17 17 23 36 36 36 23 19 17 17 17 36 17 17 17 23 17 23 23 36
     36 23 17 36 17 19 17 36 17 36 17 17 17 23 17 36 36 17 36 17 17 19 36 36 23 19 19 36 17 23 17 36 23 23 17 36 36 36 23 19 17 23 17 17 17 23 17 36 36 36


RECOUNT THE NUMBER OF LINES WITH 'AF '

cd /home/syoung/base/pipeline/human1-velvet/data
grep -n "AF " human1_sequence_in.ace

961245

SAME AS IN .ace HEADER LINE SO OKAY.

    
***********************************************************************
*** NB: TRIED TO GET NUMBER FROM .afg FILE BUT NOT STRAIGHTFORWARD: ***
cd /home/syoung/base/pipeline/human1-velvet
grep -c iid: assembly/velvet_assy.afg
    4760751
cd /home/syoung/base/pipeline/human1-velvet
records data/human1_sequence_in.solexa.fasta
    4756221

ALIGNED     4760751
UNALIGNED      4530
TOTAL       4756221

LOOKS FISHY - iid DOES NOT REPRESENT JUST ALIGNED READS, RATHER ALL READS
***********************************************************************


1.2.1.3 DO NUCMER ALIGNMENT AGAINST cDNA
----------------------------------------

INPUTFILE IS VELVET CONTIGS: /home/syoung/base/pipeline/human1-velvet/assembly/contigs.fa

./nucmer.pl --inputfile /home/syoung/base/pipeline/human1-velvet/assembly/contigs.fa \
	--referencefile /home/syoung/base/pipeline/human-cdna-embl/Homo_sapiens.NCBI36.49.cdna.known.fas \
	--outputdir /home/syoung/base/pipeline/human1-velvet/nucmer-cdna


cd /home/syoung/base/pipeline/human1-velvet/nucmer-cdna
ll

    -rw-rw-rw-  1 syoung users 495K Dec 17 11:08 out.cluster
    -rw-rw-rw-  1 syoung users 328K Dec 17 11:08 out.delta


*** 3,821 VELVET CONTIG HITS AGAINST cDNA, OF THEM AGAINST UNIQUE cDNAs ***

records out.cluster 
    3821

head out.cluster
    /home/syoung/base/pipeline/human1-velvet/assembly/contigs.fa /home/syoung/base/pipeline/human-cdna-embl/Homo_sapiens.NCBI36.49.cdna.known.fas
    NUCMER
    >NODE_3812_length_271_cov_32.929890 ENST00000361390 291 957
     1  1
          67        1    225     -      -
    >NODE_1559_length_209_cov_15.354067 ENST00000361390 229 957
     1 -1
          16      957     75     -      -
          92      881    138     1      1

out.cluster FILE FORMAT:

    -   First line: the two original input files separated by a space.
    -   Second line: the type of alignment data - either "NUCMER" or "PROMER". 

Each match cluster contains a five column match list:

    1. the start of the match in the reference
    2. the start of the match in the query
    3. the length of the match
    4. the gap between this match and the previous match in the reference
    5. the gap between this match and the previous match in the query respectively.

    NB:
    
    All coordinates reference the forward strand of each sequence, regardless of match direction, and are always measured in DNA bases regardless of alignment type (DNA or amino acid). Therefore, when running PROmer, all the numbers in the length and gaps columns must be multiples of three.
    
    In addition, because the matches reference the forward DNA strand forward match clusters will be sorted in ascending fashion while reverse match clusters will be sorted in descending fashion.
    
    Each individual cluster has a header formed from two digits in the set [-1, -2, -3, 1, 2, 3]. These two digits represent the direction of the cluster (negative for reverse and positive for forward) and the frame of the cluster in the reference and query sequences respectively (note that matches within the same cluster must have a consistent reading frame).
    
    For NUCmer output, the header will always show a "1" for the reference and a "-1" or "1" for the query, since only the query can be reverse complemented. However, for PROmer output all 36 combinations of these two digits are valid headers. For instance, " -2 3" would represent a cluster on the 2nd reading frame of the reversed reference sequence and on the 3rd reading frame of the forward query sequence.


1.2.1.4 FILTER NUCMER OUTPUT TO GET ONLY UNIQUE HITS, THEN DO THE COORDS FILE 
------------------------------------------------------------------------------


1. CREATE delta.filter FILE (A one-to-one local mapping of reference to query sequences)

./nucmer-deltafilter.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/out.delta

*** 1,469 UNIQUE RECIPROCAL HITS BETWEEN VELVET CONTIGS AND cDNA (REDUCED TO 1,443 AFTER EXLUDING Chr6 VARIANT REGION cDNAs)***

cd /home/syoung/base/pipeline/human1-velvet/nucmer-cdna
records delta.filter 
1469



2. GENERATE COORDINATES FOR HITS WITHIN delta.filter FILE

./nucmer-showcoords.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/delta.filter

cd /home/syoung/base/pipeline/human1-velvet/nucmer-cdna
lines delta.filter.coords
    1491

cd /home/syoung/base/pipeline/human1-velvet/nucmer-cdna
head delta.filter.coords

    /home/syoung/base/pipeline/human1-velvet/assembly/contigs.fa /home/syoung/base/pipeline/human-cdna-embl/Homo_sapiens.NCBI36.49.cdna.known.fas
    NUCMER
    
        [S1]     [E1]  |     [S2]     [E2]  |  [LEN 1]  [LEN 2]  |  [% IDY]  |  [COV R]  [COV Q]  | [TAGS]
    ==========================================================================================================
           1      235  |     1792     1558  |      235      235  |   100.00  |    98.74     4.21  | NODE_3019_length_218_cov_5.032110       ENST00000006951
           1      497  |       25      521  |      497      497  |   100.00  |    98.81    95.39  | NODE_3183_length_483_cov_9.049689       ENST00000009589
           1      146  |      570      715  |      146      146  |   100.00  |   100.00    10.56  | NODE_5331_length_126_cov_5.142857       ENST00000022615
           1      134  |     1236     1369  |      134      134  |   100.00  |   100.00     9.70  | NODE_6976_length_114_cov_5.561403       ENST00000022615
           1      246  |     4280     4525  |      246      246  |   100.00  |   100.00     3.39  | NODE_3896_length_226_cov_8.252213       ENST00000031135


1.2.1.5 GENERATE GENOME-RELATIVE GFF FILE FOR UNIQUE HITS IN delta.filter.coords FILE
-------------------------------------------------------------------------------------

CREATE cdna_chromosomes.txt FILE FOR EMBL cDNAs:

1. GENERATE 'pre' FILE FROM FASTA HEADERS IN 'raw' FILE

./parsecolumns.pl --inputfile /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.raw.txt \
    --outputfile /home/syoung/base/pipeline/human-cdna-embl/cdna_chromosomes.pre.txt \
    --regex "^.+?>(\S+)\s+[^:]+:[^:]+:[^:]*?:([^:]+):(\d+):(\d+):(\S+)\s+gene:(\S+)$" \
    --headings "id:start:stop:orientation:chromosome:gene" \
    --order "1:3:4:5:2:6"


head /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.pre.txt

    id      start   stop    orientation     chromosome      gene
    ENST00000391556 7373    8827    -1      NT_113908       ENSG00000212867
    ENST00000361390 3308    4264    1       MT      ENSG00000198888
    ENST00000391565 3308    5514    1       MT      ENSG00000212876
    ENST00000361453 4471    5512    1       MT      ENSG00000198763
    ENST00000391564 5585    7515    1       MT      ENSG00000212875
    ENST00000361624 5905    7446    1       MT      ENSG00000198804
    ENST00000361739 7587    8270    1       MT      ENSG00000198712

2. GENERATE GENOME-RELATIVE cDNA POSITIONS FILE WITH 'pre' FILE AND chromosome_positions.txt FILE

./cdna-positions.pl --inputfile /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.pre.txt \
--chromofile /home/syoung/base/pipeline/human-genome/chromosome_positions.txt \
--outputfile /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.final.txt


ll /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.final.txt
    -rw-rw-rw- 1 syoung users 1.8M Dec 19 21:13 /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.final.txt

head /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.final.txt
    ENST00000298232 2836447089      2836531783      84695
    ENST00000342420 2836447089      2836531783      84695
    ENST00000359693 2836447089      2836512601      65513
    ENST00000361285 2836447089      2836531783      84695
    ENST00000400230 2836447620      2836531761      84142
    ENST00000356832 2836561721      2836639576      77856
    ENST00000335369 2836588426      2836639616      51191
    ENST00000400589 2839855984      2839865210      9227
    ENST00000305570 2839909529      2839926349      16821
    ENST00000332473 2840162467      2840163848      1382


3. GENERATE GENOME-RELATIVE VELVET CONTIG HITS AGAINST cDNA USING *coords FILE AND cdna_positions.final.txt FILE
(NB: EXCLUDED ALL cDNAS BELONGING TO CHROMOSOME 6 VARIANTS AND THEREFORE NOT IN chromosome_positions.txt FILE, E.G., Chromosome c6_COX)
./coords2gff.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/delta.filter.coords --chromofile /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.final.txt --source velvet --algorithm nucmer

    /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/delta.filter.coords.gff
    
    Run time: 00:00:00
    Completed ./coords2gff.pl
    10:15PM, 19 December 2008
    ****************************************

lines /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/delta.filter.coords.gff

    1443
    
head /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/delta.filter.coords.gff

    #seqname        source  feature start   end     score   strand  frame   attributes      comments
    NODE_3019       velvet  contig  2542202175      2542202422      .       +       .       Target: ENST00000006951; Coverage: 5.032110; Length: 248; Query hit start/stop: 1..235; Alignment algorithm: nucmer
    NODE_3183       velvet  contig  1476534352      1476534864      .       +       .       Target: ENST00000009589; Coverage: 9.049689; Length: 513; Query hit start/stop: 1..497; Alignment algorithm: nucmer
    NODE_5331       velvet  contig  1461755275      1461755430      .       +       .       Target: ENST00000022615; Coverage: 5.142857; Length: 156; Query hit start/stop: 1..146; Alignment algorithm: nucmer
    NODE_6976       velvet  contig  1461755941      1461756084      .       +       .       Target: ENST00000022615; Coverage: 5.561403; Length: 144; Query hit start/stop: 1..134; Alignment algorithm: nucmer
    NODE_3896       velvet  contig  1219694283      1219694538      .       +       .       Target: ENST00000031135; Coverage: 8.252213; Length: 256; Query hit start/stop: 1..246; Alignment algorithm: nucmer
    NODE_4753       velvet  contig  1219694281      1219694462      .       +       .       Target: ENST00000031135; Coverage: 5.203948; Length: 182; Query hit start/stop: 1..169; Alignment algorithm: nucmer
    NODE_6483       velvet  contig  716681770       716681924       .       +       .       Target: ENST00000040738; Coverage: 7.352000; Length: 155; Query hit start/stop: 1..145; Alignment algorithm: nucmer
    NODE_6915       velvet  contig  2423427209      2423427298      .       +       .       Target: ENST00000044462; Coverage: 5.116667; Length: 90; Query hit start/stop: 1..79; Alignment algorithm: nucmer
    NODE_193        velvet  contig  688137475       688137825       .       +       .       Target: ENST00000169298; Coverage: 11.632399; Length: 351; Query hit start/stop: 1..341; Alignment algorithm: nucmer



1.2.1.6 FILTER NUCMER OUTPUT TO GET ONLY UNIQUE HITS, THEN DO THE COORDS FILE 
------------------------------------------------------------------------------

1. COPY nucmer-cdna TO nucmer-cdna-all

cd /home/syoung/base/pipeline/human1-velvet
cp -r nucmer-cdna nucmer-cdna-all

2. CREATE delta.filter FILE (A one-to-one local mapping of reference to query sequences)

./nucmer-deltafilter.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/out.delta --parameters " "

cd /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all
records delta.filter 
    3821
records ../nucmer-cdna/delta.filter
    1469

*** delta-filter RETAINED ALL 3,821 VELVET CONTIG HITS AGAINST cDNA ***


2. GENERATE COORDINATES FOR HITS WITHIN delta.filter FILE

./nucmer-showcoords.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/delta.filter

cd /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all
lines delta.filter.coords
    4249

cd /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all
head delta.filter.coords

    /home/syoung/base/pipeline/human1-velvet/assembly/contigs.fa /home/syoung/base/pipeline/human-cdna-embl/Homo_sapiens.NCBI36.49.cdna.known.fas
    NUCMER
    
        [S1]     [E1]  |     [S2]     [E2]  |  [LEN 1]  [LEN 2]  |  [% IDY]  |  [COV R]  [COV Q]  | [TAGS]
    ==========================================================================================================
           1      235  |     1792     1558  |      235      235  |   100.00  |    98.74     4.21  | NODE_3019_length_218_cov_5.032110       ENST00000006951
           1      118  |      584      467  |      118      118  |   100.00  |   100.00    13.10  | NODE_866_length_98_cov_7.540816 ENST00000008180
           1      497  |       25      521  |      497      497  |   100.00  |    98.81    95.39  | NODE_3183_length_483_cov_9.049689       ENST00000009589
          31      235  |      641      845  |      205      205  |   100.00  |    87.23    11.60  | NODE_4311_length_215_cov_5.865116       ENST00000010338
           1      420  |      833     1252  |      420      420  |    99.76  |   100.00    23.77  | NODE_875_length_400_cov_7.725000        ENST00000010338



1.2.1.7 GENERATE GENOME-RELATIVE GFF FILE FOR UNIQUE HITS IN delta.filter.coords FILE
-------------------------------------------------------------------------------------

CREATE cdna_chromosomes.txt FILE FOR EMBL cDNAs:

1. GENERATE 'pre' FILE FROM FASTA HEADERS IN 'raw' FILE

SEE ABOVE.

2. GENERATE GENOME-RELATIVE cDNA POSITIONS FILE WITH 'pre' FILE AND chromosome_positions.txt FILE

SEE ABOVE.


3. GENERATE GENOME-RELATIVE VELVET CONTIG HITS AGAINST cDNA USING *coords FILE AND cdna_positions.final.txt FILE
(NB: EXCLUDED ALL cDNAS BELONGING TO CHROMOSOME 6 VARIANTS AND THEREFORE NOT IN chromosome_positions.txt FILE, E.G., Chromosome c6_COX)

./coords2gff.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/delta.filter.coords --chromofile /home/syoung/base/pipeline/human-cdna-embl/cdna_positions.final.txt --source velvet --algorithm nucmer

    /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/delta.filter.coords.gff
    
    Run time: 00:00:00
    Completed ./coords2gff.pl
    10:36PM, 19 December 2008
    ****************************************

lines /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/delta.filter.coords.gff

    3970

COMPARED TO UNIQUE HITS:

lines /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/delta.filter.coords.gff

    1443
    
head /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/delta.filter.coords.gff

    #seqname        source  feature start   end     score   strand  frame   attributes      comments
    NODE_3019       velvet  contig  2542202175      2542202422      .       +       .       Target: ENST00000006951; Coverage: 5.032110; Length: 248; Query hit start/stop: 1..235; Alignment algorithm: nucmer
    NODE_866        velvet  contig  2452209115      2452209242      .       +       .       Target: ENST00000008180; Coverage: 7.540816; Length: 128; Query hit start/stop: 1..118; Alignment algorithm: nucmer
    NODE_3183       velvet  contig  1476534352      1476534864      .       +       .       Target: ENST00000009589; Coverage: 9.049689; Length: 513; Query hit start/stop: 1..497; Alignment algorithm: nucmer
    NODE_4311       velvet  contig  208000619       208000863       .       +       .       Target: ENST00000010338; Coverage: 5.865116; Length: 245; Query hit start/stop: 31..235; Alignment algorithm: nucmer
    NODE_875        velvet  contig  208000841       208001270       .       +       .       Target: ENST00000010338; Coverage: 7.725000; Length: 430; Query hit start/stop: 1..420; Alignment algorithm: nucmer
    NODE_5331       velvet  contig  1461755275      1461755430      .       +       .       Target: ENST00000022615; Coverage: 5.142857; Length: 156; Query hit start/stop: 1..146; Alignment algorithm: nucmer
    NODE_6976       velvet  contig  1461755941      1461756084      .       +       .       Target: ENST00000022615; Coverage: 5.561403; Length: 144; Query hit start/stop: 1..134; Alignment algorithm: nucmer
    NODE_3896       velvet  contig  1219694283      1219694538      .       +       .       Target: ENST00000031135; Coverage: 8.252213; Length: 256; Query hit start/stop: 1..246; Alignment algorithm: nucmer
    NODE_4753       velvet  contig  1219694281      1219694462      .       +       .       Target: ENST00000031135; Coverage: 5.203948; Length: 182; Query hit start/stop: 1..169; Alignment algorithm: nucmer





1.2.1.8 GET UNIQUE TARGETS FROM *.coords FILE
---------------------------------------------

*** FOR BEST VELVET-cDNA UNIQUE HITS, 1,105 UNIQUE cDNAs WERE HIT BY VELVET CONTIGS (1,486 HITS IN TOTAL) ***

./nucmer-uniquetargets.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/delta.filter.coords --outputfile out.targets 

    No. unique targets: 1105
    No. lines: 1486
    Output file printed:
    
    /home/syoung/base/pipeline/human1-velvet/nucmer-cdna/out.targets
    Run time: 00:00:00
    Completed ./nucmer-uniquetargets.pl
    11:09PM, 19 December 2008
    ****************************************


*** FOR ALL VELVET HITS, 2,493 UNIQUE cDNAs WERE HIT BY VELVET CONTIGS (4,244 HITS IN TOTAL) ***

./nucmer-uniquetargets.pl --inputfile /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/delta.filter.coords --outputfile out.targets 

    Inputfile: /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/delta.filter.coords
    Output directory: /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all
    No. unique targets: 2493
    No. lines: 4244
    Output file printed:
    
    /home/syoung/base/pipeline/human1-velvet/nucmer-cdna-all/out.targets
    Run time: 00:00:00
    Completed ./nucmer-uniquetargets.pl
    11:11PM, 19 December 2008
    ****************************************



1.3.1 COMPARE READS IN .ace FILES OF ELAND AND VELVET ASSEMBLIES
----------------------------------------------------------------

1. EXTRACT READS FROM VELVET .ace FILE:
/home/syoung/base/pipeline/human1-velvet/data/human1_sequence_in.ace

cd /home/syoung/base/pipeline/human1-velvet/data
cat human1_sequence_in.ace | grep "AF " > human1-velvet-assembled-reads.pre.txt

head human1-velvet-assembled-reads.txt 
    AF HWI-EAS185_1_JIA_cDNA_JH:3:1:237:251 U 69
    AF HWI-EAS185_1_JIA_cDNA_JH:3:14:154:894 U 73
    AF HWI-EAS185_1_JIA_cDNA_JH:3:27:247:920 U 105
    AF HWI-EAS185_1_JIA_cDNA_JH:3:29:166:899 U 70
    AF HWI-EAS185_1_JIA_cDNA_JH:3:31:834:294 U 48
    AF HWI-EAS185_1_JIA_cDNA_JH:3:33:293:287 U 73
    AF HWI-EAS185_1_JIA_cDNA_JH:3:47:755:370 U 86
    AF HWI-EAS185_1_JIA_cDNA_JH:3:59:267:42 U 105
    AF HWI-EAS185_1_JIA_cDNA_JH:3:63:94:532 U 95
    AF HWI-EAS185_1_JIA_cDNA_JH:3:69:119:133 U 89

cut -d " " -f 2 human1-velvet-assembled-reads.pre.txt > human1-velvet-assembled-reads.txt
head /home/syoung/base/pipeline/human1-velvet/data/human1-velvet-assembled-reads.txt
    HWI-EAS185_1_JIA_cDNA_JH:3:1:237:251
    HWI-EAS185_1_JIA_cDNA_JH:3:14:154:894
    HWI-EAS185_1_JIA_cDNA_JH:3:27:247:920
    HWI-EAS185_1_JIA_cDNA_JH:3:29:166:899
    HWI-EAS185_1_JIA_cDNA_JH:3:31:834:294
    HWI-EAS185_1_JIA_cDNA_JH:3:33:293:287
    HWI-EAS185_1_JIA_cDNA_JH:3:47:755:370
    HWI-EAS185_1_JIA_cDNA_JH:3:59:267:42
    HWI-EAS185_1_JIA_cDNA_JH:3:63:94:532
    HWI-EAS185_1_JIA_cDNA_JH:3:69:119:133


2. EXTRACT READS FROM ELAND .txt FILE:

ELAND .txt FILE:

cd /home/syoung/base/pipeline/human1-eland/assembly
head human1-cdna_embl-eland.txt

cut -f 1 human1-cdna_embl-eland.txt > human1-eland-assembled-reads.pre.txt
cut -d ">" -f 2 human1-eland-assembled-reads.pre.txt > human1-eland-assembled-reads.txt

head /home/syoung/base/pipeline/human1-eland/assembly/human1-eland-assembled-reads.txt 
    HWI-EAS185_1_JIA_cDNA_JH:3:1:129:540
    HWI-EAS185_1_JIA_cDNA_JH:3:1:113:576
    HWI-EAS185_1_JIA_cDNA_JH:3:1:212:252
    HWI-EAS185_1_JIA_cDNA_JH:3:1:118:571
    HWI-EAS185_1_JIA_cDNA_JH:3:1:207:277
    HWI-EAS185_1_JIA_cDNA_JH:3:1:103:565
    HWI-EAS185_1_JIA_cDNA_JH:3:1:211:297
    HWI-EAS185_1_JIA_cDNA_JH:3:1:114:511
    HWI-EAS185_1_JIA_cDNA_JH:3:1:217:361
    HWI-EAS185_1_JIA_cDNA_JH:3:1:728:353


3. FIND THE INTERSECTION OF THE VELVET AND ELAND MATCHES

./compare-reads.pl --firstfile /home/syoung/base/pipeline/human1-eland/assembly/human1-eland-assembled-reads.txt --secondfile /home/syoung/base/pipeline/human1-velvet/data/human1-velvet-assembled-reads.txt --assemblynames eland,velvet --outputdir /home/syoung/base/pipeline/human-eland-velvet

    First: eland, second: velvet
    Loading first file into hash: /home/syoung/base/pipeline/human1-eland/assembly/human1-eland-assembled-reads.txt ...
    Checking through second file for matching reads in first file...
    First only file printed: /home/syoung/base/pipeline/human-eland-velvet/eland-only.txt
    Second only file printed: /home/syoung/base/pipeline/human-eland-velvet/velvet-only.txt
    Both file printed: /home/syoung/base/pipeline/human-eland-velvet/eland-velvet.both.txt
    
    Run time: 00:00:04
    Completed ./compare-reads.pl
    2:40AM, 21 December 2008
    ****************************************


ll /home/syoung/base/pipeline/human-eland-velvet

    -rw-rw-rw-  1 syoung users  12M Dec 21 02:40 eland-only.txt
    -rw-rw-rw-  1 syoung users 5.7M Dec 21 02:40 eland-velvet.both.txt
    -rw-rw-rw-  1 syoung users  30M Dec 21 02:40 velvet-only.txt


cd /home/syoung/base/pipeline/human-eland-velvet
lines eland-only.txt
    324025
lines eland-velvet.both.txt
    155040
lines velvet-only.txt
    806205


GOOD IF VELVET IS GOOD ASSEMBLY...    


CREATE ONE OR MORE SEQUENCE FILES (FILENAME = SEQUENCE ID, CONTENT = SEQUENCE ONLY) FROM SINGLE FASTA FILE

./sequence-files.pl --fastafile /home/syoung/base/pipeline/human-cdna-embl/Homo_sapiens.NCBI36.49.cdna.known.fas \
--outputdir /home/syoung/base/pipeline/human-eland-velvet/sequences

OKAY:
40,000+ 'ENST00000401097' ETC. SEQUENCE FILES PRINTED TO DIRECTORY /home/syoung/base/pipeline/human-eland-velvet/sequences

E.G.:
head  /home/syoung/base/pipeline/human-eland-velvet/sequences/ENST00000401096

GET READ ALIGNMENT ACCURACIES BY COMPARING THE CONSENSUS SEQUENCE IN AN .ace FILE TO THE ACTUAL SEQUENCE:

./ace-read-accuracy.pl --inputfile /home/syoung/base/pipeline/human1-velvet/data/human1_sequence_in.ace \
--sequencedir /home/syoung/base/pipeline/human-eland-velvet/sequences


GET READ ALIGNMENT ACCURACIES FOR:

    1) ELAND ONLY READS

    2) VELVET ONLY READS

    3) READS INCORPORATED IN BOTH ELAND AND VELVET









(2) HUMAN 2 (LANES 1-3,5-8) ASSEMBLY OVERLAPS AGAINST cDNA (EMBL) - Eland versus Velvet
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ELAND
=====

LOCATION:

cd /home/syoung/base/pipeline/human2-eland/assembly


RUN ELAND MULTI:

DO 1 OF 2: 

./eland.pl -i /home/syoung/base/pipeline/human2-eland/data/human2-1of2.fasta  -r /home/syoung/base/pipeline/human2-eland/data -o /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland-1of2.txt > /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland-1of2.log
    
    Eland: /usr/local/Pipeline/Eland/eland
    Output directory: /home/syoung/base/pipeline/human2-eland/assembly
    /usr/local/Pipeline/Eland/eland /home/syoung/base/pipeline/human2-eland/data/human2-1of2.fasta /home/syoung/base/pipeline/human2-eland/data /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland-1of2.txt --multi
    
    Run time: 00:12:51
    Completed ./eland.pl
    0:07AM, 16 December 2008
    # EXECUTED FULL COMMAND:
    # ./eland.pl -i /home/syoung/base/pipeline/human2-eland/data/human2-1of2.fasta -r /home/syoung/base/pipeline/human2-eland/data -o /home/syoung/base/pipeline/human2-eland/assembl\
    y/human2-cdna_embl-eland-1of2.txt
    ****************************************

    ELAND OUTPUT:

    ...
    Parsed offset=119327430, name=/ENST00000315492
    Parsed offset=119328819, name=/ENST00000366471
    Parsed offset=119330529, name=/ENST00000391820
    Parsed offset=119330987, name=/ENST00000329291
    Parsed offset=119332960, name=/ENST00000355360
    Outputting results: User: 0.367944s System: 1.84372s Actual: 3.48364s Efficiency: 63.4871%
    Info: 17915531 matches were stored
    Info: 71662124 bytes of temp storage used for oligo numbers
    Info: 71662124 bytes of temp storage used for match positions
    ... done User: 47.4918s System: 11.0143s Actual: 59.0701s Efficiency: 99.0452%
    Run complete! Time now: Tue Dec 16 00:07:42 2008


DO 2 OF 2:

./eland.pl \
    -i /home/syoung/base/pipeline/human2-eland/data/human2-2of2.fasta \
    -r /home/syoung/base/pipeline/human2-eland/data \
    -o /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland-2of2.txt \
    &> /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland-2of2.log


tail /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland-2of2.log

    Run time: 00:12:44
    Completed ./eland.pl
    0:09AM, 16 December 2008
    # EXECUTED FULL COMMAND:
    # ./eland.pl -i /home/syoung/base/pipeline/human2-eland/data/human2-2of2.fasta -r /home/syoung/base/pipeline/human2-eland/data -o /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland-2of2.txt
    ****************************************



./eland.pl -i /home/syoung/base/pipeline/human2-eland/data/human2_sequence_in.fasta \
            -r /home/syoung/base/pipeline/human2-eland/data \
            -o /home/syoung/base/pipeline/human-eland/assembly/human2-cdna_embl-eland.txt

*** ROUGHLY 10% OF READS HAVE UNIQUE HITS AGAINST THE cDNA REFERENCE ***

                Number reads       %
ALIGNED          3,209,719      10.049
NOT ALIGNED     28,729,599      89.951
TOTAL           31,939,318     100.000



LScd /home/syoung/base/pipeline/human2-eland/assembly
cat human2-cdna_embl-eland-contigs.solexa.fasta.1 human2-cdna_embl-eland-contigs.solexa.fasta.2 > human2-cdna_embl-eland.txt
cat human2-cdna_embl-eland.txt | grep NCBI36 > human2-cdna_embl-eland.hits
lines human2-cdna_embl-eland.hits
    3,209,719
lines human2-cdna_embl-eland.txt
    31,939,318




VELVET
======

LOCATION:

/home/syoung/base/pipeline/human1-velvet/assembly

RUN:

Notes-project02-ng_assembly.txt, P.178



1. GENERATE ELAND ALIGNMENT CONTIGS .gff FILE:

CONCENTRATE ALL HITS IN ONE FILE:

/home/syoung/base/pipeline/human2-eland/assembly

cat human2-cdna_embl-eland-contigs.solexa.fasta.1 human2-cdna_embl-eland-contigs.solexa.fasta.2 | grep NCBI36 > human2-cdna_embl-eland.txt





./eland2gff.pl \
    --inputfile /home/syoung/base/pipeline/human2-eland/assembly/human2-cdna_embl-eland.hits \
    --outputdir /home/syoung/base/pipeline/human2-eland/assembly/gff \
    --cdnadir /home/syoung/base/pipeline/human-cdna-embl/gff \
    --chromofile /home/syoung/base/pipeline/human-genome/chromosome_positions.txt \
    --readlength 34


SORT THE ELAND GFF FILE JUST IN CASE THE cDNAs WERE NOT IN THE RIGHT ORDER:

./sortgff.pl -i /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.gff \
            -o /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.sorted.gff

    Run time: 00:00:03
    Completed ./sortgff.pl
    10:39PM, 15 December 2008
    ****************************************

lines /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.gff
lines /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.sorted.gff

diff /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.gff /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.sorted.gff


head /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.sorted.gff

./elandgff2contig.pl  --inputdir /home/syoung/base/pipeline/human2-eland/assembly/gff \
                      --outputdir /home/syoung/base/pipeline/human2-eland/assembly/contig



2. COMPARE OVERLAPPING CONTIGS ALIGNED TO EACH CHROMOSOME


./comparegff.pl \
    --firstfile /home/syoung/base/pipeline/human-cdna-embl/gff/human-cdna-embl-chr2.gff  \
    --secondfile /home/syoung/base/pipeline/human2-eland/assembly/gff/human-cdna-embl-chr2.eland.sorted.gff  \
    --assemblynames cdna,eland \
    --outputdir /home/syoung/base/pipeline/human2-eland/assembly/compare 




3. CHECK COVERAGE DIFFERENCES BETWEEN OVERLAPPING AND NON-OVERLAPPING REGIONS







(2) ASSEMBLY CONSENSUS DIFFERENCES IN OVERLAPPING REGIONS (RESIDUES AND READS)








</entry>



<entry [Thu Sep 11 23:37:58 EDT 2008] USE dnadiff TO COMPARE ASSEMBLIES>



Genome assembly forensics: finding the elusive mis-assembly
Reviewed by Adam M Phillippy,1 Michael C Schatz,1 and Mihai Popcorresponding author1
Published online 2008 March 14

The Phrap assemblies were aligned against the reference sequences using the MUMmer utility dnadiff to collect regions of mis-assembly. dnadiff performs a whole-genome alignment and compactly summarizes the location and characteristics of differences between two contig sets (http://mummer.sourceforge.net).

TAKEN FROM:

To supplement the anecdotal results presented above, we have performed a systematic evaluation of assemblies using amosvalidate. Sequencing data for 16 bacterial genomes were collected and assembled with Phrap v0.990329 using the phrap.manyreads program with default parameters. Phrap was chosen because of its popularity, simplicity, and tendency to mis-assemble repetitive genomes. Similar experiments were attempted with Celera Assembler, but not enough mis-assemblies were produced to allow adequate validation. In larger genomes, Celera Assembler, and virtually all other assemblers, produce many errors; however, there are not enough fully finished eukaryotic genomes to allow comprehensive testing of our methods. For extensive and objective testing, bacteria were chosen as the assembly targets because many complete, finished genomes are available, thus providing a proper reference that can be used to identify true mis-assemblies.

The Phrap assemblies were aligned against the reference sequences using the MUMmer utility dnadiff to collect regions of mis-assembly. dnadiff performs a whole-genome alignment and compactly summarizes the location and characteristics of differences between two contig sets [45]. 

For aligning contigs to a reference genome, this process is identical to the read mapping discussed in the 'Read breakpoint analysis' section. Using the same algorithm, the contig set is mapped to the reference genome using nucmer, and the optimal mapping for each contig is identified. The alignment information is then parsed, and all alignment breakpoints are identified. By default, nucmer creates a contiguous alignment as long as the average nucleotide identity is greater than 70% for a 200 bp window; therefore, any stretch of greater than approximately 60 mis-matches will force the alignment to break. After alignment, the breakpoints are classified as insertions, deletions, rearrangements, or inversions based on their surrounding context. For example, a breakpoint between a forward-strand and negative-strand alignment on the same contig is classified as an inversion. For the Phrap contigs, only alignment differences that produced a breakpoint were considered as mis-assemblies. Small differences such as consensus SNPs, short indels (less than approximately 60 bp), and breakpoints occurring within the first 10 bp of a contig were ignored. All contigs less than 5,000 bp were also ignored because of their generally low quality.

amosvalidate was then run on all 16 Phrap assemblies to determine if the mis-assembled regions were correctly identified by our methods. Additional data file 1 lists the NCBI Taxonomy and RefSeq identifiers for the 16 reference genomes. Table 1 gives a summary of the Phrap induced mis-assemblies, along with statistics detailing the performance of amosvalidate. Table 2 gives specific details on the types of mis-assemblies introduced by Phrap, and the size characteristics of the amosvalidate features. Mis-joins (rearrangements) were the most prevalent type of mis-assembly reported by dnadiff.


</entry>



<entry [Fri Aug 15 02:45 EDT 2008] CREATED compare-gff-reference.pl TO COUNT EXONS IN COMMON BETWEEN TWO ASSEMBLIES ON A REFERENCE BACKBONE>



COMPARED: eland, velvet (run 1 - HUMAN 7 LANES)

REFERENCE: HUMAN cDNA GFF FILES

./compare-reference.pl -f /home/syoung/base/pipeline/human-eland/assembly/gff/human-cdna-embl-chr1.eland.gff -s /home/syoung/base/pipeline/human2-velvet/nucmer.whole-human/chromosome-gff/human-velvet-nucmer.chr1.gff -p eland,velvet -r /home/syoung/base/pipeline/human-cdna-embl/gff/human-cdna-embl-chr1.gff -o /home/syoung/base/pipeline/human-eland-velvet/comparison-eland-velvet



OUTPUT

    1. SET 1 - NO. OF HITS IN BOTH ASSEMBLY 1 AND ASSEMBLY 2
    2. SET 2 - NO. OF HITS IN ASSEMBLY 1 AND NOT IN ASSEMBLY 2
    3. SET 3 - NO. OF HITS IN ASSEMBLY 2 AND NOT IN ASSEMBLY 1
    4. SET 4 - NO. OF HITS IN EITHER ASSEMBLY 1 OR ASSEMBLY 2







</entry>



<entry [http://massgenomics.wordpress.com/2008/05/14/short-read-aligners-maq-eland-and-others/] HENG LI COMPARISON OF MAQ WITH ELAND, RMAP, SOAP AND SHRiMP>



COMMENTS
========

Sparks (Colin, Novocraft):

MAQ randomly chooses one alignment from a set of equal scoring alignments, which introduces some FP and some extra (random) TP.

ac:
We generally get around this by providing only uniquely aligned reads from Eland as input to MAQ. The obvious drawback to this is that you may be losing some reads. However, I havent seen any drop in depth beyond 1X unless it is a highly repetitive region. Fortunately we did see some FPs go away with this approach but does anyone see any drawbacks?

#  Justin Says:
May 18, 2008 at 9:26 pm

I am under the impression that the random assignment protocol in MAQ for repeats results in a lower mapping quality score for such assigned reads.

Can anyone here point me in a direction to understand how SNP calling is conditioned on mapping quality score for MAQ?

I couldnt find it on the MAQ page.

ARTICLE
=======

Short Read Aligners: Maq, Eland, and Others

This month Ive come across some interesting statistics on the performance of Maq, Eland, and other short-read alignment tools as applied to Illumina/Solexa data. I took note because these programs are finally being evaluated against appropriate data sets, as opposed to simulated reads or tiny genomes. First the disclaimers: all of these numbers came from people other than myself (see Credits, below), so please forgive any inaccuracies. Also, this entry reflects my personal second-hand impressions of the different alignment tools, and should not be considered an endorsement or criticism of the different alignment tools by the WashU GC.

Short-Read Data Sets at the WashU Genome Center

One of our data sets includes 100+ Solexa runs (non-paired) from the genomic DNA of a single individual. Weve applied a number of alignment tools to these data: Eland (part of the Illumina suite), Maq (free/open source), SX Oligo Search (proprietary), SlimSearch (proprietary), and even BLAT. Our group (Medical Genomics) is currently leaning toward Maq for read mapping and SNP discovery purposes. Theres recently been a new release of Maq (0.6.5) which seems to run substantially faster:
Metric 	Maq 0.6.3 	Maq 0.6.5
Average alignment time for normal runs 	17.7 hours 	9.1 hours
Max alignment time for a normal run 	240 hours 	28.8 hours
Total number of jobs 	2168 	1467
Jobs that took longer than 1 day 	443 	3

The developer of Maq, Heng Li, presented a poster describing the Maq algorithm at CSHL last week and also gave a small workshop talk on issues in short read mapping. He sent these links out to the Maq user list along with a benchmarking comparison of various read mapping tools.

Heng Lis Comparison of Short-Read Aligners

For the comparison, Heng generated 1 million simulated read-pairs from chromosome X. The numbers themselves are a bit mind-boggling, but fortunately he summarized the results with these notes:

    * Eland: eland is definitely the fastest, much faster than all the competitors. What is more important, eland gives the number of alternative places, which makes it possible for you to get further information about the repetitive structures of the genome and to select reads that can be really confidently mapped. In addition, with the help of additional scripts, Eland IS able to map reads longer than 32bp. Eland is one of the best software I ever used. It would be even superior if Tony could make it easier to use for a user, like me, who wants to run eland independently of the GAPipeline.

    * RMAP: the strength of rmap is to use base qualities to improve the alignment accuracy. I believe it can produce better alignment than maq -se because maq trades accuracy for speed at this point (technically it is a bit hard to explain here). Nonetheless, I think rmap would be more popular if its authors could add support for fastq-like quality string which is now the standard in both Illumina and the Sanger Institute (although maybe not elsewhere). rmap supports longer reads, which is also a gain. Furthermore, I did learn a lot from its way to count the number of mismatches.

    * SOAP: soap is a versatile program. It supports iterative-trimmed alignment, long reads, gapped alignment, TAG alignment and PE mode. Its PE mode is easier to use than eland. In principle, soap and eland should give almost the same number of wrong alignments. However, soap gives 442 more wrong alignments. Further investigation shows that most of these 442 wrong ones are flagged as R? (repeat) by eland.

    * SHRiMP: Actually I was not expecting that a program using seeding +Smith-Waterman could be that fast. So far as I know, all the other software in the list do not do Smith-Waterman (maq does for PE data only), which is why they are fast. SHRiMPs normodds score has similar meaning to mapping quality. Such score helps to determine whether an alignment is reliable. The most obvious advantage is SHRiMP can map long reads (454/capillary) with the standard gapped alignment. If you only work with small genomes, SHRiMP is a worthy choice. I think SHRiMP would be better if it could make use of paired end information; it would be even better if it could calculate mapping quality. The current normodds score helps but is not exactly the mapping quality. In addition, I also modified probcalc codes because in 1.04 underflow may occur to long reads and leads to nan normodds. However, although my revision fixes the underflow, it may lead to some inaccurate normodds.

    * Maq: at the moment maq is easier to use than eland. Supporting SNP calling is maqs huge gain. Its paired end mode is also highly helpful to recover some repetitive regions. Maqs random mapping, which is frequently misused by users who have not noticed mapping qualities, may be useful to some people, too, and at least it helps to call SNPs at the verge of repeats.

What a nice guy! Here he is, comparing his own tool against several competitors and he manages to praise the strengths of each one. That takes humility.

More Comments from Heng Li

Ken Chen, a colleague of mine, happened to discuss the benchmarking with Heng at Cold Spring Harbor. According to his evaluation, the current version of recently-published SOAP may be somewhat buggy (it had more mapping errors and crashed on paired-end alignment), but is nevertheless promising because it supports gapped alignment and longer reads. Paired-end alignment is perhaps Maqs greatest strength; the alignment error rate from Maq for paired-end data is significantly reduced. Heng also mentioned that the upcoming new release of Eland will support longer read lengths (>32 bp) and will also calculate mapping quality scores.

Unbiased Comparisons of Short-Read Aligners

In summary, there are a number of competing tools for short read alignment, each with its own set of strengths, weaknesses, and caveats. Its hard to trust any benchmarking comparison on tools like these because usually, its the developers of one of the tools that publish them. Heres an idea: what if NHGRI, Illumina, or another group put together a short-read-aligning contest? They generate a few short-read data sets: real, simulated, with/without errors, with/without SNPs and indels, etc. Then, the developers of each aligner are invited to throw their best efforts at it. Every group submits the results to a DCC, which analyzes the results in a simple, unbiased way: # of reads placed correctly/incorrectly. # of SNPs/indels detected, missed, or false-positives. The results are published on a web site or in the literature for all to see. Yeah, I know, there are hurdles, like the fact that most proprietary tool developers would probably chicken out of an unbiased head-to-head comparison, given the stakes. But wouldnt it be nice to know the results? Unless that happens, however, I think Hengs analysis is about as unbiased as can be.

Credits

WashU GC Maq version comparisons were sent out by Jim Eldred on 5/01/2008. Heng Lis benchmarking comparison was sent to the Maq user list on 5/12/2008. Additional comments from Heng Li were reported by Ken Chen on 5/12/2008.



</entry>



<entry [Mon Aug 25 21:34:38 EDT 2008] ASSEMBLY TIMINGS>



mira
====

START
Localtime: Thu Jul  3 02:36:29 2008
END
Localtime: Thu Jul  3 08:39:08 2008

6:02 hours










++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

QUOTE FOR CLC BIO


From: Young, Stuart 
Sent: Monday, July 21, 2008 2:35 AM
To: Khuri, Sawsan
Subject: Next generation assemblers

Hi Sawsan,

It appears that neither the  Genomics Workbench or NextGene are quite what were looking for right now because they dont perform well or at all when loaded with our most recent batch of human data using the Solexa sequencer. DNAStar releases the demo version of SMGA in a week or sos time. It might be a good idea to wait until we can test SMGA before we purchase. 

I tried assembling one lane of Solexa data using CLC Bios Genomics Workbench and SoftGenetics NextGene but my laptop froze up in both cases. Genomics Workbench will do smaller data sets quite quickly and it has a nice GUI (graphical user interface). Genomics Workbench took 20 mins to do a reference sequence-based assembly and 200 mins to do a de novo respectively to finish the assembly. 

So neither of the two Windows-platform assemblers Ive tried so far can assemble large numbers of sequences. But Im wondering if the people who will use the assembly viewer may also want to use the other functions it has but it seems a lot to pay just for a nice UI.
 
Ill run some more tests tomorrow and send you the details and comparisons between different assemblies. (Ill also send you my bullets  I havent forgotten).

Cheers,


Stuart.



Genomics workbench
==================

-----Original Message-----
From: Rob Mervis [mailto:rmervis@clcbio.com] 
Sent: Thursday, July 10, 2008 10:19 AM
To: Young, Stuart
Subject: GWB Quote request from Suart Yong, University of Miami

Hi Stuart,

Thanks for your continued interest in the CLC Genomics Workbench.

As per your request below, I have attached 3 quotes;  for 1, 3, and 5 licenses of the Genomics Workbench Software.

Please note the discounts extended for each quantity.  The price breaks we offer that are applicable here are 25% off for quantities 2 - 4, and 35% off for quantities 5-9.  These discounts are applied to the already discounted Academic/Government/Non-profit list pricing of $4999 for a single license.


Please let me know if you have any questions.

Thanks again and best regards,

-Rob Mervis
